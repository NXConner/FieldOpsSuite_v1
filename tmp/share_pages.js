
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cf059cf0-fe07-5d25-afa0-f18f9974fc2e")}catch(e){}}();
import{j as e,v as W,r as p,z as A,h as X,c as J}from"./vendor-BK0nFAyt.js";import{aF as O,cT as Y,af as K,fr as Q,u as v,B as m,i as h,dD as U,cm as Z,ah as _,D as ee,fs as ae,ft as B,fu as se,a2 as te,aN as oe,aE as re,G as ne,A as ie,eW as ce,aS as le,eV as de,dX as me,c as ge,eY as pe,eX as ue}from"./index-CsNVOiaE.js";import he from"./copy-add-C58iCS4h.js";import{u as fe,c as xe,d as Pe,b as Se,P as ye,e as Ce,f as ve,g as je,h as Ne}from"./use-clean-history-state-DjDDzDTH.js";import E from"./delete-B-LLJLBf.js";import ke from"./eye-ecq5WZgO.js";import"./sentry-D3-uqDEW.js";import"./use-page-DAMeUVlT.js";import"./text-bold-6B99JMND.js";import"./text-bullet-list-alvY6QRa.js";import"./text-code-B5zvce_2.js";import"./text-italic-B8N-oUmx.js";import"./text-numbered-list-DlQLP5J-.js";import"./text-paragraph-DkJixuUb.js";import"./use-list-key-down-CTifKUl1.js";import"./pages-welcome-dark-r64A2mUI.js";import"./pages-welcome-light-DDUDcHxX.js";import"./contract-down-left-BwSlgERN.js";import"./arrow-enter-up-Dek80rks.js";import"./thumbs-up-filled-BwQjcjI1.js";import"./use-scroll-element-into-view-waXQSMgh.js";import"./use-supports-hover-CZ3yRVvS.js";function we(s){return K(s,Q,{analytics:{anonymousPath:"/pages/shares/*"}}).then(o=>o.data)}function be(s){const{refetch:o}=O(),{data:t,isLoading:a,error:r}=Y(`/pages/shares/${s}`,we,{shouldRetryOnError:!1,onSuccess:()=>{o()}});return{data:t,isLoading:a,error:r}}function M(s){const{mode:o,isCopying:t,onCopy:a,onShare:r}=s,{t:c}=v(),i=o==="copy",g=i?a:r,l=c(i?"common.makeACopy":"common.share");let d;return i?d=t?e.jsx(h,{className:"size-5"}):e.jsx(he,{className:"size-5"}):d=e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"size-5"}),e.jsx("span",{className:"hidden sm:inline",children:l})]}),e.jsx(m,{title:l,alignment:"center",color:"subtle-dimmed-inverted",size:"40-base",onClick:g,className:"shrink-0",children:d})}async function De(s){await _({path:s,args:{options:{method:"DELETE"},analytics:{anonymousPath:"/pages/shares/*/view"}}})}function Ie(s){const{trigger:o,isMutating:t}=Z(`/pages/shares/${s}/view`,De,{revalidate:!1}),{refetch:a}=O();return{deleteAndRefetchSharedPage:async()=>{await o(),await a()},isDeleting:t}}function F(s){const{pageId:o,onClose:t}=s,{t:a}=v(),{isDeleting:r,deleteAndRefetchSharedPage:c}=Ie(o),i=a("pages.removePageButtonText"),g=a("pages.keepPageButtonText"),l=()=>{t(!1)},d=async()=>{await c(),ae({sectionName:"titleBar",pageId:o}),t(!0)};return e.jsxs(ee,{isOpen:!0,onClose:l,headerText:a("pages.removeSharedPageModalTitle"),className:"w-full max-w-[400px]",children:[e.jsx("p",{className:"mb-6",children:a("pages.removeSharedPageModalDescription")}),e.jsx(m,{title:i,color:"default",size:"56-xl",variant:"rect",className:"mt-auto w-full text-system-red-550 dark:text-system-red-350",disabled:r,onClick:d,children:r?e.jsx(h,{className:"size-7"}):i}),e.jsx(m,{title:g,color:"strong",size:"56-xl",variant:"rect",className:"w-full",disabled:r,onClick:l,children:g})]})}const Te=A.object({impressionScenario:A.enum(se)});function ze(s){const o=Te.safeParse(s);return o.success?o.data:null}function Re(s){const{loaded:o}=s,{location:t}=W(),a=fe(),r=p.useRef(!1);p.useEffect(()=>{if(!o||r.current)return;const c=ze(t.state);if(c){const{impressionScenario:i}=c;B(i),a(["impressionScenario"])}else B("direct");r.current=!0},[a,o,t.state])}const Ae=X("/shares/pages/$shareId");function Be(){var z,R;const{shareId:s}=Ae.useParams();te.setLandingPage("sharedPage");const o=oe(),{t}=v(),{data:a,isLoading:r,error:c}=be(s),i=re();xe({isLoading:r});const g=ne("pages-header-v2"),l=!!((z=ie.instance().config().pages)!=null&&z.hideTitleBar),[d,j]=p.useState(!1),{captureFocus:f,restoreFocus:N}=ce(),k=()=>{f(),j(!0),ue({pageName:"viewerPage",sectionName:"titleBar",pageId:s})},{exportPage:L}=Pe({pageId:s,pageType:"viewerPage",pageTitle:a==null?void 0:a.title}),$=async n=>L(n),q=()=>{j(!1),setTimeout(()=>{N()},0)},{createConversation:G}=le(),[w,b]=p.useState(!1),x=()=>{f(),b(!0)},D=n=>{b(!1),setTimeout(()=>{N()},0),n&&G()},P=async n=>{await H({impressionScenario:"makeACopyViewerPage"}),pe({pageName:"viewerPage",sectionName:n,pageId:s})};p.useEffect(()=>{var n;(n=a==null?void 0:a.page)!=null&&n.id&&i({pageId:a.page.id,closeSidebar:!1,sourcePage:"sharedPage"})},[a,i]),Re({loaded:!!a&&!r&&!c});const{canCreatePage:S}=de(),{copyAndRefetchPage:H,isCopying:I}=Se(s,"viewerPage"),[u,T]=p.useState(!1);return r?e.jsx("div",{className:"grid size-full place-items-center bg-background-100",children:e.jsx(h,{className:"size-12"})}):c||!a?e.jsxs(e.Fragment,{children:[e.jsx(ye,{title:t("pages.errors.deletedSharedPageTitle"),message:t("pages.errors.deletedSharedPageDescription"),className:"max-w-pages-error",hideReloadButton:!0,headerAction:!l&&o&&e.jsx(m,{title:t("common.remove"),alignment:"center",color:"subtle-dimmed",size:"40-base",variant:"square",className:"shrink-0",onClick:x,children:e.jsx(E,{className:"size-5"})})}),!l&&o&&w&&e.jsx(F,{onClose:D,pageId:s})]}):(R=a.page)!=null&&R.id?null:e.jsxs(e.Fragment,{children:[e.jsx(Ce,{title:a.title??"",content:a.content??"",pageId:s,conversationId:"",toolbarItems:e.jsxs(e.Fragment,{children:[e.jsx(me,{color:"thin",containerClassNames:{surface:"px-0 py-0"},placement:"bottom-end",floatingOffset:4,renderTrigger:({openPopover:n,isOpen:y,ref:C})=>e.jsxs(m,{title:t("common.viewOnly"),color:"subtle-dimmed-inverted",size:"36-sm",ref:C,className:ge("shrink-0 whitespace-nowrap rounded-xl border border-stone-250 px-1.5 text-foreground-800 dark:border-slate-700",!S&&"pointer-events-none"),"aria-expanded":y,onClick:V=>{f(),n(V)},children:[e.jsx(ke,{className:"size-5"}),t("common.viewOnly")]}),renderSurface:({closePopover:n,focusRef:y})=>e.jsxs("div",{className:"flex w-[276px] flex-col gap-3 bg-acrylic-default-tint-light/95 p-4 dark:bg-acrylic-default-tint-dark/95",children:[e.jsx("div",{className:"p-1 text-foreground-600 text-sm",children:t("pages.copyPageDescription")}),e.jsx(m,{title:t(u?"common.loading":"common.makeACopy"),size:"36-sm",color:"strong",className:"shrink-0",ref:y,onClick:async C=>{T(!0),await P("viewOnlyPanel"),T(!1),n(C)},children:u?e.jsx(h,{className:"size-8"}):t("common.makeACopy")})]})}),g?e.jsxs(e.Fragment,{children:[e.jsx(ve,{onShare:k,onExport:$}),e.jsx(je,{isCopying:I&&!u,onCopy:()=>P("titleBar"),deleteButtonText:t("pages.editor.header.removePage"),onDelete:x})]}):e.jsxs(e.Fragment,{children:[S?e.jsx(M,{mode:"copy",isCopying:I&&!u,onCopy:()=>P("titleBar")}):e.jsx(M,{mode:"share",onShare:k}),S&&e.jsx(m,{title:t("common.remove"),alignment:"center",color:"subtle-dimmed",size:"40-base",variant:"square",className:"shrink-0",onClick:x,children:e.jsx(E,{className:"size-5"})})]})]}),readOnly:!0}),d&&e.jsx(Ne,{onClose:q,pageId:s}),w&&e.jsx(F,{onClose:D,pageId:s})]})}const ta=J("/shares/pages/$shareId")({component:Be});export{ta as Route};

//# debugId=cf059cf0-fe07-5d25-afa0-f18f9974fc2e
