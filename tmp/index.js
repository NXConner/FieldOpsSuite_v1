
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="9d6227d6-c0f1-54a4-96a3-a011de4575fb")}catch(e){}}();
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-AuNyv2yH.js","assets/vendor-BK0nFAyt.js","assets/sentry-D3-uqDEW.js","assets/index-C8996GQb.js","assets/deferred-CkS1ARY2.js","assets/math.scalar.functions-C0i4R8fp.js","assets/animationGroup-CVR9oVXA.js","assets/skeleton-CtN3nvI4.js","assets/rawTexture-B6LZah48.js","assets/easing-Cjz4Yrm4.js","assets/weightedsound-caP7Dwda.js","assets/audioEngine-DXMfS2Tx.js","assets/babylonFileParser.function-CWsVgwsY.js","assets/assetContainer-CSSLOHdq.js","assets/asyncLock-Ch21Em-h.js","assets/ray-DTzrvUcx.js","assets/webgpuEngine-Csf9l2Dm.js","assets/bakedVertexAnimation-CI6J844m.js","assets/helperFunctions-ByZuZJ7O.js","assets/fresnelFunction-DfLxnAAq.js","assets/meshUboDeclaration-CQdopdKT.js","assets/sceneUboDeclaration-B4nh6Adw.js","assets/decalFragment-DQm1EIrX.js","assets/dataReader-BrT-cUKg.js","assets/standardMaterial-DtdE369_.js","assets/shaderMaterial-CZsOK9u9.js","assets/bakedVertexAnimation-DV20roKO.js","assets/morphTargetsVertex-C6yPwsh3.js","assets/shadowsVertex-C_GdW6Wh.js","assets/vertexColorMixing-C7l2UvYY.js","assets/discBuilder-DqyK610r.js","assets/abstractEngine.cubeTexture-CaF84qmu.js","assets/engine.multiRender-C5JKdhfS.js","assets/environmentTextureTools-F-Pop1-G.js","assets/dumpTools-DfBnm0-p.js","assets/engine.multiRender-Cegdbh3K.js","assets/flowGraphParser-5zJkbBOD.js","assets/flowGraphRichTypes-BQ8A_8wF.js","assets/flowGraphJsonPointerParserBlock-CkMTtjBL.js","assets/flowGraphCachedOperationBlock-MjBm-RKC.js","assets/flowGraphConsoleLogBlock-BHS07Icg.js","assets/flowGraphBranchBlock-Qu1SBCWn.js","assets/flowGraphDoNBlock-D-jzarm-.js","assets/flowGraphForLoopBlock-8hsnjY9j.js","assets/flowGraphThrottleBlock-BIh9oBY2.js","assets/flowGraphMultiGateBlock-CFfYvDrG.js","assets/flowGraphSwitchBlock-C2D0JEJv.js","assets/flowGraphWaitAllBlock-D4x9e9e3.js","assets/flowGraphCounterBlock-CVYwsPSX.js","assets/flowGraphWhileLoopBlock-D23aVUzq.js","assets/flowGraphDebounceBlock-Byczfx_V.js","assets/flowGraphFlipFlopBlock-3hj-qjuP.js","assets/flowGraphSequenceBlock-auOCkuee.js","assets/flowGraphSetDelayBlock-cL2mpbwz.js","assets/flowGraphCancelDelayBlock-6D_2IvAp.js","assets/flowGraphPlayAnimationBlock-CT5APMlA.js","assets/flowGraphStopAnimationBlock-l9nZOBJq.js","assets/flowGraphPauseAnimationBlock-hcm2XmK1.js","assets/flowGraphInterpolationBlock-C8x53qu5.js","assets/flowGraphEasingBlock-mIzjFSJ6.js","assets/flowGraphBezierCurveEasingBlock-DWZzSvMu.js","assets/flowGraphConditionalDataBlock-yNueCNtj.js","assets/flowGraphGetVariableBlock-Bp6us172.js","assets/flowGraphSetVariableBlock-C6PBh2W_.js","assets/flowGraphTransformCoordinatesSystemBlock-BQuhM7a0.js","assets/flowGraphGetPropertyBlock-h8sLfJ6_.js","assets/flowGraphSetPropertyBlock-DeuXhwrW.js","assets/flowGraphConstantBlock-CJOJTJP-.js","assets/flowGraphGetAssetBlock-TKfOOeD_.js","assets/flowGraphDataSwitchBlock-CMm_4ssD.js","assets/flowGraphMathBlocks-zyDLnUqh.js","assets/flowGraphBinaryOperationBlock-DJbJ0rP2.js","assets/flowGraphUnaryOperationBlock-Be1kAqfd.js","assets/flowGraphMathCombineExtractBlocks-D4WKemCv.js","assets/flowGraphMatrixMathBlocks-B0Veg_Xh.js","assets/flowGraphVectorMathBlocks-C_SvhQk6.js","assets/flowGraphTypeToTypeBlocks-kM9bN-pP.js","assets/flowGraphContextBlock-C2GIG5pY.js","assets/flowGraphArrayIndexBlock-Crc6A4lS.js","assets/flowGraphCodeExecutionBlock-ZW2J-Tfx.js","assets/flowGraphIndexOfBlock-BZQ5tMtd.js","assets/flowGraphFunctionReferenceBlock-DV9A8J6-.js","assets/flowGraphMeshPickEventBlock-zxYVw4pD.js","assets/flowGraphSceneReadyEventBlock-BBSCTR58.js","assets/flowGraphReceiveCustomEventBlock-BNkIjVAK.js","assets/flowGraphSendCustomEventBlock-C8kZ6rxy.js","assets/flowGraphSceneTickEventBlock-CoxWhBGE.js","assets/flowGraphPointerOutEventBlock-Btq1j_2g.js","assets/flowGraphPointerOverEventBlock-hynwwEPQ.js","assets/shadowGeneratorSceneComponent-BnIrRVQP.js","assets/shadowGenerator-CXRi17w6.js","assets/clipPlaneFragment-DIGJamP7.js","assets/clipPlaneVertex-CxQYU1I8.js","assets/pointCloudVertex-DncYcnOq.js","assets/pointLight-Bhp8uwUm.js","assets/cubeTexture-Bpyt1M1u.js","assets/dds-E_GvVUQ_.js","assets/ktxTextureLoader-BZwWR4Tg.js","assets/workerPool-H9Ji3mCo.js","assets/iblCdfGenerator-BePxmY-X.js","assets/helperFunctions-kkDgNyA_.js","assets/fogFragment-ComYmOUR.js","assets/logDepthVertex-C5fET958.js","assets/sceneUboDeclaration-CHwC5TpU.js","assets/meshUboDeclaration-DeIDxBev.js","assets/iesTextureLoader-jaYDMBUn.js","assets/hdrCubeTexture-fh4UP1gK.js","assets/hdr-C23ofmsl.js","assets/background.vertex-Qbm6mWYr.js","assets/backgroundUboDeclaration-D2kmBITq.js","assets/logDepthDeclaration-Bt5-0w3f.js","assets/background.fragment-ptsWlhC9.js","assets/lightFragment-Dz3M1Met.js","assets/lightsFragmentFunctions-BgOWFfrX.js","assets/background.vertex-CRiZyY4D.js","assets/backgroundUboDeclaration-BZwUvgPl.js","assets/logDepthVertex-CRijnwg9.js","assets/shadowsVertex-fkqmL4cX.js","assets/logDepthDeclaration-LgTGId5l.js","assets/background.fragment-CrM07uM0.js","assets/lightFragment-PdD5bQ06.js","assets/lightsFragmentFunctions-BBedF9tF.js","assets/fogFragmentDeclaration-CxWdFdoK.js","assets/samplerVertexImplementation-BiHXMk21.js","assets/pbr.vertex-v9EFhqiK.js","assets/harmonicsFunctions-B5Av4Alf.js","assets/mainUVVaryingDeclaration-DWZzdAQV.js","assets/pbr.fragment-B6twru5J.js","assets/oitFragment-oqcTbGbA.js","assets/pbr.vertex-CegznJxH.js","assets/harmonicsFunctions-iJdjbaAs.js","assets/mainUVVaryingDeclaration--0aOem0J.js","assets/bumpVertex-B3Ghp34F.js","assets/pbr.fragment-SQFziuwt.js","assets/oitFragment-DOelKrIx.js","assets/bumpFragment-BiPEF-IQ.js","assets/shaderLanguage-BjwqUAVi.js","assets/ddsTextureLoader-Dr2bLChy.js","assets/envTextureLoader-B1_zPjr-.js","assets/tgaTextureLoader-CrpWnx3M.js","assets/hdrTextureLoader-BTO8U75p.js","assets/basisTextureLoader-fegYUuHH.js","assets/exrTextureLoader-DWsFH1i3.js","assets/iblShadowsRenderPipeline-qbUSX0LP.js","assets/rawCubeTexture-C9hX2w57.js","assets/pointsCloudSystem-B3Yv09OW.js","assets/thinInstanceMesh-D0OQBd9y.js","assets/default.fragment-D7SedFud.js","assets/defaultUboDeclaration-DUw5Us5r.js","assets/default.vertex-SsGMRrcE.js","assets/default.fragment-B-1ZJeXx.js","assets/defaultUboDeclaration-fDG-mxdF.js","assets/default.vertex-tsZYuoYV.js","assets/dracoDecoder-D3jz1WVC.js","assets/meshoptCompression-DP0Dy7Tw.js","assets/mesh.vertexData.functions-BXkNVxNr.js","assets/lodCube.fragment-0RuBF3oL.js","assets/lod.fragment-C-OnN2yx.js","assets/lodCube.fragment-ClD-B-8p.js","assets/lod.fragment-CBhhQIAR.js","assets/rgbdDecode.fragment-BsY6Xwj9.js","assets/rgbdEncode.fragment-C3sbkAtj.js","assets/rgbdDecode.fragment-BP5ZvIPA.js","assets/rgbdEncode.fragment-DMgrxmHf.js","assets/postProcessRenderPipelineManagerSceneComponent-Blalfcci.js","assets/postprocess.vertex-beQv9sVO.js","assets/pass.fragment-BpAKer8X.js","assets/passCube.fragment-CDUv3DHQ.js","assets/pass.fragment-CZEmc6zR.js","assets/passCube.fragment-C311tdwL.js","assets/index-B5nJtYyh.js","assets/glTFLoader-BgW-WFe0.js","assets/glTFLoaderExtensionRegistry-DPlsyOCJ.js","assets/objectModelMapping-BaV5AVgx.js","assets/KHR_animation_pointer-CmSOh6h9.js","assets/EXT_lights_image_based-dSaN--uz.js","assets/EXT_mesh_gpu_instancing-CDUzqLTd.js","assets/EXT_meshopt_compression-B9FINWJ3.js","assets/EXT_texture_webp-KyaAwok2.js","assets/EXT_texture_avif-D1EQ_8IZ.js","assets/EXT_lights_ies-DDpRCaNS.js","assets/KHR_draco_mesh_compression-CSXeAbG5.js","assets/KHR_lights_punctual-C2xE0OIR.js","assets/KHR_materials_pbrSpecularGlossiness-S5xTEO_8.js","assets/KHR_materials_unlit-BPOAtJ_u.js","assets/KHR_materials_clearcoat-CdFadWyP.js","assets/KHR_materials_iridescence-Do3QDVCp.js","assets/KHR_materials_anisotropy-C8WYVAj7.js","assets/KHR_materials_emissive_strength-CMvOE4Rc.js","assets/KHR_materials_sheen-B_a--2Pi.js","assets/KHR_materials_specular-ClRy_Fiq.js","assets/KHR_materials_ior-WQEz9KIl.js","assets/KHR_materials_variants-C9mQWKfw.js","assets/KHR_materials_transmission-CnuF4NRt.js","assets/KHR_materials_diffuse_transmission-CKz41A8R.js","assets/KHR_materials_volume-DUReLzTH.js","assets/KHR_materials_dispersion-CK4fc5DS.js","assets/EXT_materials_diffuse_roughness-BU-LCM4v.js","assets/KHR_mesh_quantization-BG1C6Q_t.js","assets/KHR_texture_basisu-DK27xp1L.js","assets/KHR_texture_transform-DykSLOio.js","assets/KHR_xmp_json_ld-D9imHpom.js","assets/MSFT_audio_emitter-Bau9i7YV.js","assets/MSFT_lod-BwxsGtB_.js","assets/MSFT_minecraftMesh-tZR_V2O4.js","assets/MSFT_sRGBFactors-BrWpEqEB.js","assets/KHR_interactivity-DgTXwcNQ.js","assets/declarationMapper-ByApRiSd.js","assets/KHR_node_visibility-I0Ynmskd.js","assets/KHR_node_selectability-Ciw8v8Mw.js","assets/KHR_node_hoverability-BHNhGzsm.js","assets/ExtrasAsMetadata-BXNxD7j7.js","assets/index-DFb2dAVI.js","assets/stlFileLoader.metadata-D34mcJg2.js","assets/babylon.inspector.bundle-EVozy_8I.js","assets/objFileLoader-DiRt5ZSo.js","assets/stlFileLoader-DglaKQhB.js","assets/splatFileLoader-B_A9ZX5E.js","assets/index-DpS4JTDc.js","assets/sidebar-pages-C_4ELvRE.js","assets/use-supports-hover-CZ3yRVvS.js","assets/conversations-B4bT0gpZ.js","assets/delete-B-LLJLBf.js","assets/use-share-message-DdayU8_c.js","assets/use-list-key-down-CTifKUl1.js","assets/botd.esm-lgyyZBu9.js","assets/index.es-B1Q_jbUA.js","assets/code-BBUUtRD2.js","assets/copy-hUbZV67l.js","assets/core-BiIOkrJH.js","assets/language-loader-DH8IXb6w.js","assets/index-YnDusNz7.js","assets/index-Chjiymov.js","assets/sender-share-conversation-modal-BlAwiJv9.js","assets/alert-DG2zhKXr.js","assets/error-C5HxSO4E.js","assets/sender-share-modal-cta-with-social-media-Q0JL7Ig_.js","assets/character-EZQ4m8o-.js","assets/use-set-up-babylon--Wr2b8Q3.js","assets/starter-prompt-category-Bd1uIdNx.js","assets/product-purchase-D6ud5ovI.js","assets/constants-B56mozXm.js","assets/utils-BUf0c38z.js","assets/wallet-element-factory-BqDQlId1.js","assets/pidl-pages-QIkGckoR.js","assets/constants-BnxRz7co.js","assets/payment-methods-management-D-SPsZ-D.js","assets/v4-CtRu48qb.js","assets/index-DmSGk4sl.js","assets/upsell-block-CWNF8Ri0.js","assets/cross-selling-strip-BKrm_LEF.js","assets/price-tracking-block-CzyM37Ee.js","assets/use-price-tracking-DHgHCgZy.js","assets/use-shopping-telemetry-C3aqVrzl.js","assets/shopping-telemetry-CC5AXEeA.js","assets/chevron-bolded-yUU9HusZ.js","assets/shopping-api-DpUhdQS2.js","assets/format-money-5coY0IJJ.js","assets/composer-auto-complete-CPBByIJb.js","assets/composer-actions-prompt-suggestions-Dl3tKfm2.js","assets/booking-D442AII4.js","assets/expedia-DCCO75MN.js","assets/flower-D7IG4qVq.js","assets/hotels-DdnqdrUT.js","assets/kayak-TRjuZcWD.js","assets/open-table-DhU4nm2o.js","assets/priceline-B9hoZeiG.js","assets/sky-scanner-D0BEObzj.js","assets/trip-advisor-mY3mADf7.js","assets/viator-n-UTur1R.js","assets/voice-options-C0EjD4wp.js","assets/use-key-up-XJiY9Oln.js","assets/think-deeper-pro-subscription-DiC9bvSs.js","assets/over-task-quota-DNlQASn7.js","assets/composer-action-CkFMKms7.js","assets/computer-use-task-closed-PKtkyL6j.js","assets/export-B-gZxsYE.js","assets/import-Bdg3RzAw.js","assets/settings-Bw37g4VE.js","assets/speed-CjLBjqU2.js","assets/audio-controls-CCV6lZNN.js","assets/next-BeZJzm-Q.js","assets/pause-CXYLaVq-.js","assets/play-DToWVlpr.js","assets/progress-bar-vV9af14Q.js","assets/close-button-B--aiFgz.js","assets/replay-Dv9WUR7A.js","assets/safety-risk-card-DNeSO5UC.js","assets/use-send-action-command-a5LNdulr.js","assets/add-to-page-C9fEpY6t.js","assets/cross-selling-strip-consumer-BcC0bqCu.js","assets/composer-prompt-review-BiRrCY-3.js","assets/use-ocv-feedback-CeNRm6RF.js","assets/biometric-consent-CX-K5aHX.js","assets/daily-briefing-chat-JAkt9Aba.js","assets/contract-down-left-BwSlgERN.js","assets/dailly-briefing-composer-input-2P5C6tmc.js","assets/composer-sign-in-CImxjkLw.js","assets/merge-conversation-checkbox-BgwDwy5T.js","assets/daily-briefing-composer-player-DT9-rEBN.js","assets/settings-wrapper-B0uq52Y3.js","assets/info-2G5SQfal.js","assets/media-viewer-B36CCjiZ.js","assets/async-image-wrapper-BUe6kkhz.js","assets/utils-mynBgshD.js","assets/image-wrapper-C8AGDNpm.js","assets/image-off-D6A4ZM2P.js","assets/picture-in-picture-g7WUq2Iq.js","assets/video-player-B4GPW7dj.js","assets/native-player-C4uM5bP-.js","assets/card-carousel-BOvS1sm5.js","assets/use-carousel-BCvd0mwc.js","assets/utils-ifQmq0fb.js","assets/composer-large-screen-C1wi-P-j.js","assets/link-Dg6OQIH9.js","assets/types-S47nI6MK.js","assets/discover-D4g6cehV.js","assets/collapse-pane-DcWXbgXT.js","assets/use-discover-feed-BPuEOxZy.js","assets/block-BilBTXJq.js","assets/thumbs-up-filled-BwQjcjI1.js","assets/document-one-page-sparkle-BV-X7Mrs.js","assets/food-apple-DHEpy65I.js","assets/lightbulb-NZZxkfcb.js","assets/location-ripple-BQpmMPad.js","assets/podcast-H_ZakaWH.js","assets/scales-CEMqM4oe.js","assets/tag-BhHk97br.js","assets/play-outline-BynnTAGD.js","assets/weather-states-categories-CmeEET4X.js","assets/parseISO-CSWmVgD4.js","assets/watchlist-bridge-Bxp_HUXM.js","assets/widget-player-B2c_daN-.js","assets/generateCategoricalChart-s3AnE5C4.js","assets/headphones-DkV_YZoB.js","assets/use-podcasts-navigation-D6vRK_IN.js","assets/audio-recorder-BeXU1zgv.js","assets/actions-chat-detail-BGR7xeS-.js","assets/expand-pane-DWW8sp_U.js","assets/save-action-BP2hwkfE.js","assets/external-link-Bdk8V7ip.js","assets/new-tab-BOeFvjvM.js","assets/pause-outline-B5kmmBds.js","assets/showroom-chat-detail-B07K2FRq.js","assets/contextual-shopping-card-C4v24Z9M.js","assets/product-rating-Bl0nW4i4.js","assets/conversion-tracking-disclaimer-S-G0b6c5.js","assets/use-shopping-visibility-telemetry-jyitCNDP.js","assets/shopping-utils-QIU6NZCU.js","assets/citation-chips-row-Cz3RBhvu.js","assets/bell-alert-yheJwj2a.js","assets/bell-Chq_Paml.js","assets/star-C8pIJncN.js","assets/arrow-trending-down-X3jOZNuP.js","assets/price-history-chart-DEyagjl9.js","assets/appearance-chat-BQNyN1Vt.js","assets/ai-message-C8ikz2Ct.js","assets/use-page-DAMeUVlT.js","assets/use-ads-card-operations-Dv2u_JZ_.js","assets/use-podcast-share-CEwKy9do.js","assets/topic-selection.lazy-B5cI1orD.js","assets/login.lazy-C39O15Ja.js","assets/library.lazy-zM9-siRr.js","assets/gaming.lazy-BCtfmq0S.js","assets/gallery.lazy-CrAumhq5.js","assets/gallery-pX9jiB-n.js","assets/daily.lazy-CvPqLBmR.js","assets/daily-briefing-wIKp09EE.js","assets/formatDistanceToNow-CX-a3Byc.js","assets/constructNow-BDl09Jen.js","assets/use-scroll-element-into-view-waXQSMgh.js","assets/arrow-maximize-DHs6kBvk.js","assets/arrow-minimize-D1SpPdhl.js","assets/use-is-portrait-B8H7o37w.js","assets/wand-ywlFqbtp.js","assets/use-is-sidebar-expanded-on-the-side-oaRWh7pb.js","assets/agents.lazy-DWNX03Hz.js","assets/index.lazy-BkyizCh6.js","assets/utils-Be64CX99.js","assets/use-finger-printing-Dn9CFHeM.js","assets/rewards-link-BcbJk0WW.js","assets/arrow-referral-WdHFQUc5.js","assets/copliot-referral-Da2M2JHR.js","assets/four-leaf-clover-Cjg6NbZS.js","assets/hexagon-B-fzgva_.js","assets/message-referral-CFxLOX0I.js","assets/rewards-O8OeMw9a.js","assets/index.lazy-DkDc0SGa.js","assets/use-labs-telemetry-C5e0mxPx.js","assets/index-D9sjouVy.js","assets/labs-social-icon-discord-yM8-as6Z.js","assets/labs-social-icon-instagram-nBpxbfbU.js","assets/labs-social-icon-x-CBLiLNZW.js","assets/labs-social-icon-youtube-CyPhkIVH.js","assets/subscription.start.lazy-ECFx5Fve.js","assets/subscription.manage.lazy-B6aiVxo_.js","assets/shares._conversationId.lazy-DfJgrCt4.js","assets/rules.lazy-CKsdQ3DE.js","assets/gift-DdmBWb_8.js","assets/link-multiple-31EC9L1x.js","assets/pro.subscribe.lazy-Cvnppj0b.js","assets/checkout-wrapper-B_zxVxhK.js","assets/paywall-container-q-Cmjsfz.js","assets/add-address-C7P0LK2V.js","assets/address-C8q4Qnhs.js","assets/pidl-element-factory-jJ9gdNPR.js","assets/workflow-pi-dropdown-disabler-ABoIA1D3.js","assets/visa-DNBWtMre.js","assets/atoms-Ce2g0t6L.js","assets/react-number-format.es-LvCSzAdG.js","assets/dropdown-radio-ChnS_m2U.js","assets/wallet-dropdown-DBaZCyxM.js","assets/wallet-icon-button-DDVo0FZz.js","assets/wallet-list-7RSsPh2C.js","assets/current-CZBoTuBC.js","assets/plus-DnCI41wZ.js","assets/pidl-element-factory-DikK38DI.css","assets/add-address-view-dX4SN2qC.js","assets/form-field-skeleton-BHY_JsF7.js","assets/add-payment-instrument-CUoxxh68.js","assets/add-payment-instrument-view-CGb8Z5e0.js","assets/add-ewallet-skeleton-DGS3_Iu3.js","assets/select-payment-instrument-pduLeQhn.js","assets/start-line-Bgyn5bnw.js","assets/credit-card-6U_yFDBj.js","assets/pro.subscribe-DU9qjcuZ.css","assets/pages._pageId.lazy-D-TEEBIg.js","assets/use-clean-history-state-DjDDzDTH.js","assets/text-bold-6B99JMND.js","assets/text-bullet-list-alvY6QRa.js","assets/text-code-B5zvce_2.js","assets/text-italic-B8N-oUmx.js","assets/text-numbered-list-DlQLP5J-.js","assets/text-paragraph-DkJixuUb.js","assets/pages-welcome-dark-r64A2mUI.js","assets/pages-welcome-light-DDUDcHxX.js","assets/arrow-enter-up-Dek80rks.js","assets/use-clean-history-state-VM7_CLIT.css","assets/copy-add-C58iCS4h.js","assets/memory.narrative.lazy-DN0YBIDB.js","assets/mask-wrapper-D1VZ6cNz.js","assets/gallery._galleryItemId.lazy-B0N8Q4zd.js","assets/gallery-schemas-B4eGxJsd.js","assets/connector.callback.lazy-BLFM1XTG.js","assets/chats.private.lazy-D158OGYP.js","assets/campaigns._campaignId.lazy-syIKUxMy.js","assets/index.lazy-B8ukvlN1.js","assets/index.lazy-C8UXcOZm.js","assets/shares.podcasts._shareId.lazy-BBylXnFT.js","assets/shares.pages._shareId.lazy-BaoYf6Y9.js","assets/eye-ecq5WZgO.js","assets/shares.3d-generations._shareId.lazy-Duil6rPz.js","assets/generations3d-error-wrapper-BmxNLWw6.js","assets/cube-solid-CqN_tNz4.js","assets/cube-CXsSHuq1.js","assets/pro.redeem._redeemCode.lazy-KwSzkrST.js","assets/pro.ewallet.return.lazy-C9pttPAC.js","assets/podcasts._podcastType._podcastId.lazy-Bb5VWy3F.js","assets/talk.lazy-CKQ1Wepe.js","assets/audio-call-CrM4v2M9.js","assets/timer-BwjlyM3V.js","assets/voicemail-dark-BtARQIb1.js","assets/voicemail-light-DeMSWjpH.js","assets/experiments._experimentAlias.lazy-DYjNjQEX.js","assets/chats_._conversationId.talk.lazy-CCDeMOlb.js","assets/my-creations.lazy-ofoK-SiS.js","assets/use-window-size-RxzqMiyX.js","assets/my-creations-DV8PrLMj.css"])))=>i.map(i=>d[i]);
var WB=Object.defineProperty;var kk=t=>{throw TypeError(t)};var YB=(t,e,n)=>e in t?WB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var j=(t,e,n)=>YB(t,typeof e!="symbol"?e+"":e,n),TC=(t,e,n)=>e.has(t)||kk("Cannot "+n);var he=(t,e,n)=>(TC(t,e,"read from private field"),n?n.call(t):e.get(t)),on=(t,e,n)=>e.has(t)?kk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ft=(t,e,n,r)=>(TC(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Fe=(t,e,n)=>(TC(t,e,"access private method"),n);import{r as m,a as P,k as at,u as x,j as d,P as QB,R as nl,b as ve,p as JM,z as c,s as _E,Q as XM,w as py,Z as kg,e as Ze,f as AE,A as Mn,m as Ne,H as ZM,l as dp,C as hp,S as eO,n as wd,T as kE,U as xE,V as RE,W as JB,X as XB,Y as NE,F as my,_ as gy,o as _d,D as Ad,t as PE,B as tO,$ as nO,K as rO,a0 as nd,a1 as ZB,a2 as eH,a3 as oO,i as tH,x as nH,d as vy,M as iO,a4 as rH,a5 as oH,O as iH,a6 as sH,a7 as aH,g as bt,a8 as cH,a9 as sO,h as lH,aa as uH,ab as dH,ac as hH}from"./vendor-BK0nFAyt.js";import{g as fH}from"./sentry-D3-uqDEW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const pH="modulepreload",mH=function(t){return"https://studiostaticassetsprod.azureedge.net/bundle-cmc/"+t},xk={},H=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=s(n.map(u=>{if(u=mH(u),u in xk)return;xk[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":pH,h||(p.as="script"),p.crossOrigin="",p.href=u,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((g,v)=>{p.addEventListener("load",g),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return o.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},gH=t=>{const e="input"in t?t.input:"input",n="output"in t?t.output:"output",r="schema"in t?t.schema._input:t._input,o="schema"in t?t.schema._output:t._output;return{types:{input:e==="output"?o:r,output:n==="input"?r:o},parse:i=>"schema"in t?t.schema.parse(i):t.parse(i)}},aO=m.createContext(null),wC={didCatch:!1,error:null};class cO extends m.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=wC}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,r,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];(n=(r=this.props).onReset)===null||n===void 0||n.call(r,{args:i,reason:"imperative-api"}),this.setState(wC)}}componentDidCatch(e,n){var r,o;(r=(o=this.props).onError)===null||r===void 0||r.call(o,e,n)}componentDidUpdate(e,n){const{didCatch:r}=this.state,{resetKeys:o}=this.props;if(r&&n.error!==null&&vH(e.resetKeys,o)){var i,s;(i=(s=this.props).onReset)===null||i===void 0||i.call(s,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(wC)}}render(){const{children:e,fallbackRender:n,FallbackComponent:r,fallback:o}=this.props,{didCatch:i,error:s}=this.state;let a=e;if(i){const l={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")a=n(l);else if(r)a=m.createElement(r,l);else if(o!==void 0)a=o;else throw s}return m.createElement(aO.Provider,{value:{didCatch:i,error:s,resetErrorBoundary:this.resetErrorBoundary}},a)}}function vH(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,r)=>!Object.is(n,e[r]))}function yH(t){if(t==null||typeof t.didCatch!="boolean"||typeof t.resetErrorBoundary!="function")throw new Error("ErrorBoundaryContext not found")}function lO(){const t=m.useContext(aO);yH(t);const[e,n]=m.useState({error:null,hasError:!1}),r=m.useMemo(()=>({resetBoundary:()=>{t.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:o=>n({error:o,hasError:!0})}),[t.resetErrorBoundary]);if(e.hasError)throw e.error;return r}var _C,Rk;function bH(){return Rk||(Rk=1,_C={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),_C}var CH=bH();const SH=fH(CH);var IH=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Nk(t){var e={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=t.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(e.name=n[1],(SH[n[1]]||t.charAt(t.length-2)==="/")&&(e.voidElement=!0),e.name.startsWith("!--"))){var r=t.indexOf("-->");return{type:"comment",comment:r!==-1?t.slice(4,r):""}}for(var o=new RegExp(IH),i=null;(i=o.exec(t))!==null;)if(i[0].trim())if(i[1]){var s=i[1].trim(),a=[s,""];s.indexOf("=")>-1&&(a=s.split("=")),e.attrs[a[0]]=a[1],o.lastIndex--}else i[2]&&(e.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return e}var EH=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,TH=/^\s*$/,wH=Object.create(null);function uO(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?function(n){var r=[];for(var o in n)r.push(o+'="'+n[o]+'"');return r.length?" "+r.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(uO,"")+"</"+e.name+">";case"comment":return t+"<!--"+e.comment+"-->"}}var _H={parse:function(t,e){e||(e={}),e.components||(e.components=wH);var n,r=[],o=[],i=-1,s=!1;if(t.indexOf("<")!==0){var a=t.indexOf("<");r.push({type:"text",content:a===-1?t:t.substring(0,a)})}return t.replace(EH,function(l,u){if(s){if(l!=="</"+n.name+">")return;s=!1}var h,f=l.charAt(1)!=="/",p=l.startsWith("<!--"),g=u+l.length,v=t.charAt(g);if(p){var y=Nk(l);return i<0?(r.push(y),r):((h=o[i]).children.push(y),r)}if(f&&(i++,(n=Nk(l)).type==="tag"&&e.components[n.name]&&(n.type="component",s=!0),n.voidElement||s||!v||v==="<"||n.children.push({type:"text",content:t.slice(g,t.indexOf("<",g))}),i===0&&r.push(n),(h=o[i-1])&&h.children.push(n),o[i]=n),(!f||n.voidElement)&&(i>-1&&(n.voidElement||n.name===l.slice(2,-1))&&(i--,n=i===-1?r:o[i]),!s&&v!=="<"&&v)){h=i===-1?r:o[i].children;var b=t.indexOf("<",g),C=t.slice(g,b===-1?void 0:b);TH.test(C)&&(C=" "),(b>-1&&i+h.length>=0||C!==" ")&&h.push({type:"text",content:C})}}),r},stringify:function(t){return t.reduce(function(e,n){return e+uO("",n)},"")}};function Xm(){if(console&&console.warn){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Lo(e[0])&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const Pk={};function xg(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Lo(e[0])&&Pk[e[0]]||(Lo(e[0])&&(Pk[e[0]]=new Date),Xm(...e))}const dO=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},Mk=(t,e,n)=>{t.loadNamespaces(e,dO(t,n))},Ok=(t,e,n,r)=>{Lo(n)&&(n=[n]),n.forEach(o=>{t.options.ns.indexOf(o)<0&&t.options.ns.push(o)}),t.loadLanguages(e,dO(t,r))},AH=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.languages[0],o=e.options?e.options.fallbackLng:!1,i=e.languages[e.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const s=(a,l)=>{const u=e.services.backendConnector.state[`${a}|${l}`];return u===-1||u===2};return n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!s(e.isLanguageChangingTo,t)?!1:!!(e.hasResourceBundle(r,t)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||s(r,t)&&(!o||s(i,t)))},kH=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(xg("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(t,{lng:n.lng,precheck:(o,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!i(o.isLanguageChangingTo,t))return!1}}):AH(t,e,n)},Lo=t=>typeof t=="string",bu=t=>typeof t=="object"&&t!==null,xH=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,RH={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},NH=t=>RH[t],PH=t=>t.replace(xH,NH);let J0={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:PH};const MH=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};J0={...J0,...t}},hO=()=>J0;let fO;const OH=t=>{fO=t},ME=()=>fO,AC=(t,e)=>{if(!t)return!1;const n=t.props?t.props.children:t.children;return e?n.length>0:!!n},kC=t=>{if(!t)return[];const e=t.props?t.props.children:t.children;return t.props&&t.props.i18nIsDynamicList?Cu(e):e},LH=t=>Array.isArray(t)&&t.every(m.isValidElement),Cu=t=>Array.isArray(t)?t:[t],DH=(t,e)=>{const n={...e};return n.props=Object.assign(t.props,e.props),n},pO=(t,e)=>{if(!t)return"";let n="";const r=Cu(t),o=e.transSupportBasicHtmlNodes&&e.transKeepBasicHtmlNodesFor?e.transKeepBasicHtmlNodesFor:[];return r.forEach((i,s)=>{if(Lo(i))n+=`${i}`;else if(m.isValidElement(i)){const{props:a,type:l}=i,u=Object.keys(a).length,h=o.indexOf(l)>-1,f=a.children;if(!f&&h&&!u)n+=`<${l}/>`;else if(!f&&(!h||u)||a.i18nIsDynamicList)n+=`<${s}></${s}>`;else if(h&&u===1&&Lo(f))n+=`<${l}>${f}</${l}>`;else{const p=pO(f,e);n+=`<${s}>${p}</${s}>`}}else if(i===null)Xm("Trans: the passed in value is invalid - seems you passed in a null child.");else if(bu(i)){const{format:a,...l}=i,u=Object.keys(l);if(u.length===1){const h=a?`${u[0]}, ${a}`:u[0];n+=`{{${h}}}`}else Xm("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",i)}else Xm("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",i)}),n},jH=(t,e,n,r,o,i)=>{if(e==="")return[];const s=r.transKeepBasicHtmlNodesFor||[],a=e&&new RegExp(s.map(b=>`<${b}`).join("|")).test(e);if(!t&&!a&&!i)return[e];const l={},u=b=>{Cu(b).forEach(S=>{Lo(S)||(AC(S)?u(kC(S)):bu(S)&&!m.isValidElement(S)&&Object.assign(l,S))})};u(t);const h=_H.parse(`<0>${e}</0>`),f={...l,...o},p=(b,C,S)=>{const I=kC(b),E=v(I,C.children,S);return LH(I)&&E.length===0||b.props&&b.props.i18nIsDynamicList?I:E},g=(b,C,S,I,E)=>{b.dummy?(b.children=C,S.push(m.cloneElement(b,{key:I},E?void 0:C))):S.push(...m.Children.map([b],T=>{const w={...T.props};return delete w.i18nIsDynamicList,m.createElement(T.type,{...w,key:I,ref:T.ref},E?null:C)}))},v=(b,C,S)=>{const I=Cu(b);return Cu(C).reduce((T,w,A)=>{const _=w.children&&w.children[0]&&w.children[0].content&&n.services.interpolator.interpolate(w.children[0].content,f,n.language);if(w.type==="tag"){let L=I[parseInt(w.name,10)];S.length===1&&!L&&(L=S[0][w.name]),L||(L={});const N=Object.keys(w.attrs).length!==0?DH({props:w.attrs},L):L,K=m.isValidElement(N),q=K&&AC(w,!0)&&!w.voidElement,ae=a&&bu(N)&&N.dummy&&!K,O=bu(t)&&Object.hasOwnProperty.call(t,w.name);if(Lo(N)){const W=n.services.interpolator.interpolate(N,f,n.language);T.push(W)}else if(AC(N)||q){const W=p(N,w,S);g(N,W,T,A)}else if(ae){const W=v(I,w.children,S);g(N,W,T,A)}else if(Number.isNaN(parseFloat(w.name)))if(O){const W=p(N,w,S);g(N,W,T,A,w.voidElement)}else if(r.transSupportBasicHtmlNodes&&s.indexOf(w.name)>-1)if(w.voidElement)T.push(m.createElement(w.name,{key:`${w.name}-${A}`}));else{const W=v(I,w.children,S);T.push(m.createElement(w.name,{key:`${w.name}-${A}`},W))}else if(w.voidElement)T.push(`<${w.name} />`);else{const W=v(I,w.children,S);T.push(`<${w.name}>${W}</${w.name}>`)}else if(bu(N)&&!K){const W=w.children[0]?_:null;W&&T.push(W)}else g(N,_,T,A,w.children.length!==1||!_)}else if(w.type==="text"){const L=r.transWrapTextNodes,N=i?r.unescape(n.services.interpolator.interpolate(w.content,f,n.language)):n.services.interpolator.interpolate(w.content,f,n.language);L?T.push(m.createElement(L,{key:`${w.name}-${A}`},N)):T.push(N)}return T},[])},y=v([{dummy:!0,children:t||[]}],h,Cu(t||[]));return kC(y[0])};function UH(t){let{children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s={},values:a,defaults:l,components:u,ns:h,i18n:f,t:p,shouldUnescape:g,...v}=t;const y=f||ME();if(!y)return xg("You will need to pass in an i18next instance by using i18nextReactModule"),e;const b=p||y.t.bind(y)||(q=>q),C={...hO(),...y.options&&y.options.react};let S=h||b.ns||y.options&&y.options.defaultNS;S=Lo(S)?[S]:S||["translation"];const I=pO(e,C),E=l||I||C.transEmptyNodeValue||o,{hashTransKey:T}=C,w=o||(T?T(I||E):I||E);y.options&&y.options.interpolation&&y.options.interpolation.defaultVariables&&(a=a&&Object.keys(a).length>0?{...a,...y.options.interpolation.defaultVariables}:{...y.options.interpolation.defaultVariables});const A=a||n!==void 0||!e?s.interpolation:{interpolation:{...s.interpolation,prefix:"#$?",suffix:"?$#"}},_={...s,context:i||s.context,count:n,...a,...A,defaultValue:E,ns:S},L=w?b(w,_):E;u&&Object.keys(u).forEach(q=>{const ae=u[q];if(typeof ae.type=="function"||!ae.props||!ae.props.children||L.indexOf(`${q}/>`)<0&&L.indexOf(`${q} />`)<0)return;function O(){return m.createElement(m.Fragment,null,ae)}u[q]=m.createElement(O)});const N=jH(u||e,L,y,C,_,g),K=r!==void 0?r:C.defaultTransParent;return K?m.createElement(K,v,N):N}const FH={type:"3rdParty",init(t){MH(t.options.react),OH(t)}},mO=m.createContext();class BH{constructor(){j(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}}function co(t){let{children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s={},values:a,defaults:l,components:u,ns:h,i18n:f,t:p,shouldUnescape:g,...v}=t;const{i18n:y,defaultNS:b}=m.useContext(mO)||{},C=f||y||ME(),S=p||C&&C.t.bind(C);return UH({children:e,count:n,parent:r,i18nKey:o,context:i,tOptions:s,values:a,defaults:l,components:u,ns:h||S&&S.ns||b||C&&C.options&&C.options.defaultNS,i18n:C,t:p,shouldUnescape:g,...v})}const HH=(t,e)=>{const n=m.useRef();return m.useEffect(()=>{n.current=t},[t,e]),n.current},gO=(t,e,n,r)=>t.getFixedT(e,n,r),zH=(t,e,n,r)=>m.useCallback(gO(t,e,n,r),[t,e,n,r]),xe=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:n}=e,{i18n:r,defaultNS:o}=m.useContext(mO)||{},i=n||r||ME();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new BH),!i){xg("You will need to pass in an i18next instance by using initReactI18next");const E=(w,A)=>Lo(A)?A:bu(A)&&Lo(A.defaultValue)?A.defaultValue:Array.isArray(w)?w[w.length-1]:w,T=[E,{},!1];return T.t=E,T.i18n={},T.ready=!1,T}i.options.react&&i.options.react.wait!==void 0&&xg("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const s={...hO(),...i.options.react,...e},{useSuspense:a,keyPrefix:l}=s;let u=t||o||i.options&&i.options.defaultNS;u=Lo(u)?[u]:u||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(u);const h=(i.isInitialized||i.initializedStoreOnce)&&u.every(E=>kH(E,i,s)),f=zH(i,e.lng||null,s.nsMode==="fallback"?u:u[0],l),p=()=>f,g=()=>gO(i,e.lng||null,s.nsMode==="fallback"?u:u[0],l),[v,y]=m.useState(p);let b=u.join();e.lng&&(b=`${e.lng}${b}`);const C=HH(b),S=m.useRef(!0);m.useEffect(()=>{const{bindI18n:E,bindI18nStore:T}=s;S.current=!0,!h&&!a&&(e.lng?Ok(i,e.lng,u,()=>{S.current&&y(g)}):Mk(i,u,()=>{S.current&&y(g)})),h&&C&&C!==b&&S.current&&y(g);const w=()=>{S.current&&y(g)};return E&&i&&i.on(E,w),T&&i&&i.store.on(T,w),()=>{S.current=!1,E&&i&&E.split(" ").forEach(A=>i.off(A,w)),T&&i&&T.split(" ").forEach(A=>i.store.off(A,w))}},[i,b]),m.useEffect(()=>{S.current&&h&&y(p)},[i,l,h]);const I=[v,i,h];if(I.t=v,I.i18n=i,I.ready=h,h||!h&&!a)return I;throw new Promise(E=>{e.lng?Ok(i,e.lng,u,()=>E()):Mk(i,u,()=>E())})},vO=P([]),Lk=new Map,Oa=t=>{let e=Lk.get(t);return e||(e=P(n=>n(vO).includes(t)),Lk.set(t,e),e)};function se(t){return x(Oa(t))}function ze(t){return at().get(Oa(t))}function bo(t){return x(Oa(t))}function Wr(t){return at().get(Oa(t))}function OE(){return bo("kill-domain-referrer")?"noopener noreferrer":"noopener"}function yO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=yO(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Y(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=yO(t))&&(r&&(r+=" "),r+=e);return r}const fp={Namibia:"NA","South Africa":"ZA",Cameroon:"CM",Japan:"JP",Ghana:"GH",Ethiopia:"ET","United States":"US","United Arab Emirates":"AE",Bahrain:"BH",Djibouti:"DJ",Algeria:"DZ",Egypt:"EG","Western Sahara":"EH",Eritrea:"ER",Israel:"IL",Iraq:"IQ",Jordan:"JO",Comoros:"KM",Kuwait:"KW",Lebanon:"LB",Libya:"LY",Morocco:"MA",Mauritania:"MR",Oman:"OM","Palestinian Territories":"PS",Qatar:"QA","Saudi Arabia":"SA",Sudan:"SD",Somalia:"SO","South Sudan":"SS",Syria:"SY",Chad:"TD",Tunisia:"TN",Yemen:"YE",Chile:"CL",India:"IN",Tanzania:"TZ",Spain:"ES",Azerbaijan:"AZ",Russia:"RU",Belarus:"BY",Zambia:"ZM",Bulgaria:"BG",Mali:"ML",Bangladesh:"BD","China mainland":"CN",France:"FR","Bosnia & Herzegovina":"BA",Andorra:"AD",Italy:"IT",Philippines:"PH",Uganda:"UG",Iran:"IR",Czechia:"CZ","United Kingdom":"GB",Denmark:"DK",Greenland:"GL",Kenya:"KE",Austria:"AT",Belgium:"BE",Switzerland:"CH",Germany:"DE",Liechtenstein:"LI",Luxembourg:"LU",Niger:"NE",Maldives:"MV",Senegal:"SN",Bhutan:"BT",Togo:"TG",Cyprus:"CY",Greece:"GR","Antigua & Barbuda":"AG",Anguilla:"AI",Albania:"AL",Argentina:"AR","American Samoa":"AS",Australia:"AU",Barbados:"BB",Burundi:"BI",Bermuda:"BM",Brunei:"BN",Brazil:"BR",Bahamas:"BS",Botswana:"BW",Belize:"BZ",Canada:"CA","Cocos (Keeling) Islands":"CC","Cook Islands":"CK",Colombia:"CO","Cape Verde":"CV","Christmas Island":"CX","Diego Garcia":"DG",Dominica:"DM",Estonia:"EE",Finland:"FI",Fiji:"FJ","Falkland Islands":"FK",Micronesia:"FM",Grenada:"GD",Guernsey:"GG",Gibraltar:"GI",Gambia:"GM",Guam:"GU",Guyana:"GY","Hong Kong":"HK",Hungary:"HU",Indonesia:"ID",Ireland:"IE","Isle of Man":"IM","Chagos Archipelago":"IO",Jersey:"JE",Jamaica:"JM",Kiribati:"KI","St. Kitts & Nevis":"KN","South Korea":"KR","Cayman Islands":"KY","St. Lucia":"LC",Liberia:"LR",Lesotho:"LS",Lithuania:"LT",Latvia:"LV",Madagascar:"MG","Marshall Islands":"MH","Myanmar (Burma)":"MM",Macao:"MO","Northern Mariana Islands":"MP",Montserrat:"MS",Malta:"MT",Mauritius:"MU",Malawi:"MW",Mexico:"MX",Malaysia:"MY","Norfolk Island":"NF",Nigeria:"NG",Netherlands:"NL",Norway:"NO",Nauru:"NR",Niue:"NU","New Zealand":"NZ","Papua New Guinea":"PG",Pakistan:"PK",Poland:"PL","Pitcairn Islands":"PN","Puerto Rico":"PR",Portugal:"PT",Palau:"PW",Rwanda:"RW","Solomon Islands":"SB",Seychelles:"SC",Sweden:"SE",Singapore:"SG","St. Helena":"SH",Slovenia:"SI",Slovakia:"SK","Sierra Leone":"SL","Sint Maarten":"SX",Eswatini:"SZ","Turks & Caicos Islands":"TC",Thailand:"TH",Tokelau:"TK",Tonga:"TO",Türkiye:"TR","Trinidad & Tobago":"TT",Tuvalu:"TV",Taiwan:"TW",Ukraine:"UA","U.S. Outlying Islands":"UM","St. Vincent & Grenadines":"VC","British Virgin Islands":"VG","U.S. Virgin Islands":"VI",Vanuatu:"VU",Samoa:"WS",Zimbabwe:"ZW",Bolivia:"BO","Caribbean Netherlands":"BQ","Costa Rica":"CR",Cuba:"CU",Curaçao:"CW","Dominican Republic":"DO","Ceuta & Melilla":"EA",Ecuador:"EC","Equatorial Guinea":"GQ",Guatemala:"GT",Honduras:"HN",Haiti:"HT","Canary Islands":"IC",Nicaragua:"NI",Panama:"PA",Peru:"PE",Paraguay:"PY","El Salvador":"SV",Uruguay:"UY",Venezuela:"VE",Afghanistan:"AF","Burkina Faso":"BF",Guinea:"GN","Guinea-Bissau":"GW","Faroe Islands":"FO",Benin:"BJ","St. Barthélemy":"BL","Congo - Kinshasa":"CD","Central African Republic":"CF","Congo - Brazzaville":"CG","Côte d'Ivoire":"CI",Gabon:"GA","French Guiana":"GF",Guadeloupe:"GP",Monaco:"MC","St. Martin":"MF",Martinique:"MQ","New Caledonia":"NC","French Polynesia":"PF","St. Pierre & Miquelon":"PM",Réunion:"RE","Wallis & Futuna":"WF",Mayotte:"YT",Croatia:"HR",Armenia:"AM",Iceland:"IS","San Marino":"SM","Vatican City":"VA",Georgia:"GE",Kazakhstan:"KZ",Cambodia:"KH","North Korea":"KP",Kyrgyzstan:"KG",Angola:"AO",Laos:"LA",Mozambique:"MZ","North Macedonia":"MK",Mongolia:"MN","Svalbard & Jan Mayen":"SJ",Nepal:"NP",Aruba:"AW",Suriname:"SR","São Tomé & Príncipe":"ST","Timor-Leste":"TL",Moldova:"MD",Romania:"RO","Sri Lanka":"LK",Kosovo:"XK",Montenegro:"ME",Serbia:"RS","Åland Islands":"AX",Tajikistan:"TJ",Turkmenistan:"TM",Uzbekistan:"UZ",Vietnam:"VN"},bO=["blowing-dust","blowing-sand","blowing-snow","clear","clear-occasional-rain-or-thunderstorms","clear-then-cloudy","clear-then-occasional-rain","clear-then-occasional-snow","clear-then-rain","clear-then-rain-or-snow","clear-then-rain-or-thunderstorms","clear-then-snow","clear-then-snow-or-rain","clear-then-thunderstorms","clear-with-isolated-snow","clear-with-isolated-thunderstorms","clear-with-occasional-clouds","clear-with-occasional-rain","clear-with-occasional-rain-or-snow","clear-with-occasional-snow","clear-with-occasional-snow-or-rain","cloudy","cloudy-and-occasionally-clear","cloudy-occasional-rain-or-thunderstorms","cloudy-then-clear","cloudy-then-occasional-rain","cloudy-then-occasional-snow","cloudy-then-occasionally-clear","cloudy-then-rain","cloudy-then-rain-or-snow","cloudy-then-rain-or-thunderstorms","cloudy-then-snow","cloudy-then-snow-or-rain","cloudy-with-isolated-rain","cloudy-with-occasional-rain","cloudy-with-occasional-rain-or-snow","cloudy-with-occasional-snow","cloudy-with-occasional-snow-or-rain","cloudy-with-thundersnow-at-times","drifting-sand","drifting-snow","drizzle","duststorm","fair","fog","freezing-drizzle","freezing-fog","freezing-rain","hail","haze","heavy-drizzle","heavy-rain","heavy-snow","heavy-thunderstorms","ice-pellets","light-drizzle","light-fog","light-freezing-drizzle","light-freezing-rain","light-hail","light-rain","light-rain-and-snow","light-rain-and-snow-shower","light-rain-shower","light-snow","light-snow-shower","mostly-clear","mostly-cloudy","mostly-sunny","partly-cloudy","partly-sunny","patchy-fog","rain","rain-and-occasionally-clear","rain-and-occasionally-cloudy","rain-and-snow","rain-and-snow-shower","rain-or-snow","rain-or-snow-then-clear","rain-or-snow-then-cloudy","rain-showers","rain-then-clear","rain-then-cloudy","rain-then-occasional-snow","rain-turning-to-snow","rain-with-occasional-snow","severe-duststorm","sleet","smoke","snow","snow-and-occasionally-clear","snow-and-occasionally-cloudy","snow-or-rain","snow-or-rain-then-clear","snow-or-rain-then-cloudy","snow-showers","snow-then-clear","snow-then-cloudy","snow-then-rain","squalls","sunny","thundersnow","thunderstorms","unknown","windy-rainstorm","windy-with-heavy-snow"],VH=["adult","teen"],$H=["twenty-four-hours","one-day","five-days","one-week","one-month","one-year","five-years","max"],GH=["pro","m365-basic","m365-personal-classic","m365-family-classic-admin","m365-family-classic-guest","m365-personal","m365-family-admin","m365-family-guest","m365-premium-admin","m365-premium-guest"],KH=["direct","apple","google","retail"],qH=["guest","free","m365-personal","pro","m365-premium"],WH=["python"],YH=5,QH=10240,qRe=100,JH=15e3,Ei=8,jt={mediaViewer:"z-10",composer:"z-10",composerBottomSlot:"z-20",coachmark:"z-30",chatScrollToBottomButton:"z-10",babylonCharacter:"z-10",citations:"z-20",settings:"z-30",audioBase:"z-10",audioDisplayContent:"z-40",modalBackground:"z-30",modal:"z-40",sidebar:"z-40",toastNotification:"z-50",dropdownMenuOverModal:"z-50",pages:{warning:"z-10",chat:"z-20"},shopping:{navigation:"z-10"},headerIcon:"z-30",header:"z-[60]",default:"z-0"},jo={default:.15,slow:.5,composerButton:.2,settings:.1,audio:{available:.5,unavailable:2,deepLinkLanding:.5},suggestions:.2,dailyBriefing:{background:.5,sourcePopoverScale:.2,sourcePopoverOpacity:.15}},WRe=.25,YRe=2,QRe=0,XH=1.5,CO=2e3,ZH=.25,ot={opacity:0},Lt={opacity:1},ez=.2,tz=.025,JRe={initial:ot,animate:{...Lt,transition:{delayChildren:ez,staggerChildren:tz}}},XRe={initial:ot,animate:Lt},LE={willChange:"auto"},Rg="9188040d-6c67-4c5b-b112-36a304b66dad",xC="copilot.cloud.microsoft",ZRe=Y("mt-px text-end uppercase text-foreground-450 text-2xs dark:text-foreground-600"),e2e="flex items-center justify-between text-start",nz=["Austria","Belgium","Brazil","Bulgaria","Canada","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Latvia","Liechtenstein","Lithuania","Luxembourg","Malta","Netherlands","Norway","China mainland","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden","Switzerland","Türkiye","United Kingdom"],yy=nz.map(t=>fp[t]),rz=["Austria","Belgium","Bulgaria","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden"],oz=rz.map(t=>fp[t]),iz=["Belarus","China mainland","Lebanon","Macao","Russia","Venezuela","North Korea","Cuba","Syria","Iran"],sz=iz.map(t=>fp[t]),az="https://account.live.com/ep",Ng="chat",SO="Think Deeper",cz="Think Deeper (o4-mini)",IO="Smart",EO="Smart (GPT-5)",t2e=1500,Pg=24*60*60*1e3,lz=5,DE=451,TO="Not allowed child account",jE="LEGALLY_UNAVAILABLE_STATUS",X0=3,RC=[80,100,110,125,150],pp=100,uz=1e3,wO=!1,UE=!1,_O="/chats/private",Mg=3,dz="https://www.copilot.com",hz="https://www.copilot-stg.com";function AO(){return typeof window>"u"?!1:window.location.origin===dz||window.location.origin===hz}function kO(){return AO()?`${window.location.origin}/c/api`:"https://copilot.microsoft.com/c/api"}function da(t){const e=t.split("://");return e.length===1?`https://${t}`:e[0]==="http"?`https://${e[1]}`:t}function fz(t){return t==="."||t==="!"||t==="?"}function pz(t){return t===" "||t===`
`||t==="	"}function mz(t){let e=t.length-1;for(;e>=0&&pz(t[e]);)e-=1;return[t.slice(0,e+1),t.slice(e+1)]}function gz(t,e,n){return t.slice(0,n)+e+t.slice(n)}const vz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-banner-Dtr5ysxQ.webp",yz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-copied-popup-BRVm_KWU.webp",bz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-engaging-popup-YSBImXns.webp",Cz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-secondday-popup--nxha975.webp",Sz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-setting-TTFEOcbN.webp",Iz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-think-deeper-popup-FHodYGgC.webp",Ez="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-thumbsup-card-DH3zTT3T.webp",Tz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-aggressive-thumbsup-popup-D7hBD_1Q.webp",wz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-discover-strip-DnlsnV3g.webp",_z="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-setting-banner-CqsoJ8gk.webp",Az="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-dark-desktop-setting-menu-item-C25mGU_p.webp",kz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-banner-CKv2a8_f.webp",xz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-copied-popup-M4nhJM3H.webp",Rz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-engaging-popup-B-vXLUhP.webp",Nz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-secondday-popup-DBikSjcg.webp",Pz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-setting-D2OBsvlS.webp",Mz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-think-deeper-popup-D5tA7N2r.webp",Oz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-thumbsup-card-CwLVOvcv.webp",Lz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-aggressive-thumbsup-popup-DM6aMFdv.webp",Dz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-discover-strip-flsYDh7H.webp",jz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-setting-banner-C2lNCEe_.webp",Uz="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-desktop-setting-menu-item-BzBe-XWV.webp",Dk="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-qr-light-shopping-Dm2se5Rq.png",Fz={appLayout:{showSettings:!0,showCookieBanner:!0,showSettingsRelyOnChatDetailLayout:!0,showMobileCrossSelling:!0},surfaceQueryParam:null,showScrollbarOnHover:!1,dailyBriefingOcid:"cp_web_daily",persistThemeChoice:!0,entraRedirectModalBehaviour:"replace",redirectBackEnabled:!0,crossPromotion:{discoverStrip:{dark:wz,light:Dz,fontSize:"m"},settingMenuItem:{dark:Az,light:Uz},settingBanner:{dark:_z,light:jz},aggressive:{banner:{dark:vz,light:kz},setting:{dark:Sz,light:Pz},card:{thumbsUp:{dark:Ez,light:Oz}},popup:{secondDay:{dark:Cz,light:Nz},thumbsUp:{dark:Tz,light:Lz},copied:{dark:yz,light:xz},engaging:{dark:bz,light:Rz},thinkDeeper:{dark:Iz,light:Mz}}}},proSubscription:{enabled:!0,manageRefId:"cmc",urlParams:{client:"cmc",ocids:{ActionsLimit:{freeTrial:"cmmmcpyae96",buy:"cmm46gj0qnu"},VoiceLimit:{freeTrial:"cmm0ghcr8ka",buy:"cmmxki6wg02"},Settings:{freeTrial:"cmma4vbm2dq",buy:"cmmugsiwg58"},ChatReasoningLimit:{freeTrial:"cmmtjssvrv9",buy:"cmmzn5kdy9p"},MarketSelect:{freeTrial:"cmmxe0nad8b",buy:"cmmtbwi4652",market:"none"},RedirectFromAuth0Account:{freeTrial:"cmmxe0nad8b",buy:"cmmtbwi4652"},PodcastLimit:{buy:"cmmtzkwxk60"},DeepResearchLimit:{buy:"cmmoe57pdco"}}},m365UrlParams:{ocids:{Management:{buy:"cmmuwkdmgrx"},"Management-FromWinNative":{buy:"cmm37as1oow"},Settings:{buy:"cmm7br2b8jz"},"Settings-FromWinNative":{buy:"cmmn7sj2u1h"},Unknown:{buy:"cmmquw3utd3"},VisionLimit:{buy:"cmmel7cuppc"},"VisionLimit-FromWinNative":{buy:"cmmkixaxk1s"},"VisionLimit-FromEdge":{buy:"cmm1jlg6uo0"},"VisionLimit-FromEdgeCopilotMode":{buy:"cmmrvmke5cp"},PodcastLimit:{buy:"cmmzh6u3s7s"},"PodcastLimit-FromWinNative":{buy:"cmmis92nwrv"},"PodcastLimit-FromEdgeCopilotMode":{buy:"cmmqak9uo3w"},ActionsLimit:{buy:"cmmmnsn10i7"},"ActionsLimit-FromWinNative":{buy:"cmmn7sj2u1h"},"ActionsLimit-FromEdgeCopilotMode":{buy:"cmmb2arb6s3"},DeepResearchLimit:{buy:"cmmfwtv3wop"},"DeepResearchLimit-FromWinNative":{buy:"cmm3x3vhgp4"},"DeepResearchLimit-FromEdgeCopilotMode":{buy:"cmm86lqbhrs"}}},upsellFromAuth0:{navigateToProSubPageAfterLogin:!0}},referralEnabled:!0,adsEnabled:!0,adsShowroomEnabled:!0,thinkDeeperFreemiumEnabled:!0,monitorAccountChangesAcrossTabs:!0,shopping:{upsell:{banner:{light:Dk,dark:Dk}}},sidebarNavigation:!0,showChatDetail:!0,enableAuth0:!0,settingsOverrides:{shouldShowActivityHistory:!0,shouldShowMemoryDelete:!0},enableCustom1DS:!0,actions:{enableActions:()=>Promise.resolve(!0)},landingPage:{enableLandingRoute:!0,enableCentralComposer:!0,enableStarterPrompts:!0,enableAutoSuggest:!0,enableWidgets:!0,enablePromptedGreetings:!0,shouldFetchWidgetsData:!0,regexForAutoSuggest:/\S+\s+/},supportsYouTubeVideos:!0,useMSALPwBApp:!0,isBotDetectionEnabled:!0,enableLabs:!0},lc=class lc{constructor(){j(this,"cfg",Fz)}static instance(){return lc.singleton||(lc.singleton=new lc),lc.singleton}config(){return this.cfg}setConfig(e){this.cfg=e}};j(lc,"singleton",null);let me=lc;const Bz=/^(?:(?:https?):\/\/)?(?:(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\.))+[a-z]{2,}(?:\/[\w.-]*)*\/?(?:\?[^\s#]*)?(?:#[^\s]*)?$/,Hz=/\b((https?:\/\/|www\.)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,})([/?#][\w\-._~:/?#@!$&'()*+,;=%]*)?(?=[\s<>()"'.,!?)}\]“”‘’《》「」『』【】]|$)/gi;function FE(t){return Bz.test(t)}function zz(t){return t.startsWith("/attachments/onedrive/")}function n2e(t){return!!zz(t)}function Vz(t){const[e,n]=mz(t),r=fz(e[e.length-1]),o=r?e.slice(0,-1):e;if(FE(o)){const i=r?e[e.length-1]:"";return{url:da(o),word:o,suffix:`${i}${n}`}}return{word:t}}function rd(t){let e="";try{e=new URL(t).hostname}catch{}return e}function $z(t,e,n){const{overwrite:r}=n??{};try{const o=new URL(t);for(const[i,s]of Object.entries(e))r&&o.searchParams.delete(i),o.searchParams.append(i,s);return o.toString()}catch{}return t}function od(t){const{formCodeParamOnLinks:e}=me.instance().config();return e?$z(t,{form:e}):t}function Gz(t){return t.replace(/[.,!?]+$/,"")}function Kz(t,e){return!t||e<=0?!1:t[e-1]==="@"||/[\w.-]+@/.test(t.slice(Math.max(0,e-20),e+1))}function r2e(t){const e=[];if(!t)return e;for(const n of t.matchAll(Hz)){const r=n[0],{index:o}=n;if(o<0||Kz(t,o))continue;const i=Gz(r),s=da(i),a=o+i.length;e.push({url:s,from:o,to:a})}return e}function o2e(t){return FE(t)?t:kO()+t}const ha=m.forwardRef((t,e)=>{const{children:n,href:r,className:o,title:i,"aria-controls":s,"aria-expanded":a,"aria-haspopup":l,"aria-label":u,id:h,target:f,onClick:p,onPointerDown:g,onFocus:v}=t,y=OE();return d.jsx("a",{id:h,ref:e,"aria-controls":s,"aria-expanded":a,"aria-haspopup":l,"aria-label":u,className:o,title:i,href:r&&od(r),target:f??"_blank",rel:y,onClick:p,onPointerDown:g,onFocus:v,children:n})});ha.displayName="Link";const qz="SN:ROOT",Wz=m.createContext(null);function Yz(){return m.useContext(Wz)}const BE=m.createContext(qz);BE.displayName="FocusContext";function Qz(){return m.useContext(BE)}function vh(){}function Jz({focusable:t=!0,saveLastFocusedChild:e=!0,trackChildren:n=!1,autoRestoreFocus:r=!0,forceFocus:o=!1,isFocusBoundary:i=!1,focusBoundaryDirections:s,focusKey:a,preferredChildFocusKey:l,onEnterPress:u=vh,onEnterRelease:h=vh,onArrowPress:f=()=>!0,onArrowRelease:p=vh,onFocus:g=vh,onBlur:v=vh}){const y=Yz(),b=m.useCallback(O=>{O&&u(O)},[u]),C=m.useCallback(()=>{h()},[h]),S=m.useCallback((O,W)=>f(O,W),[f]),I=m.useCallback(O=>{p(O)},[p]),E=m.useCallback((O,W)=>{g(O,W)},[g]),T=m.useCallback((O,W)=>{v(O,W)},[v]),w=m.useRef(null),[A,_]=m.useState(!1),[L,N]=m.useState(!1),K=Qz(),q=m.useMemo(()=>y?a??crypto.randomUUID():void 0,[a,y]),ae=m.useCallback((O={})=>{q&&(y==null||y.setFocus(q,O))},[q,y]);return m.useEffect(()=>{const O=w.current;return O&&q&&(y==null||y.addFocusable({focusKey:q,node:O,parentFocusKey:K,preferredChildFocusKey:l,onEnterPress:b,onEnterRelease:C,onArrowPress:S,onArrowRelease:I,onFocus:E,onBlur:T,onUpdateFocus:(W=!1)=>_(W),onUpdateHasFocusedChild:(W=!1)=>N(W),saveLastFocusedChild:e,trackChildren:n,isFocusBoundary:i,focusBoundaryDirections:s,autoRestoreFocus:r,forceFocus:o,focusable:t})),()=>{q&&(y==null||y.removeFocusable({focusKey:q}))}},[]),m.useEffect(()=>{const O=w.current;O&&q&&(y==null||y.updateFocusable(q,{node:O,preferredChildFocusKey:l,focusable:t,isFocusBoundary:i,focusBoundaryDirections:s,onEnterPress:b,onEnterRelease:C,onArrowPress:S,onArrowRelease:I,onFocus:E,onBlur:T}))},[q,l,t,i,s,b,C,S,I,E,T,y]),{ref:w,focusSelf:ae,focused:A,hasFocusedChild:L,focusKey:q}}function Xz(...t){return e=>{for(const n of t)n&&(typeof n=="function"?n(e):n.current=e)}}function kd(t,...e){const n=Jz({onEnterPress:()=>{var o;(o=n.ref.current)==null||o.click()},onFocus:()=>{var o,i;(o=n.ref.current)==null||o.focus(),t.scrollIntoViewOnFocus&&((i=n.ref.current)==null||i.scrollIntoView({block:"nearest"}))},onBlur:()=>{var o;(o=n.ref.current)==null||o.blur()},...t}),r=Xz(...e,n.ref);return{focusable:n,refCallback:r}}const HE="-",Zz=t=>{const e=tV(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:s=>{const a=s.split(HE);return a[0]===""&&a.length!==1&&a.shift(),xO(a,e)||eV(s)},getConflictingClassGroupIds:(s,a)=>{const l=n[s]||[];return a&&r[s]?[...l,...r[s]]:l}}},xO=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?xO(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(HE);return(s=e.validators.find(({validator:a})=>a(i)))==null?void 0:s.classGroupId},jk=/^\[(.+)\]$/,eV=t=>{if(jk.test(t)){const e=jk.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},tV=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return rV(Object.entries(t.classGroups),n).forEach(([i,s])=>{Z0(s,r,i,e)}),r},Z0=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:Uk(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(nV(o)){Z0(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,s])=>{Z0(s,Uk(e,i),n,r)})})},Uk=(t,e)=>{let n=t;return e.split(HE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},nV=t=>t.isThemeGetter,rV=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([s,a])=>[e+s,a])):i);return[n,o]}):t,oV=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,s)=>{n.set(i,s),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let s=n.get(i);if(s!==void 0)return s;if((s=r.get(i))!==void 0)return o(i,s),s},set(i,s){n.has(i)?n.set(i,s):o(i,s)}}},RO="!",iV=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,s=a=>{const l=[];let u=0,h=0,f;for(let b=0;b<a.length;b++){let C=a[b];if(u===0){if(C===o&&(r||a.slice(b,b+i)===e)){l.push(a.slice(h,b)),h=b+i;continue}if(C==="/"){f=b;continue}}C==="["?u++:C==="]"&&u--}const p=l.length===0?a:a.substring(h),g=p.startsWith(RO),v=g?p.substring(1):p,y=f&&f>h?f-h:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:y}};return n?a=>n({className:a,parseClassName:s}):s},sV=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},aV=t=>({cache:oV(t.cacheSize),parseClassName:iV(t),...Zz(t)}),cV=/\s+/,lV=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],s=t.trim().split(cV);let a="";for(let l=s.length-1;l>=0;l-=1){const u=s[l],{modifiers:h,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:g}=n(u);let v=!!g,y=r(v?p.substring(0,g):p);if(!y){if(!v){a=u+(a.length>0?" "+a:a);continue}if(y=r(p),!y){a=u+(a.length>0?" "+a:a);continue}v=!1}const b=sV(h).join(":"),C=f?b+RO:b,S=C+y;if(i.includes(S))continue;i.push(S);const I=o(y,v);for(let E=0;E<I.length;++E){const T=I[E];i.push(C+T)}a=u+(a.length>0?" "+a:a)}return a};function uV(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=NO(e))&&(r&&(r+=" "),r+=n);return r}const NO=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=NO(t[r]))&&(n&&(n+=" "),n+=e);return n};function dV(t,...e){let n,r,o,i=s;function s(l){const u=e.reduce((h,f)=>f(h),t());return n=aV(u),r=n.cache.get,o=n.cache.set,i=a,a(l)}function a(l){const u=r(l);if(u)return u;const h=lV(l,n);return o(l,h),h}return function(){return i(uV.apply(null,arguments))}}const sn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},PO=/^\[(?:([a-z-]+):)?(.+)\]$/i,hV=/^\d+\/\d+$/,fV=new Set(["px","full","screen"]),pV=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,mV=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gV=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,vV=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yV=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ss=t=>Ou(t)||fV.has(t)||hV.test(t),zs=t=>xd(t,"length",_V),Ou=t=>!!t&&!Number.isNaN(Number(t)),NC=t=>xd(t,"number",Ou),yh=t=>!!t&&Number.isInteger(Number(t)),bV=t=>t.endsWith("%")&&Ou(t.slice(0,-1)),vt=t=>PO.test(t),Vs=t=>pV.test(t),CV=new Set(["length","size","percentage"]),SV=t=>xd(t,CV,MO),IV=t=>xd(t,"position",MO),EV=new Set(["image","url"]),TV=t=>xd(t,EV,kV),wV=t=>xd(t,"",AV),bh=()=>!0,xd=(t,e,n)=>{const r=PO.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},_V=t=>mV.test(t)&&!gV.test(t),MO=()=>!1,AV=t=>vV.test(t),kV=t=>yV.test(t),xV=()=>{const t=sn("colors"),e=sn("spacing"),n=sn("blur"),r=sn("brightness"),o=sn("borderColor"),i=sn("borderRadius"),s=sn("borderSpacing"),a=sn("borderWidth"),l=sn("contrast"),u=sn("grayscale"),h=sn("hueRotate"),f=sn("invert"),p=sn("gap"),g=sn("gradientColorStops"),v=sn("gradientColorStopPositions"),y=sn("inset"),b=sn("margin"),C=sn("opacity"),S=sn("padding"),I=sn("saturate"),E=sn("scale"),T=sn("sepia"),w=sn("skew"),A=sn("space"),_=sn("translate"),L=()=>["auto","contain","none"],N=()=>["auto","hidden","clip","visible","scroll"],K=()=>["auto",vt,e],q=()=>[vt,e],ae=()=>["",ss,zs],O=()=>["auto",Ou,vt],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],te=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>["start","end","center","between","around","evenly","stretch"],re=()=>["","0",vt],J=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>[Ou,vt];return{cacheSize:500,separator:":",theme:{colors:[bh],spacing:[ss,zs],blur:["none","",Vs,vt],brightness:ne(),borderColor:[t],borderRadius:["none","","full",Vs,vt],borderSpacing:q(),borderWidth:ae(),contrast:ne(),grayscale:re(),hueRotate:ne(),invert:re(),gap:q(),gradientColorStops:[t],gradientColorStopPositions:[bV,zs],inset:K(),margin:K(),opacity:ne(),padding:q(),saturate:ne(),scale:ne(),sepia:re(),skew:ne(),space:q(),translate:q()},classGroups:{aspect:[{aspect:["auto","square","video",vt]}],container:["container"],columns:[{columns:[Vs]}],"break-after":[{"break-after":J()}],"break-before":[{"break-before":J()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),vt]}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",yh,vt]}],basis:[{basis:K()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",vt]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:["first","last","none",yh,vt]}],"grid-cols":[{"grid-cols":[bh]}],"col-start-end":[{col:["auto",{span:["full",yh,vt]},vt]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[bh]}],"row-start-end":[{row:["auto",{span:[yh,vt]},vt]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",vt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",vt]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...G()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...G(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...G(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",vt,e]}],"min-w":[{"min-w":[vt,e,"min","max","fit"]}],"max-w":[{"max-w":[vt,e,"none","full","min","max","fit","prose",{screen:[Vs]},Vs]}],h:[{h:[vt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[vt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[vt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[vt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Vs,zs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",NC]}],"font-family":[{font:[bh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",vt]}],"line-clamp":[{"line-clamp":["none",Ou,NC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ss,vt]}],"list-image":[{"list-image":["none",vt]}],"list-style-type":[{list:["none","disc","decimal",vt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...te(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ss,zs]}],"underline-offset":[{"underline-offset":["auto",ss,vt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:q()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",vt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",vt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),IV]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",SV]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},TV]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[...te(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:te()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...te()]}],"outline-offset":[{"outline-offset":[ss,vt]}],"outline-w":[{outline:[ss,zs]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[ss,zs]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Vs,wV]}],"shadow-color":[{shadow:[bh]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Vs,vt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[I]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",vt]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",vt]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",vt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[yh,vt]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",vt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",vt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":q()}],"scroll-mx":[{"scroll-mx":q()}],"scroll-my":[{"scroll-my":q()}],"scroll-ms":[{"scroll-ms":q()}],"scroll-me":[{"scroll-me":q()}],"scroll-mt":[{"scroll-mt":q()}],"scroll-mr":[{"scroll-mr":q()}],"scroll-mb":[{"scroll-mb":q()}],"scroll-ml":[{"scroll-ml":q()}],"scroll-p":[{"scroll-p":q()}],"scroll-px":[{"scroll-px":q()}],"scroll-py":[{"scroll-py":q()}],"scroll-ps":[{"scroll-ps":q()}],"scroll-pe":[{"scroll-pe":q()}],"scroll-pt":[{"scroll-pt":q()}],"scroll-pr":[{"scroll-pr":q()}],"scroll-pb":[{"scroll-pb":q()}],"scroll-pl":[{"scroll-pl":q()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",vt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ss,zs,NC]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},RV=dV(xV);function Be(...t){return RV(Y(t))}const mp="overflow-hidden",Ps="backdrop-blur-2xl backdrop-saturate-200",zE="bg-white/70 dark:bg-slate-800/70",mi=Y(mp,Ps,zE),NV=Y(mp,Ps),PV=Y(Ps,zE),MV="bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]",OV="dark:bg-white/70  bg-slate-800/70",LV=Y(mp,Ps,OV);Y(Ps,zE);const OO="bg-accent-100/60 dark:bg-slate-800/50",DV=Y(Ps,OO),aa=Y(mp,Ps,OO),jV="bg-acrylic-thin-fallback-light/95 dark:bg-acrylic-thin-fallback-dark/[92]",LO="dark:bg-accent-900/60 bg-slate-800/50";Y(Ps,LO);const UV=Y(mp,Ps,LO),kf="relative flex items-center",Yo="text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650",Fk="text-slate-200 fill-slate-200 active:text-slate-300 active:fill-slate-300 dark:text-stone-800 dark:fill-stone-800 dark:active:text-stone-600 dark:active:fill-stone-600",FV="text-foreground-250 fill-foreground-250 active:text-foreground-350 active:fill-foreground-350 dark:text-foreground-750 dark:fill-foreground-750 dark:active:text-foreground-650 dark:active:fill-foreground-650",BV="text-accent-550 fill-accent-550 active:text-accent-450/80 active:fill-accent-450/80 dark:text-accent-850 dark:fill-accent-850 dark:active:text-accent-700 dark:active:fill-accent-700",Ch="shadow-sm",Bk="shadow-with-highlight-sm",HV="text-cocoa-550 safe-hover:text-caramel-450 dark:text-slate-300 dark:active:text-slate-200",zV="bg-white/70 safe-hover:bg-caramel-200 active:bg-caramel-200/20 dark:bg-slate-450/30 dark:safe-hover:bg-midnight-800 dark:active:bg-midnight-800/20",VV="border-[0.5px] border-transparent safe-hover:border-caramel-400 dark:safe-hover:border-midnight-350",$V="text-caramel-600 fill-caramel-600 active:text-caramel-400 active:fill-caramel-400 dark:text-slate-200 dark:fill-text-slate-200 dark:active:text-slate-100 dark:active:fill-slate-100",GV="bg-caramel-200 safe-hover:bg-caramel-300 active:bg-caramel-300 dark:bg-slate-650 dark:safe-hover:bg-slate-400 dark:active:bg-slate-400",PC="bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-black/30 dark:active:bg-black/20",Pc={default:`${Yo} ${Bk} bg-white/70 safe-hover:bg-white active:bg-white/60 dark:bg-slate-450/30 dark:safe-hover:bg-slate-450/40 dark:active:bg-slate-450/20`,strong:`${FV} ${Ch} bg-stone-800 safe-hover:bg-black active:bg-stone-750 dark:bg-slate-600 dark:safe-hover:bg-slate-550 dark:active:bg-slate-600/80`,accent:`${BV} bg-accent-250 safe-hover:bg-accent-300 active:bg-accent-200 dark:bg-accent-550 dark:safe-hover:bg-accent-450 dark:active:bg-accent-600/80`,"overlay-bright":`${Yo} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"overlay-bright-inverted":`${Yo} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed":`${Yo} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed-inverted":`${Yo} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"subtle-bright":`${Yo} bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,"subtle-bright-inverted":`${Yo} ${PC}`,"subtle-dimmed":`${Yo} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-black/30 dark:active:bg-black/20`,"subtle-dimmed-inverted":`${Yo} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,acrylic:`${Yo} ${Ch} ${PC}`,"acrylic-inverted":`${Fk} ${Ch} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,"acrylic-thin":`${Yo} ${Ch} ${PC}`,"acrylic-thin-inverted":`${Fk} ${Ch} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,chip:`${HV} ${zV} ${Bk} ${VV}`,alert:"bg-system-red-600 safe-hover:bg-system-red-650 active:bg-system-red-550","composer-selected":`${$V} ${GV}`},DO={acrylic:`${mi}`,"acrylic-inverted":`${LV}`,"acrylic-thin":`${aa}`,"acrylic-thin-inverted":`${UV}`};function KV(t){return t in DO}const qV={start:"justify-start",center:"justify-center",end:"justify-end"},VE={"28-xxs":"text-xs","32-xs":"text-xs","36-sm":"text-xs","40-base":"text-sm","48-lg":"text-base","56-xl":"text-base","64-xxl":"text-base"},Xs={"28-xxs":"gap-x-1.5","32-xs":"gap-x-1.5","36-sm":"gap-x-1.5","40-base":"gap-x-2","48-lg":"gap-x-3","56-xl":"gap-x-3","64-xxl":"gap-x-3"},$E={"28-xxs":`min-h-7 min-w-8 px-3 py-1 ${Xs["28-xxs"]}`,"32-xs":`min-h-8 min-w-8 px-2.5 py-1 ${Xs["32-xs"]}`,"36-sm":`min-h-9 min-w-9 px-2.5 py-1 ${Xs["36-sm"]}`,"40-base":`min-h-10 min-w-10 px-3 py-2 ${Xs["40-base"]}`,"48-lg":`min-h-12 min-w-12 px-3 py-2.5 ${Xs["48-lg"]}`,"56-xl":`min-h-14 min-w-14 px-4 py-3.5 ${Xs["56-xl"]}`,"64-xxl":`min-h-16 min-w-16 p-4 ${Xs["64-xxl"]}`},WV={"28-xxs":"size-7","32-xs":"size-8","36-sm":"size-9","40-base":"size-10","48-lg":"size-12","56-xl":"size-14","64-xxl":"size-16"},e1={"28-xxs":"rounded-lg before:rounded-lg","32-xs":"rounded-lg before:rounded-lg","36-sm":"rounded-xl before:rounded-xl","40-base":"rounded-xl before:rounded-xl","48-lg":"rounded-3xl before:rounded-3xl","56-xl":"rounded-4xl before:rounded-4xl","64-xxl":"rounded-4xl before:rounded-4xl"},YV={none:"",regular:"border border-solid border-stone-350 dark:border-slate-600",strong:"border border-solid border-2 border-stroke-750"},Hk="rounded-full before:rounded-full",QV="opacity-40 pointer-events-none",by="before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900",Te=m.forwardRef((t,e)=>{const{children:n,onClick:r,onFocus:o,onBlur:i,onKeyDown:s,onKeyUp:a,onMouseEnter:l,onMouseLeave:u,href:h,className:f,title:p,variant:g="rect",alignment:v="center",color:y="default",outline:b="none",size:C="40-base",disabled:S,id:I,role:E,testId:T,spatialNavigationAutofocus:w=!1,"aria-controls":A,"aria-expanded":_,"aria-haspopup":L,"aria-pressed":N,"aria-label":K,"aria-selected":q,onPointerDown:ae}=t,O=g==="circle"||g==="square",W=g==="circle"||g==="pill",te=Be(kf,Pc[y],VE[C],qV[v],O?WV[C]:$E[C],W?Hk:e1[C],by,S&&QV,YV[b],f);let D=n;if(KV(y)){const J=Be(DO[y],W?Hk:e1[C]);D=d.jsxs(d.Fragment,{children:[d.jsx("div",{className:Be("absolute inset-0",J)}),d.jsx("div",{className:`relative ${kf} ${Xs[C]}`,children:n})]})}const{refCallback:G,focusable:re}=kd({autoRestoreFocus:!0,forceFocus:!0},e);return h!==void 0?d.jsx(ha,{id:I,onPointerDown:ae,"aria-controls":A,"aria-expanded":_,"aria-haspopup":L,href:h,ref:re.ref,onClick:r,title:p,className:te,"data-testid":T,"aria-label":K,"aria-selected":q,children:D}):d.jsx("button",{onPointerDown:ae,ref:G,id:I,"aria-controls":A,"aria-expanded":_,"aria-haspopup":L,"aria-pressed":N,"aria-selected":q,type:"button",className:te,title:p,role:E,disabled:S,onClick:r,onFocus:o,onBlur:i,onKeyDown:s,onKeyUp:a,onMouseEnter:l,onMouseLeave:u,"data-testid":T,"data-spatial-navigation-autofocus":w,"aria-label":K,"data-spatial-focus-key":re.focusKey,children:D})});Te.displayName="Button";function JV({reason:t,onReload:e}){const{t:n}=xe();return d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"pb-3 text-lg",children:n("authentication.accountChanged")}),d.jsx("p",{className:"pb-7",children:n(t==="login"?"authentication.signedInOtherTab":"authentication.signedOutOtherTab")}),d.jsx(Te,{onClick:e,title:n("authentication.reloadToContinue"),variant:"pill",size:"48-lg",className:"w-full",children:n("authentication.reloadToContinue")})]})}const GE=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M15.144 5.885c.62-.777 1.042-1.82.931-2.885-.909.045-2.018.6-2.66 1.377-.576.665-1.087 1.752-.954 2.772 1.02.089 2.04-.51 2.683-1.264ZM16.064 7.349c-1.482-.089-2.742.84-3.45.84-.707 0-1.79-.796-2.963-.774-1.525.022-2.94.884-3.714 2.256-1.592 2.744-.42 6.814 1.128 9.049.752 1.105 1.658 2.323 2.852 2.279 1.128-.044 1.57-.73 2.94-.73 1.371 0 1.77.73 2.963.708 1.238-.022 2.013-1.106 2.764-2.213.863-1.26 1.216-2.477 1.238-2.544-.022-.022-2.388-.93-2.41-3.65-.022-2.28 1.858-3.363 1.946-3.43-1.061-1.57-2.72-1.747-3.294-1.791Z"})),i2e=Object.freeze(Object.defineProperty({__proto__:null,default:GE},Symbol.toStringTag,{value:"Module"})),KE=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 24",...t},m.createElement("g",{clipPath:"url(#a)"},m.createElement("path",{fill:"#4285F4",d:"M20.5 12.2a8 8 0 0 0-.2-1.8h-8.1v3.3H17c-.1.8-.7 2-1.8 3l2.5 2 .2.1a9 9 0 0 0 2.6-6.6Z"}),m.createElement("path",{fill:"#34A853",d:"M12.2 21c2.3 0 4.3-.8 5.7-2.2l-2.7-2.2a5.2 5.2 0 0 1-8-2.8l-2.7 2.1v.1c1.4 3 4.3 5 7.7 5Z"}),m.createElement("path",{fill:"#FBBC05",d:"M7.2 13.8a5.7 5.7 0 0 1 0-3.6L4.5 7.8a9.2 9.2 0 0 0 0 8.1l2.7-2.2Z"}),m.createElement("path",{fill:"#EB4335",d:"M12.2 6.5c1.6 0 2.7.7 3.3 1.3L18 5.4A8.2 8.2 0 0 0 12.2 3C8.8 3 5.9 5 4.4 8l2.8 2.2a5.3 5.3 0 0 1 5-3.7Z"})),m.createElement("defs",null,m.createElement("clipPath",{id:"a"},m.createElement("path",{fill:"#fff",d:"M3.5 3h17v18h-17z"})))),s2e=Object.freeze(Object.defineProperty({__proto__:null,default:KE},Symbol.toStringTag,{value:"Module"})),Cy=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 24",...t},m.createElement("path",{fill:"#F25022",d:"M12.05 3H3.5v8.55h8.55V3Z"}),m.createElement("path",{fill:"#7FBA00",d:"M21.5 3h-8.55v8.55h8.55V3Z"}),m.createElement("path",{fill:"#00A4EF",d:"M12.05 12.45H3.5V21h8.55v-8.55Z"}),m.createElement("path",{fill:"#FFB900",d:"M21.5 12.45h-8.55V21h8.55v-8.55Z"})),a2e=Object.freeze(Object.defineProperty({__proto__:null,default:Cy},Symbol.toStringTag,{value:"Module"})),jO="140e65af-45d1-4427-bf08-3e7295db6836/ChatAI.ReadWrite",zk={auth:{clientId:"14638111-3389-403d-b206-a6a71d9f8f16",authority:"https://login.microsoftonline.com/common",navigateToLoginRequestUrl:!1},system:{allowNativeBroker:!1},cache:{cacheLocation:"localStorage"}},qE={scopes:[jO],extraQueryParameters:{lw:"1",coa:"1",nopa:"2",fl:"easi2_nowld",cobrandid:"8c0b039e-5a73-4399-9b56-7e237be2cd06"},prompt:"select_account",redirectUri:typeof window<"u"?window.location.origin:void 0},XV={scopes:[jO],prompt:"none",authority:"https://login.microsoftonline.com/consumers",redirectUri:typeof window<"u"?window.location.origin:void 0},Vk={scopes:["User.Read"]},ZV={scopes:["OneDrive.ReadWrite"],authority:"https://login.microsoftonline.com/consumers"},WE={graphMeApiSuffix:"/me",graphMeImageApiSuffix:"/me/photo/$value",graphMeLicenseDetails:"/me/licenseDetails"},$k={appName:"copilot_studio",enableMATS:!0,appVersion:"0.0.0"},e$="IalDS3vRtEI5X0zvsmGG7zJP9UrHTcei",t$="auth.copilot.microsoft.com",UO="https://copilot.microsoft.com",n$={clientId:e$,domain:t$,cacheLocation:"localstorage",useRefreshTokens:!0,useRefreshTokensFallback:!0},FO="openid profile email offline_access ChatAI.ReadWrite",BO=typeof window<"u"?window.location.origin:void 0,xf={authorizationParams:{audience:UO,scope:FO,redirect_uri:BO}},r$={authorizationParams:{audience:UO,scope:FO,redirect_uri:BO,prompt:"select_account"}},t1="cp-pro";function o$(t){switch(t){case"login":return qE;case"graph":return Vk;case"oneDrive":return ZV;default:return Vk}}const i$={actAsBroker:!0,preferredInteractionType:"redirect"};function rl(){return!!me.instance().config().enableAuth0}var Sy=QB();const ca=()=>{},dn=ca(),MC=Object,De=t=>t===dn,Rr=t=>typeof t=="function",go=(t,e)=>({...t,...e}),s$=t=>Rr(t.then),sm=new WeakMap;let a$=0;const Rf=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let o,i;if(MC(t)===t&&!r&&n!=RegExp){if(o=sm.get(t),o)return o;if(o=++a$+"~",sm.set(t,o),n==Array){for(o="@",i=0;i<t.length;i++)o+=Rf(t[i])+",";sm.set(t,o)}if(n==MC){o="#";const s=MC.keys(t).sort();for(;!De(i=s.pop());)De(t[i])||(o+=i+":"+Rf(t[i])+",");sm.set(t,o)}}else o=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},No=new WeakMap,OC={},am={},YE="undefined",Iy=typeof window!=YE,n1=typeof document!=YE,c$=()=>Iy&&typeof window.requestAnimationFrame!=YE,Pi=(t,e)=>{const n=No.get(t);return[()=>!De(e)&&t.get(e)||OC,r=>{if(!De(e)){const o=t.get(e);e in am||(am[e]=o),n[5](e,go(o,r),o||OC)}},n[6],()=>!De(e)&&e in am?am[e]:!De(e)&&t.get(e)||OC]};let r1=!0;const l$=()=>r1,[o1,i1]=Iy&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ca,ca],u$=()=>{const t=n1&&document.visibilityState;return De(t)||t!=="hidden"},d$=t=>(n1&&document.addEventListener("visibilitychange",t),o1("focus",t),()=>{n1&&document.removeEventListener("visibilitychange",t),i1("focus",t)}),h$=t=>{const e=()=>{r1=!0,t()},n=()=>{r1=!1};return o1("online",e),o1("offline",n),()=>{i1("online",e),i1("offline",n)}},f$={isOnline:l$,isVisible:u$},p$={initFocus:d$,initReconnect:h$},Mc=!nl.useId,Es=!Iy||"Deno"in window,QE=t=>c$()?window.requestAnimationFrame(t):setTimeout(t,1),Do=Es?m.useEffect:m.useLayoutEffect,LC=typeof navigator<"u"&&navigator.connection,Gk=!Es&&LC&&(["slow-2g","2g"].includes(LC.effectiveType)||LC.saveData),Ts=t=>{if(Rr(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Rf(t):"",[t,e]};let m$=0;const Oc=()=>++m$,HO=0,zO=1,VO=2,g$=3;var Nr={__proto__:null,ERROR_REVALIDATE_EVENT:g$,FOCUS_EVENT:HO,MUTATE_EVENT:VO,RECONNECT_EVENT:zO};async function Ey(...t){const[e,n,r,o]=t,i=go({populateCache:!0,throwOnError:!0},typeof o=="boolean"?{revalidate:o}:o||{});let s=i.populateCache;const a=i.rollbackOnError;let l=i.optimisticData;const u=p=>typeof a=="function"?a(p):a!==!1,h=i.throwOnError;if(Rr(n)){const p=n,g=[],v=e.keys();for(const y of v)!/^\$(inf|sub)\$/.test(y)&&p(e.get(y)._k)&&g.push(y);return Promise.all(g.map(f))}return f(n);async function f(p){const[g]=Ts(p);if(!g)return;const[v,y]=Pi(e,g),[b,C,S,I]=No.get(e),E=()=>{const ae=b[g];return(Rr(i.revalidate)?i.revalidate(v().data,p):i.revalidate!==!1)&&(delete S[g],delete I[g],ae&&ae[0])?ae[0](VO).then(()=>v().data):v().data};if(t.length<3)return E();let T=r,w;const A=Oc();C[g]=[A,0];const _=!De(l),L=v(),N=L.data,K=L._c,q=De(K)?N:K;if(_&&(l=Rr(l)?l(q,N):l,y({data:l,_c:q})),Rr(T))try{T=T(q)}catch(ae){w=ae}if(T&&s$(T))if(T=await T.catch(ae=>{w=ae}),A!==C[g][0]){if(w)throw w;return T}else w&&_&&u(w)&&(s=!0,y({data:q,_c:dn}));if(s&&!w)if(Rr(s)){const ae=s(T,q);y({data:ae,error:dn,_c:dn})}else y({data:T,error:dn,_c:dn});if(C[g][1]=Oc(),Promise.resolve(E()).then(()=>{y({_c:dn})}),w){if(h)throw w;return}return T}}const Kk=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},v$=(t,e)=>{if(!No.has(t)){const n=go(p$,e),r={},o=Ey.bind(dn,t);let i=ca;const s={},a=(h,f)=>{const p=s[h]||[];return s[h]=p,p.push(f),()=>p.splice(p.indexOf(f),1)},l=(h,f,p)=>{t.set(h,f);const g=s[h];if(g)for(const v of g)v(f,p)},u=()=>{if(!No.has(t)&&(No.set(t,[r,{},{},{},o,l,a]),!Es)){const h=n.initFocus(setTimeout.bind(dn,Kk.bind(dn,r,HO))),f=n.initReconnect(setTimeout.bind(dn,Kk.bind(dn,r,zO)));i=()=>{h&&h(),f&&f(),No.delete(t)}}};return u(),[t,o,u,i]}return[t,No.get(t)[4]]},y$=(t,e,n,r,o)=>{const i=n.errorRetryCount,s=o.retryCount,a=~~((Math.random()+.5)*(1<<(s<8?s:8)))*n.errorRetryInterval;!De(i)&&s>i||setTimeout(r,a,o)},b$=(t,e)=>Rf(t)==Rf(e),[JE,C$]=v$(new Map),S$=go({onLoadingSlow:ca,onSuccess:ca,onError:ca,onErrorRetry:y$,onDiscarded:ca,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Gk?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Gk?5e3:3e3,compare:b$,isPaused:()=>!1,cache:JE,mutate:C$,fallback:{}},f$),I$=(t,e)=>{const n=go(t,e);if(e){const{use:r,fallback:o}=t,{use:i,fallback:s}=e;r&&i&&(n.use=r.concat(i)),o&&s&&(n.fallback=go(o,s))}return n},E$=m.createContext({}),$O="$inf$",GO=Iy&&window.__SWR_DEVTOOLS_USE__,T$=GO?window.__SWR_DEVTOOLS_USE__:[],w$=()=>{GO&&(window.__SWR_DEVTOOLS_REACT__=nl)},KO=t=>Rr(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],XE=()=>go(S$,m.useContext(E$)),_$=t=>(e,n,r)=>t(e,n&&((...i)=>{const[s]=Ts(e),[,,,a]=No.get(JE);if(s.startsWith($O))return n(...i);const l=a[s];return De(l)?n(...i):(delete a[s],l)}),r),A$=T$.concat(_$),ZE=t=>function(...n){const r=XE(),[o,i,s]=KO(n),a=I$(r,s);let l=t;const{use:u}=a,h=(u||[]).concat(A$);for(let f=h.length;f--;)l=h[f](l);return l(o,i||a.fetcher||null,a)},eT=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o>=0&&(r[o]=r[r.length-1],r.pop())}},qO=(t,e)=>(...n)=>{const[r,o,i]=KO(n),s=(i.use||[]).concat(e);return t(r,o,{...i,use:s})};w$();const qk=nl.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),DC={dedupe:!0},k$=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:l,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:p}=n,[g,v,y,b]=No.get(r),[C,S]=Ts(t),I=m.useRef(!1),E=m.useRef(!1),T=m.useRef(C),w=m.useRef(e),A=m.useRef(n),_=()=>A.current,L=()=>_().isVisible()&&_().isOnline(),[N,K,q,ae]=Pi(r,C),O=m.useRef({}).current,W=De(s)?n.fallback[C]:s,te=(k,B)=>{for(const ge in O){const M=ge;if(M==="data"){if(!o(k[M],B[M])&&(!De(k[M])||!o(be,B[M])))return!1}else if(B[M]!==k[M])return!1}return!0},D=m.useMemo(()=>{const k=!C||!e?!1:De(a)?_().isPaused()||i?!1:De(l)?!0:l:a,B=Z=>{const Ee=go(Z);return delete Ee._k,k?{isValidating:!0,isLoading:!0,...Ee}:Ee},ge=N(),M=ae(),Q=B(ge),fe=ge===M?Q:B(M);let z=Q;return[()=>{const Z=B(N());return te(Z,z)?(z.data=Z.data,z.isLoading=Z.isLoading,z.isValidating=Z.isValidating,z.error=Z.error,z):(z=Z,Z)},()=>fe]},[r,C]),G=Sy.useSyncExternalStore(m.useCallback(k=>q(C,(B,ge)=>{te(ge,B)||k()}),[r,C]),D[0],D[1]),re=!I.current,J=g[C]&&g[C].length>0,ne=G.data,X=De(ne)?W:ne,Ie=G.error,Ce=m.useRef(X),be=p?De(ne)?Ce.current:ne:X,ue=J&&!De(Ie)?!1:re&&!De(a)?a:_().isPaused()?!1:i?De(X)?!1:l:De(X)||l,Me=!!(C&&e&&re&&ue),Ye=De(G.isValidating)?Me:G.isValidating,le=De(G.isLoading)?Me:G.isLoading,we=m.useCallback(async k=>{const B=w.current;if(!C||!B||E.current||_().isPaused())return!1;let ge,M,Q=!0;const fe=k||{},z=!y[C]||!fe.dedupe,Z=()=>Mc?!E.current&&C===T.current&&I.current:C===T.current,Ee={isValidating:!1,isLoading:!1},tt=()=>{K(Ee)},ht=()=>{const Ve=y[C];Ve&&Ve[1]===M&&delete y[C]},mt={isValidating:!0};De(N().data)&&(mt.isLoading=!0);try{if(z&&(K(mt),n.loadingTimeout&&De(N().data)&&setTimeout(()=>{Q&&Z()&&_().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[B(S),Oc()]),[ge,M]=y[C],ge=await ge,z&&setTimeout(ht,n.dedupingInterval),!y[C]||y[C][1]!==M)return z&&Z()&&_().onDiscarded(C),!1;Ee.error=dn;const Ve=v[C];if(!De(Ve)&&(M<=Ve[0]||M<=Ve[1]||Ve[1]===0))return tt(),z&&Z()&&_().onDiscarded(C),!1;const rt=N().data;Ee.data=o(rt,ge)?rt:ge,z&&Z()&&_().onSuccess(ge,C,n)}catch(Ve){ht();const rt=_(),{shouldRetryOnError:xt}=rt;rt.isPaused()||(Ee.error=Ve,z&&Z()&&(rt.onError(Ve,C,rt),(xt===!0||Rr(xt)&&xt(Ve))&&(!_().revalidateOnFocus||!_().revalidateOnReconnect||L())&&rt.onErrorRetry(Ve,C,rt,qt=>{const Wt=g[C];Wt&&Wt[0]&&Wt[0](Nr.ERROR_REVALIDATE_EVENT,qt)},{retryCount:(fe.retryCount||0)+1,dedupe:!0})))}return Q=!1,tt(),!0},[C,r]),Ke=m.useCallback((...k)=>Ey(r,T.current,...k),[]);if(Do(()=>{w.current=e,A.current=n,De(ne)||(Ce.current=ne)}),Do(()=>{if(!C)return;const k=we.bind(dn,DC);let B=0;const M=eT(C,g,(Q,fe={})=>{if(Q==Nr.FOCUS_EVENT){const z=Date.now();_().revalidateOnFocus&&z>B&&L()&&(B=z+_().focusThrottleInterval,k())}else if(Q==Nr.RECONNECT_EVENT)_().revalidateOnReconnect&&L()&&k();else{if(Q==Nr.MUTATE_EVENT)return we();if(Q==Nr.ERROR_REVALIDATE_EVENT)return we(fe)}});return E.current=!1,T.current=C,I.current=!0,K({_k:S}),ue&&(De(X)||Es?k():QE(k)),()=>{E.current=!0,M()}},[C]),Do(()=>{let k;function B(){const M=Rr(u)?u(N().data):u;M&&k!==-1&&(k=setTimeout(ge,M))}function ge(){!N().error&&(h||_().isVisible())&&(f||_().isOnline())?we(DC).then(B):B()}return B(),()=>{k&&(clearTimeout(k),k=-1)}},[u,h,f,C]),m.useDebugValue(be),i&&De(X)&&C){if(!Mc&&Es)throw new Error("Fallback data is required when using suspense in SSR.");w.current=e,A.current=n,E.current=!1;const k=b[C];if(!De(k)){const B=Ke(k);qk(B)}if(De(Ie)){const B=we(DC);De(be)||(B.status="fulfilled",B.value=!0),qk(B)}else throw Ie}return{mutate:Ke,get data(){return O.data=!0,be},get error(){return O.error=!0,Ie},get isValidating(){return O.isValidating=!0,Ye},get isLoading(){return O.isLoading=!0,le}}},x$=ZE(k$),Wk=Mc?t=>{t()}:nl.startTransition,R$=t=>{const[,e]=m.useState({}),n=m.useRef(!1),r=m.useRef(t),o=m.useRef({data:!1,error:!1,isValidating:!1}),i=m.useCallback(s=>{let a=!1;const l=r.current;for(const u in s){const h=u;l[h]!==s[h]&&(l[h]=s[h],o.current[h]&&(a=!0))}a&&!n.current&&e({})},[]);return Do(()=>(n.current=!1,()=>{n.current=!0})),[r,o.current,i]},N$=()=>(t,e,n={})=>{const{mutate:r}=XE(),o=m.useRef(t),i=m.useRef(e),s=m.useRef(n),a=m.useRef(0),[l,u,h]=R$({data:dn,error:dn,isMutating:!1}),f=l.current,p=m.useCallback(async(v,y)=>{const[b,C]=Ts(o.current);if(!i.current)throw new Error("Can’t trigger the mutation: missing fetcher.");if(!b)throw new Error("Can’t trigger the mutation: missing key.");const S=go(go({populateCache:!1,throwOnError:!0},s.current),y),I=Oc();a.current=I,h({isMutating:!0});try{const E=await r(b,i.current(C,{arg:v}),go(S,{throwOnError:!0}));return a.current<=I&&(Wk(()=>h({data:E,isMutating:!1,error:void 0})),S.onSuccess==null||S.onSuccess.call(S,E,b,S)),E}catch(E){if(a.current<=I&&(Wk(()=>h({error:E,isMutating:!1})),S.onError==null||S.onError.call(S,E,b,S),S.throwOnError))throw E}},[]),g=m.useCallback(()=>{a.current=Oc(),h({data:dn,error:dn,isMutating:!1})},[]);return Do(()=>{o.current=t,i.current=e,s.current=n}),{trigger:p,reset:g,get data(){return u.data=!0,f.data},get error(){return u.error=!0,f.error},get isMutating(){return u.isMutating=!0,f.isMutating}}},tT=qO(x$,N$);var WO=Symbol.for("immer-nothing"),Yk=Symbol.for("immer-draftable"),Ht=Symbol.for("immer-state");function Po(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var id=Object.getPrototypeOf;function sd(t){return!!t&&!!t[Ht]}function ws(t){var e;return t?YO(t)||Array.isArray(t)||!!t[Yk]||!!((e=t.constructor)!=null&&e[Yk])||wy(t)||_y(t):!1}var P$=Object.prototype.constructor.toString();function YO(t){if(!t||typeof t!="object")return!1;const e=id(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===P$}function Nf(t,e){Ty(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function Ty(t){const e=t[Ht];return e?e.type_:Array.isArray(t)?1:wy(t)?2:_y(t)?3:0}function s1(t,e){return Ty(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function QO(t,e,n){const r=Ty(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function M$(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function wy(t){return t instanceof Map}function _y(t){return t instanceof Set}function Xn(t){return t.copy_||t.base_}function a1(t,e){if(wy(t))return new Map(t);if(_y(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=YO(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Ht];let o=Reflect.ownKeys(r);for(let i=0;i<o.length;i++){const s=o[i],a=r[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[s]})}return Object.create(id(t),r)}else{const r=id(t);if(r!==null&&n)return{...t};const o=Object.create(r);return Object.assign(o,t)}}function nT(t,e=!1){return Ay(t)||sd(t)||!ws(t)||(Ty(t)>1&&(t.set=t.add=t.clear=t.delete=O$),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>nT(r,!0))),t}function O$(){Po(2)}function Ay(t){return Object.isFrozen(t)}var c1={};function Lc(t){const e=c1[t];return e||Po(0,t),e}function L$(t,e){c1[t]||(c1[t]=e)}var Pf;function Og(){return Pf}function D$(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Qk(t,e){e&&(Lc("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function l1(t){u1(t),t.drafts_.forEach(j$),t.drafts_=null}function u1(t){t===Pf&&(Pf=t.parent_)}function Jk(t){return Pf=D$(Pf,t)}function j$(t){const e=t[Ht];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Xk(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Ht].modified_&&(l1(e),Po(4)),ws(t)&&(t=Lg(e,t),e.parent_||Dg(e,t)),e.patches_&&Lc("Patches").generateReplacementPatches_(n[Ht].base_,t,e.patches_,e.inversePatches_)):t=Lg(e,n,[]),l1(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==WO?t:void 0}function Lg(t,e,n){if(Ay(e))return e;const r=e[Ht];if(!r)return Nf(e,(o,i)=>Zk(t,r,e,o,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Dg(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const o=r.copy_;let i=o,s=!1;r.type_===3&&(i=new Set(o),o.clear(),s=!0),Nf(i,(a,l)=>Zk(t,r,o,a,l,n,s)),Dg(t,o,!1),n&&t.patches_&&Lc("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function Zk(t,e,n,r,o,i,s){if(sd(o)){const a=i&&e&&e.type_!==3&&!s1(e.assigned_,r)?i.concat(r):void 0,l=Lg(t,o,a);if(QO(n,r,l),sd(l))t.canAutoFreeze_=!1;else return}else s&&n.add(o);if(ws(o)&&!Ay(o)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Lg(t,o),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Dg(t,o)}}function Dg(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&nT(e,n)}function U$(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:Og(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=r,i=rT;n&&(o=[r],i=Mf);const{revoke:s,proxy:a}=Proxy.revocable(o,i);return r.draft_=a,r.revoke_=s,a}var rT={get(t,e){if(e===Ht)return t;const n=Xn(t);if(!s1(n,e))return F$(t,n,e);const r=n[e];return t.finalized_||!ws(r)?r:r===jC(t.base_,e)?(UC(t),t.copy_[e]=Of(r,t)):r},has(t,e){return e in Xn(t)},ownKeys(t){return Reflect.ownKeys(Xn(t))},set(t,e,n){const r=JO(Xn(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const o=jC(Xn(t),e),i=o==null?void 0:o[Ht];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(M$(n,o)&&(n!==void 0||s1(t.base_,e)))return!0;UC(t),hs(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return jC(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,UC(t),hs(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Xn(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Po(11)},getPrototypeOf(t){return id(t.base_)},setPrototypeOf(){Po(12)}},Mf={};Nf(rT,(t,e)=>{Mf[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Mf.deleteProperty=function(t,e){return Mf.set.call(this,t,e,void 0)};Mf.set=function(t,e,n){return rT.set.call(this,t[0],e,n,t[0])};function jC(t,e){const n=t[Ht];return(n?Xn(n):t)[e]}function F$(t,e,n){var o;const r=JO(e,n);return r?"value"in r?r.value:(o=r.get)==null?void 0:o.call(t.draft_):void 0}function JO(t,e){if(!(e in t))return;let n=id(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=id(n)}}function hs(t){t.modified_||(t.modified_=!0,t.parent_&&hs(t.parent_))}function UC(t){t.copy_||(t.copy_=a1(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var B$=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const s=this;return function(l=i,...u){return s.produce(l,h=>n.call(this,h,...u))}}typeof n!="function"&&Po(6),r!==void 0&&typeof r!="function"&&Po(7);let o;if(ws(e)){const i=Jk(this),s=Of(e,void 0);let a=!0;try{o=n(s),a=!1}finally{a?l1(i):u1(i)}return Qk(i,r),Xk(o,i)}else if(!e||typeof e!="object"){if(o=n(e),o===void 0&&(o=e),o===WO&&(o=void 0),this.autoFreeze_&&nT(o,!0),r){const i=[],s=[];Lc("Patches").generateReplacementPatches_(e,o,i,s),r(i,s)}return o}else Po(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(s,...a)=>this.produceWithPatches(s,l=>e(l,...a));let r,o;return[this.produce(e,n,(s,a)=>{r=s,o=a}),r,o]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){ws(t)||Po(8),sd(t)&&(t=H$(t));const e=Jk(this),n=Of(t,void 0);return n[Ht].isManual_=!0,u1(e),n}finishDraft(t,e){const n=t&&t[Ht];(!n||!n.isManual_)&&Po(9);const{scope_:r}=n;return Qk(r,e),Xk(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const o=e[n];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}n>-1&&(e=e.slice(n+1));const r=Lc("Patches").applyPatches_;return sd(t)?r(t,e):this.produce(t,o=>r(o,e))}};function Of(t,e){const n=wy(t)?Lc("MapSet").proxyMap_(t,e):_y(t)?Lc("MapSet").proxySet_(t,e):U$(t,e);return(e?e.scope_:Og()).drafts_.push(n),n}function H$(t){return sd(t)||Po(10,t),XO(t)}function XO(t){if(!ws(t)||Ay(t))return t;const e=t[Ht];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=a1(t,e.scope_.immer_.useStrictShallowCopy_)}else n=a1(t,!0);return Nf(n,(r,o)=>{QO(n,r,XO(o))}),e&&(e.finalized_=!1),n}function z$(){class t extends Map{constructor(l,u){super(),this[Ht]={type_:2,parent_:u,scope_:u?u.scope_:Og(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Xn(this[Ht]).size}has(l){return Xn(this[Ht]).has(l)}set(l,u){const h=this[Ht];return s(h),(!Xn(h).has(l)||Xn(h).get(l)!==u)&&(n(h),hs(h),h.assigned_.set(l,!0),h.copy_.set(l,u),h.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const u=this[Ht];return s(u),n(u),hs(u),u.base_.has(l)?u.assigned_.set(l,!1):u.assigned_.delete(l),u.copy_.delete(l),!0}clear(){const l=this[Ht];s(l),Xn(l).size&&(n(l),hs(l),l.assigned_=new Map,Nf(l.base_,u=>{l.assigned_.set(u,!1)}),l.copy_.clear())}forEach(l,u){const h=this[Ht];Xn(h).forEach((f,p,g)=>{l.call(u,this.get(p),p,this)})}get(l){const u=this[Ht];s(u);const h=Xn(u).get(l);if(u.finalized_||!ws(h)||h!==u.base_.get(l))return h;const f=Of(h,u);return n(u),u.copy_.set(l,f),f}keys(){return Xn(this[Ht]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const u=l.next();return u.done?u:{done:!1,value:this.get(u.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const u=l.next();if(u.done)return u;const h=this.get(u.value);return{done:!1,value:[u.value,h]}}}}[Symbol.iterator](){return this.entries()}}function e(a,l){return new t(a,l)}function n(a){a.copy_||(a.assigned_=new Map,a.copy_=new Map(a.base_))}class r extends Set{constructor(l,u){super(),this[Ht]={type_:3,parent_:u,scope_:u?u.scope_:Og(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Xn(this[Ht]).size}has(l){const u=this[Ht];return s(u),u.copy_?!!(u.copy_.has(l)||u.drafts_.has(l)&&u.copy_.has(u.drafts_.get(l))):u.base_.has(l)}add(l){const u=this[Ht];return s(u),this.has(l)||(i(u),hs(u),u.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const u=this[Ht];return s(u),i(u),hs(u),u.copy_.delete(l)||(u.drafts_.has(l)?u.copy_.delete(u.drafts_.get(l)):!1)}clear(){const l=this[Ht];s(l),Xn(l).size&&(i(l),hs(l),l.copy_.clear())}values(){const l=this[Ht];return s(l),i(l),l.copy_.values()}entries(){const l=this[Ht];return s(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,u){const h=this.values();let f=h.next();for(;!f.done;)l.call(u,f.value,f.value,this),f=h.next()}}function o(a,l){return new r(a,l)}function i(a){a.copy_||(a.copy_=new Set,a.base_.forEach(l=>{if(ws(l)){const u=Of(l,a);a.drafts_.set(l,u),a.copy_.add(u)}else a.copy_.add(l)}))}function s(a){a.revoked_&&Po(3,JSON.stringify(Xn(a)))}L$("MapSet",{proxyMap_:e,proxySet_:o})}var vo=new B$,Or=vo.produce;vo.produceWithPatches.bind(vo);vo.setAutoFreeze.bind(vo);vo.setUseStrictShallowCopy.bind(vo);vo.applyPatches.bind(vo);vo.createDraft.bind(vo);vo.finishDraft.bind(vo);function ky(t){const e=P(t,(n,r,o)=>r(e,Or(n(e),typeof o=="function"?o:()=>o)));return e}function gp(t,e){const n=ve(t);return m.useCallback(r=>n(Or(r)),[n])}async function V$(t){return new Promise(e=>{let n=!1;t.catch(r=>{r instanceof Error?(n=!0,e(`Type: ${r.name}, Message: ${r.message}, Stack: ${r.stack}`)):(n=!0,e(`Type: ${typeof r}, Value: ${JSON.stringify(r)}`))}),setTimeout(()=>{n||e("Promise.catch wasn't called. The Promise is not rejected.")},1e3)})}class $${constructor(){j(this,"latestClientExperimentationAssignmentRequestId",null);j(this,"latestApiExperimentationAssignmentRequestId",null)}getTraceIdAnalytics(){return{TraceId_LastClientAssignment:this.latestClientExperimentationAssignmentRequestId,TraceId_Latest:this.latestApiExperimentationAssignmentRequestId}}trackClientExperimentationAssignment(e){const n=this.getTraceIdFromResponseHeaders(e);n&&(this.latestClientExperimentationAssignmentRequestId=n)}trackLatestApiAssignment(e){const n=this.getTraceIdFromResponseHeaders(e);n&&(this.latestApiExperimentationAssignmentRequestId=n)}trackLatestChatConnectedAssignment(e){const{requestId:n}=e;this.latestApiExperimentationAssignmentRequestId=n}getTraceIdFromResponseHeaders(e){return(e.get("x-ceto-ref")??"").split("|")[0]??null}}const Lf=new $$;function oT(){return"baeb9b5"}function G$(){return`mscmc@${oT().substring(0,7)}`}function rn(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function d1(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function iT(t,e){const n=rn(t);return isNaN(e)?d1(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function K$(t){return document.cookie.split(";").find(e=>e.trim().startsWith(`${t}=`))}function Df(t){const e=K$(t),n=e==null?void 0:e.split("=")[1];if(n)return decodeURIComponent(n)}function ex(t,e,n={}){const{expireDays:r,path:o="/",domain:i,secure:s=!0,host:a}=n;let l=t;s&&!i&&o==="/"&&a&&(l=`__Host-${t}`);let u=`${l}=${encodeURIComponent(e)}; path=${o}`;if(r){const h=iT(new Date,r);u+=`; expires=${h.toUTCString()}`}i&&(u+=`; domain=${i}`),s&&(u+="; secure"),document.cookie=u}const su={name:"CMCCP",expirationDays:365},xy={name:"BCP"},q$="3PAdsOptOut";function sT(){return Df(su.name)??Df(xy.name)}function tx(t,e){const{analytics:n,advertising:r,socialMedia:o}=t,i=new URLSearchParams;i.set("AD",r?"1":"0"),i.set("AL",n?"1":"0"),i.set("SM",o?"1":"0");const s=iT(new Date,e);return i.set("expires",s.getTime().toString()),i.toString()}function W$(t){ex(su.name,tx(t,su.expirationDays),{expireDays:su.expirationDays}),ex(xy.name,tx(t,su.expirationDays),{expireDays:su.expirationDays})}function ol(){const t=Df(xy.name);if(!t)return{advertising:!1,analytics:!1,socialMedia:!1};const e=new URLSearchParams(t),n=e.get("AD")==="1",r=e.get("AL")==="1",o=e.get("SM")==="1";return{advertising:n,analytics:r,socialMedia:o}}function ZO(){const t=Df(q$)!=="1";return navigator.globalPrivacyControl?!1:t}const uc=class uc{constructor(){j(this,"listeners",new Map)}static getInstance(){return uc.instance||(uc.instance=new uc),uc.instance}on(e,n){var r;this.listeners.has(e)||this.listeners.set(e,[]),(r=this.listeners.get(e))==null||r.push(n)}emit(e,n){const r=this.listeners.get(e);if(r)for(const o of r)o(n)}off(e,n){const r=this.listeners.get(e);r&&this.listeners.set(e,r.filter(o=>o!==n))}};j(uc,"instance",null);let h1=uc;const wt=h1.getInstance();function Y$(t){let e="unknown";try{const n=/(?:CopilotNative|BingNative|MicrosoftLauncher)\/([0-9]+(?:\.[0-9]+)*(?:-[a-zA-Z0-9]+)?)/,r=t==null?void 0:t.match(n);if(r!=null&&r[1]){const[,o]=r;e=o}return e}catch{return e}}function ba(t,e){sessionStorage.setItem(t,e)}function li(t){return sessionStorage.getItem(t)}function Q$(t){return li(t)==="true"}function eL(t){sessionStorage.removeItem(t)}function mn(t){return new URLSearchParams(window.location.search).get(t)}function Yr(t){const e=new URL(window.location.href);e.searchParams.delete(t),window.history.replaceState(null,"",e)}function J$(){const t=mn("ocid")??mn("OCID"),e=mn("msclkid"),n=mn("gclid"),r={};return t&&(r.OCID=t),e&&(r.msclkid=e),n&&(r.gclid=n),r}function tL(){Yr("ocid"),Yr("OCID"),Yr("msclkid"),Yr("gclid")}function X$(){const t=mn("form");if(t)return Yr("form"),t;const e=mn("FORM");return e&&Yr("FORM"),e}function Z$(){return mn("alias")}function eG(){const t=mn("chat-mode");return t&&Yr("chat-mode"),t}function tG(){const t=mn("q");return t&&Yr("q"),t}function nG(){const t=mn("prompt");return t&&Yr("prompt"),t}function rG(){const t=mn("sandbox");return t&&Yr("sandbox"),t==="1"}function oG(){if(typeof window>"u")return!1;const t=mn("disable-all-features");return t!==null&&t!=="0"&&t!=="false"}function c2e(){return mn("payflow-correlationId")}const iG=["ActionsLimit","VoiceLimit","Settings","ChatReasoningLimit","MarketSelect","RedirectFromAuth0Account","DeepResearchLimit","PodcastLimit","ProfileUpdateRequired","Settings-FromWinNative","VisionLimit-FromWinNative","Management"];function sG(t){return iG.some(e=>e===t)}function l2e(){const t=mn("entry-point")??"";return sG(t)?t:"Unknown"}function u2e(){const t=mn("campaign");return t?(ba("campaignId",t),t):null}function d2e(){const t=mn("referral-code");return t?(ba("referralCode",t),t):null}function aG(){return mn("charid")}function h2e(){const t=mn("pff");return t&&Yr("pff"),t}function f2e(){const t=mn("pfah");return t&&Yr("pfah"),t}function p2e(){const t=mn("pfcid");return t&&Yr("pfcid"),t}function cG(){return mn("intent")}const lG=["text","queryParam"];function uG(t){return lG.includes(t)}function dG(){const t=mn("input-method");return t?(Yr("input-method"),uG(t)?t:"queryParam"):"queryParam"}function m2e(){return[]}function Rd(t){const e=typeof navigator<"u"?navigator.userAgent:null;return e?t.test(e):!1}function nL(){return Rd(/BingSapphire/gi)}function hG(){return Rd(/NewsSapphire/gi)}function aT(){return!!(navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Macintosh/i.test(navigator.userAgent)&&"ontouchend"in document)}function rL(){return aT()||Rd(/iPad|iPhone|Android|iPod/gi)}function g2e(){return Rd(/macintosh|mac os x/gi)&&!aT()&&!oL()}function fG(){return Rd(/Android/gi)}function oL(){return aT()||Rd(/iPhone|iPad|iPod/gi)}const nx="mobileCrossSellingLastClosed",FC="mobilePromoCountClose",jg="hasBeenAuthenticated",Ug="colorTheme",Ry="newConversationsStarted",ad="timeOfNewConversationThreshold",f1="hasCorrectedPersonalizationSettings",p1="banAppealSubmitted",pG="hideDeleteConversationModal",mG="hasBeenPromptedForLocation",gG="hasSeenCharacter",rx="voiceAppearanceId",vG="disableAppearanceOnHomeScreen",yG="hasSeenAppearance",bG="hasSeenAppearanceOnVoiceCall",CG="hasDismissedAppearanceModal",m1="crossPromoFirstVisit",cT="crossPromoDiscoverStripLastClosed",Fg="crossPromoDiscoverStripCountClose",v2e="crossPromoStripGetAppIsClicked",ox="reviewActiveDays",g1="reviewPromptResponse",iL="userSidebarOpen",y2e="referralEligibilityStatus",b2e="referralHasSeenEntryNewBadge",SG="coachmark",v1="isEagerMSALEnabled",sL="isMsalSilentSsoEnabled",y1="isStartRetryEnabled",aL="user.UserFirstName",b1="loginStartTime",C1="reauthLoginFlag",C2e="subscription.m365SubscriberFRE",ix="userConversationVoiceSpeed",sx="authModuleRefactor",S1="authRfInitAuthAccount",I1="authRfMsalEventRemoval",IG="copilotBeta",EG="copilotBetaAnnouncementRequired";function cr(t,e){typeof window<"u"&&localStorage.setItem(t,e)}function yn(t){return typeof window<"u"?localStorage.getItem(t):null}function tr(t){typeof window<"u"&&localStorage.removeItem(t)}function Co(t,e){const n=yn(t);if(!n)return null;try{const r=JSON.parse(n);return e.parse(r)}catch{return null}}function Ro(t,e,n){try{e.parse(n),cr(t,JSON.stringify(n))}catch{}}function Nd(t){const{key:e,schema:n,initialValue:r}=t;return JM(e,r,{getItem:()=>Co(e,n)??r,setItem:(i,s)=>{s===void 0?tr(e):Ro(e,n,s)},removeItem:()=>tr(e)},{getOnInit:!0})}const lT=P(!1),TG=c.boolean().optional(),cd=Nd({key:IG,schema:TG,initialValue:void 0}),wG=c.boolean().optional(),BC=Nd({key:EG,schema:wG,initialValue:void 0});function Ue(t){return at().get(t)}function _G(){return Ue(lT)&&!!Ue(cd)}const AG={"thumbs-up":"thumbsUp","thumbs-down":"thumbsDown",report:"reportMessage"},ax="homepage";class kG{constructor(e={}){j(this,"analytics",null);j(this,"features");j(this,"picassoId",null);j(this,"anid",null);j(this,"formCode",null);j(this,"landingPage",ax);j(this,"trafficAlias",null);j(this,"settings",null);j(this,"isAADUser",null);j(this,"isNewUser",null);j(this,"isCopilotMode",null);j(this,"accountType",null);j(this,"referrer",null);j(this,"deviceInfo",null);j(this,"anaheimId",null);j(this,"pluginProvider",null);j(this,"pluginCache",null);j(this,"isInitializing",!1);j(this,"pendingEvents",[]);j(this,"initRetryCount",0);j(this,"maxRetries");j(this,"maxPendingEvents");j(this,"delay");j(this,"onInitializeError");this.maxRetries=e.maxRetries??3,this.maxPendingEvents=e.maxPendingEvents??1e3,this.delay=e.delay??0,this.onInitializeError=e.onInitializeError}ensureInitialized(e){!this.isInitialized&&!this.isInitializing&&(this.pluginProvider=e,this.isInitializing=!0,this.initialize())}get plugin(){return this.pluginCache===null&&this.pluginProvider!==null&&this.analytics!==null&&(this.pluginCache=this.pluginProvider(),this.pluginCache&&this.analytics.addNotificationListener(this.pluginCache)),this.pluginCache}get isInitialized(){return this.analytics!==null&&this.analytics.isInitialized()}get currentEnv(){return"prod"}get initializationFailed(){return this.initRetryCount>=this.maxRetries}setFeatures(e){this.features=e.join(",")}setAnid(e){this.anid=e}setIsNewUser(e){this.isNewUser===null&&(this.isNewUser=e)}setIsAad(e){this.isAADUser=e}setCopilotMode(e){this.isCopilotMode=e}setSettings(e){this.settings={...this.settings,...e}}getPicassoId(){return this.picassoId}setPicassoId(e){this.picassoId=e}setFormCode(e){this.formCode=e}getFormCode(){return this.formCode}setDeviceInfo(e){this.deviceInfo=e}setLandingPage(e){this.landingPage===ax&&(this.landingPage=e)}getLandingPage(){return this.landingPage}isValidLowercaseUserAccountType(e){return["msa","aad","apple","google"].includes(e)}setUserAccountType(e){if(!e){this.accountType=null;return}const n=e.toLowerCase();this.isValidLowercaseUserAccountType(n)?this.accountType=n:this.accountType=null}processFormCode(){const e=X$();this.formCode=e}processAlias(){const e=Z$();e&&(this.trafficAlias=e)}processReferrer(){this.referrer===null&&typeof document<"u"&&(this.referrer=document.referrer)}getAnaheimIdFromHTML(){try{const e=document.querySelector("meta[name='x-client-data']");if(!e)return null;const n=e.getAttribute("content");if(!n)return null;const r=atob(n),o=JSON.parse(r);if(typeof o!="object"||o===null)return null;const i=o;if(!("4"in i))return null;const s=i[4];return typeof s=="string"?s:null}catch{return null}}processAnaheimId(){const e=this.getAnaheimIdFromHTML();e&&(this.anaheimId=e)}initialize(){this.isInitialized||(this.processFormCode(),this.processAlias(),this.processReferrer(),this.processAnaheimId(),this.dynamicInitialization().catch(()=>{}))}async dynamicInitialization(){var n,r;this.delay>0&&await new Promise(o=>{setTimeout(o,this.delay)});const e=await H(()=>import("./Index-AuNyv2yH.js"),__vite__mapDeps([0,1,2])).catch(o=>o instanceof Error?o:new Error(`Failed to load @microsoft/1ds-analytics-js: ${o}`));if(e instanceof Error)(n=this.onInitializeError)==null||n.call(this,e),this.initRetryCount+=1,this.initRetryCount>=this.maxRetries&&((r=this.onInitializeError)==null||r.call(this,new Error("ApplicationInsights initialization: Max retries reached")),this.pendingEvents.length=0);else{const{ApplicationInsights:o}=e;this.analytics=new o;const i={instrumentationKey:"be6e4c19699f4fdf9f8c0ec9f9b398ef-25d58bb9-9926-4df7-8e36-bc7afb4b2c34-7563",channelConfiguration:{eventsLimitInMem:5e3},propertyConfiguration:{populateBrowserInfo:!0},disableCookiesUsage:!0};this.analytics.initialize(i,[]),this.flushPendingEvents()}this.isInitializing=!1}flushPendingEvents(){for(let e=0,n=this.pendingEvents.length;e<n;e+=1){const r=this.pendingEvents[e];r&&this.trackEventInternal(r)}this.pendingEvents.length=0}getPlatformSurface(e){if(e==="pageseditor"){if(fG())return"android";if(oL())return"ios"}return e}getAppFlavor(){return _G()?{eventInfo_appFlavor:"beta"}:null}getFixEventProperties(){const e=this.getPlatformSurface("cmc");return{appName:`CopilotN-${this.currentEnv}-web-${e}`,appVersion:oT(),surface:e,surfaceVersion:Y$(navigator.userAgent),accountType:this.accountType,userMuid:Df("MUID"),userAnid:this.anid,userPicassoId:this.picassoId,userFlightIds:this.features,trafficAlias:this.trafficAlias,eventInfo_entryPoint:this.formCode,eventInfo_surfaceVisible:document.visibilityState==="visible",eventInfo_isCopilotMode:this.isCopilotMode,isAADUser:this.isAADUser,isNewUser:this.isNewUser,pathname:window.location.pathname,referrer:this.referrer,anaheimId:this.anaheimId,"UserInfo.Id":this.picassoId,...Lf.getTraceIdAnalytics(),...this.settings,...this.deviceInfo,...this.getAppFlavor()}}trackEvent(e){if(!this.initializationFailed){if(this.pendingEvents.length>=this.maxPendingEvents){console.warn(`Analytics pending events queue is full (${this.maxPendingEvents}). Dropping event: ${JSON.stringify(e)}`);return}if(this.ensureInitialized(this.pluginProvider),this.isInitializing||!this.isInitialized){this.pendingEvents.push(e);return}this.trackEventInternal(e)}}trackEventInternal(e){var a,l;const n=this.getFixEventProperties(),r=ol(),o=ZO(),i=((a=this.plugin)==null?void 0:a.generateClientEventId(e))??void 0;if(!this.analytics){console.error("Failed to initialize AnalyticsService.");return}const s={name:e.name,data:{...n,eventInfo_clientEventId:i,...e.data},ext:{web:{consentDetails:JSON.stringify({Required:!0,Analytics:r.analytics,SocialMedia:r.socialMedia,Advertising:r.advertising,GPC_DataSharingOptIn:o})}}};(e.data.eventName==="copilotCompose"||e.data.eventName==="copilotAudioInput")&&wt.emit("composer:send-query",{isNewUser:this.isNewUser,event:e.data}),(l=this.plugin)==null||l.onBeforeTrackEvent(s),this.analytics.track(s)}}const U=new kG({maxRetries:3,maxPendingEvents:1e3,delay:200,onInitializeError:t=>{console.error("AnalyticsService initialization error:",t)}});function cL(t,e){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ErrorBoundary",eventInfo_errorName:t.name,eventInfo_errorMessage:t.message,eventInfo_errorStack:t.stack??"",eventInfo_componentStack:e.componentStack??""}}),H(async()=>{const{captureReactException:n}=await import("./vendor-BK0nFAyt.js").then(r=>r.ad);return{captureReactException:n}},__vite__mapDeps([1,2])).then(({captureReactException:n})=>n(t,e))}function jf(t,e,n=!1){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"APIResponseParseError",eventInfo_apiUrl:e,eventInfo_errors:JSON.stringify(t.format()),eventInfo_safe:n}})}async function cx(t){const e=await V$(t.promise);U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"UnhandledRejection",eventInfo_reason:`${t.reason}`,eventInfo_customData:e}})}function xG(t,e,n){try{new URL(da(t)).hostname}catch(r){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"invalidCitationURL",eventInfo_url:t,eventInfo_errorMessage:r instanceof Error?r.message:"",eventInfo_conversationId:e,eventInfo_messageId:n}})}}function lL(t){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"PlaybackApiError",eventInfo_errorMessage:t instanceof Error?t.message:"",eventInfo_details:"An error occurred during media playback tracking api call."}})}function RG(t,e,n=void 0){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"InvalidJsonResponse",eventInfo_apiUrl:n,eventInfo_errorMessage:t.message,eventInfo_errorCode:e.statusText,eventInfo_details:JSON.stringify(Object.fromEntries(e.headers.entries()))}})}const NG=25,PG=25,MG=6e3,OG=12,LG=["mica","aqua","erin"];function uL(t){switch(t){case"mica":case"aqua":case"erin":return t;default:return null}}function DG(t,e){switch(t){case"mica":return e("characterAnimation.characterNameMica");case"aqua":return e("characterAnimation.characterNameAqua");case"erin":return e("characterAnimation.characterNameErin");default:return""}}function jG(t,e){return(n,r)=>{U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CharacterError",eventInfo_details:`animatingMessageId: ${t}, characterId: ${e}, name: ${n.name}, info: ${r.componentStack}`,eventInfo_errorMessage:n.message}}),cL(n,r)}}const So=c.object({partId:c.string()}),Ny=c.object({event:c.literal("invokeAction"),actionId:c.string()}),UG=c.enum(WH),FG=c.object({type:c.literal("code"),language:UG,content:c.string()}),BG=c.object({type:c.literal("file"),url:c.string().refine(t=>t.startsWith("/")||c.string().url().safeParse(t).success,{message:"Must be a valid URL or relative path"}),name:c.string(),contentType:c.string()}),HG=c.discriminatedUnion("type",[FG,BG]),dL=c.union([c.literal("running"),c.literal("completed"),c.literal("failed")]),zG=c.object({title:c.string(),status:dL}),hL=c.object({status:dL,title:c.string(),steps:c.array(zG),artifacts:c.array(HG)}),fL=So.extend({type:c.literal("activity"),activity:hL}),Jr=c.object({amount:c.number(),currency:c.string().nullable(),currencySymbol:c.string().nullable()}),VG=c.enum(["current-search-term","recent-searches","age","gender","website-visits","interests","custom-audience","similar-audience","profile-targeting"]);c.enum(["multimedia","product","tourActivity","propertyPromotion","text","miniShowroom","mainShowroom","showroom","organic"]);const $G=c.enum(["top","bottom","left","right"]),GG=c.object({adDomain:c.string(),advertiser:c.object({name:c.string(),country:c.string()}),isVerified:c.boolean(),selectionReasons:c.array(VG)}),il=c.object({url:c.string(),urlPingSuffix:c.string()}),Ms=c.object({url:c.string(),width:c.number().nullish(),height:c.number().nullish(),link:il.nullish(),impressionToken:c.string().nullish()}),KG=c.object({downPayment:c.string(),description:c.string()}),qG=c.object({rating:c.number(),link:il,impressionToken:c.string()}),vp=c.object({businessName:c.string(),image:Ms,impressionToken:c.string().nullish()}),pL=c.object({text:c.string(),url:c.string(),urlPingSuffix:c.string()}),WG=c.object({title:c.string(),text:c.string(),url:c.string(),layout:c.enum(["inline","overlay"])}),sl=c.object({impressionToken:c.string(),selectionCriteria:GG}),Py=c.object({rowIndex:c.number().int(),columnIndex:c.number().int(),textPosition:$G,imagesPerRow:c.number().int()}),mL=sl.extend({type:c.literal("multimedia"),description:c.string(),title:c.string(),displayUrl:c.string(),link:il,image:Ms.nullish(),logo:vp.nullish(),action:pL.nullish(),layout:Py.nullish()});sl.extend({type:c.literal("organic"),description:c.string(),title:c.string(),link:c.string(),image:Ms,layout:Py});const My=c.object({category:c.string(),value:c.string()}),uT=sl.extend({type:c.literal("product"),offer:c.object({seller:c.string(),link:il,price:Jr,lowPrice:Jr.nullish(),item:c.object({name:c.string(),image:Ms})}),tags:c.array(My).nullish(),shipping:c.object({isFree:c.boolean(),description:c.string()}).nullish(),productRating:qG.nullish(),installment:KG.nullish(),pricePerUnit:c.string().nullish(),energyRating:c.string().nullish(),layout:Py.nullish()}),gL=sl.extend({type:c.literal("tourActivity"),title:c.string(),domain:c.string(),startingPrice:Jr,image:Ms,link:il,tags:c.array(My).nullish()}),vL=sl.extend({type:c.literal("propertyPromotion"),title:c.string(),domain:c.string(),price:Jr,image:Ms,link:il,tags:c.array(My).nullish()}),YG=sl.extend({type:c.literal("text"),title:c.string(),description:c.string(),displayUrl:c.string(),link:il,image:Ms.nullish(),logo:vp.nullish(),disclaimer:WG.nullish()}),QG=sl.extend({type:c.literal("miniShowroom"),title:c.string(),description:c.string(),displayUrl:c.string(),image:Ms,logo:vp.nullish(),brandId:c.string().nullish(),brandBackground:c.number().int().nullish()}),JG=c.object({ad:c.union([uT,mL]),adId:c.string().nullish()}),XG=c.object({isLoading:c.boolean().nullish(),isEmpty:c.boolean().nullish()}),yL=XG.extend({type:c.literal("mainShowroom"),id:c.string(),brandId:c.string(),title:c.string().nullish(),description:c.string().nullish(),backgroundColor:c.number().int().nullish(),images:c.array(Ms).nullish(),logo:vp.nullish(),slotAds:c.array(JG).nullish(),action:pL.nullish(),layout:Py.nullish()}),ZG=c.union([mL,uT,gL,vL,YG,QG,yL]);c.union([uT,gL,vL]);const bL=c.object({pageLoadPingUrl:c.string(),visibilityPingUrlBase:c.string(),clickPingUrlBase:c.string()}),HC=c.object({tagsSupported:c.boolean()});c.object({supportedTypes:c.array(c.enum(["multimedia","product","tourActivity","propertyPromotion","text","showroom","miniShowroom","mainShowroom"])),product:HC.nullish(),propertyPromotion:HC.nullish(),tourActivity:HC.nullish(),optOutOfPersonalization:c.boolean().nullish()});const CL=c.enum(["open","expand","chat"]);c.object({showroom:c.object({scenario:CL,brandId:c.string(),brandName:c.string().nullish(),adId:c.string().nullish()})});const eK=c.object({brandBackground:c.number().int().nullish(),brandLogo:vp.nullish(),conversationId:c.string(),theme:c.enum(["light","dark"]).nullish(),viewMode:c.enum(["cardView","extendedView"]),rguid:c.string().nullish(),rlink:c.string().nullish(),messageId:c.string(),triggerAt:c.number(),mainShowroomAdId:c.string().nullish()});eK.extend({brandId:c.string(),adId:c.string().nullish(),scenario:CL.nullish()});c.object({brandId:c.string(),brandName:c.string().nullish(),messageId:c.string(),conversationId:c.string(),visible:c.boolean()});const tK=c.object({requestId:c.string(),ads:c.array(yL),instrumentation:bL}),nK=c.object({selectedTag:My.nullish(),collapsed:c.boolean().nullish(),showroomData:c.array(c.object({requestUrl:c.string(),response:tK})).nullish()}),rK=nK.extend({type:c.literal("ads"),requestId:c.string(),summary:c.string(),ads:c.array(ZG).nullish(),instrumentation:bL}),oK=c.object({type:c.literal("computerUseFeedback")}),al=c.union([c.literal("startTask"),c.literal("pauseTask"),c.literal("resumeTask"),c.literal("cancelTask"),c.literal("takeTaskControl"),c.literal("releaseTaskControl")]),iK=c.union([c.literal("bringAgentTabsToForeground"),c.literal("failedTask"),c.literal("completedTask"),c.literal("moveAgentTabsToBackground"),c.literal("showConsentDialog")]);c.union([al,iK]);const sK=c.union([c.literal("allSessionInfo"),c.literal("activeSessionInfo"),c.literal("failedTask"),c.literal("completedTask")]);c.union([al,sK]);const aK=c.union([c.literal("allSessionInfo"),c.literal("activeSessionInfo"),c.literal("failedTask"),c.literal("completedTask")]);c.union([al,aK]);const SL=c.union([c.literal("askUserInput"),c.literal("safetyRiskDetected"),c.literal("userTakeControl"),c.literal("giveBackControl"),c.literal("resumeFromInput"),c.literal("resumeFromRisk"),c.literal("pauseByClick"),c.literal("resumeByClick"),c.literal("taskCompleted")]),cK=c.object({reason:SL,title:c.string().optional(),text:c.string().optional()}),Pd=c.object({taskId:c.string()}),lK=Pd.extend({type:c.literal("startTask")}),uK=Pd.extend({type:c.literal("pauseTask")}),dK=Pd.extend({type:c.literal("resumeTask")}),hK=Pd.extend({type:c.literal("cancelTask")}),fK=Pd.extend({type:c.literal("takeTaskControl")}),pK=Pd.extend({type:c.literal("releaseTaskControl")}),IL=c.object({title:c.string(),instruction:c.object({text:c.string(),websites:c.array(c.object({url:c.string().url(),iconUrl:c.string().url().optional()}))})}),S2e=IL.extend({id:c.string()});IL.extend({isActive:c.boolean()});const mK=c.enum(["choose","replay"]),gK=c.enum(["2","1","0.5"]),vK=c.object({isRunning:c.boolean().nullish(),speed:gK.nullish()}),yK=c.object({name:c.string(),url:c.string().nullish(),description:c.string().nullish(),phoneNumber:c.string().nullish(),smsNumber:c.string().nullish(),chatUrl:c.string().nullish(),whatsAppUrl:c.string().nullish()}),bK=c.object({type:c.literal("safetyHelpline"),countryEmergencyNumber:c.string().nullable(),helplines:c.array(yK)}),CK=c.object({type:c.literal("document"),attachmentId:c.string(),fileName:c.string(),contentType:c.string()}),SK=c.object({type:c.literal("file"),url:c.string().url(),name:c.string(),contentType:c.string()}),IK=c.object({name:c.string(),disclaimerUrl:c.string(),url:c.string()}),EL=c.object({price:c.number().nullish(),changeInPercentage:c.number().nullish(),changeInAmount:c.number().nullish()}),TL=c.object({id:c.string(),symbol:c.string(),displayName:c.string(),price:c.number(),previousClosePrice:c.number(),changeInPercentage:c.number(),changeInAmount:c.number(),updatedAt:c.string(),iconUrl:c.string(),provider:IK,isFollowed:c.boolean().nullish()}),EK=c.object({priceOpen:c.number().nullish(),priceHigh:c.number().nullish(),priceLow:c.number().nullish(),price52wHigh:c.number().nullish(),price52wLow:c.number().nullish()}),yp=TL.extend({intradayPricing:EK,isMarketLastSale:c.boolean(),exchangeTimeZoneId:c.string().nullish(),isMarketRegularHours:c.boolean().optional(),lastUpdatedAt:c.string(),tradingDayEndAt:c.string(),accumulatedVolume:c.number().nullish()}),TK=yp.extend({securityType:c.literal("stock"),marketCap:c.number().nullish(),marketCapCurrency:c.string().nullish(),averageVolume:c.number().nullish(),peRatio:c.number().nullish(),postMarket:EL.nullish()}),wK=yp.extend({securityType:c.literal("etf"),netAssets:c.number().nullish(),expenseRatio:c.number().nullish(),yieldPercent:c.number().nullish(),postMarket:EL.nullish()}),_K=yp.extend({securityType:c.literal("index")}),AK=TL.extend({securityType:c.literal("fund"),price52wHigh:c.number().nullish(),price52wLow:c.number().nullish(),netAssets:c.number().nullish(),expenseRatio:c.number().nullish(),yieldPercent:c.number().nullish(),oneYearReturn:c.number().nullish()}),wL=c.object({amount:c.number().nullish(),currency:c.string().nullish(),currencySymbol:c.string().nullish()}),lx=c.object({value:wL,fullName:c.string().nullish()}),kK=c.object({oneMonth:c.number().nullish(),sixMonths:c.number().nullish(),oneYear:c.number().nullish()}),xK=yp.extend({securityType:c.literal("currencyExchange"),fromCurrency:lx,toCurrency:lx,percentageReturns:kK}),RK=yp.extend({securityType:c.literal("cryptocurrency"),marketDominancePercentage:c.number().nullish(),circulatingSupply:c.number().nullish(),maxSupply:c.number().nullish(),oneYearReturn:c.number().nullish(),marketCap:wL,marketCapCurrency:c.string().nullish()}),NK=c.enum($H),PK=c.object({price:c.number(),volume:c.number(),at:c.string()}),ux=c.array(PK),MK=c.object({afterHoursSeries:ux,series:ux,chartType:NK}),OK=c.discriminatedUnion("securityType",[TK,wK,_K,AK,xK,RK]),LK=c.object({currency:c.string(),instrument:OK,chart:MK.optional()}),DK=LK.extend({type:c.literal("financeChart")}),jK=c.discriminatedUnion("type",[DK]),UK=c.object({id:c.string()}),FK=c.array(UK),I2e=c.object({entities:FK}),BK=c.object({type:c.literal("generativeUI"),markup:c.string(),data:c.record(c.string(),c.any())}),_L=c.object({image:c.object({url:c.string(),thumbnailUrl:c.string(),altText:c.string(),width:c.number(),height:c.number()}),source:c.object({title:c.string(),url:c.string(),iconUrl:c.string().nullable()})}),HK=c.object({type:c.literal("image"),images:c.array(_L)}),zK=c.object({type:c.literal("inlineImage"),title:c.string(),description:c.string()}).merge(_L),VK=c.object({type:c.literal("inlineVideo"),title:c.string(),description:c.string(),video:c.object({url:c.string(),thumbnailUrl:c.string(),title:c.string(),isShort:c.boolean()}),source:c.object({url:c.string(),iconUrl:c.string().optional()})}),$K=c.object({name:c.string(),logoUrl:c.string().nullable(),postUrl:c.string()}),GK=c.object({title:c.string(),companyName:c.string(),companyLogoUrl:c.string().nullable(),postedAt:c.string(),location:c.string(),providers:c.array($K),description:c.string(),salary:c.string().nullable(),type:c.string().nullable(),locationType:c.string().nullable(),tags:c.array(c.string()).nullable()}),KK=c.object({type:c.literal("job"),jobs:c.array(GK)}),qK=c.object({type:c.literal("localEntity"),entities:c.array(c.object({name:c.string(),phoneNumber:c.string().nullish(),url:c.string().nullish(),reviews:c.array(c.object({count:c.number(),rating:c.number(),providerName:c.string(),providerIconUrl:c.string().nullish(),url:c.string()})),location:c.object({address:c.string().nullish(),latitude:c.number(),longitude:c.number()}),photos:c.array(c.object({url:c.string(),altText:c.string().nullish(),providerName:c.string().nullish(),providerUrl:c.string()})),category:c.string().nullish(),price:c.string().nullish()}))}),WK=c.object({providerName:c.string(),url:c.string().nullish(),thumbnailUrl:c.string(),providerOptions:c.array(c.string()).nullish(),source:c.object({url:c.string(),name:c.string()}).nullish()}),YK=c.object({sourceName:c.string(),maxRating:c.number(),rating:c.number(),url:c.string()}),QK=c.object({url:c.string(),source:c.object({url:c.string(),name:c.string()}).nullish()}),E1=c.object({url:c.string().nullish(),name:c.string().nullish()}),JK={thumbnail:c.object({url:c.string(),source:E1.nullish()}),source:E1.nullish()},XK=c.object({type:c.literal("mediaSpotlight"),title:c.string(),label:c.string().nullish(),description:c.string(),thumbnail:QK,facts:c.record(c.string(),c.string()).nullish(),criticRatings:c.array(YK).nullish(),watchLinks:c.array(WK).nullish(),featuredVideo:c.object(JK).nullish(),sources:c.array(E1).nullish()}),ZK=c.object({id:c.string(),type:c.literal("oneDrive"),name:c.string(),lastModifiedAt:c.string(),url:c.string(),webDavUrl:c.string().optional(),contentType:c.string(),size:c.number()}),eq=c.object({type:c.literal("m365"),items:c.array(ZK)}),tq=c.object({type:c.literal("person"),fullName:c.string(),thumbnailUrl:c.string()}),nq=c.object({name:c.string(),url:c.string(),width:c.number().optional(),height:c.number().optional(),thumbnailUrl:c.string().optional()}),rq=c.object({images:c.array(nq)}),oq=rq.extend({type:c.literal("phoneImages")}),iq=c.object({qrCodeUrl:c.string(),linkDeviceUrl:c.string()}),sq=iq.extend({type:c.literal("phoneLinking")}),aq=c.union([c.literal("executing"),c.literal("completed"),c.literal("failed")]),dT=c.object({deviceName:c.string().optional(),state:aq.optional(),disabled:c.boolean().optional(),completedAt:c.string().optional()}),cq=c.enum(["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]),lq=dT.extend({triggerAt:c.string(),repeatDays:c.array(cq).optional().nullable()}),uq=lq.extend({type:c.literal("phoneAlarm")}),dq=dT.extend({seconds:c.number()}),hq=dq.extend({type:c.literal("phoneTimer")}),fq=dT.extend({actionId:c.string(),text:c.string(),phoneNumber:c.string().nullable().optional(),contactName:c.string().nullable().optional(),deviceName:c.string().optional()}),pq=fq.extend({type:c.literal("phoneSendMessage")}),mq=Ny.extend({actionName:c.literal("phone_send_message"),parameters:c.object({text:c.string(),phoneNumber:c.string().nullable().optional(),contactName:c.string().nullable().optional()})}),gq=c.discriminatedUnion("type",[sq,oq,uq,hq,pq]),vq=c.object({type:c.literal("quiz"),title:c.string(),quiz:c.array(c.object({type:c.literal("singleSelect"),question:c.string(),options:c.array(c.string()),answer:c.number(),topics:c.array(c.string()).nullable(),explanation:c.string()}))}),yq=c.object({value:c.number(),count:c.number().nullish(),maxRating:c.number().nullish()}),bq=c.object({hours:c.number(),minutes:c.number()}),AL=c.object({name:c.string(),quantity:c.number().nullish(),unit:c.string().nullish()}),Cq=c.object({title:c.string(),url:c.string().url(),source:c.string(),imageUrl:c.string().url().nullish(),rating:yq.nullish(),serving:c.number().nullish(),calories:c.number().nullish(),cookingTime:bq.nullish(),instructions:c.array(c.string()).nullish(),ingredients:c.array(AL).nullish()}),Sq=c.object({type:c.literal("recipe"),recipes:c.array(Cq)});c.object({title:c.string(),url:c.string().url(),ingredients:c.array(AL),instructions:c.array(c.string()).nullish(),imageUrl:c.string().url().nullish(),messageId:c.string().nullish()});const hT=c.object({position:c.number(),url:c.string(),title:c.string(),iconUrl:c.string().nullish(),publisher:c.string().nullish()}),kL=c.object({url:c.string(),name:c.string(),imageUrl:c.string(),images:c.array(c.string()).nullish(),price:Jr,seller:c.string().nullish()}),xL=c.object({value:c.number(),count:c.number()}).nullish(),Iq=kL.extend({type:c.literal("shopping"),id:c.string(),rating:xL}),Eq=kL.extend({isNotificationEnabled:c.boolean().nullish(),offerId:c.string(),currentPrice:Jr.nullish(),percentageDrop:c.number(),durationInWeeks:c.number()}),RL=c.object({title:c.string().nullish(),url:c.string()}),Tq=c.enum(["textual","visual"]),wq=c.object({displayName:c.string(),value:c.string(),isActive:c.boolean(),isSelected:c.boolean(),thumbnailImage:RL.nullish()}),_q=c.object({id:c.string(),displayName:c.string(),filterValues:c.array(wq),filterType:Tq}),Aq=c.object({id:c.string().nullish(),groupId:c.string().nullish(),brandGroupId:c.string().nullish()}),kq=c.object({displayName:c.string(),values:c.array(c.string())}),NL=c.object({offerUrl:c.string(),domain:c.string()}),xq=c.object({summary:c.string(),attributions:c.array(NL)}),Rq=c.object({pros:c.array(c.string()).nullish(),cons:c.array(c.string()).nullish(),attributions:c.array(NL)}),Nq=c.discriminatedUnion("type",[c.object({type:c.literal("buyWithMerchant"),checkoutUrl:c.string().nullish(),merchant:c.string().nullish()}),c.object({type:c.literal("buyWithCopilot"),merchantProvider:c.string().nullish(),storeId:c.string().nullish()})]),fT=c.object({product:Aq,offerId:c.string(),url:c.string(),name:c.string(),description:c.string().nullish(),images:c.array(RL).nullish(),filters:c.array(_q).nullish(),specifications:c.array(kq).nullish(),review:xq.nullish(),prosAndCons:Rq.nullish(),price:Jr,discountPrice:Jr.nullish(),seller:c.string(),sellerLogoUrl:c.string().nullish(),brandName:c.string().nullish(),rating:xL.nullish(),checkoutOption:Nq.nullish(),curation:c.string().nullish(),canTrackPrice:c.boolean()}),Pq=c.object({type:c.literal("shoppingProducts"),products:c.array(fT)}),PL=c.union([c.literal("lowest-price"),c.literal("free-shipping")]),Mq=c.object({offerName:c.string(),offerId:c.string(),url:c.string(),price:Jr,discountPrice:Jr.nullish(),seller:c.string(),sellerLogoUrl:c.string().nullish(),tags:c.array(PL).nullish(),canTrackPrice:c.boolean()}),E2e=c.object({error:c.string(),message:c.string()}),Oq=c.object({minPrice:Jr,maxPrice:Jr,averagePrice:Jr,timePeriodInDays:c.number()}),ML=c.object({date:c.coerce.date(),price:Jr}),Lq=c.object({daily:ML.array()}),Dq=c.object({label:c.string(),prompt:c.string()}),jq=c.object({scenario:c.literal("priceHistory"),priceHistory:c.object({dailyPrices:ML.array(),type:c.union([c.literal("increase"),c.literal("decrease")]),percentage:c.number()})}),Uq=c.discriminatedUnion("scenario",[jq]),Fq=fT.extend({otherBuyingOptions:c.array(Mq).nullish(),priceInsight:Oq.nullish(),tags:c.array(PL).nullish(),priceHistory:Lq.nullish(),conversationStarters:c.array(Dq).nullish(),insights:Uq.nullish()}),Bq=Fq.partial();c.object({errorCode:c.string().nullish(),metadata:Bq.nullish()});const T2e=c.object({products:Eq.array()}),Hq=c.object({category:c.string(),curationGroupId:c.string(),position:c.union([c.literal("top"),c.literal("middle"),c.literal("bottom")]).nullish()}),Zm=fT.extend({curationInfo:Hq.nullish()});c.object({product:Zm,messageId:c.string(),allProducts:c.array(Zm).nullish(),accessories:c.array(Zm).nullish()});const zq=c.object({type:c.literal("shoppingCurated"),title:c.string().optional(),products:c.array(Zm),groupType:c.string().nullish()}),Vq=c.discriminatedUnion("type",[Iq,Pq,zq]),w2e=c.object({emailNotificationEnabled:c.boolean()}),$q=c.object({name:c.string(),url:c.string(),offerId:c.string()}),Gq=c.object({url:c.string(),source:c.string()}),Kq=c.object({reason:c.string(),references:c.array(Gq)}),qq=c.enum(["buy-now","buy-later"]),_2e=c.object({whenToBuy:qq,seller:$q,supportingReasons:c.array(Kq)}),Wq=c.union([c.literal("top-highlight"),c.literal("buying-tip"),c.literal("ideal-for"),c.literal("review-snapshot")]),A2e=c.object({title:c.string(),content:c.string(),type:Wq,citations:c.array(hT)});c.object({isPDP:c.boolean(),name:c.string().nullish(),image:c.string().url().nullish(),base64_image:c.string().nullish(),price_currency:c.string().nullish(),price_value:c.coerce.number().nullish(),"aggregateRating/ratingValue":c.union([c.string(),c.nan()]).nullish(),"aggregateRating/reviewCount":c.union([c.string(),c.nan()]).nullish()});c.object({name:c.string().optional(),rating:c.object({value:c.number(),count:c.number()}).optional(),images:c.array(c.object({url:c.string()})).optional(),price:c.object({amount:c.number(),currency:c.string().nullable(),currencySymbol:c.string().nullable()}).optional()});const Yq=c.enum(["%","$"]),OL=c.object({category:c.string(),commissionType:Yq,commissionValue:c.number(),priority:c.number()}),Qq=OL.extend({maxRebateValue:c.number().nullish(),minPurchaseValue:c.number().nullish()});c.object({highestCashbackCategory:Qq,merchantName:c.string(),merchantId:c.string(),merchantFullName:c.string(),merchantUri:c.string(),merchantImageUrl:c.string(),affiliateNetwork:c.string(),categories:c.array(OL),exclusions:c.string(),isSignedinWithMSA:c.boolean(),isCashbackActivated:c.boolean(),isDealDaysOffer:c.boolean().nullish()});const Jq=c.enum(["home","away"]),ui=c.enum(["win","loss","tie","no-game"]),LL=c.enum(["pre-game","in-progress","final","postponed","delayed","abandoned","cancelled"]),Xq=c.enum(["test","odi","t20"]),Zq=c.enum(["test","limited-overs","super-over"]),eW=c.enum([...LL.options,"drinks","dinner","tea","lunch","innings-break","super-over","toss","stumps","strategic-timeout","forfeited"]),tW=c.enum([...LL.options,"bye","retired","forfeited","unscheduled","suspended"]),nW=c.enum(["men-singles","men-doubles","women-singles","women-doubles","mixed-doubles"]),rW=c.enum(["round-of256","round-of128","round-of64","round-of32","round-of16","quarter-final","semi-final","final"]),DL=c.object({name:c.string(),city:c.string().nullish()}),oW=c.object({name:c.string(),thumbnailUrl:c.string().nullish(),seasonPhase:c.string().nullish(),seasonStartsAt:c.string().nullish(),seasonEndsAt:c.string().nullish(),leagueId:c.string()}),iW=c.object({type:c.literal("league"),league:oW}),Bg=c.object({name:c.string(),thumbnailUrl:c.string().nullish()}),sW=c.object({type:c.literal("team"),team:Bg}),aW=c.object({type:c.literal("matchup"),matchup:c.object({teamA:Bg,teamB:Bg})}),bp=c.discriminatedUnion("type",[iW,sW,aW]),cW=c.object({name:c.string(),alias:c.string().nullish(),thumbnailUrl:c.string().nullish()}),Hr=cW.extend({primaryColorHex:c.string().nullish(),venueType:Jq.nullish(),previousGameOutcomes:c.array(ui).nullish(),seed:c.number().nullish(),gameOutcome:ui.nullish(),score:c.string().nullish()}),pT=Hr.extend({winProbability:c.number().nullish()}),mT=c.object({wins:c.number(),losses:c.number(),overtimeLosses:c.number().nullish()}),lW=c.object({playerName:c.string(),clock:c.object({minutes:c.number(),seconds:c.number()})}),uW=c.object({ballPossessionPercentage:c.number().nullish(),goals:c.array(lW).nullish()}),jL=Hr.extend({gameStats:uW,score:c.string()}),dW=jL.extend({gameOutcome:ui}),hW=c.object({wins:c.number(),participantName:c.string()}),fW=c.enum(["final","not-started","in-progress"]),pW=c.enum(["national-championship","first-four","first-round","second-round","conference-semifinal","conference-final","sweet16","elite-eight","final-four","final"]),mW=c.object({state:fW,winsInfo:c.array(hW).nullish(),gameNumber:c.number().nullish(),conference:c.string().nullish()}),UL=mW.extend({phase:pW}),gT=c.object({name:c.string(),score:c.string()}),gW=c.object({current:c.number(),total:c.number(),aggregatedScores:c.array(gT).nullish()}),vT=c.object({startsAt:c.string(),status:c.string(),leagueName:c.string(),legInfo:gW.nullish(),leagueId:c.string().nullish(),gameId:c.string().nullish(),startTimeToBeAnnounced:c.boolean().nullish()}),Md=c.object({minutes:c.number(),seconds:c.number()}),vW=c.enum(["quarter","half","extra","penalties","shoot-out","overtime","inning","period"]),yW=c.enum(["top","bottom"]),La=c.object({type:vW,period:c.number(),division:yW.nullish()}),Oy=c.object({playingPeriod:La,score:c.string()}),bW=pT.extend({record:mT.nullish(),gameOutcome:ui.nullish(),score:c.string().nullish(),playingPeriodScores:c.array(Oy).nullish(),gameStats:c.null().nullish()}),cl=vT.extend({week:c.number().nullish()}),ll=vT.extend({name:c.string().nullish(),seasonPhase:c.string().nullish(),bracket:UL.nullish(),week:c.number().nullish(),clock:Md.nullish(),currentPlayingPeriod:La.nullish()}),CW=cl.extend({status:c.literal("pre-game"),participants:c.array(pT)}),yT=c.object({clock:Md,description:c.string(),team:Bg,participantScores:c.array(gT).nullish()}),SW=yT.extend({type:c.enum(["score-change","yellow-card","red-card"])}),bT=yT.extend({type:c.enum(["three-point-made","two-point-made","touchdown","field-goal","extra-point","safety","two-point-conversion","blocked-punt-safety","blocked-field-goal-safety","fumble-safety"])}),Od=c.object({url:c.string(),thumbnailUrl:c.string(),title:c.string(),durationInSeconds:c.number().nullish()}),IW=ll.extend({status:c.literal("pre-game"),participants:c.array(bW),timeline:c.object({events:c.array(bT)}).nullish(),videos:c.array(Od).nullish()}),EW=cl.extend({status:c.literal("in-progress"),participants:c.array(jL),clock:Md,currentPlayingPeriod:La,timeline:c.object({events:c.array(SW)}).nullish()}),TW=cl.extend({status:c.literal("final"),participants:c.array(dW),videos:c.array(Od).nullish()}),wW=cl.extend({status:c.literal("postponed"),participants:c.array(Hr)}),_W=cl.extend({status:c.literal("delayed"),participants:c.array(Hr)}),AW=cl.extend({status:c.literal("abandoned"),participants:c.array(Hr)}),kW=cl.extend({status:c.literal("cancelled"),participants:c.array(Hr)}),T1=c.discriminatedUnion("status",[CW,EW,TW,AW,kW,_W,wW]),FL=Hr.extend({playingPeriodScores:c.array(Oy).nullish(),score:c.string(),record:mT.nullish(),gameOutcome:ui.nullish(),winProbability:c.number().nullish(),gameStats:c.null().nullish()}),xW=FL.extend({gameOutcome:ui}),RW=ll.extend({status:c.literal("in-progress"),participants:c.array(FL),clock:Md,currentPlayingPeriod:La,timeline:c.object({events:c.array(bT)}).nullish(),videos:c.array(Od).nullish()}),NW=ll.extend({status:c.literal("final"),participants:c.array(xW),videos:c.array(Od).nullish(),clock:Md.nullish(),currentPlayingPeriod:La.nullish(),timeline:c.object({events:c.array(bT)}).nullish()}),PW=ll.extend({status:c.literal("postponed"),participants:c.array(Hr)}),MW=ll.extend({status:c.literal("delayed"),participants:c.array(Hr)}),OW=ll.extend({status:c.literal("abandoned"),participants:c.array(Hr)}),LW=ll.extend({status:c.literal("cancelled"),participants:c.array(Hr)}),w1=c.discriminatedUnion("status",[IW,RW,NW,OW,LW,MW,PW]),DW=c.object({type:c.literal("sportsSchedule"),sport:c.enum(["basketball","ice-hockey","football"]),games:c.array(w1),header:bp.nullish(),heroGame:w1.nullish()}),jW=c.object({type:c.literal("sportsSchedule"),sport:c.literal("soccer"),games:c.array(T1),header:bp.nullish(),heroGame:T1.nullish()}),UW=c.object({type:c.literal("sportsGame"),sport:c.enum(["basketball","ice-hockey","football"]),game:w1}),FW=c.object({type:c.literal("sportsGame"),sport:c.literal("soccer"),game:T1}),ul=vT.extend({name:c.string().nullish(),seasonPhase:c.string(),week:c.number().nullish(),videos:c.array(Od).nullish(),bracket:UL.nullish(),clock:Md.nullish(),currentPlayingPeriod:La.nullish()}),BL=c.object({hits:c.number(),errors:c.number(),runs:c.number()}),CT=yT.extend({type:c.enum(["conversion","bat"]),playingPeriod:La,participantScores:c.array(gT)}),HL=pT.extend({record:mT.nullish(),gameOutcome:ui.nullish(),score:c.string().nullish(),playingPeriodScores:c.array(Oy).nullish(),gameStats:BL.nullish()}),zL=HL.extend({playingPeriodScores:c.array(Oy).nullish(),score:c.string(),gameStats:BL.nullish()}),BW=zL.extend({gameOutcome:ui}),HW=ul.extend({status:c.literal("pre-game"),participants:c.array(HL),timeline:c.object({events:c.array(CT)}).nullish()}),zW=ul.extend({status:c.literal("in-progress"),participants:c.array(zL),currentPlayingPeriod:La,timeline:c.object({events:c.array(CT)}).nullish()}),VW=ul.extend({status:c.literal("final"),participants:c.array(BW),videos:c.array(Od).nullish(),timeline:c.object({events:c.array(CT)}).nullish()}),$W=ul.extend({status:c.literal("postponed"),participants:c.array(Hr)}),GW=ul.extend({status:c.literal("delayed"),participants:c.array(Hr)}),KW=ul.extend({status:c.literal("abandoned"),participants:c.array(Hr)}),qW=ul.extend({status:c.literal("cancelled"),participants:c.array(Hr)}),_1=c.discriminatedUnion("status",[HW,zW,VW,$W,GW,KW,qW]),WW=c.object({type:c.literal("sportsSchedule"),sport:c.literal("baseball"),games:c.array(_1),header:bp.nullish(),heroGame:_1.nullish()}),YW=c.object({type:c.literal("sportsGame"),sport:c.literal("baseball"),game:_1}),QW=c.object({ballsFaced:c.number(),runsScored:c.number(),isBatting:c.boolean()}),JW=c.object({oversBowled:c.string(),wicketsTaken:c.number(),runsConceded:c.number(),isBowling:c.boolean()}),XW=QW.extend({type:c.literal("batting")}),ZW=JW.extend({type:c.literal("bowling")}),VL=c.discriminatedUnion("type",[XW,ZW]),eY=c.object({name:c.string(),stats:VL}),tY=c.object({playerName:c.string(),teamName:c.string(),gameStats:c.array(VL).nullish()}),nY=c.object({current:c.number(),required:c.number().nullish()}),rY=c.object({name:c.string(),currentMatch:c.number(),totalMatches:c.number(),roundName:c.string().nullish(),equation:c.string().nullish()}),$L=c.object({type:Zq,runs:c.number(),wickets:c.number(),oversPlayed:c.string(),isFollowedOn:c.boolean(),isDeclared:c.boolean(),duckworthLewisEquation:c.object({target:c.number(),revisedOvers:c.string()}).nullish()}),ST=c.object({name:c.string(),alias:c.string().nullish(),thumbnailUrl:c.string().nullish()}),oY=ST.extend({previousGameOutcomes:c.array(ui).nullish()}),iY=ST.extend({inningScores:c.array($L).nullish(),playersStats:c.array(eY).nullish(),yetToBat:c.boolean()}),sY=ST.extend({gameOutcome:ui,didNotBat:c.boolean(),inningScores:c.array($L).nullish()}),aY=c.object({startsAt:c.string(),startTimeToBeAnnounced:c.boolean(),tossInfo:c.string().nullish(),participants:c.array(oY),type:c.literal("pre")}),cY=c.object({gameSummary:c.string(),runRate:nY.nullish(),participants:c.array(iY),type:c.literal("live")}),lY=c.object({startsAt:c.string(),gameSummary:c.string(),playerOfTheMatch:tY.nullish(),participants:c.array(sY),type:c.literal("final")}),uY=c.discriminatedUnion("type",[aY,cY,lY]),A1=c.object({gameId:c.string(),leagueId:c.string(),venue:DL.nullish(),format:Xq,status:eW,seriesInfo:rY,phase:uY}),dY=c.object({type:c.literal("sportsGame"),sport:c.literal("cricket"),game:A1}),hY=c.object({type:c.literal("sportsSchedule"),sport:c.literal("cricket"),games:c.array(A1),header:bp.nullish(),heroGame:A1.nullable()}),fY=c.object({name:c.string(),countryFlagThumbnailUrl:c.string().nullish(),seed:c.number().nullish()}),pY=c.object({points:c.number(),isServing:c.boolean(),tieBreakerPoints:c.number().nullish(),currentGamePoints:c.string().nullish(),setWon:c.boolean().nullish()}),GL=c.object({players:c.array(fY)}),mY=GL,KL=GL.extend({setPoints:c.array(pY)}),gY=KL.extend({gameOutcome:ui}),vY=c.object({type:c.literal("pre"),participants:c.array(mY)}),yY=c.object({type:c.literal("live"),participants:c.array(KL)}),bY=c.object({type:c.literal("final"),participants:c.array(gY)}),CY=c.discriminatedUnion("type",[vY,yY,bY]),dx=c.object({gameId:c.string(),leagueId:c.string(),status:tW,startsAt:c.string().nullish(),startTimeToBeAnnounced:c.boolean(),venue:DL.nullish(),matchType:nW,round:rW.nullish(),phase:CY}),SY=c.object({type:c.literal("sportsSchedule"),sport:c.literal("tennis"),games:c.array(dx),header:bp.nullish(),heroGame:dx.nullish()}),IY=c.union([DW,jW,WW,hY,SY]),EY=c.discriminatedUnion("sport",[FW,UW,YW,dY]),TY=c.union([IY,EY]),wY=c.object({title:c.string(),description:c.string(),startTime:c.number(),endTime:c.number()}),_Y=c.object({video:c.object({url:c.string(),thumbnailUrl:c.string(),duration:c.number(),title:c.string(),isShort:c.boolean()}),source:c.object({url:c.string(),iconUrl:c.string().optional()}),bestMomentIndex:c.number().optional(),moments:c.array(wY).optional()}),AY=c.object({type:c.literal("video"),videos:c.array(_Y)}),kY=c.enum(["c","f"]),xY=c.enum(["mm","cm","in"]),RY=c.enum(["hPa","inHg","mb","mmHg"]),NY=c.enum(["bft","kph","mph","ms"]),PY=c.enum(["m","km","mi"]),MY=c.object({temperature:kY,height:xY,pressure:RY.optional(),speed:NY.optional(),distance:PY.optional()}),IT=c.enum(bO),OY=c.enum(["rain","snow"]),ET=c.object({type:OY,amount:c.number(),chance:c.number()}),LY=c.object({current:c.number(),high:c.number().optional(),low:c.number().optional()}),DY=c.object({at:c.string(),state:IT,summary:c.string(),description:c.string().optional(),temperature:LY,precipitation:ET.optional()}),qL=c.object({high:c.number(),low:c.number()}),jY=c.object({date:c.string(),state:IT,temperature:qL,precipitation:ET.optional()}),UY=c.object({at:c.string(),state:IT,temperature:qL,precipitation:ET.optional()}),FY=c.object({daily:c.array(jY),hourly:c.array(UY).optional()}),BY=c.object({type:c.literal("weather"),location:c.string(),units:MY,spotlight:DY.optional(),forecast:FY}),Uf=c.enum(bO),HY=c.object({type:c.literal("weatherTemperatureHourly"),location:c.string(),unit:c.union([c.literal("f"),c.literal("c")]),spotlight:c.object({date:c.string(),state:Uf,summary:c.string(),temperature:c.number().optional(),high:c.number(),low:c.number()}),forecast:c.array(c.object({at:c.string(),state:Uf,temperature:c.number(),precipitationChance:c.number()}))}),zY=c.object({type:c.literal("weatherTemperatureDaily"),location:c.string(),unit:c.union([c.literal("f"),c.literal("c")]),forecast:c.array(c.object({date:c.string(),state:Uf,high:c.number(),low:c.number(),precipitationChance:c.number()}))}),WL=c.union([c.literal("rain"),c.literal("snow")]),YL=c.union([c.literal("in"),c.literal("mm")]),VY=c.object({type:c.literal("weatherPrecipitationHourly"),location:c.string(),unit:YL,precipitationType:WL,spotlight:c.object({date:c.string(),summary:c.string(),amount:c.number(),chance:c.number()}),forecast:c.array(c.object({at:c.string(),state:Uf,amount:c.number(),chance:c.number()}))}),$Y=c.object({type:c.literal("weatherPrecipitationDaily"),location:c.string(),unit:YL,precipitationType:WL,forecast:c.array(c.object({date:c.string(),state:Uf,amount:c.number(),chance:c.number()}))}),GY=c.union([BY,HY,zY,VY,$Y]),QL=c.union([rK,jK,BK,HK,zK,KK,qK,eq,XK,tq,gq,vq,SK,bK,Vq,VK,TY,AY,GY,Sq,oK,CK]),KY=c.object({id:c.string(),imageUrl:c.string(),voiceId:c.string()}),$s=c.object({light:c.string(),dark:c.string()}),qY=c.object({foreground1:$s,foreground2:$s,accent:$s,shape:$s,shapeInverse:$s,background1:$s,background2:$s,background3:$s}),hx=c.object({name:c.enum(["ginto-copilot-nord-bold","ginto-copilot-nord-medium-italic","ginto-copilot-480","kari-regular"]),url:c.string().url()}),WY=c.object({name:c.string(),url:c.string().url()}),ld=c.object({url:c.string().url()}),ud=c.object({urlLight:c.string().url(),urlDark:c.string().url()}),k1=c.object({url:c.string().url()}),Ld=c.object({type:c.string(),title:c.string()}),YY=Ld.extend({type:c.literal("coverPage"),content:c.string(),template:c.enum(["image-background","fuzzy-image"]),image0:ld,sticker0:ud.nullish(),sticker1:ud.nullish()}),QY=Ld.extend({type:c.literal("heroImage"),content:c.string(),template:c.enum(["noisy-circle","macaron","wavy-shape"]),image0:ld}),JY=Ld.extend({type:c.literal("stickerSheet"),content:c.string(),template:c.enum(["sticker1","sticker2"]),sticker0:ud,sticker1:ud,accent0:k1,accent1:k1}),XY=Ld.extend({type:c.literal("simpleText"),content:c.string(),template:c.string().nullish()}),ZY=Ld.extend({type:c.literal("photoJournal"),content:c.string().nullish(),template:c.enum(["shapes-only","shapes-accents"]),variation:c.enum(["shape-group1","shape-group2"]),label0:c.string(),label1:c.string(),image0:ld,image1:ld,sticker0:ud.nullish(),accent0:k1.nullish()}),eQ=Ld.extend({type:c.literal("endPage"),content:c.string(),template:c.enum(["wide-cards","tall-cards"]),variation:c.enum(["shape-group1","shape-group2"]),questions:c.array(c.string()),image0:ld,image1:ld.nullish(),sticker0:ud}),tQ=c.object({type:c.literal("shareDefault"),template:c.string().nullish()}),nQ=c.discriminatedUnion("type",[YY,QY,JY,XY,ZY,eQ,tQ]),rQ=c.object({id:c.string(),modifiedAt:c.string(),theme:qY,font:hx,fontHandwriting:hx.nullish(),masks:c.array(WY),sections:c.array(nQ)}),oQ=c.object({type:c.literal("chatAboutNarrative"),narrativeId:c.string(),messageIndex:c.number()}),iQ=c.object({id:c.string(),factText:c.string(),createdAt:c.string(),updatedAt:c.string()});c.object({results:c.array(iQ),next:c.string().nullable()});const sQ=c.object({type:c.literal("provideImageFeedback"),messageId:c.string(),feedbackTypes:c.array(c.string())}),aQ=c.object({type:c.literal("createPage"),messageId:c.string()}),cQ=c.object({type:c.literal("appendToPage"),messageId:c.string(),pageId:c.string()}),lQ=c.object({id:c.string(),conversationId:c.string()}),k2e=c.object({title:c.string().nullish(),content:c.string().nullish(),conversationId:c.string()}),uQ=So.extend({type:c.literal("page"),page:c.object({id:c.string(),conversationId:c.string(),title:c.string().nullish()})}),dQ=c.object({id:c.string(),title:c.string().nullish(),updatedAt:c.string(),conversationId:c.string().optional(),type:c.enum(["page","sharedPage"]).optional()}),hQ=c.object({results:c.array(dQ),next:c.string().nullish()}),x2e=c.object({title:c.string().nullish(),content:c.string().nullish(),page:c.object({id:c.string()}).nullable()}),R2e=c.object({id:c.string(),url:c.string()}),fQ=c.enum(["page-count-exceeded","page-content-length-exceeded"]),pQ=c.object({errorCode:fQ}),N2e=c.enum(["public","user"]),P2e=c.object({id:c.string(),url:c.string()});c.object({type:c.literal("podcast"),id:c.string().min(1)});const JL=c.literal("generatePodcast"),mQ=c.object({type:JL,taskId:c.string().min(1)}),gQ=c.object({prompt:c.string()}),Ly=c.literal("executeTask"),vQ=c.object({type:Ly,taskId:c.string(),context:gQ.optional()}),yQ=c.string(),bQ=c.object({currentConversationId:c.string().nullable(),isNewUser:c.boolean(),banExpiresAt:c.string().nullable(),remainingTurns:c.number().nullable(),features:c.array(yQ),allowBeta:c.boolean().nullish(),userId:c.string().nullish()}),CQ=c.object({id:c.string(),name:c.string(),previewUrl:c.string(),voicemails:c.array(c.string())}),SQ=c.object({id:c.string(),backgroundImageUrl:c.string()}),IQ=c.object({id:c.string(),name:c.string(),location:SQ.nullish()}),ni=c.object({type:c.string(),label:c.string()}),EQ=c.array(ni),TQ=c.object({positive:c.array(ni),negative:c.array(ni)}),bi=c.union([EQ,TQ]),$a=c.object({type:c.string(),label:c.string(),subOptions:c.array(ni).nullish()}),XL=c.object({local:bi,ads:bi,video:bi,image:bi,sports:bi,job:bi,shopping:bi,finance:bi,quiz:bi,weather:bi}),wQ=c.object({positive:c.array(ni).nullish(),negative:c.array(ni)});XL.keyof();const ZL=c.object({newsArticle:c.array($a),newsVideo:c.array($a),newsGem:c.array($a),chat:c.array($a),dailyBriefing:c.array($a),podcast:c.array($a),default:c.array($a)});ZL.keyof();const _Q=c.object({computerUse:c.array(ni)}),AQ=c.object({text:c.array(ni),image:c.array(ni),call:c.array(ni),appearance:c.array(ni),card:XL,showroom:wQ.nullish(),discover:ZL.nullish(),task:_Q.nullish()}),kQ=c.object({maxFilesPerMessage:c.number(),maxFileNameLength:c.number(),image:c.object({mimeTypes:c.array(c.string()),maxBytes:c.number()}),document:c.object({mimeTypes:c.array(c.string()),maxBytes:c.number()}),binary:c.object({mimeTypes:c.array(c.string()),maxBytes:c.number()})}),xQ=c.object({minTextLength:c.number().min(0),textDeltaPercent:c.number().min(0).max(100),debounceInMilliseconds:c.number().min(0)}),RQ=c.object({signInPrompts:c.array(c.number()),voices:c.array(CQ),maxTextMessageLength:c.number(),feedbackOptions:AQ,characters:c.array(IQ).nullish(),pageLimit:c.number(),maxPageContentLength:c.number(),maxPageTitleLength:c.number(),messagePreview:xQ,attachments:kQ,portraits:c.array(KY).nullish()});c.object({hasVisionAccess:c.boolean(),allowedDomains:c.array(c.string()).nullable(),allowedDomainSuffixes:c.array(c.string()).nullable(),blockedDomains:c.array(c.string()).nullable(),blockedDomainSuffixes:c.array(c.string()).nullable()});const NQ=c.object({startTime:c.string(),text:c.string()}),PQ=c.object({startTime:c.string(),text:c.string(),words:c.array(NQ)}),fx=c.object({url:c.string(),duration:c.number(),transcript:c.array(PQ).nullish()}),MQ=c.object({title:c.string(),image:c.string(),url:c.string(),createdAt:c.string()}),OQ=c.object({publisherName:c.string(),publisherIcon:c.string(),articles:c.array(MQ)}),px=c.object({url:c.string(),foregroundColor:c.string(),backgroundColor:c.string()}),mx=c.object({name:c.string(),foregroundColor:c.string(),backgroundColor:c.string(),altText:c.string().nullish(),url:c.string()}),LQ=c.object({landscape:mx,portrait:mx}),DQ=c.object({id:c.string(),title:c.string(),image:c.object({landscape:px,portrait:px}),audio:c.record(c.string(),fx),transitionMusic:fx.nullable(),sources:c.array(OQ)}),e5=c.object({topics:c.array(c.object({id:c.string(),label:c.string(),imageUrl:c.string(),isFollowed:c.boolean()}))}),jQ=c.object({position:c.number(),chapterId:c.string()}),t5=c.object({isAvailable:c.boolean(),podcastId:c.string(),chapters:c.array(DQ),topics:e5.optional(),playback:jQ}),UQ=c.object({positionInSeconds:c.number(),chapterId:c.string()}),FQ=c.object({id:c.string(),title:c.string(),topic:c.string().nullable().optional(),image:LQ,audio:c.object({name:c.string(),duration:c.number()})}),Hg=c.object({isAvailable:c.boolean(),podcastId:c.string(),chapters:c.array(FQ),playback:UQ}),BQ=c.enum(qH),HQ=c.enum(GH),zQ=c.enum(KH),VQ=c.object({channel:zQ,tier:HQ,isAutoRenew:c.boolean()}),n5=c.object({id:c.string(),firstName:c.string().nullable(),anid:c.string().nullable(),isPro:c.boolean(),isDeprecated:c.boolean().nullish(),inEeaPlusRegion:c.boolean(),regionCode:c.enum(Object.values(fp)),isHistoryMigrationPending:c.boolean(),isEligibleForFreeTrial:c.boolean().optional(),phoneLink:c.object({deviceName:c.string().nullable()}).nullable(),ageGroup:c.enum(VH).nullable(),allowedToggles:c.object({textTraining:c.boolean(),voiceTraining:c.boolean(),personalization:c.boolean()}),remainingCalls:c.object({reasoning:c.number(),podcastGeneration:c.number(),research:c.number()}).nullish(),accountTier:BQ.nullish(),subscriptions:c.array(VQ).nullish()}),$Q=c.object({preferredVoice:c.string().nullable(),preferredCharacter:c.string().nullable().optional(),optOutOfTraining:c.boolean(),optInToVoiceTraining:c.boolean(),optOutOfPersonalization:c.boolean(),optOutOfPhoneConnection:c.boolean(),optInToGenerativeUI:c.boolean().optional(),allowBiometricDataUse:c.boolean().optional(),allowOneDriveAccess:c.boolean().optional(),features:c.object({suggestedFollowups:c.boolean().optional()}).nullish()}),r5=c.object({errorCode:c.union([c.literal("attachment-too-large"),c.literal("unsupported-content-type"),c.literal("empty-attachment"),c.literal("content-blocked"),c.literal("rate-limit-exceeded"),c.literal("not-signed-in")])}),GQ=c.union([c.object({url:c.string()}),r5]),o5=c.union([c.object({id:c.string()}),r5]),KQ=c.object({id:c.string(),title:c.string().optional(),updatedAt:c.string(),characterId:c.string().nullable().optional(),continuedAt:c.string().nullable()}),qQ=c.object({results:c.array(KQ),next:c.string().nullable()}),WQ=c.object({id:c.string()}),i5=c.union([c.literal("thumbs-down"),c.literal("thumbs-up"),c.null()]),Dy=c.union([c.literal("running"),c.literal("completed"),c.literal("failed"),c.literal("cancelled"),c.literal("pending"),c.literal("paused")]),YQ=c.union([c.literal("research"),c.literal("computerUse"),c.literal("podcast")]),QQ=c.object({type:c.literal("chainOfThought"),text:c.string()}),JQ=c.object({type:c.literal("query"),text:c.string()}),XQ=c.object({type:c.literal("citation"),title:c.string(),url:c.string()}),ZQ=c.discriminatedUnion("type",[QQ,JQ,XQ]),eJ=c.object({id:c.string(),title:c.string().nullish(),contents:c.array(ZQ).nullish(),inlineCitations:c.array(hT).nullish(),partialOutput:c.array(c.string()).nullish(),finalResponse:c.string().nullish(),type:c.literal("research"),status:Dy,prompt:c.string().optional()}),s5=c.object({url:c.string(),createdAt:c.string()}),tJ=c.object({type:c.literal("computerUse"),title:c.string().nullish(),conversationId:c.string().nullish(),id:c.string(),status:Dy,lastScreenshot:s5.nullish(),updatedAt:c.string().nullish()}),a5=c.object({id:c.string(),title:c.string().nullish(),thumbnail:c.object({name:c.string().nullish()}).nullish()}),nJ=c.object({type:c.literal("podcast"),id:c.string(),podcast:a5.nullish(),status:Dy,updatedAt:c.string().nullish()}),c5=c.discriminatedUnion("type",[eJ,tJ,nJ]),TT=c.object({id:c.string(),title:c.string().optional(),conversationId:c.string().optional(),updatedAt:c.string(),status:Dy,type:YQ}),rJ=TT.extend({type:c.literal("research")}),oJ=TT.extend({type:c.literal("computerUse"),screenshot:c.string().nullish(),lastScreenshot:s5.nullish(),chainOfThought:c.array(c.string()).nullish(),computerAction:c.string().nullish(),statusChange:cK.optional(),lastUserCommand:al.optional(),reaction:i5.optional(),activeTabFaviconUrl:c.string().nullish(),activeTabTitle:c.string().nullish(),viewMode:mK.nullish(),replay:vK.nullish()}),iJ=TT.extend({type:c.literal("podcast"),podcast:a5.nullish()}),sJ=c.discriminatedUnion("type",[rJ,oJ,iJ]),M2e=c.object({results:c.array(sJ),next:c.string().nullable()}),dl=c.union([c.literal("report"),...i5.options]),aJ=c.union([c.literal("generating"),c.literal("generated"),c.literal("failed"),c.literal("non-complete")]),l5=c.object({id:c.string(),createdAt:c.string()}),cJ=c.object({index:c.string(),title:c.string(),url:c.string(),iconUrl:c.string().nullable(),publisher:c.string().nullable()}),lJ=So.extend({type:c.literal("image"),url:c.string().optional(),prompt:c.string().optional().nullable(),isPartiallyLoading:c.boolean().optional(),reaction:dl.optional(),partialGenerationStep:c.number().optional(),status:aJ.optional(),progressionText:c.string().nullable().optional()}),uJ=So.extend({type:c.literal("citation"),...hT.shape}),dJ=So.extend({type:c.literal("text"),text:c.string(),citations:c.array(cJ).optional(),reaction:dl.optional()}),hJ=So.extend({type:c.literal("task"),task:c5.nullish(),reaction:dl.optional()}),fJ=So.extend({type:c.literal("card"),card:QL,reaction:dl.optional()}),pJ=So.extend({type:c.literal("document"),attachmentId:c.string(),fileName:c.string(),contentType:c.string(),reaction:dl.optional()}),mJ=So.extend({type:c.literal("deleted"),partType:c.enum(["page","task"])}),gJ=So.extend({type:c.literal("error"),text:c.string()});c.object({text:c.string(),title:c.string().optional(),lastSubActionScreenshotUrl:c.string().nullish()});const u5=So.extend({type:c.literal("chainOfThought"),text:c.string(),title:c.string().optional(),screenshotUrl:c.string().nullish(),reaction:dl.optional(),partId:c.string()}),vJ=c.union([u5,fL]),yJ=So.extend({type:c.literal("chainOfThoughtGroup"),items:c.array(vJ).optional(),isComplete:c.boolean()}),bJ=So.extend({type:c.literal("memorySignal"),text:c.string(),signalType:c.union([c.literal("remember"),c.literal("forget")]).nullish()}),CJ=c.object({position:c.union([c.literal("left"),c.literal("right")]),isDefault:c.boolean(),isStreamingComplete:c.boolean().optional()}),SJ=c.discriminatedUnion("type",[dJ,lJ,uQ,uJ,gJ,fJ,pJ,hJ,mJ,u5,yJ,fL,bJ]),IJ=c.object({type:c.literal("text"),text:c.string()}),EJ=c.object({type:c.literal("browserTabs"),tabs:c.array(c.object({title:c.string().optional(),url:c.string().optional(),id:c.number().optional(),favIconUrl:c.string().optional(),windowId:c.number()}))}),TJ=c.object({type:c.literal("image"),url:c.string()}),wJ=c.object({type:c.literal("document"),partId:c.string(),fileName:c.string(),contentType:c.string()});c.object({type:c.literal("document"),attachmentId:c.string()});c.union([al,Ly]);c.union([c.literal("provideImageFeedback"),c.literal("createPage"),c.literal("appendToPage"),c.literal("promptCharacterSpeech"),c.literal("chatAboutNarrative"),al,Ly,JL]);const _J=c.object({type:c.literal("promptCharacterSpeech")}),AJ=c.discriminatedUnion("type",[sQ,aQ,cQ,lK,uK,dK,hK,fK,pK,_J,oQ,vQ,mQ]),kJ=c.object({type:c.literal("command"),command:AJ}),xJ=c.object({type:c.literal("dailyBriefing"),chapterId:c.string()}),RJ=c.object({type:c.literal("greeting"),greetingMessage:c.string()}),NJ=c.object({type:c.literal("news"),articleId:c.string()}),PJ=c.object({type:c.literal("newsGem"),gemId:c.string(),snapshotKey:c.string()}),MJ=c.discriminatedUnion("type",[xJ,RJ,NJ,PJ]);c.object({type:c.literal("reference"),reference:MJ});const OJ=c.discriminatedUnion("type",[IJ,TJ,wJ,kJ,EJ]),d5=c.enum(["chat","smart","study","reasoning","research","computerUse"]),LJ=l5.extend({author:c.literal("ai"),content:c.array(SJ),mode:d5.optional(),sideBySideConfig:CJ.optional(),reaction:dl.optional()}),DJ=l5.extend({author:c.literal("human"),content:c.array(OJ)}),h5=c.discriminatedUnion("author",[LJ,DJ]),f5=c.object({results:c.array(h5),next:c.string().nullable()}),jJ=c.object({messages:c.array(h5),conversationTitle:c.string()}),O2e=c.object({url:c.string()}),UJ=c.object({conversation:c.object({id:c.string(),title:c.string()})});c.object({qc:c.object({q:c.string(),gt:c.string(),sc:c.string()}),s:c.array(c.object({st:c.string(),t:c.string()}))});const wT=c.union([c.literal("active"),c.literal("banned"),c.literal("ineligible")]),_T=c.union([c.literal("active"),c.literal("not-started"),c.literal("expired"),c.literal("paused")]),FJ=c.union([c.literal("not-started"),c.literal("completed"),c.literal("ineligible")]),BJ=c.object({id:c.string(),type:c.string(),points:c.number()}),HJ=c.object({redeemableCount:c.number(),redeemedCount:c.number(),skus:c.array(BJ)}),L2e=c.object({userStatus:wT,status:_T,startAt:c.string(),endAt:c.string(),referralCode:c.string().nullish(),referralTaskStatus:FJ.nullish(),rewards:HJ.nullish()}),D2e=c.object({userStatus:wT.nullish(),programStatus:_T}),j2e=c.object({userStatus:wT.nullish(),programStatus:_T,lastRequestTime:c.string(),userId:c.string()}),zC=c.enum(["prefillComposer","sendMessage","deepLink"]),AT=c.discriminatedUnion("type",[c.object({type:c.literal(zC.enum.prefillComposer),prompt:c.string()}),c.object({type:c.literal(zC.enum.sendMessage),prompt:c.string()}),c.object({type:c.literal(zC.enum.deepLink),uri:c.string()})]),p5=c.object({id:c.string(),text:c.string(),action:AT}),zJ=c.object({id:c.string(),text:c.string(),thumbnail:c.object({url:c.string(),altText:c.string()}),action:AT}),VJ=c.object({id:c.string(),text:c.string(),action:AT}),$J=c.object({id:c.string(),label:c.string(),items:c.array(p5)}),GJ=c.discriminatedUnion("type",[c.object({type:c.literal("text"),id:c.literal("conversation-starter"),title:c.string().nullish(),items:c.array(p5)}),c.object({type:c.literal("textAndImage"),id:c.union([c.literal("feature-discovery"),c.literal("kickstarter"),c.literal("image-generation")]),title:c.string().nullish(),items:c.array(zJ)}),c.object({type:c.literal("textAndGreeting"),id:c.string(),title:c.string().nullish(),greeting:c.string().nullish(),items:c.array(VJ)}),c.object({type:c.literal("categories"),id:c.literal("categorized-conversation-starter"),title:c.string().nullish(),categories:c.array($J)})]),KJ=c.object({widgets:c.array(GJ)}),qJ=c.object({dPPRank:c.string()}),WJ=c.object({query:c.string(),source:c.string(),metadata:qJ});c.object({suggestedQueries:c.array(WJ),url:c.string()});c.object({tabId:c.number(),windowId:c.number(),url:c.string(),title:c.string(),content:c.string()});const m5={"sticky-conversation-mode":d5};function YJ(t,e){try{return m5[t].parse(e),sessionStorage.setItem(t,JSON.stringify(e)),!0}catch{return!1}}function g5(t){const e=sessionStorage.getItem(t);if(!e)return null;try{const n=JSON.parse(e);return m5[t].parse(n)}catch{return null}}z$();const hl=P(!1),jy=P(void 0),VC=P(Ng),hn=P(t=>t(VC),(t,e,n)=>{if(t(VC)===n)return;e(VC,n),ze("sticky-conversation-mode")&&YJ("sticky-conversation-mode",n)}),bn=P(new Map),it=P(void 0),zg=P(null),$C=P(void 0),kT=P(t=>t($C),(t,e,n)=>{const r=t($C);r!==n&&(e(bn,o=>{const i=new Map(o);return r&&i.delete(r),i}),e($C,n))}),v5=P(null),eo=P(t=>{const e=t(it);if(e)return t(bn).get(e)}),QJ=_E(eo,t=>(t==null?void 0:t.streamingState)==="streaming",(t,e)=>t===e),U2e=t=>_E(bn,e=>{var n;return((n=e.get(t))==null?void 0:n.streamingState)==="streaming"},(e,n)=>e===n),Lu=P(!1),di=P(new Map),F2e=P([]);P([]);const B2e=t=>P(e=>e(di).get(t)),Zi=P(t=>{var e;return((e=t(eo))==null?void 0:e.history)??[]}),xT=P(t=>{const e=t(bn);for(const n of e.values())if(!n.title&&!n.history.length&&n.isNew)return n.id}),RT=P(new Map),$h=P(void 0),Uy=P([]),y5=P(!1),NT=P(t=>{var e;return uL((e=t(eo))==null?void 0:e.characterId)}),Ic=P("idle"),b5=P(!1),Os=P(null),JJ=P("idle"),rf=P("checking-availability"),XJ=P(null),C5=P([]),Dc=P(null),PT=P(null),MT=P([]),ZJ=P([]),S5=P(null),eX=P(t=>t(Dc)===0),OT=P(null),I5=P(null),tX=P(null),of=P(!1),E5=P(!1),T5=P(QH),Ff=P(void 0),nX=P(!0),w5=P(null),rX=P(t=>!!t(w5));P(null);const Dd=P(!1);P(null);const Fy=P(void 0),oX=P(void 0),iX=P(void 0),sX=P(t=>{const e=t(eo);return e==null?void 0:e.suggestedFollowup}),H2e=P(void 0),_5=P(null),z2e=P(!1),aX=P(!1),LT=P(void 0),V2e=P(!1),$2e=P(void 0);P(null);const cX=P(null),DT=P(!1),fl=P(void 0),G2e=ky({}),By=P(void 0),Lr=P("chat-only"),K2e=P(null),q2e=P(null),W2e=P(null),lX=P(null),A5=P({}),jT=P(!1),ms=P(null),k5=P({data:void 0,isLoading:!1}),uX=P(t=>t(k5).data),x5=P(t=>t(k5).isLoading),eg=P(!1),R5=P(null);P(t=>{const e=t(R5);return(e==null?void 0:e.lcp)??null});const N5=P(null),dX=JM("coachmark",{},void 0,{getOnInit:!0});P(!1);const hX=["m365-family-classic-guest","m365-family-guest","m365-premium-guest"],fX="App Store",pX="Google Play",mX=["m365-personal","m365-family-admin"],P5=["m365-family-guest","m365-premium-guest","m365-premium-admin"],gX=["m365-personal","m365-family-admin"],gx=["pro","m365-premium-admin","m365-family-admin","m365-personal","m365-personal-classic","m365-premium-guest","m365-family-guest","m365-family-classic-admin","m365-family-classic-guest","m365-basic"];function vX(t,e=!1){return t.length===0?e?"buypremium":"buym365":t.some(n=>n.tier==="pro")?"buypremium":t.some(n=>P5.includes(n.tier))?null:t.some(n=>gX.includes(n.tier))||e?"upgradepremium":"upgradem365"}function Y2e(t){return t.length>0&&!t.some(e=>e.tier==="pro")}function Q2e(t){return t.some(e=>mX.includes(e.tier))&&!t.some(e=>P5.includes(e.tier))}function yX(t){return t.slice().sort((e,n)=>gx.indexOf(e.tier)-gx.indexOf(n.tier))}function J2e(t){const e=t.find(n=>n.tier==="pro");return(e==null?void 0:e.isAutoRenew)??!1}function bX(t){const e=t==null?void 0:t.tier,n=t==null?void 0:t.channel,r=e!==void 0&&!hX.includes(e)&&(n==="apple"||n==="google");return{shouldRedirectMobile:r,redirectMobileSource:r?n:null}}function X2e({isM365SkuEnabled:t,isPro:e,subscriptions:n}){return t?n.length===0&&!e:!e}function CX(t){return t.toLowerCase()==="zh-hant"?"zh-TW":t}const UT="ellie",M5=[UT],vx=c.union([c.enum(M5),c.undefined()]),SX=c.object({model:c.literal("vasa"),eyesOpenRatio:c.array(c.number()).min(1),eyesPose:c.array(c.number()).min(6),jawPose:c.array(c.number()).length(3),neckPose:c.array(c.number()).length(3),rotation:c.array(c.number()).length(3),translation:c.array(c.number()).length(3),viseme:c.array(c.number()).min(10)}),IX=c.object({model:c.literal("spda2e"),poseDiffusion:c.array(c.number())}),EX=c.object({type:c.literal("topicList"),id:c.string(),topics:c.array(c.object({text:c.string()})).nullable(),selectedIndex:c.number().nullable()}),TX=EX.nullable(),wX=c.union([c.string(),c.number(),c.boolean(),c.null()]),Bf=c.lazy(()=>c.union([wX,c.array(Bf),c.record(Bf)])),_X=c.object({op:c.literal("add"),path:c.string(),value:Bf}),AX=c.object({op:c.literal("remove"),path:c.string()}),kX=c.object({op:c.literal("replace"),path:c.string(),value:Bf}),xX=c.object({op:c.literal("move"),from:c.string(),path:c.string()}),RX=c.object({op:c.literal("copy"),from:c.string(),path:c.string()}),NX=c.object({op:c.literal("test"),path:c.string(),value:Bf}),PX=c.discriminatedUnion("op",[_X,AX,kX,xX,RX,NX]),yx=c.array(PX),MX=c.union([c.literal("event-not-recognized"),c.literal("over-turn-limit"),c.literal("unknown-error"),c.literal("message-too-large"),c.literal("invalid-event"),c.literal("empty-message"),c.literal("empty-text"),c.literal("text-too-long"),c.literal("multiple-text-parts"),c.literal("multiple-image-parts"),c.literal("too-many-messages"),c.literal("over-reasoning-quota"),c.literal("over-lifetime-task-quota"),c.literal("over-task-quota"),c.literal("page-content-length-exceeded"),c.literal("page-count-exceeded"),c.literal("character-out-of-capacity"),c.string()]),OX=c.union([c.literal("blocked"),c.literal("not-signed-in"),c.literal("failed"),c.string()]),O5=c.union([c.literal("quiz"),c.literal("generative-ui")]),L5=c.union([c.literal("throttled"),c.literal("throttled-non-pro"),c.literal("time-expired"),c.literal("time-expired-non-pro"),c.literal("not-in-flight"),c.literal("error"),c.literal("signed-out"),c.literal("region-not-available"),c.literal("time-expired-month"),c.literal("time-expired-month-non-pro")]),LX=c.object({voice:c.string().optional(),speed:c.number().min(50).max(200).optional()}).partial(),bx=c.number().min(0).max(200).default(100),Cx=c.union([c.literal("standard"),c.literal("character")]),Sx=c.discriminatedUnion("event",[Ny,c.object({event:c.literal("pong"),id:c.string()}),c.object({event:c.literal("connected"),id:c.string(),requestId:c.string()}),c.object({event:c.literal("received"),conversationId:c.string(),messageId:c.string(),createdAt:c.string()}),c.object({event:c.literal("emojiReaction"),messageId:c.string(),emoji:c.string()}),c.object({event:c.literal("startMessage"),conversationId:c.string(),messageId:c.string(),createdAt:c.string()}),c.object({event:c.literal("appendText"),messageId:c.string(),text:c.string(),partId:c.string()}),c.object({event:c.literal("replaceText"),messageId:c.string(),text:c.string(),partId:c.string()}),c.object({event:c.literal("titleUpdate"),conversationId:c.string(),title:c.string()}),c.object({event:c.literal("generatingImage"),messageId:c.string(),prompt:c.string(),partId:c.string(),progressionText:c.string().nullable().optional()}),c.object({id:c.string(),event:c.literal("generatingImages"),messageId:c.string(),partIds:c.array(c.string()),prompt:c.string()}),c.object({event:c.literal("imageGenerated"),messageId:c.string(),url:c.string(),partId:c.string()}),c.object({event:c.literal("partialImageGenerated"),messageId:c.string(),url:c.string(),partId:c.string(),content:c.string()}),c.object({event:c.literal("page"),messageId:c.string(),partId:c.string(),page:c.object({id:c.string(),conversationId:c.string(),title:c.string().nullish()})}),c.object({event:c.literal("challenge"),method:c.literal("copilot").nullish(),parameter:c.string().nullish()}),c.object({event:c.literal("imageGenerationFailed"),messageId:c.string(),errorCode:OX,partId:c.string()}),c.object({id:c.string(),event:c.literal("generatingCard"),messageId:c.string(),partId:c.string(),type:O5}),c.object({id:c.string(),event:c.literal("cardGenerationFailed"),messageId:c.string(),partId:c.string()}),c.object({event:c.literal("transcriptEvent")}),c.object({event:c.literal("audioStart"),conversationId:c.string()}),c.object({event:c.literal("audio"),audio:c.string()}),c.object({event:c.literal("audioStartFailed"),reason:L5}),c.object({event:c.literal("audioTimeRemaining"),seconds:c.number()}),c.object({event:c.literal("callTerminated"),reason:c.string().optional()}),c.object({event:c.literal("audioEnd")}),c.object({event:c.literal("callEnded"),id:c.string()}),c.object({event:c.literal("audioConfig"),options:LX}),c.object({event:c.literal("interruptAudio")}),c.object({event:c.literal("speechEndDetected")}),c.object({event:c.literal("citation"),messageId:c.string(),url:c.string(),title:c.string(),partId:c.string(),iconUrl:c.string().nullable(),publisher:c.string().nullable()}),c.object({event:c.literal("chainOfThought"),messageId:c.string(),partId:c.string(),text:c.string()}),c.object({event:c.literal("turnLimitReached"),id:c.string()}),c.object({event:c.literal("done"),messageId:c.string()}),c.object({event:c.literal("error"),errorCode:MX}),c.object({event:c.literal("card"),messageId:c.string(),partId:c.string(),card:QL}),c.object({event:c.literal("document"),messageId:c.string(),partId:c.string(),attachmentId:c.string(),fileName:c.string(),contentType:c.string()}),c.object({event:c.literal("callUI"),id:c.string(),callUI:TX}),c.object({event:c.literal("banned"),expiresAt:c.string()}),c.object({id:c.string(),event:c.literal("suggestedFollowups"),messageId:c.string(),suggestions:c.array(c.string())}),c.object({event:c.literal("taskStart"),id:c.string(),messageId:c.string(),partId:c.string(),task:c5}),c.object({event:c.literal("taskUpdate"),id:c.string().nullish(),taskId:c.string(),update:yx}),c.object({event:c.literal("startSuggestion"),id:c.string(),pageId:c.string(),suggestionId:c.string(),editTargets:c.array(c.object({startIndex:c.number(),endIndex:c.number()}))}),c.object({event:c.literal("appendSuggestion"),id:c.string(),pageId:c.string(),suggestionId:c.string(),text:c.string()}),c.object({event:c.literal("characterAnimation"),id:c.string(),offsetInMilliseconds:c.number().nullable().optional(),frame:c.discriminatedUnion("model",[SX,IX]).nullable().optional()}),c.object({event:c.literal("setCallType"),callType:Cx}),c.object({event:c.literal("callTypeChanged"),callType:Cx}),c.object({event:c.literal("activityStart"),activity:hL,id:c.string(),messageId:c.string(),partId:c.string()}),c.object({event:c.literal("activityUpdate"),id:c.string(),messageId:c.string(),partId:c.string(),update:yx}),c.object({event:c.literal("memorySignal"),messageId:c.string(),partId:c.string(),text:c.string(),signalType:c.union([c.literal("remember"),c.literal("forget")]).nullish()}),c.object({event:c.literal("sideBySideComparison"),id:c.string(),conversationId:c.string(),sideBySideComparisonId:c.string(),defaultMessageId:c.string(),options:c.array(c.object({messageId:c.string(),position:c.union([c.literal("left"),c.literal("right")])}))}),c.object({event:c.literal("characterEmotion"),emotion:c.string(),bodyReaction:c.string()}),c.object({event:c.literal("modeSelected"),id:c.string(),messageId:c.string(),mode:c.union([c.literal("chat"),c.literal("reasoning")])}),c.object({event:c.literal("partCompleted"),id:c.string(),messageId:c.string(),partId:c.string()})]),D5={kNotPresent:0};function Z2e(t){return typeof t=="object"&&t!==null&&"eventName"in t&&"requestId"in t&&(!("isOutgoing"in t)||!t.isOutgoing)&&"args"in t}const br=P(void 0),Hy=P(t=>t(br)!==void 0),j5=Nd({key:aL,schema:c.string().optional(),initialValue:void 0}),U5=P(t=>{const e=t(br),n=t(j5);return e===void 0?n:e.firstName??e.givenName}),F5=P(t=>{var e;return(e=t(br))==null?void 0:e.id}),Cp=P(void 0),eNe=P(t=>t(Uy).find(e=>e.id===t(Cp))),tNe=P(t=>{var r,o;const e=t(Uy),n=t(Cp)??((r=e[0])==null?void 0:r.id);return(o=e.find(i=>i.id===n))==null?void 0:o.voicemails}),DX=Nd({key:ix,schema:bx,initialValue:Co(ix,bx)??pp}),Sp=Nd({key:rx,schema:vx,initialValue:Co(rx,vx)??void 0}),jX=Nd({key:vG,schema:c.boolean().optional(),initialValue:void 0}),B5=P(null),Ip=P(null),H5=P(t=>t(MT).find(e=>e.id===t(Ip))),nNe=P(!1),rNe=P(D5.kNotPresent),oNe=P(D5.kNotPresent),z5=P(void 0),FT=P(!1),zy=P(void 0),UX=P(!1),V5=P(void 0),FX=P(!1),BT=P(null),Vy=P(null),BX=P(!0),iNe=P(!1),sNe=P(!1),pl=P(t=>{const e=t(br),n=t(Oa("cmc-m365-sku")),r=!!(e!=null&&e.isPro),o=(e==null?void 0:e.subscriptions)??[];return n&&o.some(i=>i.tier==="pro")||r}),HX=P(t=>{var e;return(e=t(br))==null?void 0:e.isStudent}),$5=P(t=>{var e;return(e=t(br))==null?void 0:e.inEeaPlusRegion}),Cr=P(void 0),zX=P(!1);P(t=>{const e=t(Cr);return e&&oz.includes(e)});const G5=P(void 0),$y=P(t=>{var e;return((e=t(br))==null?void 0:e.isEligibleForFreeTrial)??!1}),K5=P(void 0),Gy=P(t=>{var e;return((e=t(br))==null?void 0:e.ageGroup)==="teen"}),VX=P(t=>{var e;return(e=t(br))==null?void 0:e.allowedToggles.personalization}),$X=P(t=>{var e;return(e=t(br))==null?void 0:e.allowedToggles.textTraining}),GX=P(t=>{var e;return(e=t(br))==null?void 0:e.allowedToggles.voiceTraining}),q5=P(!1),W5=P(null),Y5=P(t=>{var e;return((e=t(br))==null?void 0:e.subscriptions)??[]}),Q5=P(t=>{const e=t(Y5);return yX(e)[0]}),x1=P(0),J5=P(void 0),X5=P(0),Ky=P(!1),HT=P(t=>{const e=t(uX),n=t(x5),r=t(J5),o=t(Ky);if(!(n||o))return e||r}),Da=P(t=>{const e=t(HT),n=t(x1);if(!e||e.length===0)return;const r=Math.max(0,Math.min(n,e.length-1));return e[r]}),zT=P(t=>{const e=t(Da),n=t(Ky),r=t(HT);return n||!r?null:(e==null?void 0:e.type)==="textAndGreeting"?e.greeting??null:null}),Z5=P(!1),KX=P(t=>{const e=t(Da);return e==null?void 0:e.title}),qX=P(t=>{const e=t(Da);return e==null?void 0:e.id}),WX=P(t=>{const e=t(Da),n=e==null?void 0:e.id;return n==="feature-discovery"||n==="image-generation"||n==="kickstarter"}),YX=P(null,(t,e)=>{const n=t(HT),r=t(x1);if(!n||n.length<=1)return;const o=(r+1)%n.length;e(x1,o)}),QX=P(t=>{var r;const e=t(Da),n=t(X5);return e?e.type==="categories"?((r=e.categories[n])==null?void 0:r.items)??[]:e.type==="text"||e.type==="textAndGreeting"?e.items:null:null}),JX=P(void 0),XX=P(void 0),VT=P(!1);P(void 0);const ZX=ky(new Map),aNe=P(t=>{const e=t(ZX);return Array.from(e.values()).some(n=>n.isTracked)});P(void 0);const cNe=P(null),lNe=ky(void 0);function Ep(){const t=x(Zi),e=x(eo);return t.length===0&&!!(e!=null&&e.isNew)}function $T(){const t=x(VT),e=x(XX),r=Ep()&&!!e,o=r&&!!(e!=null&&e.insights);return{isContextualShoppingCardExpanded:t,showShoppingCardInNewChat:r,shoppingProductMetadata:e,isCopilotOpenedViaEdgeCTAs:o}}function eZ(t){if(!t.length)return;const e=li("greetingIndex"),n=t.length,r=e?(parseInt(e,10)+1)%n:0;return ba("greetingIndex",r.toString()),t[r]}const GT=P(!1),tZ=P(!1),eD=at(),nZ=["chat.launchMessage.authenticatedV3Type1","chat.launchMessage.authenticatedV3Type2","chat.launchMessage.authenticatedV3Type3"],rZ=["chat.launchMessage.unauthenticatedV3Type1","chat.launchMessage.unauthenticatedV3Type2","chat.launchMessage.unauthenticatedV3Type3"],oZ=["chat.launchMessage.authenticatedV4Type1","chat.launchMessage.authenticatedV4Type2","chat.launchMessage.authenticatedV4Type3","chat.launchMessage.authenticatedV4Type4","chat.launchMessage.authenticatedV4Type5","chat.launchMessage.authenticatedV4Type6","chat.launchMessage.authenticatedV4Type7","chat.launchMessage.authenticatedV4Type8","chat.launchMessage.authenticatedV4Type9","chat.launchMessage.authenticatedV4Type10"],iZ=["chat.launchMessage.unauthenticatedV4Type1","chat.launchMessage.unauthenticatedV4Type2","chat.launchMessage.unauthenticatedV4Type3","chat.launchMessage.unauthenticatedV4Type4","chat.launchMessage.unauthenticatedV4Type5","chat.launchMessage.unauthenticatedV4Type6","chat.launchMessage.unauthenticatedV4Type7","chat.launchMessage.unauthenticatedV4Type8","chat.launchMessage.unauthenticatedV4Type9","chat.launchMessage.unauthenticatedV4Type10"];function sZ(){eD.set(GT,!0)}function aZ(){eD.set(GT,!1)}function tD(){const{t}=xe(),e=x(GT),n=x(U5),r=x(qX),o=x(zT),i=x(KX),s=se("landing-rotating-greeting"),{showShoppingCardInNewChat:a}=$T(),u=m.useCallback(()=>a?n?["chat.launchMessage.authenticatedShoppingType1"]:["chat.launchMessage.unauthenticatedShoppingType1"]:r&&r==="image-generation"?["chat.launchMessage.unauthenticatedImageWidgets"]:r&&r==="feature-discovery"?n?["chat.launchMessage.authenticatedWidgets"]:["chat.launchMessage.unauthenticatedWidgets"]:n?s?oZ:nZ:s?iZ:rZ,[n,s,a,r])(),h=m.useMemo(()=>eZ(u),[u]),f=Number(li("greetingIndex"))||0,p=m.useCallback(()=>i||(r==="feature-discovery"?t("chat.launchMessage.subheadingFeatureDiscoveryWidget"):r==="image-generation"?t("chat.launchMessage.subheadingImageGenWidget"):null),[i,r,t]);return{launchGreetingShown:e,greetingKey:h,widgetGreeting:o,widgetSubheading:p(),greetingIndex:f}}function $t(){return XM({select:e=>e.pathname})}function KT(){const t=$t();return{isLivingPortraitEnabled:se("labs-portrait-enabled")&&t.startsWith("/labs/portrait")}}async function qy({from:t,to:e,params:n,search:r,state:o}){var s;e.startsWith("/chats/")||at().set(zg,null);let i=e;e==="/"&&((s=me.instance().config().landingPage)!=null&&s.enableLandingRoute)&&(i="/discover"),await Dl.navigate({to:i,params:n,state:a=>({...a,from:t,...o}),search:r})}function gi(){return qy}async function nD(t){const{conversationId:e=Ue(it),talk:n=!1,location:r}=t;e&&await qy({to:`/chats/$conversationId${n?"/talk":""}`,params:{conversationId:e},from:r.pathname,search:r.search?Object.fromEntries(new URLSearchParams(r.search)):{}})}async function cZ(t={}){await nD({conversationId:t.conversationId,talk:t.talk,location:Dl.state.location})}function rD(){const t=py(),{location:e}=t.state;return m.useCallback(async(n={})=>nD({conversationId:n.conversationId,talk:n.talk,location:{pathname:e.pathname,search:e.search}}),[e.search,e.pathname])}function En(t,e){at().set(t,e)}function oD(t){const{tasks:e,conversationId:n,taskType:r}=t;for(const o of e.values())if(o.conversationId===n){if(r&&o.type!==r)continue;return o.id}return""}function iD(t,e){return oD({tasks:t,conversationId:e,taskType:"computerUse"})!==""}function lZ(t,e){if(!e)return t;const[n,r,o]=t.slice(-3);if(!(Ca(o)&&Ca(r)&&(n==null?void 0:n.author)==="human"))return t;const s={left:o.sideBySideConfig.position==="left"?o:r,right:o.sideBySideConfig.position==="right"?o:r,createdAt:o.createdAt,id:e};return[n,s]}function uZ(t){return sD(t)||Ca(t)}function sD(t){return"left"in t&&"right"in t}function Ca(t){return!t||t.author!=="ai"?!1:!!t.sideBySideConfig}const Vg=["completed","failed","cancelled"];function dZ(t){return t.content.find(e=>{var r;if(e.type!=="task")return!1;const n=(r=e.task)==null?void 0:r.status;return n&&!Vg.includes(n)})}function hZ(t){for(let e=t.length-1;e>=0;e-=1){const n=t[e];if(n&&n.type==="task")return n}}function qT(t){for(const e of t){const n=dZ(e);if(n)return{message:e,part:n}}return null}const aD=_E(Zi,t=>{if(!$g()||t.length===0)return!1;const e=t[t.length-1];return(e==null?void 0:e.author)==="ai"&&e.content.some(n=>n.type==="activity"&&n.activity.status==="running")}),fZ=["ceo-thinkdeeper","ceo-smart-mode","ceo","webretrieval","webcontent","browserautomationorchestratortool"];function $g(){return fZ.some(ze)}const jd=at();function An(t,e,n=!1){const r=t.at(-1),o=t.find(({id:i})=>i===e);if((n||(r==null?void 0:r.id)===(o==null?void 0:o.id)||Ca(o))&&(o==null?void 0:o.author)==="ai")return o}function pZ(t,e){const n=t.find(({author:r})=>r==="human");if((n==null?void 0:n.id)===e&&n.author==="human")return n}function cD(t){const e=t.at(-1);if((e==null?void 0:e.author)==="ai")return e}function Ga(t,e){return t.find(n=>n.partId===e)}function mZ(t){for(let e=t.length-1;e>=0;e-=1){const n=t[e];if(n&&n.type==="text")return n}}function uNe(t,e,n){const r=t.find(o=>o.id===e);if(!(!r||r.author!=="ai")){for(const o of r.content)if("partId"in o&&o.partId===n)return o}}function lD(t){if(!t)return null;const e=jd.get(bn).get(t);if(!e)return null;const{history:n}=e;return qT(n)}function Dt(t,e){jd.set(bn,n=>Or(n,r=>{const o=r.get(t);o&&e(o.history)}))}function WT(t,e){jd.set(di,n=>Or(n,r=>{const o=r.get(t);o&&e(o)}))}function ki(t,e){jd.set(bn,n=>Or(n,r=>{const o=r.get(t);o&&e(o)}))}function au(t,e){jd.set(RT,n=>Or(n,r=>{if(!e)return;const o=r.get(t);o?o.add(e):r.set(t,new Set([e]))}))}function uD(t){jd.set(hn,t)}function Gh(t,e){const n={type:"error",text:t,partId:"0"},r=Math.random().toString(),o={id:r,createdAt:new Date().toISOString(),author:"ai",content:[n],mode:"chat"};au(e,r),Dt(e,i=>{i.push(o)}),ki(e,i=>{i.streamingState="idle"})}function gZ(t){if($g())for(const e of t.content)e.type==="activity"&&e.activity.status==="running"&&(e.activity.status="completed")}function dD(t){ki(t,e=>{e.sideBySideComparisonId=void 0})}function hD(t,e){const n=!e;Dt(t,r=>{const[o,i]=r.slice(-2);if(!(Ca(i)&&Ca(o)))return;const a=n?!i.sideBySideConfig.isDefault:i.id!==e,l=n?!o.sideBySideConfig.isDefault:o.id!==e;a?r.splice(r.length-1,1):l&&r.splice(r.length-2,1)})}function vZ(t,e){hD(t,e),dD(t)}function YT(t){hD(t,void 0),dD(t)}function fD(t){var a,l;const{id:e,shouldNavigateToChat:n=!0,shouldClearParentConversation:r=!0}=t;r&&Ue(it)!==Ue(zg)&&En(zg,null),En(it,e),En(Dd,!1),En(bn,u=>Or(u,h=>{const f=h.get(e);if(f!=null&&f.history.length&&(f.isNew=!1),f!=null&&f.history.some(p=>p.content.some(g=>g.type==="card"&&g.card.type==="ads"))){for(const p of f.history)if(p.author==="ai"&&p.content.some(g=>g.type==="card"&&g.card.type==="ads")){const g=p.content.filter(v=>v.type!=="card"||v.card.type!=="ads");p.content=g}}}));const o=Ue(xT);if(o&&o!==e&&En(bn,u=>Or(u,h=>{h.delete(o)})),((l=(a=lD(e))==null?void 0:a.part.task)==null?void 0:l.type)==="research")En(hn,"research");else{let u=Ng;ze("sticky-conversation-mode")&&(u=g5("sticky-conversation-mode")??Ng),En(hn,u)}const s=Ue(di);iD(s,e)?En(Lr,"side-by-side"):En(Lr,"chat-only"),n&&cZ({conversationId:e})}function yZ(){return t=>fD(t)}const pD=P(null),pt=t=>typeof t=="string",Sh=()=>{let t,e;const n=new Promise((r,o)=>{t=r,e=o});return n.resolve=t,n.reject=e,n},Ix=t=>t==null?"":""+t,bZ=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},CZ=/###/g,Ex=t=>t&&t.indexOf("###")>-1?t.replace(CZ,"."):t,Tx=t=>!t||pt(t),sf=(t,e,n)=>{const r=pt(e)?e.split("."):e;let o=0;for(;o<r.length-1;){if(Tx(t))return{};const i=Ex(r[o]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++o}return Tx(t)?{}:{obj:t,k:Ex(r[o])}},wx=(t,e,n)=>{const{obj:r,k:o}=sf(t,e,Object);if(r!==void 0||e.length===1){r[o]=n;return}let i=e[e.length-1],s=e.slice(0,e.length-1),a=sf(t,s,Object);for(;a.obj===void 0&&s.length;)i=`${s[s.length-1]}.${i}`,s=s.slice(0,s.length-1),a=sf(t,s,Object),a&&a.obj&&typeof a.obj[`${a.k}.${i}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${i}`]=n},SZ=(t,e,n,r)=>{const{obj:o,k:i}=sf(t,e,Object);o[i]=o[i]||[],o[i].push(n)},Gg=(t,e)=>{const{obj:n,k:r}=sf(t,e);if(n)return n[r]},IZ=(t,e,n)=>{const r=Gg(t,n);return r!==void 0?r:Gg(e,n)},mD=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?pt(t[r])||t[r]instanceof String||pt(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):mD(t[r],e[r],n):t[r]=e[r]);return t},Vl=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var EZ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const TZ=t=>pt(t)?t.replace(/[&<>"'\/]/g,e=>EZ[e]):t;class wZ{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const _Z=[" ",",","?","!",";"],AZ=new wZ(20),kZ=(t,e,n)=>{e=e||"",n=n||"";const r=_Z.filter(s=>e.indexOf(s)<0&&n.indexOf(s)<0);if(r.length===0)return!0;const o=AZ.getRegExp(`(${r.map(s=>s==="?"?"\\?":s).join("|")})`);let i=!o.test(t);if(!i){const s=t.indexOf(n);s>0&&!o.test(t.substring(0,s))&&(i=!0)}return i},R1=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const r=e.split(n);let o=t;for(let i=0;i<r.length;){if(!o||typeof o!="object")return;let s,a="";for(let l=i;l<r.length;++l)if(l!==i&&(a+=n),a+=r[l],s=o[a],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&l<r.length-1)continue;i+=l-i+1;break}o=s}return o},Kg=t=>t&&t.replace("_","-"),xZ={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};let RZ=class N1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||xZ,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,o){return o&&!this.debug?null:(pt(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new N1(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new N1(this.logger,e)}};var Hi=new RZ;class Wy{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const o=this.observers[r].get(n)||0;this.observers[r].set(n,o+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(s=>{let[a,l]=s;for(let u=0;u<l;u++)a(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(s=>{let[a,l]=s;for(let u=0;u<l;u++)a.apply(a,[e,...r])})}}class _x extends Wy{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,s=o.ignoreJSONStructure!==void 0?o.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,n],r&&(Array.isArray(r)?a.push(...r):pt(r)&&i?a.push(...r.split(i)):a.push(r)));const l=Gg(this.data,a);return!l&&!n&&!r&&e.indexOf(".")>-1&&(e=a[0],n=a[1],r=a.slice(2).join(".")),l||!s||!pt(r)?l:R1(this.data&&this.data[e]&&this.data[e][n],r,i)}addResource(e,n,r,o){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let a=[e,n];r&&(a=a.concat(s?r.split(s):r)),e.indexOf(".")>-1&&(a=e.split("."),o=n,n=a[1]),this.addNamespaces(n),wx(this.data,a,o),i.silent||this.emit("added",e,n,r,o)}addResources(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in r)(pt(r[i])||Array.isArray(r[i]))&&this.addResource(e,n,i,r[i],{silent:!0});o.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,o,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},a=[e,n];e.indexOf(".")>-1&&(a=e.split("."),o=r,r=n,n=a[1]),this.addNamespaces(n);let l=Gg(this.data,a)||{};s.skipCopy||(r=JSON.parse(JSON.stringify(r))),o?mD(l,r,i):l={...l,...r},wx(this.data,a,l),s.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(o=>n[o]&&Object.keys(n[o]).length>0)}toJSON(){return this.data}}var gD={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,o){return t.forEach(i=>{this.processors[i]&&(e=this.processors[i].process(e,n,r,o))}),e}};const Ax={};class qg extends Wy{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),bZ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Hi.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,n);return r&&r.res!==void 0}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const o=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const s=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!kZ(e,r,o);if(s&&!a){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:i};const u=e.split(r);(r!==o||r===o&&this.options.ns.indexOf(u[0])>-1)&&(i=u.shift()),e=u.join(o)}return pt(i)&&(i=[i]),{key:e,namespaces:i}}translate(e,n,r){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const o=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:s,namespaces:a}=this.extractFromKey(e[e.length-1],n),l=a[a.length-1],u=n.lng||this.language,h=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(h){const E=n.nsSeparator||this.options.nsSeparator;return o?{res:`${l}${E}${s}`,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${E}${s}`}return o?{res:s,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:s}const f=this.resolve(e,n);let p=f&&f.res;const g=f&&f.usedKey||s,v=f&&f.exactUsedKey||s,y=Object.prototype.toString.apply(p),b=["[object Number]","[object Function]","[object RegExp]"],C=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,I=!pt(p)&&typeof p!="boolean"&&typeof p!="number";if(S&&p&&I&&b.indexOf(y)<0&&!(pt(C)&&Array.isArray(p))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const E=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,p,{...n,ns:a}):`key '${s} (${this.language})' returned an object instead of string.`;return o?(f.res=E,f.usedParams=this.getUsedParamsDetails(n),f):E}if(i){const E=Array.isArray(p),T=E?[]:{},w=E?v:g;for(const A in p)if(Object.prototype.hasOwnProperty.call(p,A)){const _=`${w}${i}${A}`;T[A]=this.translate(_,{...n,joinArrays:!1,ns:a}),T[A]===_&&(T[A]=p[A])}p=T}}else if(S&&pt(C)&&Array.isArray(p))p=p.join(C),p&&(p=this.extendTranslation(p,e,n,r));else{let E=!1,T=!1;const w=n.count!==void 0&&!pt(n.count),A=qg.hasDefaultValue(n),_=w?this.pluralResolver.getSuffix(u,n.count,n):"",L=n.ordinal&&w?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",N=w&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),K=N&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${_}`]||n[`defaultValue${L}`]||n.defaultValue;!this.isValidLookup(p)&&A&&(E=!0,p=K),this.isValidLookup(p)||(T=!0,p=s);const ae=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&T?void 0:p,O=A&&K!==p&&this.options.updateMissing;if(T||E||O){if(this.logger.log(O?"updateKey":"missingKey",u,l,s,O?K:p),i){const G=this.resolve(s,{...n,keySeparator:!1});G&&G.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let W=[];const te=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&te&&te[0])for(let G=0;G<te.length;G++)W.push(te[G]);else this.options.saveMissingTo==="all"?W=this.languageUtils.toResolveHierarchy(n.lng||this.language):W.push(n.lng||this.language);const D=(G,re,J)=>{const ne=A&&J!==p?J:ae;this.options.missingKeyHandler?this.options.missingKeyHandler(G,l,re,ne,O,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(G,l,re,ne,O,n),this.emit("missingKey",G,l,re,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&w?W.forEach(G=>{const re=this.pluralResolver.getSuffixes(G,n);N&&n[`defaultValue${this.options.pluralSeparator}zero`]&&re.indexOf(`${this.options.pluralSeparator}zero`)<0&&re.push(`${this.options.pluralSeparator}zero`),re.forEach(J=>{D([G],s+J,n[`defaultValue${J}`]||K)})}):D(W,s,K))}p=this.extendTranslation(p,e,n,f,r),T&&p===s&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${s}`),(T||E)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${s}`:s,E?p:void 0):p=this.options.parseMissingKeyHandler(p))}return o?(f.res=p,f.usedParams=this.getUsedParamsDetails(n),f):p}extendTranslation(e,n,r,o,i){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=pt(e)&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let h;if(u){const p=e.match(this.interpolator.nestingRegexp);h=p&&p.length}let f=r.replace&&!pt(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,r.lng||this.language||o.usedLng,r),u){const p=e.match(this.interpolator.nestingRegexp),g=p&&p.length;h<g&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&o&&o.res&&(r.lng=this.language||o.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var p=arguments.length,g=new Array(p),v=0;v<p;v++)g[v]=arguments[v];return i&&i[0]===g[0]&&!r.context?(s.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${n[0]}`),null):s.translate(...g,n)},r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,l=pt(a)?[a]:a;return e!=null&&l&&l.length&&r.applyPostProcessor!==!1&&(e=gD.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...o,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,o,i,s,a;return pt(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(l,n),h=u.key;o=h;let f=u.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=n.count!==void 0&&!pt(n.count),g=p&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),v=n.context!==void 0&&(pt(n.context)||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);f.forEach(b=>{this.isValidLookup(r)||(a=b,!Ax[`${y[0]}-${b}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(a)&&(Ax[`${y[0]}-${b}`]=!0,this.logger.warn(`key "${o}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(C=>{if(this.isValidLookup(r))return;s=C;const S=[h];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(S,h,C,b,n);else{let E;p&&(E=this.pluralResolver.getSuffix(C,n.count,n));const T=`${this.options.pluralSeparator}zero`,w=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(S.push(h+E),n.ordinal&&E.indexOf(w)===0&&S.push(h+E.replace(w,this.options.pluralSeparator)),g&&S.push(h+T)),v){const A=`${h}${this.options.contextSeparator}${n.context}`;S.push(A),p&&(S.push(A+E),n.ordinal&&E.indexOf(w)===0&&S.push(A+E.replace(w,this.options.pluralSeparator)),g&&S.push(A+T))}}let I;for(;I=S.pop();)this.isValidLookup(r)||(i=I,r=this.getResource(C,b,I,n))}))})}),{res:r,usedKey:o,exactUsedKey:i,usedLng:s,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,r,o):this.resourceStore.getResource(e,n,r,o)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!pt(e.replace);let o=r?e.replace:e;if(r&&typeof e.count<"u"&&(o.count=e.count),this.options.interpolation.defaultVariables&&(o={...this.options.interpolation.defaultVariables,...o}),!r){o={...o};for(const i of n)delete o[i]}return o}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}const GC=t=>t.charAt(0).toUpperCase()+t.slice(1);class kx{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Hi.create("languageUtils")}getScriptPartFromCode(e){if(e=Kg(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Kg(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(pt(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let o=Intl.getCanonicalLocales(e)[0];if(o&&this.options.lowerCaseLng&&(o=o.toLowerCase()),o)return o}catch{}const n=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(o=>o.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=GC(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=GC(r[1].toLowerCase())),n.indexOf(r[2].toLowerCase())>-1&&(r[2]=GC(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const o=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(o))&&(n=o)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const o=this.getLanguagePartFromCode(r);if(this.isSupportedCode(o))return n=o;n=this.options.supportedLngs.find(i=>{if(i===o)return i;if(!(i.indexOf("-")<0&&o.indexOf("-")<0)&&(i.indexOf("-")>0&&o.indexOf("-")<0&&i.substring(0,i.indexOf("-"))===o||i.indexOf(o)===0&&o.length>1))return i})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),pt(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes(n||this.options.fallbackLng||[],e),o=[],i=s=>{s&&(this.isSupportedCode(s)?o.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return pt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):pt(e)&&i(this.formatLanguageCode(e)),r.forEach(s=>{o.indexOf(s)<0&&i(this.formatLanguageCode(s))}),o}}let NZ=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],PZ={1:t=>+(t>1),2:t=>+(t!=1),3:t=>0,4:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,5:t=>t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5,6:t=>t==1?0:t>=2&&t<=4?1:2,7:t=>t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,8:t=>t==1?0:t==2?1:t!=8&&t!=11?2:3,9:t=>+(t>=2),10:t=>t==1?0:t==2?1:t<7?2:t<11?3:4,11:t=>t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3,12:t=>+(t%10!=1||t%100==11),13:t=>+(t!==0),14:t=>t==1?0:t==2?1:t==3?2:3,15:t=>t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2,16:t=>t%10==1&&t%100!=11?0:t!==0?1:2,17:t=>t==1||t%10==1&&t%100!=11?0:1,18:t=>t==0?0:t==1?1:2,19:t=>t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3,20:t=>t==1?0:t==0||t%100>0&&t%100<20?1:2,21:t=>t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0,22:t=>t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3};const MZ=["v1","v2","v3"],OZ=["v4"],xx={zero:0,one:1,two:2,few:3,many:4,other:5},LZ=()=>{const t={};return NZ.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:PZ[e.fc]}})}),t};class DZ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=Hi.create("pluralResolver"),(!this.options.compatibilityJSON||OZ.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=LZ(),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{const r=Kg(e==="dev"?"en":e),o=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:o});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];const s=new Intl.PluralRules(r,{type:o});return this.pluralRulesCache[i]=s,s}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(o=>`${n}${o}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((o,i)=>xx[o]-xx[i]).map(o=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${o}`):r.numbers.map(o=>this.getSuffix(e,o,n)):[]}getSuffix(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.getRule(e,r);return o?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${o.select(n)}`:this.getSuffixRetroCompatible(o,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const r=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let o=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(o===2?o="plural":o===1&&(o=""));const i=()=>this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString();return this.options.compatibilityJSON==="v1"?o===1?"":typeof o=="number"?`_plural_${o.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!MZ.includes(this.options.compatibilityJSON)}}const Rx=function(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=IZ(t,e,n);return!i&&o&&pt(n)&&(i=R1(t,n,r),i===void 0&&(i=R1(e,n,r))),i},KC=t=>t.replace(/\$/g,"$$$$");class jZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Hi.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:o,prefix:i,prefixEscaped:s,suffix:a,suffixEscaped:l,formatSeparator:u,unescapeSuffix:h,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:g,nestingSuffix:v,nestingSuffixEscaped:y,nestingOptionsSeparator:b,maxReplaces:C,alwaysFormat:S}=e.interpolation;this.escape=n!==void 0?n:TZ,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=o!==void 0?o:!1,this.prefix=i?Vl(i):s||"{{",this.suffix=a?Vl(a):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=h?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=p?Vl(p):g||Vl("$t("),this.nestingSuffix=v?Vl(v):y||Vl(")"),this.nestingOptionsSeparator=b||",",this.maxReplaces=C||1e3,this.alwaysFormat=S!==void 0?S:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n&&n.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,r,o){let i,s,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=g=>{if(g.indexOf(this.formatSeparator)<0){const C=Rx(n,l,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(C,void 0,r,{...o,...n,interpolationkey:g}):C}const v=g.split(this.formatSeparator),y=v.shift().trim(),b=v.join(this.formatSeparator).trim();return this.format(Rx(n,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),b,r,{...o,...n,interpolationkey:y})};this.resetRegExp();const h=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,f=o&&o.interpolation&&o.interpolation.skipOnVariables!==void 0?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>KC(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?KC(this.escape(g)):KC(g)}].forEach(g=>{for(a=0;i=g.regex.exec(e);){const v=i[1].trim();if(s=u(v),s===void 0)if(typeof h=="function"){const b=h(e,i,o);s=pt(b)?b:""}else if(o&&Object.prototype.hasOwnProperty.call(o,v))s="";else if(f){s=i[0];continue}else this.logger.warn(`missed to pass in variable ${v} for interpolating ${e}`),s="";else!pt(s)&&!this.useRawValueToEscape&&(s=Ix(s));const y=g.safeValue(s);if(e=e.replace(i[0],y),f?(g.regex.lastIndex+=s.length,g.regex.lastIndex-=i[0].length):g.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o,i,s;const a=(l,u)=>{const h=this.nestingOptionsSeparator;if(l.indexOf(h)<0)return l;const f=l.split(new RegExp(`${h}[ ]*{`));let p=`{${f[1]}`;l=f[0],p=this.interpolate(p,s);const g=p.match(/'/g),v=p.match(/"/g);(g&&g.length%2===0&&!v||v.length%2!==0)&&(p=p.replace(/'/g,'"'));try{s=JSON.parse(p),u&&(s={...u,...s})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${h}${p}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,l};for(;o=this.nestingRegexp.exec(e);){let l=[];s={...r},s=s.replace&&!pt(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let u=!1;if(o[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(o[1])){const h=o[1].split(this.formatSeparator).map(f=>f.trim());o[1]=h.shift(),l=h,u=!0}if(i=n(a.call(this,o[1].trim(),s),s),i&&o[0]===e&&!pt(i))return i;pt(i)||(i=Ix(i)),i||(this.logger.warn(`missed to resolve ${o[1]} for nesting ${e}`),i=""),u&&(i=l.reduce((h,f)=>this.format(h,f,r.lng,{...r,interpolationkey:o[1].trim()}),i.trim())),e=e.replace(o[0],i),this.regexp.lastIndex=0}return e}}const UZ=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const o=r[1].substring(0,r[1].length-1);e==="currency"&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):e==="relativetime"&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach(s=>{if(s){const[a,...l]=s.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),h=a.trim();n[h]||(n[h]=u),u==="false"&&(n[h]=!1),u==="true"&&(n[h]=!0),isNaN(u)||(n[h]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},$l=t=>{const e={};return(n,r,o)=>{let i=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(i={...i,[o.interpolationkey]:void 0});const s=r+JSON.stringify(i);let a=e[s];return a||(a=t(Kg(r),o),e[s]=a),a(n)}};class FZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Hi.create("formatter"),this.options=e,this.formats={number:$l((n,r)=>o=>new Intl.NumberFormat(n,{...r}).format(o)),currency:$l((n,r)=>o=>new Intl.NumberFormat(n,{...r,style:"currency"}).format(o)),datetime:$l((n,r)=>o=>new Intl.DateTimeFormat(n,{...r}).format(o)),relativetime:$l((n,r)=>o=>new Intl.RelativeTimeFormat(n,{...r}).format(o,r.range||"day")),list:$l((n,r)=>o=>new Intl.ListFormat(n,{...r}).format(o))},this.init(e)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=$l(n)}format(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(a=>a.indexOf(")")>-1)){const a=i.findIndex(l=>l.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,a)].join(this.formatSeparator)}return i.reduce((a,l)=>{const{formatName:u,formatOptions:h}=UZ(l);if(this.formats[u]){let f=a;try{const p=o&&o.formatParams&&o.formatParams[o.interpolationkey]||{},g=p.locale||p.lng||o.locale||o.lng||r;f=this.formats[u](a,g,{...h,...o,...p})}catch(p){this.logger.warn(p)}return f}else this.logger.warn(`there was no format function for ${u}`);return a},e)}}const BZ=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class HZ extends Wy{constructor(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=o,this.logger=Hi.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=o.maxParallelReads||10,this.readingCalls=0,this.maxRetries=o.maxRetries>=0?o.maxRetries:5,this.retryTimeout=o.retryTimeout>=1?o.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,o.backend,o)}queueLoad(e,n,r,o){const i={},s={},a={},l={};return e.forEach(u=>{let h=!0;n.forEach(f=>{const p=`${u}|${f}`;!r.reload&&this.store.hasResourceBundle(u,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?s[p]===void 0&&(s[p]=!0):(this.state[p]=1,h=!1,s[p]===void 0&&(s[p]=!0),i[p]===void 0&&(i[p]=!0),l[f]===void 0&&(l[f]=!0)))}),h||(a[u]=!0)}),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:o}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,n,r){const o=e.split("|"),i=o[0],s=o[1];n&&this.emit("failedLoading",i,s,n),!n&&r&&this.store.addResourceBundle(i,s,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const a={};this.queue.forEach(l=>{SZ(l.loaded,[i],s),BZ(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{a[u]||(a[u]={});const h=l.loaded[u];h.length&&h.forEach(f=>{a[u][f]===void 0&&(a[u][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:o,wait:i,callback:s});return}this.readingCalls++;const a=(u,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(u&&h&&o<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,o+1,i*2,s)},i);return}s(u,h)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const u=l(e,n);u&&typeof u.then=="function"?u.then(h=>a(null,h)).catch(a):a(null,u)}catch(u){a(u)}return}return l(e,n,a)}prepareLoading(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();pt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),pt(n)&&(n=[n]);const i=this.queueLoad(e,n,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach(s=>{this.loadOne(s)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(s,a)=>{s&&this.logger.warn(`${n}loading namespace ${i} for language ${o} failed`,s),!s&&a&&this.logger.log(`${n}loaded namespace ${i} for language ${o}`,a),this.loaded(e,s,a)})}saveMissing(e,n,r,o,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const l={...s,isUpdate:i},u=this.backend.create.bind(this.backend);if(u.length<6)try{let h;u.length===5?h=u(e,n,r,o,l):h=u(e,n,r,o),h&&typeof h.then=="function"?h.then(f=>a(null,f)).catch(a):a(null,h)}catch(h){a(h)}else u(e,n,r,o,a,l)}!e||!e[0]||this.store.addResource(e[0],n,r,o)}}}const Nx=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),pt(t[1])&&(e.defaultValue=t[1]),pt(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Px=t=>(pt(t.ns)&&(t.ns=[t.ns]),pt(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),pt(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t),cm=()=>{},zZ=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Hf extends Wy{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Px(e),this.services={},this.logger=Hi,this.modules={external:[]},zZ(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(r=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(pt(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const o=Nx();this.options={...o,...this.options,...Px(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...o.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const i=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?Hi.init(i(this.modules.logger),this.options):Hi.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:typeof Intl<"u"&&(h=FZ);const f=new kx(this.options);this.store=new _x(this.options.resources,this.options);const p=this.services;p.logger=Hi,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new DZ(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),h&&(!this.options.interpolation.format||this.options.interpolation.format===o.interpolation.format)&&(p.formatter=i(h),p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new jZ(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new HZ(i(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",function(g){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];e.emit(g,...y)}),this.modules.languageDetector&&(p.languageDetector=i(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=i(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new qg(this.services,this.options),this.translator.on("*",function(g){for(var v=arguments.length,y=new Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];e.emit(g,...y)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,r||(r=cm),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=function(){return e.store[h](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=function(){return e.store[h](...arguments),e}});const l=Sh(),u=()=>{const h=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),r(f,p)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cm;const o=pt(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&o.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],s=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(u=>{u!=="cimode"&&i.indexOf(u)<0&&i.push(u)})};o?s(o):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>s(l)),this.options.preload&&this.options.preload.forEach(a=>s(a)),this.services.backendConnector.load(i,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(a)})}else r(null)}reloadResources(e,n,r){const o=Sh();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=cm),this.services.backendConnector.reload(e,n,i=>{o.resolve(),r(i)}),o}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&gD.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,n){var r=this;this.isLanguageChangingTo=e;const o=Sh();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},s=(l,u)=>{u?(i(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,o.resolve(function(){return r.t(...arguments)}),n&&n(l,function(){return r.t(...arguments)})},a=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=pt(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,h=>{s(h,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),o}getFixedT(e,n,r){var o=this;const i=function(s,a){let l;if(typeof a!="object"){for(var u=arguments.length,h=new Array(u>2?u-2:0),f=2;f<u;f++)h[f-2]=arguments[f];l=o.options.overloadTranslationOptionHandler([s,a].concat(h))}else l={...a};l.lng=l.lng||i.lng,l.lngs=l.lngs||i.lngs,l.ns=l.ns||i.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||i.keyPrefix);const p=o.options.keySeparator||".";let g;return l.keyPrefix&&Array.isArray(s)?g=s.map(v=>`${l.keyPrefix}${p}${v}`):g=l.keyPrefix?`${l.keyPrefix}${p}${s}`:s,o.t(g,l)};return pt(e)?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=r,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],o=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const s=(a,l)=>{const u=this.services.backendConnector.state[`${a}|${l}`];return u===-1||u===0||u===2};if(n.precheck){const a=n.precheck(this,s);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(r,e)&&(!o||s(i,e)))}loadNamespaces(e,n){const r=Sh();return this.options.ns?(pt(e)&&(e=[e]),e.forEach(o=>{this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=Sh();pt(e)&&(e=[e]);const o=this.options.preload||[],i=e.filter(s=>o.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return i.length?(this.options.preload=o.concat(i),this.loadResources(s=>{r.resolve(),n&&n(s)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new kx(Nx());return n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new Hf(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cm;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const o={...this.options,...e,isClone:!0},i=new Hf(o);return(e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(a=>{i[a]=this[a]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r&&(i.store=new _x(this.store.data,o),i.services.resourceStore=i.store),i.translator=new qg(i.services,o),i.translator.on("*",function(a){for(var l=arguments.length,u=new Array(l>1?l-1:0),h=1;h<l;h++)u[h-1]=arguments[h];i.emit(a,...u)}),i.init(o,n),i.translator.options=o,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Rt=Hf.createInstance();Rt.createInstance=Hf.createInstance;Rt.createInstance;Rt.dir;Rt.init;Rt.loadResources;Rt.reloadResources;Rt.use;Rt.changeLanguage;Rt.getFixedT;const ee=Rt.t,dNe=Rt.exists;Rt.setDefaultNamespace;Rt.hasLoadedNamespace;Rt.loadNamespaces;Rt.loadLanguages;const sc={UNDEFINED:"0",CHILD:"1",ADULT:"3",NOT_ADULT:"4",CHILD_NO_PARENTAL_CONSENT_REQUIRED:"5"},VZ=c.object({name:c.string(),email:c.string(),ageGroup:c.enum([sc.UNDEFINED,sc.CHILD,sc.ADULT,sc.NOT_ADULT,sc.CHILD_NO_PARENTAL_CONSENT_REQUIRED]),sub:c.string()}),lo={LOGIN_START:"auth0:loginStart",LOGIN_SUCCESS:"auth0:loginSuccess",LOGIN_FAILURE:"auth0:loginFailure",LOGOUT_SUCCESS:"auth0:logoutSuccess",LOGOUT_FAILURE:"auth0:logoutFailure",ACQUIRE_TOKEN_FAILURE:"auth0:acquireTokenFailure",REAUTH_START:"auth0:reauthStart",REAUTH_SUCCESS:"auth0:reauthSuccess",INITIALIZE_START:"auth0:initializeStart",INITIALIZE_END:"auth0:initializeEnd",ACQUIRE_TOKEN_OVERALL_SUCCESS:"auth0:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"auth0:acquireTokenOverallFailure"},Wg={ACQUIRE_TOKEN_OVERALL_SUCCESS:"msal:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"msal:acquireTokenOverallFailure",INTERACTION_IN_PROGRESS:"msal:interactionInProgress"};function Mi(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}var ac=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function JT(t,e){return t(e={exports:{}},e.exports),e.exports}var tc=JT(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(){var o=this;this.locked=new Map,this.addToLocked=function(i,s){var a=o.locked.get(i);a===void 0?s===void 0?o.locked.set(i,[]):o.locked.set(i,[s]):s!==void 0&&(a.unshift(s),o.locked.set(i,a))},this.isLocked=function(i){return o.locked.has(i)},this.lock=function(i){return new Promise(function(s,a){o.isLocked(i)?o.addToLocked(i,s):(o.addToLocked(i),s())})},this.unlock=function(i){var s=o.locked.get(i);if(s!==void 0&&s.length!==0){var a=s.pop();o.locked.set(i,s),a!==void 0&&setTimeout(a,0)}else o.locked.delete(i)}}return r.getInstance=function(){return r.instance===void 0&&(r.instance=new r),r.instance},r}();e.default=function(){return n.getInstance()}});QT(tc);var $Z=QT(JT(function(t,e){var n=ac&&ac.__awaiter||function(h,f,p,g){return new(p||(p=Promise))(function(v,y){function b(I){try{S(g.next(I))}catch(E){y(E)}}function C(I){try{S(g.throw(I))}catch(E){y(E)}}function S(I){I.done?v(I.value):new p(function(E){E(I.value)}).then(b,C)}S((g=g.apply(h,f||[])).next())})},r=ac&&ac.__generator||function(h,f){var p,g,v,y,b={label:0,sent:function(){if(1&v[0])throw v[1];return v[1]},trys:[],ops:[]};return y={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function C(S){return function(I){return function(E){if(p)throw new TypeError("Generator is already executing.");for(;b;)try{if(p=1,g&&(v=2&E[0]?g.return:E[0]?g.throw||((v=g.return)&&v.call(g),0):g.next)&&!(v=v.call(g,E[1])).done)return v;switch(g=0,v&&(E=[2&E[0],v.value]),E[0]){case 0:case 1:v=E;break;case 4:return b.label++,{value:E[1],done:!1};case 5:b.label++,g=E[1],E=[0];continue;case 7:E=b.ops.pop(),b.trys.pop();continue;default:if(v=b.trys,!((v=v.length>0&&v[v.length-1])||E[0]!==6&&E[0]!==2)){b=0;continue}if(E[0]===3&&(!v||E[1]>v[0]&&E[1]<v[3])){b.label=E[1];break}if(E[0]===6&&b.label<v[1]){b.label=v[1],v=E;break}if(v&&b.label<v[2]){b.label=v[2],b.ops.push(E);break}v[2]&&b.ops.pop(),b.trys.pop();continue}E=f.call(h,b)}catch(T){E=[6,T],g=0}finally{p=v=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([S,I])}}},o=ac;Object.defineProperty(e,"__esModule",{value:!0});var i="browser-tabs-lock-key",s={key:function(h){return n(o,void 0,void 0,function(){return r(this,function(f){throw new Error("Unsupported")})})},getItem:function(h){return n(o,void 0,void 0,function(){return r(this,function(f){throw new Error("Unsupported")})})},clear:function(){return n(o,void 0,void 0,function(){return r(this,function(h){return[2,window.localStorage.clear()]})})},removeItem:function(h){return n(o,void 0,void 0,function(){return r(this,function(f){throw new Error("Unsupported")})})},setItem:function(h,f){return n(o,void 0,void 0,function(){return r(this,function(p){throw new Error("Unsupported")})})},keySync:function(h){return window.localStorage.key(h)},getItemSync:function(h){return window.localStorage.getItem(h)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(h){return window.localStorage.removeItem(h)},setItemSync:function(h,f){return window.localStorage.setItem(h,f)}};function a(h){return new Promise(function(f){return setTimeout(f,h)})}function l(h){for(var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",p="",g=0;g<h;g++)p+=f[Math.floor(Math.random()*f.length)];return p}var u=function(){function h(f){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+l(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=f,h.waiters===void 0&&(h.waiters=[])}return h.prototype.acquireLock=function(f,p){return p===void 0&&(p=5e3),n(this,void 0,void 0,function(){var g,v,y,b,C,S,I;return r(this,function(E){switch(E.label){case 0:g=Date.now()+l(4),v=Date.now()+p,y=i+"-"+f,b=this.storageHandler===void 0?s:this.storageHandler,E.label=1;case 1:return Date.now()<v?[4,a(30)]:[3,8];case 2:return E.sent(),b.getItemSync(y)!==null?[3,5]:(C=this.id+"-"+f+"-"+g,[4,a(Math.floor(25*Math.random()))]);case 3:return E.sent(),b.setItemSync(y,JSON.stringify({id:this.id,iat:g,timeoutKey:C,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,a(30)];case 4:return E.sent(),(S=b.getItemSync(y))!==null&&(I=JSON.parse(S)).id===this.id&&I.iat===g?(this.acquiredIatSet.add(g),this.refreshLockWhileAcquired(y,g),[2,!0]):[3,7];case 5:return h.lockCorrector(this.storageHandler===void 0?s:this.storageHandler),[4,this.waitForSomethingToChange(v)];case 6:E.sent(),E.label=7;case 7:return g=Date.now()+l(4),[3,1];case 8:return[2,!1]}})})},h.prototype.refreshLockWhileAcquired=function(f,p){return n(this,void 0,void 0,function(){var g=this;return r(this,function(v){return setTimeout(function(){return n(g,void 0,void 0,function(){var y,b,C;return r(this,function(S){switch(S.label){case 0:return[4,tc.default().lock(p)];case 1:return S.sent(),this.acquiredIatSet.has(p)?(y=this.storageHandler===void 0?s:this.storageHandler,(b=y.getItemSync(f))===null?(tc.default().unlock(p),[2]):((C=JSON.parse(b)).timeRefreshed=Date.now(),y.setItemSync(f,JSON.stringify(C)),tc.default().unlock(p),this.refreshLockWhileAcquired(f,p),[2])):(tc.default().unlock(p),[2])}})})},1e3),[2]})})},h.prototype.waitForSomethingToChange=function(f){return n(this,void 0,void 0,function(){return r(this,function(p){switch(p.label){case 0:return[4,new Promise(function(g){var v=!1,y=Date.now(),b=!1;function C(){if(b||(window.removeEventListener("storage",C),h.removeFromWaiting(C),clearTimeout(S),b=!0),!v){v=!0;var I=50-(Date.now()-y);I>0?setTimeout(g,I):g(null)}}window.addEventListener("storage",C),h.addToWaiting(C);var S=setTimeout(C,Math.max(0,f-Date.now()))})];case 1:return p.sent(),[2]}})})},h.addToWaiting=function(f){this.removeFromWaiting(f),h.waiters!==void 0&&h.waiters.push(f)},h.removeFromWaiting=function(f){h.waiters!==void 0&&(h.waiters=h.waiters.filter(function(p){return p!==f}))},h.notifyWaiters=function(){h.waiters!==void 0&&h.waiters.slice().forEach(function(f){return f()})},h.prototype.releaseLock=function(f){return n(this,void 0,void 0,function(){return r(this,function(p){switch(p.label){case 0:return[4,this.releaseLock__private__(f)];case 1:return[2,p.sent()]}})})},h.prototype.releaseLock__private__=function(f){return n(this,void 0,void 0,function(){var p,g,v,y;return r(this,function(b){switch(b.label){case 0:return p=this.storageHandler===void 0?s:this.storageHandler,g=i+"-"+f,(v=p.getItemSync(g))===null?[2]:(y=JSON.parse(v)).id!==this.id?[3,2]:[4,tc.default().lock(y.iat)];case 1:b.sent(),this.acquiredIatSet.delete(y.iat),p.removeItemSync(g),tc.default().unlock(y.iat),h.notifyWaiters(),b.label=2;case 2:return[2]}})})},h.lockCorrector=function(f){for(var p=Date.now()-5e3,g=f,v=[],y=0;;){var b=g.keySync(y);if(b===null)break;v.push(b),y++}for(var C=!1,S=0;S<v.length;S++){var I=v[S];if(I.includes(i)){var E=g.getItemSync(I);if(E!==null){var T=JSON.parse(E);(T.timeRefreshed===void 0&&T.timeAcquired<p||T.timeRefreshed!==void 0&&T.timeRefreshed<p)&&(g.removeItemSync(I),C=!0)}}}C&&h.notifyWaiters()},h.waiters=void 0,h}();e.default=u}));const GZ={timeoutInSeconds:60},vD={name:"auth0-spa-js",version:"2.1.3"},yD=()=>Date.now();class Zn extends Error{constructor(e,n){super(n),this.error=e,this.error_description=n,Object.setPrototypeOf(this,Zn.prototype)}static fromPayload({error:e,error_description:n}){return new Zn(e,n)}}let KZ=class bD extends Zn{constructor(e,n,r,o=null){super(e,n),this.state=r,this.appState=o,Object.setPrototypeOf(this,bD.prototype)}},P1=class CD extends Zn{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,CD.prototype)}},qZ=class SD extends P1{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,SD.prototype)}},WZ=class ID extends Zn{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,ID.prototype)}},YZ=class ED extends Zn{constructor(e,n,r){super(e,n),this.mfa_token=r,Object.setPrototypeOf(this,ED.prototype)}},TD=class wD extends Zn{constructor(e,n){super("missing_refresh_token",`Missing Refresh Token (audience: '${Mx(e,["default"])}', scope: '${Mx(n)}')`),this.audience=e,this.scope=n,Object.setPrototypeOf(this,wD.prototype)}};function Mx(t,e=[]){return t&&!e.includes(t)?t:""}const tg=()=>window.crypto,qC=()=>{const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let e="";return Array.from(tg().getRandomValues(new Uint8Array(43))).forEach(n=>e+=t[n%t.length]),e},Ox=t=>btoa(t),M1=t=>{var{clientId:e}=t,n=Mi(t,["clientId"]);return new URLSearchParams((r=>Object.keys(r).filter(o=>r[o]!==void 0).reduce((o,i)=>Object.assign(Object.assign({},o),{[i]:r[i]}),{}))(Object.assign({client_id:e},n))).toString()},Lx=t=>(e=>decodeURIComponent(atob(e).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))(t.replace(/_/g,"/").replace(/-/g,"+")),QZ=async(t,e)=>{const n=await fetch(t,e);return{ok:n.ok,json:await n.json()}},JZ=async(t,e,n)=>{const r=new AbortController;let o;return e.signal=r.signal,Promise.race([QZ(t,e),new Promise((i,s)=>{o=setTimeout(()=>{r.abort(),s(new Error("Timeout when executing 'fetch'"))},n)})]).finally(()=>{clearTimeout(o)})},XZ=async(t,e,n,r,o,i,s)=>{return a={auth:{audience:e,scope:n},timeout:o,fetchUrl:t,fetchOptions:r,useFormData:s},l=i,new Promise(function(u,h){const f=new MessageChannel;f.port1.onmessage=function(p){p.data.error?h(new Error(p.data.error)):u(p.data),f.port1.close()},l.postMessage(a,[f.port2])});var a,l},ZZ=async(t,e,n,r,o,i,s=1e4)=>o?XZ(t,e,n,r,s,o,i):JZ(t,r,s);async function eee(t,e){var{baseUrl:n,timeout:r,audience:o,scope:i,auth0Client:s,useFormData:a}=t,l=Mi(t,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const u=a?M1(l):JSON.stringify(l);return await async function(h,f,p,g,v,y,b){let C,S=null;for(let _=0;_<3;_++)try{C=await ZZ(h,p,g,v,y,b,f),S=null;break}catch(L){S=L}if(S)throw S;const I=C.json,{error:E,error_description:T}=I,w=Mi(I,["error","error_description"]),{ok:A}=C;if(!A){const _=T||`HTTP error. Unable to fetch ${h}`;throw E==="mfa_required"?new YZ(E,_,w.mfa_token):E==="missing_refresh_token"?new TD(p,g):new Zn(E||"request_error",_)}return w}(`${n}/oauth/token`,r,o||"default",i,{method:"POST",body:u,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(s||vD))}},e,a)}const lm=(...t)=>{return(e=t.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(e))).join(" ");var e};let pc=class O1{constructor(e,n="@@auth0spajs@@",r){this.prefix=n,this.suffix=r,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){const[n,r,o,i]=e.split("::");return new O1({clientId:r,scope:i,audience:o},n)}static fromCacheEntry(e){const{scope:n,audience:r,client_id:o}=e;return new O1({scope:n,audience:r,clientId:o})}},tee=class{set(e,n){localStorage.setItem(e,JSON.stringify(n))}get(e){const n=window.localStorage.getItem(e);if(n)try{return JSON.parse(n)}catch{return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter(e=>e.startsWith("@@auth0spajs@@"))}},_D=class{constructor(){this.enclosedCache=function(){let e={};return{set(n,r){e[n]=r},get(n){const r=e[n];if(r)return r},remove(n){delete e[n]},allKeys:()=>Object.keys(e)}}()}},nee=class{constructor(e,n,r){this.cache=e,this.keyManifest=n,this.nowProvider=r||yD}async setIdToken(e,n,r){var o;const i=this.getIdTokenCacheKey(e);await this.cache.set(i,{id_token:n,decodedToken:r}),await((o=this.keyManifest)===null||o===void 0?void 0:o.add(i))}async getIdToken(e){const n=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!n&&e.scope&&e.audience){const r=await this.get(e);return!r||!r.id_token||!r.decodedToken?void 0:{id_token:r.id_token,decodedToken:r.decodedToken}}if(n)return{id_token:n.id_token,decodedToken:n.decodedToken}}async get(e,n=0){var r;let o=await this.cache.get(e.toKey());if(!o){const a=await this.getCacheKeys();if(!a)return;const l=this.matchExistingCacheKey(e,a);l&&(o=await this.cache.get(l))}if(!o)return;const i=await this.nowProvider(),s=Math.floor(i/1e3);return o.expiresAt-n<s?o.body.refresh_token?(o.body={refresh_token:o.body.refresh_token},await this.cache.set(e.toKey(),o),o.body):(await this.cache.remove(e.toKey()),void await((r=this.keyManifest)===null||r===void 0?void 0:r.remove(e.toKey()))):o.body}async set(e){var n;const r=new pc({clientId:e.client_id,scope:e.scope,audience:e.audience}),o=await this.wrapCacheEntry(e);await this.cache.set(r.toKey(),o),await((n=this.keyManifest)===null||n===void 0?void 0:n.add(r.toKey()))}async clear(e){var n;const r=await this.getCacheKeys();r&&(await r.filter(o=>!e||o.includes(e)).reduce(async(o,i)=>{await o,await this.cache.remove(i)},Promise.resolve()),await((n=this.keyManifest)===null||n===void 0?void 0:n.clear()))}async wrapCacheEntry(e){const n=await this.nowProvider();return{body:e,expiresAt:Math.floor(n/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?(e=await this.keyManifest.get())===null||e===void 0?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new pc({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,n){return n.filter(r=>{var o;const i=pc.fromKey(r),s=new Set(i.scope&&i.scope.split(" ")),a=((o=e.scope)===null||o===void 0?void 0:o.split(" "))||[],l=i.scope&&a.reduce((u,h)=>u&&s.has(h),!0);return i.prefix==="@@auth0spajs@@"&&i.clientId===e.clientId&&i.audience===e.audience&&l})[0]}},ree=class{constructor(e,n,r){this.storage=e,this.clientId=n,this.cookieDomain=r,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(e){this.storage.save(this.storageKey,e,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}};const Ih=t=>typeof t=="number",oee=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],iee=t=>{if(!t.id_token)throw new Error("ID token is required but missing");const e=(i=>{const s=i.split("."),[a,l,u]=s;if(s.length!==3||!a||!l||!u)throw new Error("ID token could not be decoded");const h=JSON.parse(Lx(l)),f={__raw:i},p={};return Object.keys(h).forEach(g=>{f[g]=h[g],oee.includes(g)||(p[g]=h[g])}),{encoded:{header:a,payload:l,signature:u},header:JSON.parse(Lx(a)),claims:f,user:p}})(t.id_token);if(!e.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(e.claims.iss!==t.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${t.iss}", found "${e.claims.iss}"`);if(!e.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if(e.header.alg!=="RS256")throw new Error(`Signature algorithm of "${e.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!e.claims.aud||typeof e.claims.aud!="string"&&!Array.isArray(e.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(e.claims.aud)){if(!e.claims.aud.includes(t.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but was not one of "${e.claims.aud.join(", ")}"`);if(e.claims.aud.length>1){if(!e.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(e.claims.azp!==t.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${t.aud}", found "${e.claims.azp}"`)}}else if(e.claims.aud!==t.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${t.aud}" but found "${e.claims.aud}"`);if(t.nonce){if(!e.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(e.claims.nonce!==t.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${t.nonce}", found "${e.claims.nonce}"`)}if(t.max_age&&!Ih(e.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(e.claims.exp==null||!Ih(e.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!Ih(e.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const n=t.leeway||60,r=new Date(t.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(e.claims.exp+n),r>o)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${r}) is after expiration time (${o})`);if(e.claims.nbf!=null&&Ih(e.claims.nbf)){const i=new Date(0);if(i.setUTCSeconds(e.claims.nbf-n),r<i)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${r}) is before ${i}`)}if(e.claims.auth_time!=null&&Ih(e.claims.auth_time)){const i=new Date(0);if(i.setUTCSeconds(parseInt(e.claims.auth_time)+t.max_age+n),r>i)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${r}) is after last auth at ${i}`)}if(t.organization){const i=t.organization.trim();if(i.startsWith("org_")){const s=i;if(!e.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(s!==e.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_id}"`)}else{const s=i.toLowerCase();if(!e.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(s!==e.claims.org_name)throw new Error(`Organization Name (org_name) claim mismatch in the ID token; expected "${s}", found "${e.claims.org_name}"`)}}return e};var mc=JT(function(t,e){var n=ac&&ac.__assign||function(){return n=Object.assign||function(l){for(var u,h=1,f=arguments.length;h<f;h++)for(var p in u=arguments[h])Object.prototype.hasOwnProperty.call(u,p)&&(l[p]=u[p]);return l},n.apply(this,arguments)};function r(l,u){if(!u)return"";var h="; "+l;return u===!0?h:h+"="+u}function o(l,u,h){return encodeURIComponent(l).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(u).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(f){if(typeof f.expires=="number"){var p=new Date;p.setMilliseconds(p.getMilliseconds()+864e5*f.expires),f.expires=p}return r("Expires",f.expires?f.expires.toUTCString():"")+r("Domain",f.domain)+r("Path",f.path)+r("Secure",f.secure)+r("SameSite",f.sameSite)}(h)}function i(l){for(var u={},h=l?l.split("; "):[],f=/(%[\dA-F]{2})+/gi,p=0;p<h.length;p++){var g=h[p].split("="),v=g.slice(1).join("=");v.charAt(0)==='"'&&(v=v.slice(1,-1));try{u[g[0].replace(f,decodeURIComponent)]=v.replace(f,decodeURIComponent)}catch{}}return u}function s(){return i(document.cookie)}function a(l,u,h){document.cookie=o(l,u,n({path:"/"},h))}e.__esModule=!0,e.encode=o,e.parse=i,e.getAll=s,e.get=function(l){return s()[l]},e.set=a,e.remove=function(l,u){a(l,"",n(n({},u),{expires:-1}))}});QT(mc),mc.encode,mc.parse,mc.getAll;var see=mc.get,AD=mc.set,kD=mc.remove;const cu={get(t){const e=see(t);if(e!==void 0)return JSON.parse(e)},save(t,e,n){let r={};window.location.protocol==="https:"&&(r={secure:!0,sameSite:"none"}),n!=null&&n.daysUntilExpire&&(r.expires=n.daysUntilExpire),n!=null&&n.cookieDomain&&(r.domain=n.cookieDomain),AD(t,JSON.stringify(e),r)},remove(t,e){let n={};e!=null&&e.cookieDomain&&(n.domain=e.cookieDomain),kD(t,n)}},aee={get(t){return cu.get(t)||cu.get(`_legacy_${t}`)},save(t,e,n){let r={};window.location.protocol==="https:"&&(r={secure:!0}),n!=null&&n.daysUntilExpire&&(r.expires=n.daysUntilExpire),n!=null&&n.cookieDomain&&(r.domain=n.cookieDomain),AD(`_legacy_${t}`,JSON.stringify(e),r),cu.save(t,e,n)},remove(t,e){let n={};e!=null&&e.cookieDomain&&(n.domain=e.cookieDomain),kD(t,n),cu.remove(t,e),cu.remove(`_legacy_${t}`,e)}},cee={get(t){if(typeof sessionStorage>"u")return;const e=sessionStorage.getItem(t);return e!=null?JSON.parse(e):void 0},save(t,e){sessionStorage.setItem(t,JSON.stringify(e))},remove(t){sessionStorage.removeItem(t)}};function lee(t,e,n){var r=e===void 0?null:e,o=function(l,u){var h=atob(l);if(u){for(var f=new Uint8Array(h.length),p=0,g=h.length;p<g;++p)f[p]=h.charCodeAt(p);return String.fromCharCode.apply(null,new Uint16Array(f.buffer))}return h}(t,n!==void 0&&n),i=o.indexOf(`
`,10)+1,s=o.substring(i)+(r?"//# sourceMappingURL="+r:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}var Dx,jx,Ux,WC,uee=(Dx="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",jx=null,Ux=!1,function(t){return WC=WC||lee(Dx,jx,Ux),new Worker(WC,t)});const YC={};let dee=class{constructor(e,n){this.cache=e,this.clientId=n,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var n;const r=new Set(((n=await this.cache.get(this.manifestKey))===null||n===void 0?void 0:n.keys)||[]);r.add(e),await this.cache.set(this.manifestKey,{keys:[...r]})}async remove(e){const n=await this.cache.get(this.manifestKey);if(n){const r=new Set(n.keys);return r.delete(e),r.size>0?await this.cache.set(this.manifestKey,{keys:[...r]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}};const hee={memory:()=>new _D().enclosedCache,localstorage:()=>new tee},Fx=t=>hee[t],Bx=t=>{const{openUrl:e,onRedirect:n}=t,r=Mi(t,["openUrl","onRedirect"]);return Object.assign(Object.assign({},r),{openUrl:e===!1||e?e:n})},QC=new $Z;let fee=class{constructor(e){let n,r;if(this.userCache=new _D().enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await QC.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),typeof window<"u"&&(()=>{if(!tg())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(tg().subtle===void 0)throw new Error(`
      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.
    `)})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)r=e.cache;else{if(n=e.cacheLocation||"memory",!Fx(n))throw new Error(`Invalid cache location "${n}"`);r=Fx(n)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=e.legacySameSiteCookie===!1?cu:aee,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(s=>`auth0.${s}.is.authenticated`)(this.options.clientId),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;const o=e.useCookiesForTransactions?this.cookieStorage:cee;var i;this.scope=lm("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new ree(o,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||yD,this.cacheManager=new nee(r,r.allKeys?void 0:new dee(r,this.options.clientId),this.nowProvider),this.domainUrl=(i=this.options.domain,/^https?:\/\//.test(i)?i:`https://${i}`),this.tokenIssuer=((s,a)=>s?s.startsWith("https://")?s:`https://${s}/`:`${a}/`)(this.options.issuer,this.domainUrl),typeof window<"u"&&window.Worker&&this.options.useRefreshTokens&&n==="memory"&&(this.options.workerUrl?this.worker=new Worker(this.options.workerUrl):this.worker=new uee)}_url(e){const n=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||vD)));return`${this.domainUrl}${e}&auth0Client=${n}`}_authorizeUrl(e){return this._url(`/authorize?${M1(e)}`)}async _verifyIdToken(e,n,r){const o=await this.nowProvider();return iee({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:n,organization:r,leeway:this.options.leeway,max_age:(i=this.options.authorizationParams.max_age,typeof i!="string"?i:parseInt(i,10)||void 0),now:o});var i}_processOrgHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,n,r){const o=Ox(qC()),i=Ox(qC()),s=qC(),a=(h=>{const f=new Uint8Array(h);return(p=>{const g={"+":"-","/":"_","=":""};return p.replace(/[+/=]/g,v=>g[v])})(window.btoa(String.fromCharCode(...Array.from(f))))})(await(async h=>await tg().subtle.digest({name:"SHA-256"},new TextEncoder().encode(h)))(s)),l=((h,f,p,g,v,y,b,C)=>Object.assign(Object.assign(Object.assign({client_id:h.clientId},h.authorizationParams),p),{scope:lm(f,p.scope),response_type:"code",response_mode:C||"query",state:g,nonce:v,redirect_uri:b||h.authorizationParams.redirect_uri,code_challenge:y,code_challenge_method:"S256"}))(this.options,this.scope,e,o,i,a,e.redirect_uri||this.options.authorizationParams.redirect_uri||r,n==null?void 0:n.response_mode),u=this._authorizeUrl(l);return{nonce:i,code_verifier:s,scope:l.scope,audience:l.audience||"default",redirect_uri:l.redirect_uri,state:o,url:u}}async loginWithPopup(e,n){var r;if(e=e||{},!(n=n||{}).popup&&(n.popup=(a=>{const l=window.screenX+(window.innerWidth-400)/2,u=window.screenY+(window.innerHeight-600)/2;return window.open(a,"auth0:authorize:popup",`left=${l},top=${u},width=400,height=600,resizable,scrollbars=yes,status=1`)})(""),!n.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const o=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);n.popup.location.href=o.url;const i=await(a=>new Promise((l,u)=>{let h;const f=setInterval(()=>{a.popup&&a.popup.closed&&(clearInterval(f),clearTimeout(p),window.removeEventListener("message",h,!1),u(new WZ(a.popup)))},1e3),p=setTimeout(()=>{clearInterval(f),u(new qZ(a.popup)),window.removeEventListener("message",h,!1)},1e3*(a.timeoutInSeconds||60));h=function(g){if(g.data&&g.data.type==="authorization_response"){if(clearTimeout(p),clearInterval(f),window.removeEventListener("message",h,!1),a.popup.close(),g.data.response.error)return u(Zn.fromPayload(g.data.response));l(g.data.response)}},window.addEventListener("message",h)}))(Object.assign(Object.assign({},n),{timeoutInSeconds:n.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(o.state!==i.state)throw new Zn("state_mismatch","Invalid state");const s=((r=e.authorizationParams)===null||r===void 0?void 0:r.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:o.audience,scope:o.scope,code_verifier:o.code_verifier,grant_type:"authorization_code",code:i.code,redirect_uri:o.redirect_uri},{nonceIn:o.nonce,organization:s})}async getUser(){var e;const n=await this._getIdTokenFromCache();return(e=n==null?void 0:n.decodedToken)===null||e===void 0?void 0:e.user}async getIdTokenClaims(){var e;const n=await this._getIdTokenFromCache();return(e=n==null?void 0:n.decodedToken)===null||e===void 0?void 0:e.claims}async loginWithRedirect(e={}){var n;const r=Bx(e),{openUrl:o,fragment:i,appState:s}=r,a=Mi(r,["openUrl","fragment","appState"]),l=((n=a.authorizationParams)===null||n===void 0?void 0:n.organization)||this.options.authorizationParams.organization,u=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:h}=u,f=Mi(u,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},f),{appState:s}),l&&{organization:l}));const p=i?`${h}#${i}`:h;o?await o(p):window.location.assign(p)}async handleRedirectCallback(e=window.location.href){const n=e.split("?").slice(1);if(n.length===0)throw new Error("There are no query params available for parsing.");const{state:r,code:o,error:i,error_description:s}=(f=>{f.indexOf("#")>-1&&(f=f.substring(0,f.indexOf("#")));const p=new URLSearchParams(f);return{state:p.get("state"),code:p.get("code")||void 0,error:p.get("error")||void 0,error_description:p.get("error_description")||void 0}})(n.join("")),a=this.transactionManager.get();if(!a)throw new Zn("missing_transaction","Invalid state");if(this.transactionManager.remove(),i)throw new KZ(i,s||i,r,a.appState);if(!a.code_verifier||a.state&&a.state!==r)throw new Zn("state_mismatch","Invalid state");const l=a.organization,u=a.nonce,h=a.redirect_uri;return await this._requestToken(Object.assign({audience:a.audience,scope:a.scope,code_verifier:a.code_verifier,grant_type:"authorization_code",code:o},h?{redirect_uri:h}:{}),{nonceIn:u,organization:l}),{appState:a.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch{}}async getTokenSilently(e={}){var n;const r=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:lm(this.scope,(n=e.authorizationParams)===null||n===void 0?void 0:n.scope)})}),o=await((i,s)=>{let a=YC[s];return a||(a=i().finally(()=>{delete YC[s],a=null}),YC[s]=a),a})(()=>this._getTokenSilently(r),`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`);return e.detailedResponse?o:o==null?void 0:o.access_token}async _getTokenSilently(e){const{cacheMode:n}=e,r=Mi(e,["cacheMode"]);if(n!=="off"){const o=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(o)return o}if(n!=="cache-only"){if(!await(async(o,i=3)=>{for(let s=0;s<i;s++)if(await o())return!0;return!1})(()=>QC.acquireLock("auth0.lock.getTokenSilently",5e3),10))throw new P1;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),n!=="off"){const u=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(u)return u}const o=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(r):await this._getTokenFromIFrame(r),{id_token:i,access_token:s,oauthTokenScope:a,expires_in:l}=o;return Object.assign(Object.assign({id_token:i,access_token:s},a?{scope:a}:null),{expires_in:l})}finally{await QC.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},n={}){var r;const o=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:lm(this.scope,(r=e.authorizationParams)===null||r===void 0?void 0:r.scope)})});return n=Object.assign(Object.assign({},GZ),n),await this.loginWithPopup(o,n),(await this.cacheManager.get(new pc({scope:o.authorizationParams.scope,audience:o.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(e){e.clientId!==null?e.clientId=e.clientId||this.options.clientId:delete e.clientId;const n=e.logoutParams||{},{federated:r}=n,o=Mi(n,["federated"]),i=r?"&federated":"";return this._url(`/v2/logout?${M1(Object.assign({clientId:e.clientId},o))}`)+i}async logout(e={}){const n=Bx(e),{openUrl:r}=n,o=Mi(n,["openUrl"]);e.clientId===null?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const i=this._buildLogoutUrl(o);r?await r(i):r!==!1&&window.location.assign(i)}async _getTokenFromIFrame(e){const n=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),r=this.cookieStorage.get(this.orgHintCookieName);r&&!n.organization&&(n.organization=r);const{url:o,state:i,nonce:s,code_verifier:a,redirect_uri:l,scope:u,audience:h}=await this._prepareAuthorizeUrl(n,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new Zn("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const f=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,p=await((v,y,b=60)=>new Promise((C,S)=>{const I=window.document.createElement("iframe");I.setAttribute("width","0"),I.setAttribute("height","0"),I.style.display="none";const E=()=>{window.document.body.contains(I)&&(window.document.body.removeChild(I),window.removeEventListener("message",T,!1))};let T;const w=setTimeout(()=>{S(new P1),E()},1e3*b);T=function(A){if(A.origin!=y||!A.data||A.data.type!=="authorization_response")return;const _=A.source;_&&_.close(),A.data.response.error?S(Zn.fromPayload(A.data.response)):C(A.data.response),clearTimeout(w),window.removeEventListener("message",T,!1),setTimeout(E,2e3)},window.addEventListener("message",T,!1),window.document.body.appendChild(I),I.setAttribute("src",v)}))(o,this.domainUrl,f);if(i!==p.state)throw new Zn("state_mismatch","Invalid state");const g=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:a,code:p.code,grant_type:"authorization_code",redirect_uri:l,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:s,organization:n.organization});return Object.assign(Object.assign({},g),{scope:u,oauthTokenScope:g.scope,audience:h})}catch(f){throw f.error==="login_required"&&this.logout({openUrl:!1}),f}}async _getTokenUsingRefreshToken(e){const n=await this.cacheManager.get(new pc({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(n&&n.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new TD(e.authorizationParams.audience||"default",e.authorizationParams.scope)}const r=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,o=typeof e.timeoutInSeconds=="number"?1e3*e.timeoutInSeconds:null;try{const i=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:n&&n.refresh_token,redirect_uri:r}),o&&{timeout:o}));return Object.assign(Object.assign({},i),{scope:e.authorizationParams.scope,oauthTokenScope:i.scope,audience:e.authorizationParams.audience||"default"})}catch(i){if((i.message.indexOf("Missing Refresh Token")>-1||i.message&&i.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw i}}async _saveEntryInCache(e){const{id_token:n,decodedToken:r}=e,o=Mi(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:n,decodedToken:r}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(o)}async _getIdTokenFromCache(){const e=this.options.authorizationParams.audience||"default",n=await this.cacheManager.getIdToken(new pc({clientId:this.options.clientId,audience:e,scope:this.scope})),r=this.userCache.get("@@user@@");return n&&n.id_token===(r==null?void 0:r.id_token)?r:(this.userCache.set("@@user@@",n),n)}async _getEntryFromCache({scope:e,audience:n,clientId:r}){const o=await this.cacheManager.get(new pc({scope:e,audience:n,clientId:r}),60);if(o&&o.access_token){const{access_token:i,oauthTokenScope:s,expires_in:a}=o,l=await this._getIdTokenFromCache();return l&&Object.assign(Object.assign({id_token:l.id_token,access_token:i},s?{scope:s}:null),{expires_in:a})}}async _requestToken(e,n){const{nonceIn:r,organization:o}=n||{},i=await eee(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),s=await this._verifyIdToken(i.id_token,r,o);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},i),{decodedToken:s,scope:e.scope,audience:e.audience||"default"}),i.scope?{oauthTokenScope:i.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgHint(o||s.claims.org_id),Object.assign(Object.assign({},i),{decodedToken:s})}};async function pee(t){const e=new fee(t);return await e.checkSession(),e}const xD=P(!1),Sn=P(null),ml=P(t=>{const e=t(Sn);return e?e.accountType==="AAD":!1}),yNe=P(t=>{const e=t(Sn);return e?e.accountType==="MSA":!1}),RD=P(t=>t(Sn)!==null),ei=P(null),mee=P(!0);function ND(t,e="all"){const n=m.useRef(t),r=m.useMemo(()=>{const o=n.current.map(Oa);return P(i=>e==="all"?o.every(s=>i(s)):o.some(s=>i(s)))},[e]);return x(r)}function dd(t,e="all"){return e==="all"?t.every(n=>ze(n)):t.some(n=>ze(n))}const gee=["token-retry-max-1","token-retry-max-2"],vee=["token-retry-max-1-auth0","token-retry-max-2-auth0"],yee=["token-retry-max-1-auth0","token-retry-max-1"],bee=["token-retry-max-2-auth0","token-retry-max-2"];function PD(){const t={initialDelayMs:100,maxDelayMs:500,backoffFactor:2};return dd(yee,"any")?{...t,maxRetries:1}:dd(bee,"any")?{...t,maxRetries:2}:{...t,maxRetries:0}}function MD(t,e,n){return n!==void 0?n:e&&!t}function Sr(){const t=x(G5),e=x(ml),n=!!x(Sn);return MD(e,n,t)}function zf(){const t=at(),e=t.get(G5),n=t.get(ml),r=!!t.get(Sn);return MD(n,r,e)}async function Cee(t){var r;const e=(r=t.body)==null?void 0:r.getReader();if(!e)return 0;let n=0;try{const o=performance.now();for(;performance.now()-o<2e3;){const{value:i,done:s}=await e.read();if(s)break;n+=i.byteLength}return n}catch{return 0}}const OD=["character-animation-spda2e","character-animation-vasa","tv-lumi"];function LD(){return ND(OD,"any")}function DD(){const t=x(Sp);return LD()&&!!t}function Hx(){const t=at().get(Sp);return dd(OD,"any")&&!!t}function um(t){return M5.includes(t)}const See="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/meshopt_decoder-3Kt66jYv.js",jn=class jn{static async loadLibraries(){const[e,,n]=await Promise.all([H(()=>import("./index-C8996GQb.js").then(r=>r.c),__vite__mapDeps([3,4,5,6,7,8,9,10,11,12,13,14,15,1,2,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169])),H(()=>import("./index-B5nJtYyh.js").then(r=>r.b),__vite__mapDeps([170,171,4,5,23,7,8,13,172,173,24,25,1,2,94,174,175,144,33,34,95,31,176,146,177,154,178,179,180,181,153,98,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,10,11,12,203,204,205,206,36,37,207,208,209,210,211])),H(()=>import("./math.scalar.functions-C0i4R8fp.js").then(r=>r.f),[])]);e.MeshoptCompression.Configuration={decoder:{url:See}},e.Logger.LogLevels=e.Logger.NoneLogLevel,jn.Core=e,jn.Math=n,jn.isInitialized=!0}static async loadViewerLibraries(){const e=await H(()=>import("./index-DFb2dAVI.js").then(n=>n.i),__vite__mapDeps([212,14,4,5,9,172,213]));jn.Viewer=e}static async loadDebugLibraries(){await jn.loadLibraries(),await H(()=>import("./babylon.inspector.bundle-EVozy_8I.js").then(e=>e.b),__vite__mapDeps([214,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,170,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,215,213,216,217]))}static isLoaded(){return jn.isInitialized}static getCore(){return jn.throwIfNotInitialized("Core"),jn.Core}static getMath(){return jn.throwIfNotInitialized("Core"),jn.Math}static getViewer(){return jn.throwIfNotInitialized("Viewer"),jn.Viewer}static throwIfNotInitialized(e){if(!jn.isInitialized)throw new Error(`Libraries ${e} are not loaded yet. Call loadLibraries first.`)}};j(jn,"Core"),j(jn,"Math"),j(jn,"Viewer"),j(jn,"isInitialized",!1);let Uo=jn;function bNe(t){const e=t.split(/[\\/]/),n=e.pop();return{basePath:`${e.join("/")}/`,fileName:n??""}}function CNe(t,e){U.trackEvent({name:"interaction",data:{eventName:"characterAnimation",eventInfo_characterAnimationState:t,eventInfo_characterId:e}})}function SNe(t,e){const{Texture:n}=Uo.getCore();return new Promise((r,o)=>{const i=new n(t,e,!1,!1,1,()=>{r(i)},o)})}function INe(t){const{Vector3:e}=Uo.getCore();return new e(t[0],t[1]??0,t[2]??0)}function ENe(t){return Math.max(...t)-Math.min(...t)}function TNe(t){return t*Math.PI/180}function zx(t){const{Clamp:e}=Uo.getMath();return e(t,0,1)}function Iee(t,e,n){return Math.abs(t-e)>n?e:t}function wNe(t,e,n=.01,r=.2){const{MoveTowards:o}=Uo.getMath();return o(t,Iee(t,e,n),r)}let Vx;function Eh(...t){Vx===void 0&&(Vx=ze("babylon-debug"))}class Eee{constructor(){j(this,"resourceObserver");j(this,"entries",[]);j(this,"keyword",null);this.resourceObserver=new PerformanceObserver(e=>{this.handleResources(e)})}trackStart(e){this.keyword=e,this.resourceObserver.observe({type:"resource",buffered:!1})}trackEnd(){const{entries:e}=this,n=e[e.length-1];return this.resourceObserver.disconnect(),this.entries=[],this.keyword=null,n?{name:n.name,duration:Math.round(n.duration)}:null}handleResources(e){if(this.keyword)for(const n of e.getEntries())n.name.includes(this.keyword)&&this.entries.push(n)}}class Tee{constructor(e=!0){j(this,"interactTime",0);j(this,"voiceChatToggledTime",0);j(this,"speechEndDetectedTime",0);j(this,"startMessageTime",0);j(this,"mountedTime",0);j(this,"libsLoadedTime",0);j(this,"sceneInitializedTime",0);j(this,"interactSource","");j(this,"currentConversationId","");j(this,"currentMessageId","");j(this,"visualizerEnabled",!1);j(this,"loadedEnd",!1);j(this,"voiceChatToggledOn",!1);j(this,"resourceMonitor",new Eee);j(this,"isVoiceCall");j(this,"resetLoading",()=>{Eh("%c[] -> resetAppearanceEvent"),this.interactTime=0,this.visualizerEnabled=!1,this.loadedEnd=!1});j(this,"isAvailable",()=>this.isVoiceCall?Hx()&&this.voiceChatToggledOn&&this.interactTime>0:Hx()&&this.mountedTime>0);j(this,"trackLoadingEvent",e=>{if(!this.isAvailable())return;const{eventName:n,duration:r,characterId:o,networkDuration:i}=e;if(o&&!um(o))return;const a=["voiceChatToggled","appearanceVisible","appearanceLoadingComplete"].includes(n),l=!yn(yG);U.trackEvent({name:"system",data:{eventName:n,eventInfo_duration:Math.round(r),eventInfo_conversationId:this.currentConversationId,eventInfo_firstTime:l,eventInfo_characterId:o,eventInfo_trigger:a?this.interactSource:void 0,eventInfo_networkDuration:i,eventInfo_customData:JSON.stringify({isVoiceCall:this.isVoiceCall})}}),Eh(`%c[] -> ${n} : `,"color: #691dc6",Math.round(r),l?"firstTime":"",o?`characterId: ${o}`:"",`isVoiceCall: ${this.isVoiceCall===!0}`)});j(this,"onUserInteract",e=>{this.resetLoading(),this.interactTime=performance.now(),this.interactSource=e,Eh("%c[] -> onUserInteract","color: #222222")});j(this,"onVoiceChatToggled",(e,n)=>{if(e==="end")this.voiceChatToggledOn=!1,this.speechEndDetectedTime=0,this.resourceMonitor.trackEnd();else{this.voiceChatToggledOn=!0,this.voiceChatToggledTime=performance.now(),this.currentConversationId=n??"";const r=this.voiceChatToggledTime-this.interactTime;this.trackLoadingEvent({eventName:"voiceChatToggled",duration:r})}});j(this,"onMounted",()=>{this.mountedTime=performance.now();let e;this.isVoiceCall?e=this.mountedTime-this.voiceChatToggledTime:(this.interactTime=this.mountedTime,e=0),this.trackLoadingEvent({eventName:"appearanceMounted",duration:e})});j(this,"onUnmounted",()=>{this.resourceMonitor.trackEnd()});j(this,"onBabylonLibrariesLoaded",e=>{if(!um(e))return;this.libsLoadedTime=performance.now();const n=this.libsLoadedTime-this.mountedTime;this.trackLoadingEvent({eventName:"appearanceBabylonLoaded",duration:n,characterId:e})});j(this,"onSceneInitializationStart",e=>{um(e)&&this.resourceMonitor.trackStart(".glb")});j(this,"onSceneInitialized",e=>{if(!um(e))return;this.sceneInitializedTime=performance.now();const n=this.sceneInitializedTime-this.libsLoadedTime,r=this.resourceMonitor.trackEnd();Eh("%c[] -> monitorResult : ","color: #5bb173",r),this.trackLoadingEvent({eventName:"appearanceSceneInitialized",duration:n,characterId:e,networkDuration:r?r.duration:void 0}),this.trackLoadingEvent({eventName:"appearanceLoadingComplete",duration:this.sceneInitializedTime-this.interactTime,characterId:e}),this.loadedEnd=!0,this.checkEnd()});j(this,"onVisualizerEnabled",()=>{if(this.visualizerEnabled)return;this.visualizerEnabled=!0;const e=Math.round(performance.now()-this.interactTime);this.trackLoadingEvent({eventName:"appearanceVisible",duration:e}),this.checkEnd()});j(this,"checkEnd",()=>{this.visualizerEnabled&&this.loadedEnd&&this.resetLoading()});j(this,"onStartMessage",(e,n)=>{this.currentMessageId=e,this.startMessageTime=n});j(this,"onSpeechEndDetected",e=>{this.speechEndDetectedTime=e});j(this,"onAnimationStart",()=>{const e=Math.round(performance.now()-(this.speechEndDetectedTime||this.startMessageTime));U.trackEvent({name:"system",data:{eventName:"copilotAnimationStart",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:e}}),Eh("%c[] -> onAnimationStart : ","color: #691dc6",Math.round(e))});this.isVoiceCall=e}}const JC=new Map,wee=(t=!0)=>(JC.has(t)||JC.set(t,new Tee(t)),JC.get(t)),Yg=wee(!0),_ee=1e3;function jD(t){(t.source==="audioCallButton"||t.source==="characterTalkToggleButton"||t.source==="AppearanceTryNowModal")&&Yg.onUserInteract(t.source)}function gn(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:t.source,eventInfo_clickScenario:t.scenario,eventInfo_clickDestination:t.destination,eventInfo_conversationId:t.conversationId,eventInfo_podcastId:t.podcastId,eventInfo_messageId:t.messageId,eventInfo_mode:t.chatMode,eventInfo_messageType:t.messageType,eventInfo_cardType:t.cardType,eventInfo_merchantPlatform:t.merchantPlatform,eventInfo_additionalData:t.additionalData?JSON.stringify(t.additionalData):void 0}}),jD(t)}function nt(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_pageName:t.pageName,eventInfo_sectionName:t.sectionName,eventInfo_clickSource:t.source,eventInfo_clickScenario:t.scenario,eventInfo_clickDestination:t.destination,eventInfo_conversationId:t.conversationId,eventInfo_customData:t.customData}}),jD(t)}function Ls(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionScenario:t.scenario,eventInfo_impressionPage:t.page,eventInfo_impressionElement:t.element,eventInfo_status:t.status,eventInfo_customData:t.customData}})}function Sa(t){U.trackEvent({name:"health",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:t.feature,eventInfo_scenario:t.scenario,eventInfo_duration:t.duration,eventInfo_customData:t.customData}})}function Dr(t){U.trackEvent({name:"health",data:{eventName:"copilotError",eventInfo_feature:t.feature,eventInfo_scenario:t.scenario,eventInfo_errorType:t.errorType,eventInfo_errorMessage:t.errorMessage,eventInfo_exception:t.exception,eventInfo_customData:t.customData}})}function Aee(t){U.trackEvent({name:"interaction",data:{eventName:"copilotSettingChange",eventInfo_settingName:t.settingName,eventInfo_settingOldValue:t.oldValue,eventInfo_settingNewValue:t.newValue}})}function _Ne(t,e=_ee){let n;function r(){n=window.setTimeout(()=>{t()},e)}function o(){window.clearTimeout(n)}return{onHoverStart:r,onHoverEnd:o}}function UD(t,e,n,r){setTimeout(async()=>{try{const{status:o}=r,i=await Cee(r),s=r.headers.get("x-ceto-ref")??"";U.trackEvent({name:"apiresponse",data:{eventName:"copilotApiResponse",eventInfo_path:t,eventInfo_method:e,eventInfo_status:o,eventInfo_duration:n,eventInfo_responseContentLength:i,eventInfo_cetoRef:s}})}catch{}},0)}function $x(){performance.mark("userSession-end",{startTime:performance.now()});const{duration:t}=performance.measure("userSession-duration","startupTime-begin","userSession-end");U.trackEvent({name:"system",data:{eventName:"copilotExitEvent",eventInfo_duration:t}})}function kee(t,e,n){U.trackEvent({name:"interaction",data:{eventName:"copilotComposerInput",eventInfo_conversationId:t,eventInfo_inputMethod:e,eventInfo_customData:n}})}function xee(t){U.trackEvent({name:"interaction",data:{eventName:"copilotScroll",eventInfo_ScrollSource:t.scrollSource,eventInfo_ScrollStartX:t.scrollStartX,eventInfo_ScrollStartY:t.scrollStartY,eventInfo_ScrollEndX:t.scrollEndX,eventInfo_ScrollEndY:t.scrollEndY,eventInfo_ScrollDuration:t.scrollDuration,eventInfo_userInitiated:t.userInitiated,eventInfo_customData:t.customData}})}const L1="authInitStartTime";function FD(t,e){if(zf()){const r=at().get(Sn),o=r==null?void 0:r.accountType;Dr({feature:"api",scenario:e,errorType:"missingToken",errorMessage:`User is authenticated but no token was available for ${e==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:t,accountType:o})})}}function BD(t,e){const r=at().get(Sn),o=r==null?void 0:r.accountType,i=r==null?void 0:r.provider,s=r==null?void 0:r.tenantId;o||Dr({feature:"api",scenario:e,errorType:"emptyAccountTypeWithToken",errorMessage:`Can get the token but with no user account type ${e==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:t,provider:i,tenantId:s})})}function HD(t){const{providerType:e,apiName:n,extraInfo:r}=t,o=Date.now().toString();ba(L1,o),U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}function zD(t){const{providerType:e,apiName:n,extraInfo:r}=t,o=Date.now(),i=li(L1);if(i){const s=parseFloat(i),a=o-s;sessionStorage.removeItem(L1),U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_duration:a,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}}function VD(t){const{authWorkflowAccountType:e,interactionType:n,correlationId:r,prompt:o,redirectUri:i,apiName:s,extraInfo:a}=t,l=Date.now().toString();cr(b1,l),U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:s,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",eventInfo_interactionType:n??"",eventInfo_correlationId:r??"",eventInfo_prompt:o??"",eventInfo_redirectUri:i??"",...a})}})}function D1(t){const{authWorkflowAccountType:e,isMSA:n,authority:r,correlationId:o,interactionType:i,apiName:s,extraInfo:a}=t,l=Date.now(),u=yn(b1);let h;if(u){const f=parseFloat(u);h=l-f,tr(b1)}U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:s,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",eventInfo_interactionType:i,eventInfo_correlationId:o,eventInfo_authority:r,eventInfo_isMSA:n??!1,...a}),eventInfo_duration:h??0}})}function $D(t){const{providerType:e,apiName:n,extraInfo:r}=t;U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_providerType:e,...r})}})}function fa(t){const{authWorkflowAccountType:e,apiName:n,duration:r,extraInfo:o}=t;U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:r??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e,eventInfo_wasInBackground:XT(),...o})}})}function Ia(t){const{authWorkflowAccountType:e,apiName:n,errorMessage:r,errorType:o,errorExtraInfo:i,errorCode:s,extraInfo:a}=t;U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!1,eventInfo_apiName:n,eventInfo_errorType:o,eventInfo_errorMessage:r,eventInfo_errorCode:s,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e??"unknown",eventInfo_wasInBackground:XT(),...a,...i})}})}function XC(t){const{authWorkflowAccountType:e,apiName:n}=t;cr(C1,"1"),U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e})}})}function GD(t){const{authWorkflowAccountType:e,apiName:n,duration:r}=t,o=yn(C1);o==="1"&&tr(C1),o==="1"&&U.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:r??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:e})}})}function KD(t,e){return{eventInfo_requestType:e,eventInfo_retryAttemptCount:t.attemptCount,eventInfo_retryStartTime:t.startTime,eventInfo_retryEndDelay:t.endTime,eventInfo_retryDelayTimings:t.delayTimings.join(","),eventInfo_allErrors:JSON.stringify(t.errors),eventInfo_wasInBackground:XT()}}function qD(t,e,n){fa({authWorkflowAccountType:n,apiName:n==="microsoft"?Wg.ACQUIRE_TOKEN_OVERALL_SUCCESS:lo.ACQUIRE_TOKEN_OVERALL_SUCCESS,extraInfo:KD(t,e)})}function WD(t,e,n){const r=KD(t,e),o=t.errors[t.errors.length-1];Ia({authWorkflowAccountType:n,apiName:n==="microsoft"?Wg.ACQUIRE_TOKEN_OVERALL_FAILURE:lo.ACQUIRE_TOKEN_OVERALL_FAILURE,errorType:(o==null?void 0:o.errorType)??"unknown",errorMessage:(o==null?void 0:o.errorMessage)??"unknown error",extraInfo:{...r,eventInfo_exitReason:t.exitReason}})}function Ree(t){const e=t instanceof Error?t.message:String(t);U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"GraphAPITimeout",eventInfo_errorMessage:e,eventInfo_details:"Student status check failed or timed out"}})}function XT(){return typeof document<"u"&&document.visibilityState==="hidden"}var lp,sa,Ku,ps;class gl{constructor(e,n){on(this,lp);on(this,sa,null);on(this,Ku);on(this,ps,null);Ft(this,lp,e),Ft(this,Ku,n)}async get(e){return(he(this,ps)===null||he(this,Ku)&&(!he(this,sa)||he(this,sa)<Date.now()-he(this,Ku)))&&(Ft(this,ps,he(this,lp).call(this,e)),Ft(this,sa,Date.now())),he(this,ps)}set(e){Ft(this,ps,e),Ft(this,sa,Date.now())}reset(){Ft(this,ps,null),Ft(this,sa,null)}get isInstantiated(){return he(this,ps)!==null}}lp=new WeakMap,sa=new WeakMap,Ku=new WeakMap,ps=new WeakMap;function ZT(t){return new Promise(e=>{setTimeout(e,t)})}const Nee={maxRetries:2,initialDelayMs:100,maxDelayMs:500,backoffFactor:2,jitterFactor:.1};function Pee(t){return t instanceof Error?{errorType:t.name,errorMessage:t.message}:{errorType:"Unknown",errorMessage:String(t)}}function Mee(t,e,n,r){const o=t.maxDurationMs!==void 0&&r>=t.maxDurationMs;return n>t.maxRetries?{shouldExit:!0,exitReason:"maxRetriesReached"}:o?{shouldExit:!0,exitReason:"maxDurationReached"}:t.shouldRetry&&!t.shouldRetry(e)?{shouldExit:!0,exitReason:"shouldRetryFalse"}:{shouldExit:!1,exitReason:null}}function Oee(t,e){const n=e.jitterFactor?t*e.jitterFactor*(Math.random()*2-1):0,r=t+n;return Math.min(Math.max(r,0),e.maxDelayMs)}async function ew(t,e={}){var l,u,h,f;const n={...Nee,...e},r=performance.now();let o=n.initialDelayMs,i=0;const s=[],a=[];for(let p=0;p<=n.maxRetries;p+=1)try{const g=await t(),v=performance.now();return(l=n.onSuccess)==null||l.call(n,{attemptCount:p+1,delayTimings:a,startTime:r,endTime:v,errors:s}),g}catch(g){i=p+1,s.push(Pee(g));const v=performance.now();if(p===n.maxRetries)throw(u=n.onFailure)==null||u.call(n,{attemptCount:p+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:"maxRetriesReached"}),g;const y=v-r,{shouldExit:b,exitReason:C}=Mee(n,g,i,y);if(b)throw(h=n.onFailure)==null||h.call(n,{attemptCount:p+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:C}),g;let S=Oee(o,n);if(n.maxDurationMs!==void 0){const w=n.maxDurationMs-y;if(w<=0)throw(f=n.onFailure)==null||f.call(n,{attemptCount:p+1,delayTimings:a,startTime:r,endTime:v,errors:s,exitReason:"maxDurationReached"}),g;S=Math.min(S,w)}const I=performance.now();await ZT(S);const T=performance.now()-I;a.push(T),o=Math.min(o*n.backoffFactor,n.maxDelayMs)}throw new Error("Unexpected end of retry loop")}const ko=new gl(Lee);async function Lee(){HD({apiName:lo.INITIALIZE_START,providerType:"auth0"});const t=await pee(n$);zD({apiName:lo.INITIALIZE_END,providerType:"auth0"});const e=new Map([["on",null],["off",null],["cache-only",null]]);async function n(i,s){const a=performance.now(),l=dd(vee,"any");try{if(!l){const g=await t.getTokenSilently(i),v=performance.now();return Sa({feature:"auth0SdkUsage",scenario:"getAuth0AccessToken",duration:v-a,customData:JSON.stringify({cacheMode:i.cacheMode??"on"})}),g}const h={...PD(),shouldRetry:g=>!(g instanceof Zn&&g.error==="login_required"),onSuccess:g=>qD(g,"graph",s??"google"),onFailure:g=>WD(g,"graph",s??"google")},f=await ew(()=>t.getTokenSilently(i),h),p=performance.now();return Sa({feature:"auth0SdkUsage",scenario:"getAuth0AccessToken",duration:p-a,customData:JSON.stringify({cacheMode:i.cacheMode??"on"})}),f}catch(u){u instanceof Zn?(o({options:i,startTime:a,authWorkflowAccountType:s,errorType:u.error,errorMessage:u.error_description,exception:u.stack}),u.error==="login_required"&&En(ei,{reason:"token-expired",provider:"auth0"})):u instanceof Error?o({options:i,startTime:a,authWorkflowAccountType:s,errorType:u.name,errorMessage:u.message,exception:u.stack}):o({options:i,startTime:a,authWorkflowAccountType:s,errorType:"unknown",errorMessage:`${u}`});return}}async function r(i){const s=await t.getUser();if(!s)return;const a=s.sub&&s.sub.startsWith("google")?"google":"apple",l=i.cacheMode??"on",u=e.get(l);if(!u){const h=n(i,a);e.set(l,h);const f=await h;return e.set(l,null),f}return u}function o(i){const{startTime:s,options:a,authWorkflowAccountType:l,errorType:u,errorMessage:h,exception:f}=i;Ia({authWorkflowAccountType:l,apiName:lo.ACQUIRE_TOKEN_FAILURE,errorType:u,errorMessage:h,errorExtraInfo:{eventInfo_providerType:"auth0",eventInfo_exception:f??"",cacheMode:a.cacheMode??"on",duration:performance.now()-s}})}return{auth0:t,getAuth0AccessToken:r}}function tw(t){const e=t.split(".")[1];if(e===void 0)return;const n=e.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));try{const o=JSON.parse(r);return VZ.parse(o)}catch{return}}async function Dee(t,e){const{getAuth0AccessToken:n}=await ko.get(),{authorizationParams:r}=xf,o={...r,dob:t,ctry:e},i=await n({authorizationParams:o,cacheMode:"off"});if(!i)return;const s=tw(i);if(s)return s}async function jee(){const{getAuth0AccessToken:t}=await ko.get(),e=await t(xf);if(!e)return;const n=tw(e);if(n){if(n.sub.startsWith("google"))return"Google";if(n.sub.startsWith("apple"))return"Apple"}}function Uee(t){switch(t){case"apple":return"Apple";case"google":return"Google";case"msa":return"MSA";default:return}}const af=new BroadcastChannel("cp.broadcast");class Fee{constructor(){j(this,"hasTrackedRedirectError",!1);j(this,"CODE_RE",/[?&]code=[^&]+/);j(this,"STATE_RE",/[?&]state=[^&]+/);j(this,"ERROR_RE",/[?&]error=[^&]+/)}async handleRedirect(){try{const{auth0:e}=await ko.get();if(!this.hasAuthParams())return null;const n=performance.now();await e.handleRedirectCallback();const r=performance.now();Sa({feature:"auth0SdkUsage",scenario:"handleRedirect",duration:r-n});const o=await e.getUser();if(!o)return null;const i=o.sub?this.getTokenType(o.sub):void 0;return D1({apiName:lo.LOGIN_SUCCESS,authWorkflowAccountType:i}),GD({apiName:lo.REAUTH_SUCCESS,authWorkflowAccountType:i}),af.postMessage({eventName:"auth0.accountAdded"}),{id:o.sub,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(o.sub)}}catch(e){this.trackRedirectErrorOncePerSession(e)}return null}async handleRedirectWithoutAccount(){try{const{auth0:e}=await ko.get();if(this.hasAuthParams()){const n=performance.now();await e.handleRedirectCallback();const r=performance.now();Sa({feature:"auth0SdkUsage",scenario:"handleRedirect",duration:r-n});const o=await e.getUser();if(!o)return;const i=o.sub?this.getTokenType(o.sub):void 0;D1({apiName:lo.LOGIN_SUCCESS,authWorkflowAccountType:i}),af.postMessage({eventName:"auth0.accountAdded"})}}catch(e){this.trackRedirectErrorOncePerSession(e)}}async getCurrentActiveUserAccount(){const{auth0:e}=await ko.get(),n=await e.getUser();if(!n)return null;const{sub:r}=n;return r?{id:r,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(r)}:null}async maybeInitializeAccountWithToken(){const{auth0:e,getAuth0AccessToken:n}=await ko.get(),r=await n(xf);if(!r)return null;const o=await e.getUser();if(!o)return null;const i=o.sub;return{userAccount:{id:i,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(i)},authToken:{accessToken:r,tokenType:this.getTokenType(i)}}}async logIn(e){const{connection:n}=e;if(!n)throw new Error("connection in LoginOpts are required");const{auth0:r}=await ko.get();return VD({apiName:lo.LOGIN_START,authWorkflowAccountType:e.connection??void 0}),r.loginWithRedirect({authorizationParams:{...r$.authorizationParams,connection:this.getConnectionFromTokenType(n)}})}async logOut(){const{auth0:e}=await ko.get(),n=await e.getUser(),r=n&&n.sub?this.getTokenType(n.sub):void 0;try{await e.logout({logoutParams:{returnTo:window.location.origin}}),af.postMessage({eventName:"auth0.accountRemoved"}),$D({apiName:lo.LOGOUT_SUCCESS,providerType:"auth0"})}catch(o){Ia({authWorkflowAccountType:r,apiName:lo.LOGOUT_FAILURE,errorMessage:`${o}`,errorExtraInfo:{eventInfo_providerType:"auth0"}}),console.error("Auth0 logout failed:",o)}}async getAuthToken(){try{const{auth0:e,getAuth0AccessToken:n}=await ko.get(),r=await n(xf);if(!r)return;const o=await e.getUser();if(o){const i=o.sub,s=this.getTokenType(i);return{accessToken:r,tokenType:s}}}catch{return}}async getUserInfo(){const{auth0:e}=await ko.get(),n=await e.getUser();if(n)return{mail:n.email??"",givenName:n.given_name??"",surname:n.surname??"",imgSrc:n.picture,isStudent:!1}}async getUserInfoFromToken(e){const n=tw(e);if(!n)return;const{email:r,name:o}=n;return{mail:r,givenName:o.split(" ")[0]??"",surname:"",imgSrc:"",isStudent:!1}}supportsTokenType(e){return e==="apple"||e==="google"}getTokenType(e){return e.startsWith("google")?"google":"apple"}getAccountType(e){return e.startsWith("google")?"Google":"Apple"}getConnectionFromTokenType(e){return e==="apple"?"apple":"google-oauth2"}hasAuthParams(e=window.location.search){return(this.CODE_RE.test(e)||this.ERROR_RE.test(e))&&this.STATE_RE.test(e)}trackRedirectErrorOncePerSession(e){this.hasTrackedRedirectError||(U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"auth0HandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${e}`}}),Ia({apiName:lo.LOGIN_FAILURE,errorExtraInfo:{eventInfo_providerType:"auth0"},errorMessage:`${e}`})),this.hasTrackedRedirectError=!0}}function j1(){return Co(S1,c.boolean().nullable())===!0}function Bee(){return Co(I1,c.boolean().nullable())===!0}var U1=function(t,e){return U1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},U1(t,e)};function ANe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");U1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Gx=function(){return Gx=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Gx.apply(this,arguments)};function kNe(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function Xt(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(h){try{u(r.next(h))}catch(f){s(f)}}function l(h){try{u(r.throw(h))}catch(f){s(f)}}function u(h){h.done?i(h.value):o(h.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function xNe(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(h){return l([u,h])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(r=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(h){u=[6,h],o=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function RNe(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function NNe(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i}function PNe(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var uo;(function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"})(uo||(uo={}));const Hee="v1.0",zee="https://graph.microsoft.com/",Vee=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class jc extends Error{static setGraphClientError(e){let n;return e instanceof Error?n=e:(n=new jc,n.customError=e),n}constructor(e){super(e),Object.setPrototypeOf(this,jc.prototype)}}const $ee=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],Gee=t=>{const e=i=>i.replace(/\/+$/,""),n=i=>i.replace(/^\/+/,""),r=(i,s)=>[e(i),n(s)].join("/");return Array.prototype.slice.call(t).reduce(r)},ZC=t=>{const e=t&&t.constructor&&t.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof t=="string")return t;if(e==="ArrayBuffer")t=Buffer.from(t);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch{throw new Error("Unable to stringify the content")}return t},YD=t=>JD(t),QD=(t,e)=>(e.forEach(n=>Kee(n)),JD(t,e)),JD=(t,e=Vee)=>{if(t=t.toLowerCase(),t.indexOf("https://")!==-1){t=t.replace("https://","");const n=t.indexOf(":"),r=t.indexOf("/");let o="";if(r!==-1)return n!==-1&&n<r?(o=t.substring(0,n),e.has(o)):(o=t.substring(0,r),e.has(o))}return!1},Kee=t=>{if(t.indexOf("/")!==-1)throw new jc("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class Uc{constructor(e=[]){this.middlewareOptions=new Map;for(const n of e){const r=n.constructor;this.middlewareOptions.set(r,n)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,n){this.middlewareOptions.set(e,n)}}const qee=()=>{let t="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(t+="-"),t+=Math.floor(Math.random()*16).toString(16);return t},XD=(t,e,n)=>{let r=null;if(typeof Request<"u"&&t instanceof Request)r=t.headers.get(n);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)r=e.headers.get(n);else if(e.headers instanceof Array){const o=e.headers;for(let i=0,s=o.length;i<s;i++)if(o[i][0]===n){r=o[i][1];break}}else e.headers[n]!==void 0&&(r=e.headers[n]);return r},ZD=(t,e,n,r)=>{if(typeof Request<"u"&&t instanceof Request)t.headers.set(n,r);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[n]:r});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(n,r);else if(e.headers instanceof Array){let o=0;const i=e.headers.length;for(;o<i;o++){const s=e.headers[o];if(s[0]===n){s[1]=r;break}}o===i&&e.headers.push([n,r])}else Object.assign(e.headers,{[n]:r})},e3=(t,e,n,r)=>{typeof Request<"u"&&t instanceof Request?t.headers.append(n,r):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[n]:r}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(n,r):e.headers instanceof Array?e.headers.push([n,r]):e.headers===void 0?e.headers={[n]:r}:e.headers[n]===void 0?e.headers[n]=r:e.headers[n]+=`, ${r}`)},Wee=(t,e)=>Xt(void 0,void 0,void 0,function*(){const n=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:r,headers:o,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:u,redirect:h,integrity:f,keepalive:p,signal:g}=e;return new Request(t,{method:r,headers:o,body:n,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:u,redirect:h,integrity:f,keepalive:p,signal:g})});class Yee{constructor(e,n){this.authenticationProvider=e,this.authenticationProviderOptions=n}}var hd;(function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(hd||(hd={}));class pa{constructor(){this.featureUsage=hd.NONE}static updateFeatureUsageFlag(e,n){let r;e.middlewareControl instanceof Uc?r=e.middlewareControl.getMiddlewareOptions(pa):e.middlewareControl=new Uc,typeof r>"u"&&(r=new pa,e.middlewareControl.setMiddlewareOptions(pa,r)),r.setFeatureUsage(n)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class Vf{constructor(e){this.authenticationProvider=e}execute(e){return Xt(this,void 0,void 0,function*(){const n=typeof e.request=="string"?e.request:e.request.url;if(YD(n)||e.customHosts&&QD(n,e.customHosts)){let r;e.middlewareControl instanceof Uc&&(r=e.middlewareControl.getMiddlewareOptions(Yee));let o,i;r&&(o=r.authenticationProvider,i=r.authenticationProviderOptions),o||(o=this.authenticationProvider);const a=`Bearer ${yield o.getAccessToken(i)}`;e3(e.request,e.options,Vf.AUTHORIZATION_HEADER,a),pa.updateFeatureUsageFlag(e,hd.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[Vf.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}Vf.AUTHORIZATION_HEADER="Authorization";class Qee{execute(e){return Xt(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class Cn{constructor(e=Cn.DEFAULT_DELAY,n=Cn.DEFAULT_MAX_RETRIES,r=Cn.defaultShouldRetry){if(e>Cn.MAX_DELAY&&n>Cn.MAX_MAX_RETRIES){const o=new Error(`Delay and MaxRetries should not be more than ${Cn.MAX_DELAY} and ${Cn.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e>Cn.MAX_DELAY){const o=new Error(`Delay should not be more than ${Cn.MAX_DELAY}`);throw o.name="MaxLimitExceeded",o}else if(n>Cn.MAX_MAX_RETRIES){const o=new Error(`MaxRetries should not be more than ${Cn.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e<0&&n<0){const o=new Error("Delay and MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}else if(e<0){const o=new Error("Delay should not be negative");throw o.name="MinExpectationNotMet",o}else if(n<0){const o=new Error("MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}this.delay=Math.min(e,Cn.MAX_DELAY),this.maxRetries=Math.min(n,Cn.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return Cn.MAX_DELAY}}Cn.DEFAULT_DELAY=3;Cn.DEFAULT_MAX_RETRIES=3;Cn.MAX_DELAY=180;Cn.MAX_MAX_RETRIES=10;Cn.defaultShouldRetry=()=>!0;class ma{constructor(e=new Cn){this.options=e}isRetry(e){return ma.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,n){const r=typeof e=="string"?n.method:e.method;return!((r===uo.PUT||r===uo.PATCH||r===uo.POST)&&XD(e,n,"Content-Type")==="application/octet-stream")}getDelay(e,n,r){const o=()=>Number(Math.random().toFixed(3)),i=e.headers!==void 0?e.headers.get(ma.RETRY_AFTER_HEADER):null;let s;return i!==null?Number.isNaN(Number(i))?s=Math.round((new Date(i).getTime()-Date.now())/1e3):s=Number(i):s=n>=2?this.getExponentialBackOffTime(n)+r+o():r+o(),Math.min(s,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return Xt(this,void 0,void 0,function*(){const n=e*1e3;return new Promise(r=>setTimeout(r,n))})}getOptions(e){let n;return e.middlewareControl instanceof Uc&&(n=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof n>"u"&&(n=Object.assign(new Cn,this.options)),n}executeWithRetry(e,n,r){return Xt(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),n<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,n,e.request,e.options,e.response)){++n,ZD(e.request,e.options,ma.RETRY_ATTEMPT_HEADER,n.toString());const o=this.getDelay(e.response,n,r.delay);return yield this.sleep(o),yield this.executeWithRetry(e,n,r)}else return})}execute(e){return Xt(this,void 0,void 0,function*(){const r=this.getOptions(e);return pa.updateFeatureUsageFlag(e,hd.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,r)})}setNext(e){this.nextMiddleware=e}}ma.RETRY_STATUS_CODES=[429,503,504];ma.RETRY_ATTEMPT_HEADER="Retry-Attempt";ma.RETRY_AFTER_HEADER="Retry-After";class Mo{constructor(e=Mo.DEFAULT_MAX_REDIRECTS,n=Mo.defaultShouldRedirect){if(e>Mo.MAX_MAX_REDIRECTS){const r=new Error(`MaxRedirects should not be more than ${Mo.MAX_MAX_REDIRECTS}`);throw r.name="MaxLimitExceeded",r}if(e<0){const r=new Error("MaxRedirects should not be negative");throw r.name="MinExpectationNotMet",r}this.maxRedirects=e,this.shouldRedirect=n}}Mo.DEFAULT_MAX_REDIRECTS=5;Mo.MAX_MAX_REDIRECTS=20;Mo.defaultShouldRedirect=()=>!0;let Ud=class nc{constructor(e=new Mo){this.options=e}isRedirect(e){return nc.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(nc.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(nc.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,n){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=r.exec(e);let i,s;o!==null&&(i=o[0]);const a=r.exec(n);return a!==null&&(s=a[0]),typeof i<"u"&&typeof s<"u"&&i!==s}updateRequestUrl(e,n){return Xt(this,void 0,void 0,function*(){n.request=typeof n.request=="string"?e:yield Wee(e,n.request)})}getOptions(e){let n;return e.middlewareControl instanceof Uc&&(n=e.middlewareControl.getMiddlewareOptions(Mo)),typeof n>"u"&&(n=Object.assign(new Mo,this.options)),n}executeWithRedirect(e,n,r){return Xt(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const o=e.response;if(n<r.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&r.shouldRedirect(o)){if(++n,o.status===nc.STATUS_CODE_SEE_OTHER)e.options.method=uo.GET,delete e.options.body;else{const i=this.getLocationHeader(o);!this.isRelativeURL(i)&&this.shouldDropAuthorizationHeader(o.url,i)&&delete e.options.headers[nc.AUTHORIZATION_HEADER],yield this.updateRequestUrl(i,e)}yield this.executeWithRedirect(e,n,r)}else return})}execute(e){return Xt(this,void 0,void 0,function*(){const r=this.getOptions(e);return e.options.redirect=nc.MANUAL_REDIRECT,pa.updateFeatureUsageFlag(e,hd.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,r)})}setNext(e){this.nextMiddleware=e}};Ud.REDIRECT_STATUS_CODES=[301,302,303,307,308];Ud.STATUS_CODE_SEE_OTHER=303;Ud.LOCATION_HEADER="Location";Ud.AUTHORIZATION_HEADER="Authorization";Ud.MANUAL_REDIRECT="manual";const Jee="3.0.7";class ho{execute(e){return Xt(this,void 0,void 0,function*(){const n=typeof e.request=="string"?e.request:e.request.url;if(YD(n)||e.customHosts&&QD(n,e.customHosts)){let r=XD(e.request,e.options,ho.CLIENT_REQUEST_ID_HEADER);r||(r=qee(),ZD(e.request,e.options,ho.CLIENT_REQUEST_ID_HEADER,r));let o=`${ho.PRODUCT_NAME}/${Jee}`,i;if(e.middlewareControl instanceof Uc&&(i=e.middlewareControl.getMiddlewareOptions(pa)),i){const s=i.getFeatureUsage();o+=` (${ho.FEATURE_USAGE_STRING}=${s})`}e3(e.request,e.options,ho.SDK_VERSION_HEADER,o)}else delete e.options.headers[ho.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[ho.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}ho.CLIENT_REQUEST_ID_HEADER="client-request-id";ho.SDK_VERSION_HEADER="SdkVersion";ho.PRODUCT_NAME="graph-js";ho.FEATURE_USAGE_STRING="featureUsage";function Xee(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kx;(function(t){t[t.MANUAL=0]="MANUAL",t[t.RANDOM=1]="RANDOM"})(Kx||(Kx={}));var xi;(function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"})(xi||(xi={}));var F1;(function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"})(F1||(F1={}));var Qg;(function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"})(Qg||(Qg={}));var Jg;(function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"})(Jg||(Jg={}));class cf{static parseDocumentResponse(e,n){return typeof DOMParser<"u"?new Promise((r,o)=>{e.text().then(i=>{try{const a=new DOMParser().parseFromString(i,n);r(a)}catch(s){o(s)}})}):Promise.resolve(e.body)}static convertResponse(e,n){return Xt(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let r;const o=e.headers.get("Content-type");switch(n){case xi.ARRAYBUFFER:r=yield e.arrayBuffer();break;case xi.BLOB:r=yield e.blob();break;case xi.DOCUMENT:r=yield cf.parseDocumentResponse(e,F1.TEXT_XML);break;case xi.JSON:r=yield e.json();break;case xi.STREAM:r=yield Promise.resolve(e.body);break;case xi.TEXT:r=yield e.text();break;default:if(o!==null){const i=o.split(";")[0];new RegExp(Jg.DOCUMENT).test(i)?r=yield cf.parseDocumentResponse(e,i):new RegExp(Jg.IMAGE).test(i)?r=e.blob():i===Qg.TEXT_PLAIN?r=yield e.text():i===Qg.APPLICATION_JSON?r=yield e.json():r=Promise.resolve(e.body)}else r=Promise.resolve(e.body);break}return r})}static getResponse(e,n,r){return Xt(this,void 0,void 0,function*(){if(n===xi.RAW)return Promise.resolve(e);{const o=yield cf.convertResponse(e,n);if(e.ok)if(typeof r=="function")r(null,o);else return o;else throw o}})}}class Zee{constructor(e){this.provider=e}getAccessToken(){return Xt(this,void 0,void 0,function*(){return new Promise((e,n)=>{this.provider((r,o)=>Xt(this,void 0,void 0,function*(){if(o)e(o);else{if(!r){const s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";r=new jc(s)}const i=yield jc.setGraphClientError(r);n(i)}}))})})}}class lf extends Error{constructor(e=-1,n,r){super(n||r&&r.message),Object.setPrototypeOf(this,lf.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class Xg{static constructError(e,n,r){const o=new lf(n,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=r==null?void 0:r.headers,o}static constructErrorFromResponse(e,n,r){const o=e.error,i=new lf(n,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i.headers=r==null?void 0:r.headers,i}static getError(e=null,n=-1,r,o){return Xt(this,void 0,void 0,function*(){let i;if(e&&e.error?i=Xg.constructErrorFromResponse(e,n,o):e instanceof Error?i=Xg.constructError(e,n,o):(i=new lf(n),i.body=e),typeof r=="function")r(i,null);else return i})}}class ete{constructor(e,n,r){this.parsePath=o=>{if(o.indexOf("https://")!==-1){o=o.replace("https://","");const s=o.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+o.substring(0,s),o=o.substring(s+1,o.length));const a=o.indexOf("/");a!==-1&&(this.urlComponents.version=o.substring(0,a),o=o.substring(a+1,o.length))}o.charAt(0)==="/"&&(o=o.substr(1));const i=o.indexOf("?");if(i===-1)this.urlComponents.path=o;else{this.urlComponents.path=o.substr(0,i);const s=o.substring(i+1,o.length).split("&");for(const a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=n,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,n,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];r.length>1&&typeof n=="string"?o=Array.prototype.slice.call(r):typeof n=="string"?o.push(n):o=o.concat(n),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=Gee([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,n=[];if(Object.keys(e.oDataQueryParams).length!==0)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&n.push(r+"="+e.oDataQueryParams[r]);if(Object.keys(e.otherURLQueryParams).length!==0)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&n.push(r+"="+e.otherURLQueryParams[r]);if(e.otherURLQueryOptions.length!==0)for(const r of e.otherURLQueryOptions)n.push(r);return n.length>0?"?"+n.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){const n=e.split("&");for(const r of n)this.parseQueryParamenterString(r)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.setURLComponentsQueryParamater(n,e[n]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const n=e.indexOf("="),r=e.substring(0,n),o=e.substring(n+1);this.setURLComponentsQueryParamater(r,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,n){if($ee.indexOf(e)!==-1){const r=this.urlComponents.oDataQueryParams[e],o=r&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=o?r+","+n:n}else this.urlComponents.otherURLQueryParams[e]=n}isValidQueryKeyValuePair(e){const n=e.indexOf("=");return!(n===-1||e.indexOf("(")!==-1&&e.indexOf("(")<n)}updateRequestOptions(e){const n=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){const r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(n,e.headers),Object.assign(n,this._headers),e.headers=n}send(e,n,r){var o;return Xt(this,void 0,void 0,function*(){let i;const s=new Uc(this._middlewareOptions);this.updateRequestOptions(n);const a=(o=this.config)===null||o===void 0?void 0:o.customHosts;try{return i=(yield this.httpClient.sendRequest({request:e,options:n,middlewareControl:s,customHosts:a})).response,yield cf.getResponse(i,this._responseType,r)}catch(l){if(l instanceof jc)throw l;let u;throw i&&(u=i.status),yield Xg.getError(l,u,r,i)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}const e=Object.keys(this._headers);for(const n of e)if(n.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,n){return this._headers[e]=n,this}headers(e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this._headers[n]=e[n]);return this}option(e,n){return this._options[e]=n,this}options(e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this._options[n]=e[n]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return Xt(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:uo.GET};return yield this.send(n,r,e)})}post(e,n){return Xt(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:uo.POST,body:ZC(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers),yield this.send(r,o,n)})}create(e,n){return Xt(this,void 0,void 0,function*(){return yield this.post(e,n)})}put(e,n){return Xt(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:uo.PUT,body:ZC(e)};return yield this.send(r,o,n)})}patch(e,n){return Xt(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:uo.PATCH,body:ZC(e)};return yield this.send(r,o,n)})}update(e,n){return Xt(this,void 0,void 0,function*(){return yield this.patch(e,n)})}delete(e){return Xt(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:uo.DELETE};return yield this.send(n,r,e)})}del(e){return Xt(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return Xt(this,void 0,void 0,function*(){const n=this.buildFullUrl(),r={method:uo.GET};return this.responseType(xi.STREAM),yield this.send(n,r,e)})}putStream(e,n){return Xt(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:uo.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,o,n)})}}class t3{constructor(...e){if(!e||!e.length){const n=new Error;throw n.name="InvalidMiddlewareChain",n.message="Please provide a default middleware chain or custom middleware chain",n}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((n,r)=>{r<e.length-1&&n.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return Xt(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){const n=new Error;throw n.name="InvalidRequestOptions",n.message="Unable to execute the middleware, Please provide valid options for a request",n}return yield this.middleware.execute(e),e})}}const tte=()=>typeof process=="object"&&typeof Xee=="function";class nw{static createWithAuthenticationProvider(e){const n=new Vf(e),r=new ma(new Cn),o=new ho,i=new Qee;if(n.setNext(r),tte()){const s=new Ud(new Mo);r.setNext(s),s.setNext(o)}else r.setNext(o);return o.setNext(i),nw.createWithMiddleware(n)}static createWithMiddleware(...e){return new t3(...e)}}const nte=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}else if(typeof Promise>"u"){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}else if(typeof fetch>"u"){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}return!0};class Zg{static init(e){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=r==="authProvider"?new Zee(e[r]):e[r]);return Zg.initWithMiddleware(n)}static initWithMiddleware(e){return new Zg(e)}constructor(e){this.config={baseUrl:zee,debugLogging:!1,defaultVersion:Hee},nte();for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.config[r]=e[r]);let n;if(e.authProvider!==void 0&&e.middleware!==void 0){const r=new Error;throw r.name="AmbiguityInInitialization",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",r}else if(e.authProvider!==void 0)n=nw.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)n=new t3(...[].concat(e.middleware));else{const r=new Error;throw r.name="InvalidMiddlewareChain",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",r}this.httpClient=n}api(e){return new ete(this.httpClient,this.config,e)}}const rte=["CAREERCOACH_STUDENTS","EXCHANGESTANDARD_STUDENT","M365EDU_A3_STUDENT","M365EDU_A3_STUUSEBNFT","M365EDU_A3_STUUSEBNFT_RPA1","M365EDU_A5_STUDENT","M365EDU_A5_STUUSEBNFT","M365EDU_A5_NOPSTNCONF_STUUSEBNFT","OFFICESUBSCRIPTION_STUDENT","ATP_ENTERPRISE_STUDENT","ATP_ENTERPRISE_STUDENTS_USE_BENEFIT","POWER_BI_STANDARD_STUDENT","MCOEV_STUDENT","MEE_STUDENT","STANDARDWOFFPACK_STUDENT","STANDARDWOFFPACK_IW_STUDENT","ENTERPRISEPACKPLUS_STUDENT","ENTERPRISEPREMIUM_STUDENT","WIN10_ENT_A3_STU","MCO_TEAMS_EDU_HS_STUDENT","PROJECT_PROFESSIONAL_STUDENT","PROJECT_P1_STUDENT"];function ote(t){return Zg.init({authProvider:e=>{e(null,t)}})}async function eS(t,e){const n=performance.now(),r=await e;return U.trackEvent({name:"system",data:{eventName:"externalApiResponse",eventInfo_id:t,eventInfo_duration:performance.now()-n,eventInfo_service:"microsoft-graph"}}),r}async function ite(t){return t.api(WE.graphMeApiSuffix).get()}async function ste(t){try{const e=await t.api(WE.graphMeImageApiSuffix).get();return URL.createObjectURL(e)}catch{return}}async function ate(t){const e=Ue(ml);if(ze("aad-student")&&e)try{const n=await t.api(WE.graphMeLicenseDetails).get();return n&&n.value.some(o=>o.skuPartNumber&&rte.includes(o.skuPartNumber))}catch(n){return console.error("Error checking student status:",n),!1}else return!1}async function qx(t){const e=ote(t),[n,r,o]=await Promise.all([eS("user",ite(e)),eS("user_photo",ste(e)),eS("is_student",ate(e))]);return{...n,imgSrc:r,isStudent:o}}/*! @azure/msal-common v14.15.0 2024-09-20 */const ie={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},dm={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},Ea=[ie.OPENID_SCOPE,ie.PROFILE_SCOPE,ie.OFFLINE_ACCESS_SCOPE],Wx=[...Ea,ie.EMAIL_SCOPE],zi={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Yn={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},ga={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},hm={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},er={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Yx={PLAIN:"plain",S256:"S256"},Tp={QUERY:"query",FRAGMENT:"fragment"},cte={...Tp},n3={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},fm={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},vr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},lt={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},rw="appmetadata",lte="client_info",uf="1",ev={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},so={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},sr={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Vt={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},df={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Qx={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Jx={username:"username",password:"password"},pm={httpSuccess:200,httpBadRequest:400},Gl={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},tS={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Zs={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},ute={Pop:"pop"},dte=300;/*! @azure/msal-common v14.15.0 2024-09-20 */const Yy="unexpected_error",hte="post_request_failed";/*! @azure/msal-common v14.15.0 2024-09-20 */const Xx={[Yy]:"Unexpected error in authentication.",[hte]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Et extends Error{constructor(e,n,r){const o=n?`${e}: ${n}`:e;super(o),Object.setPrototypeOf(this,Et.prototype),this.errorCode=e||ie.EMPTY_STRING,this.errorMessage=n||ie.EMPTY_STRING,this.subError=r||ie.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function r3(t,e){return new Et(t,e?`${Xx[t]} ${e}`:Xx[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */const Qy="client_info_decoding_error",ow="client_info_empty_error",Jy="token_parsing_error",iw="null_or_empty_token",Ri="endpoints_resolution_error",sw="network_error",aw="openid_config_error",cw="hash_not_deserialized",Fc="invalid_state",lw="state_mismatch",$f="state_not_found",uw="nonce_mismatch",Xy="auth_time_not_found",dw="max_age_transpired",o3="multiple_matching_tokens",i3="multiple_matching_accounts",hw="multiple_matching_appMetadata",fw="request_cannot_be_made",pw="cannot_remove_empty_scope",mw="cannot_append_scopeset",tv="empty_input_scopeset",s3="device_code_polling_cancelled",a3="device_code_expired",c3="device_code_unknown_error",Zy="no_account_in_silent_request",gw="invalid_cache_record",eb="invalid_cache_environment",nv="no_account_found",rv="no_crypto_object",ov="unexpected_credential_type",l3="invalid_assertion",u3="invalid_client_credential",ri="token_refresh_required",d3="user_timeout_reached",vw="token_claims_cnf_required_for_signedjwt",yw="authorization_code_missing_from_server_response",bw="binding_key_not_removed",Cw="end_session_endpoint_not_supported",tb="key_id_missing",h3="no_network_connectivity",f3="user_canceled",p3="missing_tenant_id_error",yt="method_not_implemented",m3="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.15.0 2024-09-20 */const ft={[Qy]:"The client info could not be parsed/decoded correctly",[ow]:"The client info was empty",[Jy]:"Token cannot be parsed",[iw]:"The token is null or empty",[Ri]:"Endpoints cannot be resolved",[sw]:"Network request failed",[aw]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[cw]:"The hash parameters could not be deserialized",[Fc]:"State was not the expected format",[lw]:"State mismatch error",[$f]:"State not found",[uw]:"Nonce mismatch error",[Xy]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[dw]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[o3]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[i3]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[hw]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[fw]:"Token request cannot be made without authorization code or refresh token.",[pw]:"Cannot remove null or empty scope from ScopeSet",[mw]:"Cannot append ScopeSet",[tv]:"Empty input ScopeSet cannot be processed",[s3]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[a3]:"Device code is expired.",[c3]:"Device code stopped polling for unknown reasons.",[Zy]:"Please pass an account object, silent flow is not supported without account information",[gw]:"Cache record object was null or undefined.",[eb]:"Invalid environment when attempting to create cache entry",[nv]:"No account found in cache for given key.",[rv]:"No crypto object detected.",[ov]:"Unexpected credential type.",[l3]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[u3]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[ri]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[d3]:"User defined timeout for device code polling reached",[vw]:"Cannot generate a POP jwt if the token_claims are not populated",[yw]:"Server response does not contain an authorization code to proceed",[bw]:"Could not remove the credential's binding key from storage.",[Cw]:"The provided authority does not support logout",[tb]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[h3]:"No network connectivity. Check your internet connection.",[f3]:"User cancelled the flow.",[p3]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[yt]:"This method has not been implemented",[m3]:"The nested app auth bridge is disabled"};ft[Qy],ft[ow],ft[Jy],ft[iw],ft[Ri],ft[sw],ft[aw],ft[cw],ft[Fc],ft[lw],ft[$f],ft[uw],ft[Xy],ft[dw],ft[o3],ft[i3],ft[hw],ft[fw],ft[pw],ft[mw],ft[tv],ft[s3],ft[a3],ft[c3],ft[Zy],ft[gw],ft[eb],ft[nv],ft[rv],ft[ov],ft[l3],ft[u3],ft[ri],ft[d3],ft[vw],ft[yw],ft[bw],ft[Cw],ft[tb],ft[h3],ft[f3],ft[p3],ft[m3];class Fd extends Et{constructor(e,n){super(e,n?`${ft[e]}: ${n}`:ft[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Fd.prototype)}}function Ae(t,e){return new Fd(t,e)}/*! @azure/msal-common v14.15.0 2024-09-20 */const iv={createNewGuid:()=>{throw Ae(yt)},base64Decode:()=>{throw Ae(yt)},base64Encode:()=>{throw Ae(yt)},base64UrlEncode:()=>{throw Ae(yt)},encodeKid:()=>{throw Ae(yt)},async getPublicKeyThumbprint(){throw Ae(yt)},async removeTokenBindingKey(){throw Ae(yt)},async clearKeystore(){throw Ae(yt)},async signJwt(){throw Ae(yt)},async hashString(){throw Ae(yt)}};/*! @azure/msal-common v14.15.0 2024-09-20 */var pn;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(pn||(pn={}));class hi{constructor(e,n,r){this.level=pn.Info;const o=()=>{},i=e||hi.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:pn.Info,this.correlationId=i.correlationId||ie.EMPTY_STRING,this.packageName=n||ie.EMPTY_STRING,this.packageVersion=r||ie.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:pn.Info}}clone(e,n,r){return new hi({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,n)}logMessage(e,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;const i=`${`[${new Date().toUTCString()}] : [${n.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${pn[n.logLevel]} - ${e}`;this.executeCallback(n.logLevel,i,n.containsPii||!1)}executeCallback(e,n,r){this.localCallback&&this.localCallback(e,n,r)}error(e,n){this.logMessage(e,{logLevel:pn.Error,containsPii:!1,correlationId:n||ie.EMPTY_STRING})}errorPii(e,n){this.logMessage(e,{logLevel:pn.Error,containsPii:!0,correlationId:n||ie.EMPTY_STRING})}warning(e,n){this.logMessage(e,{logLevel:pn.Warning,containsPii:!1,correlationId:n||ie.EMPTY_STRING})}warningPii(e,n){this.logMessage(e,{logLevel:pn.Warning,containsPii:!0,correlationId:n||ie.EMPTY_STRING})}info(e,n){this.logMessage(e,{logLevel:pn.Info,containsPii:!1,correlationId:n||ie.EMPTY_STRING})}infoPii(e,n){this.logMessage(e,{logLevel:pn.Info,containsPii:!0,correlationId:n||ie.EMPTY_STRING})}verbose(e,n){this.logMessage(e,{logLevel:pn.Verbose,containsPii:!1,correlationId:n||ie.EMPTY_STRING})}verbosePii(e,n){this.logMessage(e,{logLevel:pn.Verbose,containsPii:!0,correlationId:n||ie.EMPTY_STRING})}trace(e,n){this.logMessage(e,{logLevel:pn.Trace,containsPii:!1,correlationId:n||ie.EMPTY_STRING})}tracePii(e,n){this.logMessage(e,{logLevel:pn.Trace,containsPii:!0,correlationId:n||ie.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.15.0 2024-09-20 */const g3="@azure/msal-common",Sw="14.15.0";/*! @azure/msal-common v14.15.0 2024-09-20 */const Gf={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net"};/*! @azure/msal-common v14.15.0 2024-09-20 */function vl(t,e){const n=fte(t);try{const r=e(n);return JSON.parse(r)}catch{throw Ae(Jy)}}function fte(t){if(!t)throw Ae(iw);const n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw Ae(Jy);return n[2]}function v3(t,e){if(e===0||Date.now()-3e5>t+e)throw Ae(dw)}/*! @azure/msal-common v14.15.0 2024-09-20 */function Wi(){return Math.round(new Date().getTime()/1e3)}function B1(t,e){const n=Number(t)||0;return Wi()+e>n}function pte(t){return Number(t)>Wi()}/*! @azure/msal-common v14.15.0 2024-09-20 */function Su(t){return[mte(t),gte(t),vte(t),yte(t),bte(t)].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}function nb(t,e,n,r,o){return{credentialType:lt.ID_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n,realm:o}}function rb(t,e,n,r,o,i,s,a,l,u,h,f,p,g,v){var b,C;const y={homeAccountId:t,credentialType:lt.ACCESS_TOKEN,secret:n,cachedAt:Wi().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:o,target:i,tokenType:h||Vt.BEARER};if(f&&(y.userAssertionHash=f),u&&(y.refreshOn=u.toString()),g&&(y.requestedClaims=g,y.requestedClaimsHash=v),((b=y.tokenType)==null?void 0:b.toLowerCase())!==Vt.BEARER.toLowerCase())switch(y.credentialType=lt.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case Vt.POP:const S=vl(n,l);if(!((C=S==null?void 0:S.cnf)!=null&&C.kid))throw Ae(vw);y.keyId=S.cnf.kid;break;case Vt.SSH:y.keyId=p}return y}function y3(t,e,n,r,o,i,s){const a={credentialType:lt.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function Iw(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function Zx(t){return t?Iw(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===lt.ACCESS_TOKEN||t.credentialType===lt.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function eR(t){return t?Iw(t)&&t.hasOwnProperty("realm")&&t.credentialType===lt.ID_TOKEN:!1}function tR(t){return t?Iw(t)&&t.credentialType===lt.REFRESH_TOKEN:!1}function mte(t){return[t.homeAccountId,t.environment].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}function gte(t){const e=t.credentialType===lt.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}function vte(t){return(t.target||"").toLowerCase()}function yte(t){return(t.requestedClaimsHash||"").toLowerCase()}function bte(t){return t.tokenType&&t.tokenType.toLowerCase()!==Vt.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}function Cte(t,e){const n=t.indexOf(sr.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&r}function Ste(t,e){let n=!1;t&&(n=t.indexOf(df.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),n&&r}function Ite({environment:t,clientId:e}){return[rw,t,e].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}function Ete(t,e){return e?t.indexOf(rw)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Tte(t,e){return e?t.indexOf(ev.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function nR(){return Wi()+ev.REFRESH_TIME_SECONDS}function mm(t,e,n){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=n,t.jwks_uri=e.jwks_uri}function nS(t,e,n){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=n}function rR(t){return t.expiresAt<=Wi()}/*! @azure/msal-common v14.15.0 2024-09-20 */const b3="redirect_uri_empty",wte="claims_request_parsing_error",C3="authority_uri_insecure",Kh="url_parse_error",S3="empty_url_error",I3="empty_input_scopes_error",E3="invalid_prompt_value",Ew="invalid_claims",T3="token_request_empty",w3="logout_request_empty",_3="invalid_code_challenge_method",Tw="pkce_params_missing",ww="invalid_cloud_discovery_metadata",A3="invalid_authority_metadata",k3="untrusted_authority",ob="missing_ssh_jwk",x3="missing_ssh_kid",_te="missing_nonce_authentication_header",Ate="invalid_authentication_header",R3="cannot_set_OIDCOptions",N3="cannot_allow_native_broker",P3="authority_mismatch";/*! @azure/msal-common v14.15.0 2024-09-20 */const kte={[b3]:"A redirect URI is required for all calls, and none has been set.",[wte]:"Could not parse the given claims request object.",[C3]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Kh]:"URL could not be parsed into appropriate segments.",[S3]:"URL was empty or null.",[I3]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[E3]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Ew]:"Given claims parameter must be a stringified JSON object.",[T3]:"Token request was empty and not found in cache.",[w3]:"The logout request was null or undefined.",[_3]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Tw]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[ww]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[A3]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[k3]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[ob]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[x3]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[_te]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Ate]:"Invalid authentication header provided",[R3]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[N3]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[P3]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class ib extends Et{constructor(e){super(e,kte[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,ib.prototype)}}function Zt(t){return new ib(t)}/*! @azure/msal-common v14.15.0 2024-09-20 */class ai{static isEmptyObj(e){if(e)try{const n=JSON.parse(e);return Object.keys(n).length===0}catch{}return!0}static startsWith(e,n){return e.indexOf(n)===0}static endsWith(e,n){return e.length>=n.length&&e.lastIndexOf(n)===e.length-n.length}static queryStringToObject(e){const n={},r=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){const[s,a]=i.split(/=(.+)/g,2);s&&a&&(n[o(s)]=o(a))}}),n}static trimArrayEntries(e){return e.map(n=>n.trim())}static removeEmptyStringsFromArray(e){return e.filter(n=>!!n)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,n){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(n)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class xn{constructor(e){const n=e?ai.trimArrayEntries([...e]):[],r=n?ai.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(o=>this.scopes.add(o))}static fromString(e){const r=(e||ie.EMPTY_STRING).split(" ");return new xn(r)}static createSearchScopes(e){const n=new xn(e);return n.containsOnlyOIDCScopes()?n.removeScope(ie.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}validateInputScopes(e){if(!e||e.length<1)throw Zt(I3)}containsScope(e){const n=this.printScopesLowerCase().split(" "),r=new xn(n);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(n=>this.containsScope(n))}containsOnlyOIDCScopes(){let e=0;return Wx.forEach(n=>{this.containsScope(n)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(n=>this.appendScope(n))}catch{throw Ae(mw)}}removeScope(e){if(!e)throw Ae(pw);this.scopes.delete(e.trim())}removeOIDCScopes(){Wx.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Ae(tv);const n=new Set;return e.scopes.forEach(r=>n.add(r.toLowerCase())),this.scopes.forEach(r=>n.add(r.toLowerCase())),n}intersectingScopeSets(e){if(!e)throw Ae(tv);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const n=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return n.size<o+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(n=>e.push(n)),e}printScopes(){return this.scopes?this.asArray().join(" "):ie.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.15.0 2024-09-20 */function sv(t,e){if(!t)throw Ae(ow);try{const n=e(t);return JSON.parse(n)}catch{throw Ae(Qy)}}function Iu(t){if(!t)throw Ae(Qy);const e=t.split(vr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?ie.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.15.0 2024-09-20 */function av(t,e){return!!t&&!!e&&t===e.split(".")[1]}function _w(t,e,n,r){if(r){const{oid:o,sub:i,tid:s,name:a,tfp:l,acr:u}=r,h=s||l||u||"";return{tenantId:h,localAccountId:o||i||"",name:a,isHomeTenant:av(h,t)}}else return{tenantId:n,localAccountId:e,isHomeTenant:av(n,t)}}function Aw(t,e,n,r){let o=t;if(e){const{isHomeTenant:i,...s}=e;o={...t,...s}}if(n){const{isHomeTenant:i,...s}=_w(t.homeAccountId,t.localAccountId,t.tenantId,n);return o={...o,...s,idTokenClaims:n,idToken:r},o}return o}/*! @azure/msal-common v14.15.0 2024-09-20 */const Xo={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.15.0 2024-09-20 */function M3(t){return t&&(t.tid||t.tfp||t.acr)||null}/*! @azure/msal-common v14.15.0 2024-09-20 */const vs={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.15.0 2024-09-20 */class Vn{generateAccountId(){return[this.homeAccountId,this.environment].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Vn.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const n=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",n||e.tenantId||""].join(vr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,n,r){var u,h,f,p,g,v;const o=new Vn;n.authorityType===Xo.Adfs?o.authorityType=fm.ADFS_ACCOUNT_TYPE:n.protocolMode===vs.AAD?o.authorityType=fm.MSSTS_ACCOUNT_TYPE:o.authorityType=fm.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&r&&(i=sv(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;const s=e.environment||n&&n.getPreferredCache();if(!s)throw Ae(eb);o.environment=s,o.realm=(i==null?void 0:i.utid)||M3(e.idTokenClaims)||"",o.localAccountId=(i==null?void 0:i.uid)||((u=e.idTokenClaims)==null?void 0:u.oid)||((h=e.idTokenClaims)==null?void 0:h.sub)||"";const a=((f=e.idTokenClaims)==null?void 0:f.preferred_username)||((p=e.idTokenClaims)==null?void 0:p.upn),l=(g=e.idTokenClaims)!=null&&g.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||l||"",o.name=((v=e.idTokenClaims)==null?void 0:v.name)||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{const y=_w(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[y]}return o}static createFromAccountInfo(e,n,r){var i;const o=new Vn;return o.authorityType=e.authorityType||fm.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=n,o.msGraphHost=r,o.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),o}static generateHomeAccountId(e,n,r,o,i){if(!(n===Xo.Adfs||n===Xo.Dsts)){if(e)try{const s=sv(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,n,r){if(!e||!n)return!1;let o=!0;if(r){const i=e.idTokenClaims||{},s=n.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===n.homeAccountId&&e.localAccountId===n.localAccountId&&e.username===n.username&&e.tenantId===n.tenantId&&e.environment===n.environment&&e.nativeAccountId===n.nativeAccountId&&o}}/*! @azure/msal-common v14.15.0 2024-09-20 */function O3(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function cv(t){if(!t||t.indexOf("=")<0)return null;try{const e=O3(t),n=Object.fromEntries(new URLSearchParams(e));if(n.code||n.error||n.error_description||n.state)return n}catch{throw Ae(cw)}return null}/*! @azure/msal-common v14.15.0 2024-09-20 */class At{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Zt(S3);e.includes("#")||(this._urlString=At.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let n=e.toLowerCase();return ai.endsWith(n,"?")?n=n.slice(0,-1):ai.endsWith(n,"?/")&&(n=n.slice(0,-2)),ai.endsWith(n,"/")||(n+="/"),n}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Zt(Kh)}if(!e.HostNameAndPort||!e.PathSegments)throw Zt(Kh);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Zt(C3)}static appendQueryString(e,n){return n?e.indexOf("?")<0?`${e}?${n}`:`${e}&${n}`:e}static removeHashFromUrl(e){return At.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const n=this.getUrlComponents(),r=n.PathSegments;return e&&r.length!==0&&(r[0]===ga.COMMON||r[0]===ga.ORGANIZATIONS)&&(r[0]=e),At.constructAuthorityUriFromObject(n)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=this.urlString.match(e);if(!n)throw Zt(Kh);const r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5],QueryString:n[7]};let o=r.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),r.PathSegments=o,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const n=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(n);if(!r)throw Zt(Kh);return r[2]}static getAbsoluteUrl(e,n){if(e[0]===ie.FORWARD_SLASH){const o=new At(n).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new At(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!cv(e)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const L3={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},oR=L3.endpointMetadata,kw=L3.instanceDiscoveryMetadata,D3=new Set;kw.metadata.forEach(t=>{t.aliases.forEach(e=>{D3.add(e)})});function xte(t,e){var o;let n;const r=t.canonicalAuthority;if(r){const i=new At(r).getUrlComponents().HostNameAndPort;n=iR(i,(o=t.cloudDiscoveryMetadata)==null?void 0:o.metadata,so.CONFIG,e)||iR(i,kw.metadata,so.HARDCODED_VALUES,e)||t.knownAuthorities}return n||[]}function iR(t,e,n,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${n}`),t&&e){const o=lv(e,t);if(o)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),o.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function Rte(t){return lv(kw.metadata,t)}function lv(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.15.0 2024-09-20 */const j3="cache_quota_exceeded",xw="cache_error_unknown";/*! @azure/msal-common v14.15.0 2024-09-20 */const rS={[j3]:"Exceeded cache storage capacity.",[xw]:"Unexpected error occurred when using cache storage."};class Ec extends Error{constructor(e,n){const r=n||(rS[e]?rS[e]:rS[xw]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Ec.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}/*! @azure/msal-common v14.15.0 2024-09-20 */class fd{constructor(e,n,r,o){this.clientId=e,this.cryptoImpl=n,this.commonLogger=r.clone(g3,Sw),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const n=this.getAllAccounts(e);return n.length>1?n.sort(o=>o.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e){const n=this.getAccountsFilteredBy(e);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,n){return e.flatMap(r=>this.getTenantProfilesFromAccountEntity(r,n==null?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,n,r,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;const a=this.getIdToken(e,n,r.tenantId);return a&&(s=vl(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=Aw(e,r,s,a==null?void 0:a.secret),i)}getTenantProfilesFromAccountEntity(e,n,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const l=i.get(n);if(l)i=new Map([[n,l]]);else return[]}const a=[];return i.forEach(l=>{const u=this.getTenantedAccountInfoByFilter(o,s,l,r);u&&a.push(u)}),a}tenantProfileMatchesFilter(e,n){return!(n.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,n.localAccountId)||n.name&&e.name!==n.name||n.isHomeTenant!==void 0&&e.isHomeTenant!==n.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,n){return!(n&&(n.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,n.localAccountId)||n.loginHint&&!this.matchLoginHintFromTokenClaims(e,n.loginHint)||n.username&&!this.matchUsername(e.preferred_username,n.username)||n.name&&!this.matchName(e,n.name)||n.sid&&!this.matchSid(e,n.sid)))}async saveCacheRecord(e,n,r){var o,i,s,a;if(!e)throw Ae(gw);try{e.account&&this.setAccount(e.account),e.idToken&&(n==null?void 0:n.idToken)!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&(n==null?void 0:n.accessToken)!==!1&&await this.saveAccessToken(e.accessToken),e.refreshToken&&(n==null?void 0:n.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(o=this.commonLogger)==null||o.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((i=this.commonLogger)==null||i.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,r),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new Ec(j3)):new Ec(l.name,l.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${l}`,r),new Ec(xw))}}async saveAccessToken(e){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=xn.fromString(e.target),i=[];r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,n,!1))return;const a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,n)&&xn.fromString(a.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(s))}),await Promise.all(i),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const n=this.getAccountKeys(),r=[];return n.forEach(o=>{var l;if(!this.isAccountKey(o,e.homeAccountId))return;const i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(l=i.tenantProfiles)==null?void 0:l.filter(u=>this.tenantProfileMatchesFilter(u,s));a&&a.length===0||r.push(i)}),r}isAccountKey(e,n,r){return!(e.split(vr.CACHE_KEY_SEPARATOR).length<3||n&&!e.toLowerCase().includes(n.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(vr.CACHE_KEY_SEPARATOR).length<6)return!1;const n=e.toLowerCase();if(n.indexOf(lt.ID_TOKEN.toLowerCase())===-1&&n.indexOf(lt.ACCESS_TOKEN.toLowerCase())===-1&&n.indexOf(lt.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&n.indexOf(lt.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(n.indexOf(lt.REFRESH_TOKEN.toLowerCase())>-1){const r=`${lt.REFRESH_TOKEN}${vr.CACHE_KEY_SEPARATOR}${this.clientId}${vr.CACHE_KEY_SEPARATOR}`,o=`${lt.REFRESH_TOKEN}${vr.CACHE_KEY_SEPARATOR}${uf}${vr.CACHE_KEY_SEPARATOR}`;if(n.indexOf(r.toLowerCase())===-1&&n.indexOf(o.toLowerCase())===-1)return!1}else if(n.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,n){return!(n.clientId&&!this.matchClientId(e,n.clientId)||n.userAssertionHash&&!this.matchUserAssertionHash(e,n.userAssertionHash)||typeof n.homeAccountId=="string"&&!this.matchHomeAccountId(e,n.homeAccountId)||n.environment&&!this.matchEnvironment(e,n.environment)||n.realm&&!this.matchRealm(e,n.realm)||n.credentialType&&!this.matchCredentialType(e,n.credentialType)||n.familyId&&!this.matchFamilyId(e,n.familyId)||n.target&&!this.matchTarget(e,n.target)||(n.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==n.requestedClaimsHash||e.credentialType===lt.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(n.tokenType&&!this.matchTokenType(e,n.tokenType)||n.tokenType===Vt.SSH&&n.keyId&&!this.matchKeyId(e,n.keyId)))}getAppMetadataFilteredBy(e){const n=this.getKeys(),r={};return n.forEach(o=>{if(!this.isAppMetadata(o))return;const i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[o]=i))}),r}getAuthorityMetadataByAlias(e){const n=this.getAuthorityMetadataKeys();let r=null;return n.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;const i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(r=i)}),r}async removeAllAccounts(){const e=this.getAccountKeys(),n=[];e.forEach(r=>{n.push(this.removeAccount(r))}),await Promise.all(n)}async removeAccount(e){const n=this.getAccount(e,this.commonLogger);n&&(await this.removeAccountContext(n),this.removeItem(e))}async removeAccountContext(e){const n=this.getTokenKeys(),r=e.generateAccountId(),o=[];n.idToken.forEach(i=>{i.indexOf(r)===0&&this.removeIdToken(i)}),n.accessToken.forEach(i=>{i.indexOf(r)===0&&o.push(this.removeAccessToken(i))}),n.refreshToken.forEach(i=>{i.indexOf(r)===0&&this.removeRefreshToken(i)}),await Promise.all(o)}updateOutdatedCachedAccount(e,n,r){var o;if(n&&n.isSingleTenant()){(o=this.commonLogger)==null||o.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const i=this.getAccountKeys().filter(h=>h.startsWith(n.homeAccountId)),s=[];i.forEach(h=>{const f=this.getCachedAccountEntity(h);f&&s.push(f)});const a=s.find(h=>av(h.realm,h.homeAccountId))||s[0];a.tenantProfiles=s.map(h=>({tenantId:h.realm,localAccountId:h.localAccountId,name:h.name,isHomeTenant:av(h.realm,h.homeAccountId)}));const l=fd.toObject(new Vn,{...a}),u=l.generateAccountKey();return i.forEach(h=>{h!==u&&this.removeOutdatedAccount(e)}),this.setAccount(l),r==null||r.verbose("Updated an outdated account entity in the cache"),l}return n}async removeAccessToken(e){const n=this.getAccessTokenCredential(e);if(n){if(n.credentialType.toLowerCase()===lt.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&n.tokenType===Vt.POP){const o=n.keyId;if(o)try{await this.cryptoImpl.removeTokenBindingKey(o)}catch{throw Ae(bw)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n)}),!0}readAccountFromCache(e){const n=Vn.generateAccountCacheKey(e);return this.getAccount(n,this.commonLogger)}getIdToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getIdToken called");const s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:lt.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(s,n),l=a.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let u=a;if(!r){const h=new Map;a.forEach((p,g)=>{p.realm===e.tenantId&&h.set(g,p)});const f=h.size;if(f<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(f===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),h.values().next().value;u=h}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),u.forEach((h,f)=>{this.removeIdToken(f)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,n){const r=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,{clientId:this.clientId,...e}))return;const s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,n,r,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");const a=xn.createSearchScopes(n.scopes),l=n.authenticationScheme||Vt.BEARER,u=l.toLowerCase()!==Vt.BEARER.toLowerCase()?lt.ACCESS_TOKEN_WITH_AUTH_SCHEME:lt.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:u,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:l,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},f=r&&r.accessToken||this.getTokenKeys().accessToken,p=[];f.forEach(v=>{if(this.accessTokenKeyMatchesFilter(v,h,!0)){const y=this.getAccessTokenCredential(v);y&&this.credentialMatchesFilter(y,h)&&p.push(y)}});const g=p.length;return g<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):g>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),p.forEach(v=>{this.removeAccessToken(Su(v))}),i&&s&&i.addFields({multiMatchedAT:p.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),p[0])}accessTokenKeyMatchesFilter(e,n,r){const o=e.toLowerCase();if(n.clientId&&o.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&o.indexOf(n.homeAccountId.toLowerCase())===-1||n.realm&&o.indexOf(n.realm.toLowerCase())===-1||n.requestedClaimsHash&&o.indexOf(n.requestedClaimsHash.toLowerCase())===-1)return!1;if(n.target){const i=n.target.asArray();for(let s=0;s<i.length;s++){if(r&&!o.includes(i[s].toLowerCase()))return!1;if(!r&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;const i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const s=n?uf:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:lt.REFRESH_TOKEN,clientId:this.clientId,familyId:s},l=r&&r.refreshToken||this.getTokenKeys().refreshToken,u=[];l.forEach(f=>{if(this.refreshTokenKeyMatchesFilter(f,a)){const p=this.getRefreshTokenCredential(f);p&&this.credentialMatchesFilter(p,a)&&u.push(p)}});const h=u.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(h>1&&o&&i&&o.addFields({multiMatchedRT:h},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])}refreshTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.familyId&&r.indexOf(n.familyId.toLowerCase())===-1||!n.familyId&&n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const n={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(n),o=Object.keys(r).map(s=>r[s]),i=o.length;if(i<1)return null;if(i>1)throw Ae(hw);return o[0]}isAppMetadataFOCI(e){const n=this.readAppMetadataFromCache(e);return!!(n&&n.familyId===uf)}matchHomeAccountId(e,n){return typeof e.homeAccountId=="string"&&n===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,n){const r=e.oid||e.sub;return n===r}matchLocalAccountIdFromTenantProfile(e,n){return e.localAccountId===n}matchName(e,n){var r;return n.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,n){return!!(e&&typeof e=="string"&&(n==null?void 0:n.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,n){return!!(e.userAssertionHash&&n===e.userAssertionHash)}matchEnvironment(e,n){if(this.staticAuthorityOptions){const o=xte(this.staticAuthorityOptions,this.commonLogger);if(o.includes(n)&&o.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(n);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,n){return e.credentialType&&n.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,n){return!!(e.clientId&&n===e.clientId)}matchFamilyId(e,n){return!!(e.familyId&&n===e.familyId)}matchRealm(e,n){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===n.toLowerCase()}matchNativeAccountId(e,n){return!!(e.nativeAccountId&&n===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,n){return e.login_hint===n||e.preferred_username===n||e.upn===n}matchSid(e,n){return e.sid===n}matchAuthorityType(e,n){return!!(e.authorityType&&n.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,n){return e.credentialType!==lt.ACCESS_TOKEN&&e.credentialType!==lt.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:xn.fromString(e.target).containsScopeSet(n)}matchTokenType(e,n){return!!(e.tokenType&&e.tokenType===n)}matchKeyId(e,n){return!!(e.keyId&&e.keyId===n)}isAppMetadata(e){return e.indexOf(rw)!==-1}isAuthorityMetadata(e){return e.indexOf(ev.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${ev.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,n){for(const r in n)e[r]=n[r];return e}}class Nte extends fd{setAccount(){throw Ae(yt)}getAccount(){throw Ae(yt)}getCachedAccountEntity(){throw Ae(yt)}setIdTokenCredential(){throw Ae(yt)}getIdTokenCredential(){throw Ae(yt)}setAccessTokenCredential(){throw Ae(yt)}getAccessTokenCredential(){throw Ae(yt)}setRefreshTokenCredential(){throw Ae(yt)}getRefreshTokenCredential(){throw Ae(yt)}setAppMetadata(){throw Ae(yt)}getAppMetadata(){throw Ae(yt)}setServerTelemetry(){throw Ae(yt)}getServerTelemetry(){throw Ae(yt)}setAuthorityMetadata(){throw Ae(yt)}getAuthorityMetadata(){throw Ae(yt)}getAuthorityMetadataKeys(){throw Ae(yt)}setThrottlingCache(){throw Ae(yt)}getThrottlingCache(){throw Ae(yt)}removeItem(){throw Ae(yt)}getKeys(){throw Ae(yt)}getAccountKeys(){throw Ae(yt)}getTokenKeys(){throw Ae(yt)}async clear(){throw Ae(yt)}updateCredentialCacheKey(){throw Ae(yt)}removeOutdatedAccount(){throw Ae(yt)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const U3={tokenRenewalOffsetSeconds:dte,preventCorsPreflight:!1},Pte={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:pn.Info,correlationId:ie.EMPTY_STRING},Mte={claimsBasedCachingEnabled:!1},Ote={async sendGetRequestAsync(){throw Ae(yt)},async sendPostRequestAsync(){throw Ae(yt)}},Lte={sku:ie.SKU,version:Sw,cpu:ie.EMPTY_STRING,os:ie.EMPTY_STRING},Dte={clientSecret:ie.EMPTY_STRING,clientAssertion:void 0},jte={azureCloudInstance:Gf.None,tenant:`${ie.DEFAULT_COMMON_TENANT}`},Ute={application:{appName:"",appVersion:""}};function Fte({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:l,telemetry:u,serverTelemetryManager:h,persistencePlugin:f,serializableCache:p}){const g={...Pte,...n};return{authOptions:Bte(t),systemOptions:{...U3,...e},loggerOptions:g,cacheOptions:{...Mte,...r},storageInterface:o||new Nte(t.clientId,iv,new hi(g)),networkInterface:i||Ote,cryptoInterface:s||iv,clientCredentials:a||Dte,libraryInfo:{...Lte,...l},telemetry:{...Ute,...u},serverTelemetryManager:h||null,persistencePlugin:f||null,serializableCache:p||null}}function Bte(t){return{clientCapabilities:[],azureCloudOptions:jte,skipAuthorityMetadataCache:!1,instanceAware:!1,...t}}function H1(t){return t.authOptions.authority.options.protocolMode===vs.OIDC}/*! @azure/msal-common v14.15.0 2024-09-20 */class Yi extends Et{constructor(e,n,r,o,i){super(e,n,r),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,Yi.prototype)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Li{static generateThrottlingStorageKey(e){return`${df.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,n){var i;const r=Li.generateThrottlingStorageKey(n),o=e.getThrottlingCache(r);if(o){if(o.throttleTime<Date.now()){e.removeItem(r);return}throw new Yi(((i=o.errorCodes)==null?void 0:i.join(" "))||ie.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,n,r){if(Li.checkResponseStatus(r)||Li.checkResponseForRetryAfter(r)){const o={throttleTime:Li.calculateThrottleTime(parseInt(r.headers[zi.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Li.generateThrottlingStorageKey(n),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(zi.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const n=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(n||df.DEFAULT_THROTTLE_TIME_SECONDS),r+df.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,n,r,o){const i={clientId:n,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},s=this.generateThrottlingStorageKey(i);e.removeItem(s)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Hte{constructor(e,n){this.networkClient=e,this.cacheManager=n}async sendPostRequest(e,n,r){Li.preProcess(this.cacheManager,e);let o;try{o=await this.networkClient.sendPostRequestAsync(n,r)}catch(i){throw i instanceof Et?i:Ae(sw)}return Li.postProcess(this.cacheManager,e,o),o}}/*! @azure/msal-common v14.15.0 2024-09-20 */const mo={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.15.0 2024-09-20 */const pd="client_id",zte="redirect_uri",sR="response_type",Vte="response_mode",$te="grant_type",Gte="claims",Kte="scope",qte="refresh_token",Wte="state",Yte="nonce",Qte="prompt",Jte="code",Xte="code_challenge",Zte="code_challenge_method",ene="code_verifier",tne="client-request-id",nne="x-client-SKU",rne="x-client-VER",one="x-client-OS",ine="x-client-CPU",sne="x-client-current-telemetry",ane="x-client-last-telemetry",cne="x-ms-lib-capability",lne="x-app-name",une="x-app-ver",dne="post_logout_redirect_uri",hne="id_token_hint",fne="device_code",pne="client_secret",mne="client_assertion",gne="client_assertion_type",aR="token_type",cR="req_cnf",vne="assertion",yne="requested_token_use",lR="return_spa_code",bne="nativebroker",Cne="logout_hint",Sne="sid",Ine="login_hint",Ene="domain_hint",Tne="x-client-xtra-sku";/*! @azure/msal-common v14.15.0 2024-09-20 */class lu{static validateRedirectUri(e){if(!e)throw Zt(b3)}static validatePrompt(e){const n=[];for(const r in er)n.push(er[r]);if(n.indexOf(e)<0)throw Zt(E3)}static validateClaims(e){try{JSON.parse(e)}catch{throw Zt(Ew)}}static validateCodeChallengeParams(e,n){if(!e||!n)throw Zt(Tw);this.validateCodeChallengeMethod(n)}static validateCodeChallengeMethod(e){if([Yx.PLAIN,Yx.S256].indexOf(e)<0)throw Zt(_3)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class hf{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(sR,encodeURIComponent(ie.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(sR,encodeURIComponent(`${ie.TOKEN_RESPONSE_TYPE} ${ie.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(Vte,encodeURIComponent(e||cte.QUERY))}addNativeBroker(){this.parameters.set(bne,encodeURIComponent("1"))}addScopes(e,n=!0,r=Ea){n&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const o=n?[...e||[],...r]:e||[],i=new xn(o);this.parameters.set(Kte,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(pd,encodeURIComponent(e))}addRedirectUri(e){lu.validateRedirectUri(e),this.parameters.set(zte,encodeURIComponent(e))}addPostLogoutRedirectUri(e){lu.validateRedirectUri(e),this.parameters.set(dne,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(hne,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(Ene,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(Ine,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(zi.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(zi.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(Sne,encodeURIComponent(e))}addClaims(e,n){const r=this.addClientCapabilitiesToClaims(e,n);lu.validateClaims(r),this.parameters.set(Gte,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(tne,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(nne,e.sku),this.parameters.set(rne,e.version),e.os&&this.parameters.set(one,e.os),e.cpu&&this.parameters.set(ine,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(lne,e.appName),e!=null&&e.appVersion&&this.parameters.set(une,e.appVersion)}addPrompt(e){lu.validatePrompt(e),this.parameters.set(`${Qte}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Wte,encodeURIComponent(e))}addNonce(e){this.parameters.set(Yte,encodeURIComponent(e))}addCodeChallengeParams(e,n){if(lu.validateCodeChallengeParams(e,n),e&&n)this.parameters.set(Xte,encodeURIComponent(e)),this.parameters.set(Zte,encodeURIComponent(n));else throw Zt(Tw)}addAuthorizationCode(e){this.parameters.set(Jte,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(fne,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(qte,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(ene,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(pne,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(mne,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(gne,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(vne,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(yne,encodeURIComponent(e))}addGrantType(e){this.parameters.set($te,encodeURIComponent(e))}addClientInfo(){this.parameters.set(lte,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([n,r])=>{!this.parameters.has(n)&&r&&this.parameters.set(n,r)})}addClientCapabilitiesToClaims(e,n){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw Zt(Ew)}return n&&n.length>0&&(r.hasOwnProperty(hm.ACCESS_TOKEN)||(r[hm.ACCESS_TOKEN]={}),r[hm.ACCESS_TOKEN][hm.XMS_CC]={values:n}),JSON.stringify(r)}addUsername(e){this.parameters.set(Jx.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Jx.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(aR,Vt.POP),this.parameters.set(cR,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(aR,Vt.SSH),this.parameters.set(cR,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(sne,e.generateCurrentRequestHeaderValue()),this.parameters.set(ane,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(cne,df.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(Cne,encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach((n,r)=>{e.push(`${r}=${n}`)}),e.join("&")}}/*! @azure/msal-common v14.15.0 2024-09-20 */function wne(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.15.0 2024-09-20 */function _ne(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}/*! @azure/msal-common v14.15.0 2024-09-20 */function Ane(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}/*! @azure/msal-common v14.15.0 2024-09-20 */const R={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},kne=new Map([[R.AcquireTokenByCode,"ATByCode"],[R.AcquireTokenByRefreshToken,"ATByRT"],[R.AcquireTokenSilent,"ATS"],[R.AcquireTokenSilentAsync,"ATSAsync"],[R.AcquireTokenPopup,"ATPopup"],[R.AcquireTokenRedirect,"ATRedirect"],[R.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[R.CryptoOptsSignJwt,"CryptoSignJwt"],[R.SilentCacheClientAcquireToken,"SltCacheClientAT"],[R.SilentIframeClientAcquireToken,"SltIframeClientAT"],[R.SilentRefreshClientAcquireToken,"SltRClientAT"],[R.SsoSilent,"SsoSlt"],[R.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[R.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[R.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[R.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[R.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[R.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[R.BrokerHandhshake,"BrokerHandshake"],[R.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[R.AcquireTokenByBroker,"ATByBroker"],[R.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[R.RefreshTokenClientAcquireToken,"RTClientAT"],[R.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[R.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[R.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[R.AcquireTokenFromCache,"ATFromCache"],[R.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[R.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[R.AcquireTokenBySilentIframe,"ATBySltIframe"],[R.InitializeBaseRequest,"InitBaseReq"],[R.InitializeSilentRequest,"InitSltReq"],[R.InitializeClientApplication,"InitClientApplication"],[R.SilentIframeClientTokenHelper,"SIClientTHelper"],[R.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[R.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[R.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[R.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[R.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[R.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[R.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[R.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[R.GetAuthCodeUrl,"GetAuthCodeUrl"],[R.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[R.HandleCodeResponse,"HandleCodeResp"],[R.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[R.AuthClientAcquireToken,"AuthClientAT"],[R.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[R.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[R.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[R.PopTokenGenerateCnf,"PopTGenCnf"],[R.PopTokenGenerateKid,"PopTGenKid"],[R.HandleServerTokenResponse,"HandleServerTRes"],[R.DeserializeResponse,"DeserializeRes"],[R.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[R.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[R.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[R.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[R.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[R.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[R.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[R.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[R.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[R.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[R.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[R.AcquireTokenByCodeAsync,"ATByCodeAsync"],[R.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[R.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[R.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[R.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[R.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[R.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[R.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[R.NativeGenerateAuthResult,"NtvGenAuthRes"],[R.RemoveHiddenIframe,"RemoveHiddenIframe"],[R.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[R.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[R.GeneratePkceCodes,"GenPkceCodes"],[R.GenerateCodeVerifier,"GenCodeVerifier"],[R.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[R.Sha256Digest,"Sha256Digest"],[R.GetRandomValues,"GetRandomValues"]]),z1={InProgress:1,Completed:2},xne=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);/*! @azure/msal-common v14.15.0 2024-09-20 */const yl=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}try{const a=t(...i);return s==null||s.end({success:!0}),n.trace(`Returning result from ${e}`),a}catch(a){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},Oe=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}return r==null||r.setPreQueueTime(e,o),t(...i).then(a=>(n.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};/*! @azure/msal-common v14.15.0 2024-09-20 */class sb{constructor(e,n,r,o){this.networkInterface=e,this.logger=n,this.performanceClient=r,this.correlationId=o}async detectRegion(e,n){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(R.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)n.region_source=Gl.ENVIRONMENT_VARIABLE;else{const i=sb.IMDS_OPTIONS;try{const s=await Oe(this.getRegionFromIMDS.bind(this),R.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(ie.IMDS_VERSION,i);if(s.status===pm.httpSuccess&&(r=s.body,n.region_source=Gl.IMDS),s.status===pm.httpBadRequest){const a=await Oe(this.getCurrentVersion.bind(this),R.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return n.region_source=Gl.FAILED_AUTO_DETECTION,null;const l=await Oe(this.getRegionFromIMDS.bind(this),R.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);l.status===pm.httpSuccess&&(r=l.body,n.region_source=Gl.IMDS)}}catch{return n.region_source=Gl.FAILED_AUTO_DETECTION,null}}return r||(n.region_source=Gl.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,n){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(R.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${ie.IMDS_ENDPOINT}?api-version=${e}&format=text`,n,ie.IMDS_TIMEOUT)}async getCurrentVersion(e){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(R.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${ie.IMDS_ENDPOINT}?format=json`,e);return r.status===pm.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}sb.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.15.0 2024-09-20 */class mr{constructor(e,n,r,o,i,s,a,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=l||!1,this.regionDiscovery=new sb(n,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(ie.CIAM_AUTH_URL))return Xo.Ciam;const n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case ie.ADFS:return Xo.Adfs;case ie.DSTS:return Xo.Dsts}return Xo.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new At(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Ae(Ri)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Ae(Ri)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Ae(Ri)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Ae(Cw);return this.replacePath(this.metadata.end_session_endpoint)}else throw Ae(Ri)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Ae(Ri)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Ae(Ri)}canReplaceTenant(e){return e.PathSegments.length===1&&!mr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Xo.Default&&this.protocolMode===vs.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let n=e;const o=new At(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,l)=>{let u=i[l];if(l===0&&this.canReplaceTenant(o)){const h=new At(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];u!==h&&(this.logger.verbose(`Replacing tenant domain name ${u} with id ${h}`),u=h)}a!==u&&(n=n.replace(`/${u}/`,`/${a}/`))}),this.replaceTenant(n)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Xo.Adfs||this.protocolMode!==vs.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(R.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),n=await Oe(this.updateCloudDiscoveryMetadata.bind(this),R.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Oe(this.updateEndpointMetadata.bind(this),R.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,n,{source:r}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:n,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:nR(),jwks_uri:""}),e}updateCachedMetadata(e,n,r){n!==so.CACHE&&(r==null?void 0:r.source)!==so.CACHE&&(e.expiresAt=nR(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(R.AuthorityUpdateEndpointMetadata,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){if(n.source===so.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&n.metadata){const a=await Oe(this.updateMetadataWithRegionalInformation.bind(this),R.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n.metadata);mm(e,a,!1),e.canonical_authority=this.canonicalAuthority}return n.source}let r=await Oe(this.getEndpointMetadataFromNetwork.bind(this),R.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(r=await Oe(this.updateMetadataWithRegionalInformation.bind(this),R.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),mm(e,r,!0),so.NETWORK;throw Ae(aw,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const n=this.getEndpointMetadataFromConfig();if(n)return this.logger.verbose("Found endpoint metadata in authority configuration"),mm(e,n,!1),{source:so.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return mm(e,o,!1),{source:so.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=rR(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:so.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new At(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Zt(A3)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(R.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{const o=await this.networkInterface.sendGetRequestAsync(n,e);return wne(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in oR?oR[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,o,i;(r=this.performanceClient)==null||r.addQueueMeasurement(R.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const n=(o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.azureRegion;if(n){if(n!==ie.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=tS.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,mr.replaceWithRegionalInformation(e,n);const s=await Oe(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),R.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=tS.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,mr.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=tS.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(R.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await Oe(this.getCloudDiscoveryMetadataFromNetwork.bind(this),R.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return nS(e,r,!0),so.NETWORK;throw Zt(k3)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||ie.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||ie.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||ie.NOT_APPLICABLE}`);const n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),nS(e,n,!1),so.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=Rte(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),nS(e,o,!1),so.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=rR(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),so.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Xo.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),mr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=lv(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Zt(ww)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),mr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(R.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${ie.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,n={};let r=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,n);let s,a;if(_ne(i.body))s=i.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(Ane(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===ie.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=lv(a,this.hostnameAndPort)}catch(i){if(i instanceof Et)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{const s=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=mr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(n=>n&&At.getDomainFromUrl(n).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let r;if(n&&n.azureCloudInstance!==Gf.None){const o=n.tenant?n.tenant:ie.DEFAULT_COMMON_TENANT;r=`${n.azureCloudInstance}/${o}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return ie.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Ae(Ri)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return D3.has(e)}static isPublicCloudAuthority(e){return ie.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,r){const o=new At(e);o.validateAsUri();const i=o.getUrlComponents();let s=`${n}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${n}.${ie.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=At.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,n){const r={...e};return r.authorization_endpoint=mr.buildRegionalAuthorityString(r.authorization_endpoint,n),r.token_endpoint=mr.buildRegionalAuthorityString(r.token_endpoint,n),r.end_session_endpoint&&(r.end_session_endpoint=mr.buildRegionalAuthorityString(r.end_session_endpoint,n)),r}static transformCIAMAuthority(e){let n=e;const o=new At(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(ie.CIAM_AUTH_URL)){const i=o.HostNameAndPort.split(".")[0];n=`${n}${i}${ie.AAD_TENANT_DOMAIN_SUFFIX}`}return n}}mr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ga.COMMON,ga.CONSUMERS,ga.ORGANIZATIONS]);function Rne(t){var o;const r=(o=new At(t).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:o.toLowerCase();switch(r){case ga.COMMON:case ga.ORGANIZATIONS:case ga.CONSUMERS:return;default:return r}}function F3(t){return t.endsWith(ie.FORWARD_SLASH)?t:`${t}${ie.FORWARD_SLASH}`}function Nne(t){const e=t.cloudDiscoveryMetadata;let n;if(e)try{n=JSON.parse(e)}catch{throw Zt(ww)}return{canonicalAuthority:t.authority?F3(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:n}}/*! @azure/msal-common v14.15.0 2024-09-20 */async function B3(t,e,n,r,o,i,s){s==null||s.addQueueMeasurement(R.AuthorityFactoryCreateDiscoveredInstance,i);const a=mr.transformCIAMAuthority(F3(t)),l=new mr(a,e,n,r,o,i,s);try{return await Oe(l.resolveEndpointsAsync.bind(l),R.AuthorityResolveEndpointsAsync,o,s,i)(),l}catch{throw Ae(Ri)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Rw{constructor(e,n){this.config=Fte(e),this.logger=new hi(this.config.loggerOptions,g3,Sw),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Hte(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n}createTokenRequestHeaders(e){const n={};if(n[zi.CONTENT_TYPE]=ie.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case mo.HOME_ACCOUNT_ID:try{const r=Iu(e.credential);n[zi.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case mo.UPN:n[zi.CCS_HEADER]=`UPN: ${e.credential}`;break}return n}async executePostToTokenEndpoint(e,n,r,o,i,s){var l,u,h,f;s&&((l=this.performanceClient)==null||l.addQueueMeasurement(s,i));const a=await this.networkManager.sendPostRequest(o,e,{body:n,headers:r});return(f=this.performanceClient)==null||f.addFields({refreshTokenSize:((u=a.body.refresh_token)==null?void 0:u.length)||0,httpVerToken:((h=a.headers)==null?void 0:h[zi.X_MS_HTTP_VERSION])||""},i),this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async updateAuthority(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(R.UpdateTokenEndpointAuthority,n);const r=`https://${e}/${this.authority.tenant}/`,o=await B3(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,n,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const n=new hf;return e.tokenQueryParameters&&n.addExtraQueryParameters(e.tokenQueryParameters),n.createQueryString()}}/*! @azure/msal-common v14.15.0 2024-09-20 */const uv="no_tokens_found",H3="native_account_unavailable",Nw="refresh_token_expired",Pne="interaction_required",Mne="consent_required",One="login_required",ab="bad_token";/*! @azure/msal-common v14.15.0 2024-09-20 */const uR=[Pne,Mne,One,ab],Lne=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Dne={[uv]:"No refresh token found in the cache. Please sign-in.",[H3]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Nw]:"Refresh token has expired.",[ab]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class jr extends Et{constructor(e,n,r,o,i,s,a,l){super(e,n,r),Object.setPrototypeOf(this,jr.prototype),this.timestamp=o||ie.EMPTY_STRING,this.traceId=i||ie.EMPTY_STRING,this.correlationId=s||ie.EMPTY_STRING,this.claims=a||ie.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function dR(t,e,n){const r=!!t&&uR.indexOf(t)>-1,o=!!n&&Lne.indexOf(n)>-1,i=!!e&&uR.some(s=>e.indexOf(s)>-1);return r||i||o}function V1(t){return new jr(t,Dne[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */class ci{static setRequestState(e,n,r){const o=ci.generateLibraryState(e,r);return n?`${o}${ie.RESOURCE_DELIM}${n}`:o}static generateLibraryState(e,n){if(!e)throw Ae(rv);const r={id:e.createNewGuid()};n&&(r.meta=n);const o=JSON.stringify(r);return e.base64Encode(o)}static parseRequestState(e,n){if(!e)throw Ae(rv);if(!n)throw Ae(Fc);try{const r=n.split(ie.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(ie.RESOURCE_DELIM):ie.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||ie.EMPTY_STRING,libraryState:a}}catch{throw Ae(Fc)}}}/*! @azure/msal-common v14.15.0 2024-09-20 */const jne={SW:"sw"};class Bc{constructor(e,n){this.cryptoUtils=e,this.performanceClient=n}async generateCnf(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(R.PopTokenGenerateCnf,e.correlationId);const r=await Oe(this.generateKid.bind(this),R.PopTokenGenerateCnf,n,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(R.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:jne.SW}}async signPopToken(e,n,r){return this.signPayload(e,n,r)}async signPayload(e,n,r,o){const{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:l,shrOptions:u}=r,h=s?new At(s):void 0,f=h==null?void 0:h.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Wi(),m:i==null?void 0:i.toUpperCase(),u:f==null?void 0:f.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:f==null?void 0:f.AbsolutePath,q:f!=null&&f.QueryString?[[],f.QueryString]:void 0,client_claims:a||void 0,...o},n,u,r.correlationId)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Une{constructor(e,n){this.cache=e,this.hasChanged=n}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Fne(t){var r,o;const e="code=",n=(r=t.error_uri)==null?void 0:r.lastIndexOf(e);return n&&n>=0?(o=t.error_uri)==null?void 0:o.substring(n+e.length):void 0}class Hc{constructor(e,n,r,o,i,s,a){this.clientId=e,this.cacheStorage=n,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,n){if(!e.state||!n)throw e.state?Ae($f,"Cached State"):Ae($f,"Server State");let r,o;try{r=decodeURIComponent(e.state)}catch{throw Ae(Fc,e.state)}try{o=decodeURIComponent(n)}catch{throw Ae(Fc,e.state)}if(r!==o)throw Ae(lw);if(e.error||e.error_description||e.suberror){const i=Fne(e);throw dR(e.error,e.error_description,e.suberror)?new jr(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new Yi(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,n){var r;if(e.error||e.error_description||e.suberror){const o=`Error(s): ${e.error_codes||ie.NOT_AVAILABLE} - Timestamp: ${e.timestamp||ie.NOT_AVAILABLE} - Description: ${e.error_description||ie.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||ie.NOT_AVAILABLE} - Trace ID: ${e.trace_id||ie.NOT_AVAILABLE}`,i=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,s=new Yi(e.error,o,e.suberror,i,e.status);if(n&&e.status&&e.status>=dm.SERVER_ERROR_RANGE_START&&e.status<=dm.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(n&&e.status&&e.status>=dm.CLIENT_ERROR_RANGE_START&&e.status<=dm.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw dR(e.error,e.error_description,e.suberror)?new jr(e.error,e.error_description,e.suberror,e.timestamp||ie.EMPTY_STRING,e.trace_id||ie.EMPTY_STRING,e.correlation_id||ie.EMPTY_STRING,e.claims||ie.EMPTY_STRING,i):s}}async handleServerTokenResponse(e,n,r,o,i,s,a,l,u){var v;(v=this.performanceClient)==null||v.addQueueMeasurement(R.HandleServerTokenResponse,e.correlation_id);let h;if(e.id_token){if(h=vl(e.id_token||ie.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&h.nonce!==i.nonce)throw Ae(uw);if(o.maxAge||o.maxAge===0){const y=h.auth_time;if(!y)throw Ae(Xy);v3(y,o.maxAge)}}this.homeAccountIdentifier=Vn.generateHomeAccountId(e.client_info||ie.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,h);let f;i&&i.state&&(f=ci.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const p=this.generateCacheRecord(e,n,r,o,h,s,i);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new Une(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),a&&!l&&p.account){const y=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(y,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Hc.generateAuthenticationResult(this.cryptoObj,n,p,!1,o,h,f,void 0,u)}await this.cacheStorage.saveCacheRecord(p,o.storeInCache,o.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return Hc.generateAuthenticationResult(this.cryptoObj,n,p,!1,o,h,f,e,u)}generateCacheRecord(e,n,r,o,i,s,a){const l=n.getPreferredCache();if(!l)throw Ae(eb);const u=M3(i);let h,f;e.id_token&&i&&(h=nb(this.homeAccountIdentifier,l,e.id_token,this.clientId,u||""),f=Pw(this.cacheStorage,n,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,l,u,a,void 0,this.logger));let p=null;if(e.access_token){const y=e.scope?xn.fromString(e.scope):new xn(o.scopes||[]),b=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,C=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,S=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,I=r+b,E=I+C,T=S&&S>0?r+S:void 0;p=rb(this.homeAccountIdentifier,l,e.access_token,this.clientId,u||n.tenant||"",y.printScopes(),I,E,this.cryptoObj.base64Decode,T,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let g=null;if(e.refresh_token){let y;if(e.refresh_token_expires_in){const b=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;y=r+b}g=y3(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,s,y)}let v=null;return e.foci&&(v={clientId:this.clientId,environment:l,familyId:e.foci}),{account:f,idToken:h,accessToken:p,refreshToken:g,appMetadata:v}}static async generateAuthenticationResult(e,n,r,o,i,s,a,l,u){var I,E,T,w,A;let h=ie.EMPTY_STRING,f=[],p=null,g,v,y=ie.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===Vt.POP&&!i.popKid){const _=new Bc(e),{secret:L,keyId:N}=r.accessToken;if(!N)throw Ae(tb);h=await _.signPopToken(L,N,i)}else h=r.accessToken.secret;f=xn.fromString(r.accessToken.target).asArray(),p=new Date(Number(r.accessToken.expiresOn)*1e3),g=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(v=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(y=r.appMetadata.familyId===uf?uf:"");const b=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",C=(s==null?void 0:s.tid)||"";l!=null&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=l==null?void 0:l.spa_accountid);const S=r.account?Aw(r.account.getAccountInfo(),void 0,s,(I=r.idToken)==null?void 0:I.secret):null;return{authority:n.canonicalAuthority,uniqueId:b,tenantId:C,scopes:f,account:S,idToken:((E=r==null?void 0:r.idToken)==null?void 0:E.secret)||"",idTokenClaims:s||{},accessToken:h,fromCache:o,expiresOn:p,extExpiresOn:g,refreshOn:v,correlationId:i.correlationId,requestId:u||ie.EMPTY_STRING,familyId:y,tokenType:((T=r.accessToken)==null?void 0:T.tokenType)||ie.EMPTY_STRING,state:a?a.userRequestState:ie.EMPTY_STRING,cloudGraphHostName:((w=r.account)==null?void 0:w.cloudGraphHostName)||ie.EMPTY_STRING,msGraphHost:((A=r.account)==null?void 0:A.msGraphHost)||ie.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function Pw(t,e,n,r,o,i,s,a,l,u,h){h==null||h.verbose("setCachedAccount called");const p=t.getAccountKeys().find(C=>C.startsWith(n));let g=null;p&&(g=t.getAccount(p,h));const v=g||Vn.createAccount({homeAccountId:n,idTokenClaims:o,clientInfo:i,environment:s,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:u},e,r),y=v.tenantProfiles||[],b=a||v.realm;if(b&&!y.find(C=>C.tenantId===b)){const C=_w(n,v.localAccountId,b,o);y.push(C)}return v.tenantProfiles=y,v}/*! @azure/msal-common v14.15.0 2024-09-20 */async function z3(t,e,n){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:n})}/*! @azure/msal-common v14.15.0 2024-09-20 */class V3 extends Rw{constructor(e,n){var r;super(e,n),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(R.GetAuthCodeUrl,e.correlationId);const n=await Oe(this.createAuthCodeUrlQueryString.bind(this),R.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return At.appendQueryString(this.authority.authorizationEndpoint,n)}async acquireToken(e,n){var a,l;if((a=this.performanceClient)==null||a.addQueueMeasurement(R.AuthClientAcquireToken,e.correlationId),!e.code)throw Ae(fw);const r=Wi(),o=await Oe(this.executeTokenRequest.bind(this),R.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(l=o.headers)==null?void 0:l[zi.X_MS_REQUEST_ID],s=new Hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),Oe(s.handleServerTokenResponse.bind(s),R.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,n,void 0,void 0,void 0,i)}handleFragmentResponse(e,n){if(new Hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,n),!e.code)throw Ae(yw);return e}getLogoutUri(e){if(!e)throw Zt(w3);const n=this.createLogoutUrlQueryString(e);return At.appendQueryString(this.authority.endSessionEndpoint,n)}async executeTokenRequest(e,n){var u,h;(u=this.performanceClient)==null||u.addQueueMeasurement(R.AuthClientExecuteTokenRequest,n.correlationId);const r=this.createTokenQueryParameters(n),o=At.appendQueryString(e.tokenEndpoint,r),i=await Oe(this.createTokenRequestBody.bind(this),R.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,n.correlationId)(n);let s;if(n.clientInfo)try{const f=sv(n.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${f.uid}${vr.CLIENT_INFO_SEPARATOR}${f.utid}`,type:mo.HOME_ACCOUNT_ID}}catch(f){this.logger.verbose("Could not parse client info for CCS Header: "+f)}const a=this.createTokenRequestHeaders(s||n.ccsCredential),l={clientId:((h=n.tokenBodyParameters)==null?void 0:h.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid};return Oe(this.executePostToTokenEndpoint.bind(this),R.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,n.correlationId)(o,i,a,l,n.correlationId,R.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(R.AuthClientCreateTokenRequestBody,e.correlationId);const n=new hf;if(n.addClientId(((s=e.tokenBodyParameters)==null?void 0:s[pd])||this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):lu.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!H1(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;n.addClientAssertion(await z3(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(a.assertionType)}if(n.addGrantType(n3.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===Vt.POP){const a=new Bc(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await Oe(a.generateCnf.bind(a),R.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(l)}else if(e.authenticationScheme===Vt.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw Zt(ob);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();n.addCorrelationId(r),(!ai.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities);let o;if(e.clientInfo)try{const a=sv(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${a.uid}${vr.CLIENT_INFO_SEPARATOR}${a.utid}`,type:mo.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case mo.HOME_ACCOUNT_ID:try{const a=Iu(o.credential);n.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case mo.UPN:n.addCcsUpn(o.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[lR])&&n.addExtraQueryParameters({[lR]:"1"}),n.createQueryString()}async createAuthCodeUrlQueryString(e){var i,s;(i=this.performanceClient)==null||i.addQueueMeasurement(R.AuthClientCreateQueryString,e.correlationId);const n=new hf;n.addClientId(((s=e.extraQueryParameters)==null?void 0:s[pd])||this.config.authOptions.clientId);const r=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(r,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);const o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(o),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),H1(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==er.SELECT_ACCOUNT)if(e.sid&&e.prompt===er.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(l);try{const u=Iu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===er.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(a);try{const u=Iu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const u=Iu(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(e,n),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===Vt.POP)){const a=new Bc(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await Oe(a.generateCnf.bind(a),R.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(l)}return n.createQueryString()}createLogoutUrlQueryString(e){const n=new hf;return e.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&n.addCorrelationId(e.correlationId),e.idTokenHint&&n.addIdTokenHint(e.idTokenHint),e.state&&n.addState(e.state),e.logoutHint&&n.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,n),n.createQueryString()}addExtraQueryParams(e,n){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var n;return((n=e.idTokenClaims)==null?void 0:n.sid)||null}extractLoginHint(e){var n;return((n=e.idTokenClaims)==null?void 0:n.login_hint)||null}}/*! @azure/msal-common v14.15.0 2024-09-20 */const Bne=300;class $1 extends Rw{constructor(e,n){super(e,n)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(R.RefreshTokenClientAcquireToken,e.correlationId);const n=Wi(),r=await Oe(this.executeTokenRequest.bind(this),R.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=(a=r.headers)==null?void 0:a[zi.X_MS_REQUEST_ID],i=new Hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),Oe(i.handleServerTokenResponse.bind(i),R.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var r;if(!e)throw Zt(T3);if((r=this.performanceClient)==null||r.addQueueMeasurement(R.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw Ae(Zy);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Oe(this.acquireTokenWithCachedRefreshToken.bind(this),R.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){const i=o instanceof jr&&o.errorCode===uv,s=o instanceof Yi&&o.errorCode===Qx.INVALID_GRANT_ERROR&&o.subError===Qx.CLIENT_MISMATCH_ERROR;if(i||s)return Oe(this.acquireTokenWithCachedRefreshToken.bind(this),R.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return Oe(this.acquireTokenWithCachedRefreshToken.bind(this),R.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,n){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(R.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=yl(this.cacheManager.getRefreshToken.bind(this.cacheManager),R.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,n,void 0,this.performanceClient,e.correlationId);if(!r)throw V1(uv);if(r.expiresOn&&B1(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||Bne))throw V1(Nw);const o={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Vt.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:mo.HOME_ACCOUNT_ID}};try{return await Oe(this.acquireToken.bind(this),R.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(s){if(s instanceof jr&&s.subError===ab){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=Su(r);this.cacheManager.removeRefreshToken(a)}throw s}}async executeTokenRequest(e,n){var l,u;(l=this.performanceClient)==null||l.addQueueMeasurement(R.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),o=At.appendQueryString(n.tokenEndpoint,r),i=await Oe(this.createTokenRequestBody.bind(this),R.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((u=e.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return Oe(this.executePostToTokenEndpoint.bind(this),R.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,R.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(R.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const n=e.correlationId,r=new hf;if(r.addClientId(((i=e.tokenBodyParameters)==null?void 0:i[pd])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(s=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:s.defaultScopes),r.addGrantType(n3.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!H1(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addCorrelationId(n),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await z3(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===Vt.POP){const a=new Bc(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await Oe(a.generateCnf.bind(a),R.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}else if(e.authenticationScheme===Vt.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Zt(ob);if((!ai.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case mo.HOME_ACCOUNT_ID:try{const a=Iu(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case mo.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.15.0 2024-09-20 */class Hne extends Rw{constructor(e,n){super(e,n)}async acquireToken(e){var n;try{const[r,o]=await this.acquireCachedToken({...e,scopes:(n=e.scopes)!=null&&n.length?e.scopes:[...Ea]});return o===Zs.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new $1(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof Fd&&r.errorCode===ri)return new $1(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(R.SilentFlowClientAcquireCachedToken,e.correlationId);let n=Zs.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!ai.isEmptyObj(e.claims))throw this.setCacheOutcome(Zs.FORCE_REFRESH_OR_CLAIMS,e.correlationId),Ae(ri);if(!e.account)throw Ae(Zy);const r=e.account.tenantId||Rne(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,r,this.performanceClient,e.correlationId);if(i){if(pte(i.cachedAt)||B1(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Zs.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),Ae(ri);i.refreshOn&&B1(i.refreshOn,0)&&(n=Zs.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Zs.NO_CACHED_ACCESS_TOKEN,e.correlationId),Ae(ri);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Oe(this.generateResultFromCacheRecord.bind(this),R.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),n]}setCacheOutcome(e,n){var r,o;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(o=this.performanceClient)==null||o.addFields({cacheOutcome:e},n),e!==Zs.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,n){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(R.SilentFlowClientGenerateResultFromCacheRecord,n.correlationId);let r;if(e.idToken&&(r=vl(e.idToken.secret,this.config.cryptoInterface.base64Decode)),n.maxAge||n.maxAge===0){const i=r==null?void 0:r.auth_time;if(!i)throw Ae(Xy);v3(i,n.maxAge)}return Hc.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,r)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const zne={sendGetRequestAsync:()=>Promise.reject(Ae(yt)),sendPostRequestAsync:()=>Promise.reject(Ae(yt))};/*! @azure/msal-common v14.15.0 2024-09-20 */const hR=",",$3="|";function Vne(t){const{skus:e,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=t,s=new Map([[0,[n,r]],[2,[o,i]]]);let a=[];if(e!=null&&e.length){if(a=e.split(hR),a.length<4)return e}else a=Array.from({length:4},()=>$3);return s.forEach((l,u)=>{var h,f;l.length===2&&((h=l[0])!=null&&h.length)&&((f=l[1])!=null&&f.length)&&$ne({skuArr:a,index:u,skuName:l[0],skuVersion:l[1]})}),a.join(hR)}function $ne(t){const{skuArr:e,index:n,skuName:r,skuVersion:o}=t;n>=e.length||(e[n]=[r,o].join($3))}class Kf{constructor(e,n){this.cacheOutcome=Zs.NOT_APPLICABLE,this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||ie.EMPTY_STRING,this.wrapperVer=e.wrapperVer||ie.EMPTY_STRING,this.telemetryCacheKey=sr.CACHE_KEY+vr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${sr.VALUE_SEPARATOR}${this.cacheOutcome}`,n=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&n.push(`broker_error=${r}`);const o=n.join(sr.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),s=[e,i].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,s,o].join(sr.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),n=Kf.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*n).join(sr.VALUE_SEPARATOR),o=e.errors.slice(0,n).join(sr.VALUE_SEPARATOR),i=e.errors.length,s=n<i?sr.OVERFLOW_TRUE:sr.OVERFLOW_FALSE,a=[i,s].join(sr.VALUE_SEPARATOR);return[sr.SCHEMA_VERSION,e.cacheHits,r,o,a].join(sr.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const n=this.getLastRequests();n.errors.length>=sr.MAX_CACHED_ERRORS&&(n.failedRequests.shift(),n.failedRequests.shift(),n.errors.shift()),n.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Et?e.subError?n.errors.push(e.subError):e.errorCode?n.errors.push(e.errorCode):n.errors.push(e.toString()):n.errors.push(e.toString()):n.errors.push(sr.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),n=Kf.maxErrorsToSend(e),r=e.errors.length;if(n===r)this.cacheManager.removeItem(this.telemetryCacheKey);else{const o={failedRequests:e.failedRequests.slice(n*2),errors:e.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let n,r=0,o=0;const i=e.errors.length;for(n=0;n<i;n++){const s=e.failedRequests[2*n]||ie.EMPTY_STRING,a=e.failedRequests[2*n+1]||ie.EMPTY_STRING,l=e.errors[n]||ie.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+l.length+3,o<sr.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||ie.EMPTY_STRING),e.push(this.regionSource||ie.EMPTY_STRING),e.push(this.regionOutcome||ie.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const n=this.getLastRequests();n.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return Vne(e)}}/*! @azure/msal-common v14.15.0 2024-09-20 */const G3="missing_kid_error",K3="missing_alg_error";/*! @azure/msal-common v14.15.0 2024-09-20 */const Gne={[G3]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[K3]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Mw extends Et{constructor(e,n){super(e,n),this.name="JoseHeaderError",Object.setPrototypeOf(this,Mw.prototype)}}function fR(t){return new Mw(t,Gne[t])}/*! @azure/msal-common v14.15.0 2024-09-20 */class Ow{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw fR(G3);if(!e.alg)throw fR(K3);const n=new Ow({typ:e.typ||ute.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(n)}}/*! @azure/msal-common v14.15.0 2024-09-20 */class G1{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class q3{generateId(){return"callback-id"}startMeasurement(e,n){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:z1.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:n||""},measurement:new G1}}startPerformanceMeasurement(){return new G1}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-common v14.15.0 2024-09-20 */function Kne(t,e,n){n&&n.push({name:e.get(t.name)||t.name})}function qne(t,e,n,r){if(!(n!=null&&n.length))return;const o=g=>g.length?g[g.length-1]:void 0,i=e.get(t.name)||t.name,s=o(n);if((s==null?void 0:s.name)!==i)return;const a=n==null?void 0:n.pop();if(!a)return;const l=r instanceof Et?r.errorCode:r instanceof Error?r.name:void 0,u=r instanceof Et?r.subError:void 0;l&&a.childErr!==l&&(a.err=l,u&&(a.subErr=u)),delete a.name,delete a.childErr;const h={...a,dur:t.durationMs};t.success||(h.fail=1);const f=o(n);if(!f)return{[i]:h};l&&(f.childErr=l);let p;if(!f[i])p=i;else{const g=Object.keys(f).filter(v=>v.startsWith(i)).length;p=`${i}_${g+1}`}return f[p]=h,f}function Wne(t,e,n,r=5){var o,i;if(t instanceof Error){if(t instanceof Et){n.errorCode=t.errorCode,n.subErrorCode=t.subError,(t instanceof Yi||t instanceof jr)&&(n.serverErrorNo=t.errorNo);return}else if(t instanceof Ec){n.errorCode=t.errorCode;return}else if((o=n.errorStack)!=null&&o.length){e.trace("PerformanceClient.addErrorStack: Stack already exist",n.correlationId);return}else if(!((i=t.stack)!=null&&i.length)){e.trace("PerformanceClient.addErrorStack: Input stack is empty",n.correlationId);return}}else{e.trace("PerformanceClient.addErrorStack: Input error is not instance of Error",n.correlationId);return}t.stack&&(n.errorStack=Yne(t.stack,r)),n.errorName=t.name}function Yne(t,e){if(e<0)return[];const n=t.split(`
`)||[];if(n.length<2)return[];const r=[];for(let o=Math.max(n.length-e-1,1);o<n.length;o++){const i=n[o];if(r.length>=e)break;r.push(Qne(i))}return r}function Qne(t){const e=t.lastIndexOf(" ")+1;if(e<1)return t;const n=t.substring(e);let r=n.lastIndexOf("/");return r=r<0?n.lastIndexOf("\\"):r,r>=0?(t.substring(0,e)+"("+n.substring(r+1)+(n.charAt(n.length-1)===")"?"":")")).trimStart():t.trimStart()}class Jne{constructor(e,n,r,o,i,s,a,l){this.authority=n,this.libraryName=o,this.libraryVersion=i,this.applicationTelemetry=s,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=a||new Set;for(const u of xne)this.intFields.add(u);this.abbreviations=l||new Map;for(const[u,h]of kne)this.abbreviations.set(u,h)}startPerformanceMeasurement(e,n){return{}}getPreQueueTime(e,n){const r=this.preQueueTimeByCorrelationId.get(n);if(r){if(r.name!==e){this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`);return}}else{this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${n}, unable to add queue measurement`);return}return r.time}calculateQueuedTime(e,n){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):n<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${n}`),0):n<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):n-e}addQueueMeasurement(e,n,r,o){if(!n){this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);return}if(r===0)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${r}`);else if(!r){this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);return}const i={eventName:e,queueTime:o?0:r,manuallyCompleted:o},s=this.queueMeasurements.get(n);if(s)s.push(i),this.queueMeasurements.set(n,s);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${n} to queue measurements`);const a=[i];this.queueMeasurements.set(n,a)}this.preQueueTimeByCorrelationId.delete(n)}startMeasurement(e,n){var i,s;const r=n||this.generateId();n||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,r),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,r);const o={eventId:this.generateId(),status:z1.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:r,appName:(i=this.applicationTelemetry)==null?void 0:i.appName,appVersion:(s=this.applicationTelemetry)==null?void 0:s.appVersion};return this.cacheEventByCorrelationId(o),Kne(o,this.abbreviations,this.eventStack.get(r)),{end:(a,l)=>this.endMeasurement({...o,...a},l),discard:()=>this.discardMeasurements(o.correlationId),add:a=>this.addFields(a,o.correlationId),increment:a=>this.incrementFields(a,o.correlationId),event:o,measurement:new G1}}endMeasurement(e,n){var u,h;const r=this.eventsByCorrelationId.get(e.correlationId);if(!r)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.eventId}`,e.correlationId),null;const o=e.eventId===r.eventId;let i={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));const s=JSON.stringify(qne(e,this.abbreviations,this.eventStack.get(r.correlationId),n));if(o?(i=this.getQueueInfo(e.correlationId),this.discardMeasurements(r.correlationId)):(u=r.incompleteSubMeasurements)==null||u.delete(e.eventId),this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${e.durationMs} ms`,e.correlationId),!o)return r[e.name+"DurationMs"]=Math.floor(e.durationMs),{...r};n&&Wne(n,this.logger,r);let a={...r,...e},l=0;return(h=a.incompleteSubMeasurements)==null||h.forEach(f=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${f.name} found for ${e.name}`,a.correlationId),l++}),a.incompleteSubMeasurements=void 0,a={...a,queuedTimeMs:i.totalQueueTime,queuedCount:i.totalQueueCount,queuedManuallyCompletedCount:i.manuallyCompletedCount,status:z1.Completed,incompleteSubsCount:l,context:s},this.truncateIntegralFields(a),this.emitEvents([a],e.correlationId),a}addFields(e,n){this.logger.trace("PerformanceClient: Updating static fields");const r=this.eventsByCorrelationId.get(n);r?this.eventsByCorrelationId.set(n,{...r,...e}):this.logger.trace("PerformanceClient: Event not found for",n)}incrementFields(e,n){this.logger.trace("PerformanceClient: Updating counters");const r=this.eventsByCorrelationId.get(n);if(r)for(const o in e){if(!r.hasOwnProperty(o))r[o]=0;else if(isNaN(Number(r[o])))return;r[o]+=e[o]}else this.logger.trace("PerformanceClient: Event not found for",n)}cacheEventByCorrelationId(e){const n=this.eventsByCorrelationId.get(e.correlationId);n?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),n.incompleteSubMeasurements=n.incompleteSubMeasurements||new Map,n.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}getQueueInfo(e){const n=this.queueMeasurements.get(e);n||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let r=0,o=0,i=0;return n==null||n.forEach(s=>{r+=s.queueTime,o++,i+=s.manuallyCompleted?1:0}),{totalQueueTime:r,totalQueueCount:o,manuallyCompletedCount:i}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Event stack discarded",e),this.eventStack.delete(e)}addPerformanceCallback(e){for(const[r,o]of this.callbacks)if(o.toString()===e.toString())return this.logger.warning(`PerformanceClient: Performance callback is already registered with id: ${r}`),r;const n=this.generateId();return this.callbacks.set(n,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${n}`),n}removePerformanceCallback(e){const n=this.callbacks.delete(e);return n?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),n}emitEvents(e,n){this.logger.verbose("PerformanceClient: Emitting performance events",n),this.callbacks.forEach((r,o)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${o}`,n),r.apply(null,[e])})}truncateIntegralFields(e){this.intFields.forEach(n=>{n in e&&typeof e[n]=="number"&&(e[n]=Math.floor(e[n]))})}getDurationMs(e){const n=Date.now()-e;return n<0?n:0}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Lw="pkce_not_created",W3="crypto_nonexistent",cb="empty_navigate_uri",Y3="hash_empty_error",Dw="no_state_in_hash",Q3="hash_does_not_contain_known_properties",J3="unable_to_parse_state",X3="state_interaction_type_mismatch",Z3="interaction_in_progress",e4="popup_window_error",t4="empty_window_error",zc="user_cancelled",Xne="monitor_popup_timeout",n4="monitor_window_timeout",r4="redirect_in_iframe",o4="block_iframe_reload",i4="block_nested_popups",Zne="iframe_closed_prematurely",lb="silent_logout_unsupported",s4="no_account_error",ere="silent_prompt_value_error",a4="no_token_request_cache_error",c4="unable_to_parse_token_request_cache_error",jw="no_cached_authority_error",tre="auth_request_not_set_error",nre="invalid_cache_type",Uw="non_browser_environment",uu="database_not_open",dv="no_network_connectivity",l4="post_request_failed",u4="get_request_failed",K1="failed_to_parse_response",d4="unable_to_load_token",Fw="crypto_key_not_found",h4="auth_code_required",f4="auth_code_or_nativeAccountId_required",p4="spa_code_and_nativeAccountId_present",Bw="database_unavailable",m4="unable_to_acquire_token_from_native_platform",g4="native_handshake_timeout",v4="native_extension_not_installed",wp="native_connection_not_established",y4="uninitialized_public_client_application",b4="native_prompt_not_supported",C4="invalid_base64_string",S4="invalid_pop_token_request";/*! @azure/msal-browser v3.26.1 2024-10-08 */const as="For more visit: aka.ms/msaljs/browser-errors",rre={[Lw]:"The PKCE code challenge and verifier could not be generated.",[W3]:"The crypto object or function is not available.",[cb]:"Navigation URI is empty. Please check stack trace for more info.",[Y3]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${as}`,[Dw]:"Hash does not contain state. Please verify that the request originated from msal.",[Q3]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${as}`,[J3]:"Unable to parse state. Please verify that the request originated from msal.",[X3]:"Hash contains state but the interaction type does not match the caller.",[Z3]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${as}`,[e4]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[t4]:"window.open returned null or undefined window object.",[zc]:"User cancelled the flow.",[Xne]:`Token acquisition in popup failed due to timeout.  ${as}`,[n4]:`Token acquisition in iframe failed due to timeout.  ${as}`,[r4]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[o4]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${as}`,[i4]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Zne]:"The iframe being monitored was closed prematurely.",[lb]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[s4]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[ere]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[a4]:"No token request found in cache.",[c4]:"The cached token request could not be parsed.",[jw]:"No cached authority found.",[tre]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[nre]:"Invalid cache type",[Uw]:"Login and token requests are not supported in non-browser environments.",[uu]:"Database is not open!",[dv]:"No network connectivity. Check your internet connection.",[l4]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[u4]:"Network request failed. Please check the network trace to determine root cause.",[K1]:"Failed to parse network response. Check network trace.",[d4]:"Error loading token to cache.",[Fw]:"Cryptographic Key or Keypair not found in browser storage.",[h4]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[f4]:"An authorization code or nativeAccountId must be provided to this flow.",[p4]:"Request cannot contain both spa code and native account id.",[Bw]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[m4]:`Unable to acquire token from native platform.  ${as}`,[g4]:"Timed out while attempting to establish connection to browser extension",[v4]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[wp]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${as}`,[y4]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${as}`,[b4]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[C4]:"Invalid base64 encoded string.",[S4]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."};class Bd extends Et{constructor(e){super(e,rre[e]),Object.setPrototypeOf(this,Bd.prototype),this.name="BrowserAuthError"}}function Qe(t){return new Bd(t)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const fo={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Eu={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},gc={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},Tn={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},pR={GET:"GET",POST:"POST"},Kt={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Gs={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},gm={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},un={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var Se;(function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"})(Se||(Se={}));const mR={scopes:Ea},I4="jwk",q1="msal.db",ore=1,ire=`${q1}.keys`,Fn={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},sre=[Fn.Default,Fn.Skip,Fn.RefreshTokenAndNetwork],are="msal.browser.log.level",cre="msal.browser.log.pii",lre="msal.browser.performance.enabled";/*! @azure/msal-browser v3.26.1 2024-10-08 */function vm(t){return encodeURIComponent(Hw(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function ub(t){return E4(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Hw(t){return E4(new TextEncoder().encode(t))}function E4(t){const e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const ure="RSASSA-PKCS1-v1_5",T4="SHA-256",dre=2048,hre=new Uint8Array([1,0,1]),gR="0123456789abcdef",vR=new Uint32Array(1),zw={name:ure,hash:T4,modulusLength:dre,publicExponent:hre};function fre(t){if("crypto"in window)t.verbose("BrowserCrypto: modern crypto interface available");else throw t.error("BrowserCrypto: crypto interface is unavailable"),Qe(W3)}async function w4(t,e,n){e==null||e.addQueueMeasurement(R.Sha256Digest,n);const o=new TextEncoder().encode(t);return window.crypto.subtle.digest(T4,o)}function pre(t){return window.crypto.getRandomValues(t)}function oS(){return window.crypto.getRandomValues(vR),vR[0]}function Qi(){const t=Date.now(),e=oS()*1024+(oS()&1023),n=new Uint8Array(16),r=Math.trunc(e/2**30),o=e&2**30-1,i=oS();n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/2**16,n[4]=t/2**8,n[5]=t,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let a=0;a<n.length;a++)s+=gR.charAt(n[a]>>>4),s+=gR.charAt(n[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}async function mre(t,e){return window.crypto.subtle.generateKey(zw,t,e)}async function iS(t){return window.crypto.subtle.exportKey(I4,t)}async function gre(t,e,n){return window.crypto.subtle.importKey(I4,t,zw,e,n)}async function vre(t,e){return window.crypto.subtle.sign(zw,t,e)}async function _4(t){const e=await w4(t),n=new Uint8Array(e);return ub(n)}/*! @azure/msal-browser v3.26.1 2024-10-08 */const A4="storage_not_supported",yre="stubbed_public_client_application_called",k4="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.26.1 2024-10-08 */const bre={[A4]:"Given storage configuration option was not supported.",[yre]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[k4]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class db extends Et{constructor(e,n){super(e,n),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,db.prototype)}}function x4(t){return new db(t,bre[t])}/*! @azure/msal-browser v3.26.1 2024-10-08 */function Cre(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function Sre(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Vw(){return window.parent!==window}function Ire(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${fo.POPUP_NAME_PREFIX}.`)===0}function oi(){return window.location.href.split("?")[0].split("#")[0]}function Ere(){const e=new At(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Tre(){if(At.hashContainsKnownProperties(window.location.hash)&&Vw())throw Qe(o4)}function wre(t){if(Vw()&&!t)throw Qe(r4)}function _re(){if(Ire())throw Qe(i4)}function R4(){if(typeof window>"u")throw Qe(Uw)}function $w(t){if(!t)throw Qe(y4)}function ys(t){R4(),Tre(),_re(),$w(t)}function yR(t,e){if(ys(t),wre(e.system.allowRedirectInIframe),e.cache.cacheLocation===Tn.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw x4(k4)}function N4(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Oo(){return Qi()}/*! @azure/msal-browser v3.26.1 2024-10-08 */class hv{navigateInternal(e,n){return hv.defaultNavigateWindow(e,n)}navigateExternal(e,n){return hv.defaultNavigateWindow(e,n)}static defaultNavigateWindow(e,n){return n.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},n.timeout)})}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Are{async sendGetRequestAsync(e,n){let r;try{r=await fetch(e,{method:pR.GET,headers:this.getFetchHeaders(n)})}catch{throw window.navigator.onLine?Qe(u4):Qe(dv)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch{throw Qe(K1)}}async sendPostRequestAsync(e,n){const r=n&&n.body||ie.EMPTY_STRING;let o;try{o=await fetch(e,{method:pR.POST,headers:this.getFetchHeaders(n),body:r})}catch{throw window.navigator.onLine?Qe(l4):Qe(dv)}try{return{headers:this.getHeaderDict(o.headers),body:await o.json(),status:o.status}}catch{throw Qe(K1)}}getFetchHeaders(e){const n=new Headers;if(!(e&&e.headers))return n;const r=e.headers;return Object.keys(r).forEach(o=>{n.append(o,r[o])}),n}getHeaderDict(e){const n={};return e.forEach((r,o)=>{n[o]=r}),n}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const kre=6e4,fv=1e4,xre=3e4,Rre=2e3;function Nre({auth:t,cache:e,system:n,telemetry:r},o){const i={clientId:ie.EMPTY_STRING,authority:`${ie.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:ie.EMPTY_STRING,authorityMetadata:ie.EMPTY_STRING,redirectUri:ie.EMPTY_STRING,postLogoutRedirectUri:ie.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:vs.AAD,OIDCOptions:{serverResponseType:Tp.FRAGMENT,defaultScopes:[ie.OPENID_SCOPE,ie.PROFILE_SCOPE,ie.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Gf.None,tenant:ie.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:Tn.SessionStorage,temporaryCacheLocation:Tn.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===Tn.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:pn.Info,piiLoggingEnabled:!1},u={...{...U3,loggerOptions:a,networkClient:o?new Are:zne,navigationClient:new hv,loadFrameTimeout:0,windowHashTimeout:(n==null?void 0:n.loadFrameTimeout)||kre,iframeHashTimeout:(n==null?void 0:n.loadFrameTimeout)||fv,navigateFrameWait:0,redirectNavigationTimeout:xre,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(n==null?void 0:n.nativeBrokerHandshakeTimeout)||Rre,pollIntervalMilliseconds:fo.DEFAULT_POLL_INTERVAL_MS},...n,loggerOptions:(n==null?void 0:n.loggerOptions)||a},h={application:{appName:ie.EMPTY_STRING,appVersion:ie.EMPTY_STRING},client:new q3};if((t==null?void 0:t.protocolMode)!==vs.OIDC&&(t!=null&&t.OIDCOptions)&&new hi(u.loggerOptions).warning(JSON.stringify(Zt(R3))),t!=null&&t.protocolMode&&t.protocolMode!==vs.AAD&&(u!=null&&u.allowNativeBroker))throw Zt(N3);return{auth:{...i,...t,OIDCOptions:{...i.OIDCOptions,...t==null?void 0:t.OIDCOptions}},cache:{...s,...e},system:u,telemetry:{...h,...r}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const pv="@azure/msal-browser",Vc="3.26.1";/*! @azure/msal-browser v3.26.1 2024-10-08 */class Gw{static loggerCallback(e,n){switch(e){case pn.Error:console.error(n);return;case pn.Info:console.info(n);return;case pn.Verbose:console.debug(n);return;case pn.Warning:console.warn(n);return;default:console.log(n);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=Nre(e,this.browserEnvironment);let n;try{n=window[Tn.SessionStorage]}catch{}const r=n==null?void 0:n.getItem(are),o=(l=n==null?void 0:n.getItem(cre))==null?void 0:l.toLowerCase(),i=o==="true"?!0:o==="false"?!1:void 0,s={...this.config.system.loggerOptions},a=r&&Object.keys(pn).includes(r)?pn[r]:void 0;a&&(s.loggerCallback=Gw.loggerCallback,s.logLevel=a),i!==void 0&&(s.piiLoggingEnabled=i),this.logger=new hi(s,pv,Vc),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class $c extends Gw{getModuleName(){return $c.MODULE_NAME}getId(){return $c.ID}async initialize(){return this.available=typeof window<"u",this.available}}$c.MODULE_NAME="";$c.ID="StandardOperatingContext";/*! @azure/msal-browser v3.26.1 2024-10-08 */function Gi(t){return new TextDecoder().decode(Pre(t))}function Pre(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Qe(C4)}const n=atob(e);return Uint8Array.from(n,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Mre{constructor(){this.dbName=q1,this.version=ore,this.tableName=ire,this.dbOpen=!1}async open(){return new Promise((e,n)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",o=>{const i=o;this.db=i.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>n(Qe(Bw)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Qe(uu));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),n(l.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,n){return await this.validateDbIsOpen(),new Promise((r,o)=>{if(!this.db)return o(Qe(uu));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(n,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",l=>{this.closeConnection(),o(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Qe(uu));const s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,n)=>{if(!this.db)return n(Qe(uu));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",s=>{const a=s;this.closeConnection(),e(a.target.result)}),i.addEventListener("error",s=>{this.closeConnection(),n(s)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Qe(uu));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),n(l.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,n)=>{const r=window.indexedDB.deleteDatabase(q1),o=setTimeout(()=>n(!1),200);r.addEventListener("success",()=>(clearTimeout(o),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),r.addEventListener("error",()=>(clearTimeout(o),n(!1)))})}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class mv{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,n){this.cache.set(e,n)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((n,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Ore{constructor(e){this.inMemoryCache=new mv,this.indexedDBCache=new Mre,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Bd&&e.errorCode===Bw)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const n=this.inMemoryCache.getItem(e);if(!n)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return n}async setItem(e,n){this.inMemoryCache.setItem(e,n);try{await this.indexedDBCache.setItem(e,n)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(n){this.handleDatabaseAccessError(n)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(n){this.handleDatabaseAccessError(n)}return e}async containsKey(e){const n=this.inMemoryCache.containsKey(e);if(!n)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return n}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Gc{constructor(e,n){this.logger=e,fre(e),this.cache=new Ore(this.logger),this.performanceClient=n}createNewGuid(){return Qi()}base64Encode(e){return Hw(e)}base64Decode(e){return Gi(e)}base64UrlEncode(e){return vm(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var h;const n=(h=this.performanceClient)==null?void 0:h.startMeasurement(R.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await mre(Gc.EXTRACTABLE,Gc.POP_KEY_USAGES),o=await iS(r.publicKey),i={e:o.e,kty:o.kty,n:o.n},s=bR(i),a=await this.hashString(s),l=await iS(r.privateKey),u=await gre(l,!1,["sign"]);return await this.cache.setItem(a,{privateKey:u,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,n,r,o){var I;const i=(I=this.performanceClient)==null?void 0:I.startMeasurement(R.CryptoOptsSignJwt,o),s=await this.cache.getItem(n);if(!s)throw Qe(Fw);const a=await iS(s.publicKey),l=bR(a),u=vm(JSON.stringify({kid:n})),h=Ow.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:u}),f=vm(h);e.cnf={jwk:JSON.parse(l)};const p=vm(JSON.stringify(e)),g=`${f}.${p}`,y=new TextEncoder().encode(g),b=await vre(s.privateKey,y),C=ub(new Uint8Array(b)),S=`${g}.${C}`;return i&&i.end({success:!0}),S}async hashString(e){return _4(e)}}Gc.POP_KEY_USAGES=["sign","verify"];Gc.EXTRACTABLE=!0;function bR(t){return JSON.stringify(t,Object.keys(t).sort())}/*! @azure/msal-browser v3.26.1 2024-10-08 */class gv{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==Tn.LocalStorage&&e!==Tn.SessionStorage||!window[e])throw x4(A4)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,n){this.windowStorage.setItem(e,n)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function P4(t,e){if(!e)return null;try{return ci.parseRequestState(t,e).libraryState.meta}catch{throw Ae(Fc)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class W1 extends fd{constructor(e,n,r,o,i,s){super(e,r,o,i),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=n,this.logger=o,this.internalStorage=new mv,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){switch(e){case Tn.LocalStorage:case Tn.SessionStorage:try{return new gv(e)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=Tn.MemoryStorage,new mv}setupTemporaryCacheStorage(e,n){switch(n){case Tn.LocalStorage:case Tn.SessionStorage:try{return new gv(e||Tn.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}case Tn.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const e=`${ie.CACHE_PREFIX}.${Yn.ID_TOKEN}`,n=`${ie.CACHE_PREFIX}.${Yn.CLIENT_INFO}`,r=`${ie.CACHE_PREFIX}.${Yn.ERROR}`,o=`${ie.CACHE_PREFIX}.${Yn.ERROR_DESC}`,i=this.browserStorage.getItem(e),s=this.browserStorage.getItem(n),a=this.browserStorage.getItem(r),l=this.browserStorage.getItem(o),u=[i,s,a,l];[Yn.ID_TOKEN,Yn.CLIENT_INFO,Yn.ERROR,Yn.ERROR_DESC].forEach((f,p)=>{const g=u[p];g&&this.setTemporaryCache(f,g,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(Gs.ACCOUNT_KEYS),n=this.getItem(`${Gs.TOKEN_KEYS}.${this.clientId}`);if(e&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case lt.ID_TOKEN:if(eR(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,lt.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case lt.ACCESS_TOKEN:case lt.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Zx(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,lt.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case lt.REFRESH_TOKEN:if(tR(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,lt.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`);break}}}if(this.isAccountKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);s&&Vn.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{const n=JSON.parse(e);return n&&typeof n=="object"?n:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,n){this.browserStorage.setItem(e,n)}getAccount(e,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,n)}getCachedAccountEntity(e){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(n);return!r||!Vn.isAccountEntity(r)?(this.removeAccountKeyFromMap(e),null):fd.toObject(new Vn,r)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();this.setItem(n,JSON.stringify(e)),this.addAccountKeyToMap(n)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(Gs.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem(Gs.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),r=n.indexOf(e);r>-1?(n.splice(r,1),this.setItem(Gs.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,lt.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,lt.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,lt.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${Gs.TOKEN_KEYS}.${this.clientId}`);if(e){const n=this.validateAndParseJson(e);if(n&&n.hasOwnProperty("idToken")&&n.hasOwnProperty("accessToken")&&n.hasOwnProperty("refreshToken"))return n;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,n){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(n){case lt.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case lt.ACCESS_TOKEN:r.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case lt.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${n}`),Ae(ov)}this.setItem(`${Gs.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,n){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(n){case lt.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const o=r.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case lt.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const i=r.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case lt.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${n}`),Ae(ov)}this.setItem(`${Gs.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.ID_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!eR(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=Su(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,lt.ID_TOKEN)}getAccessTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.ACCESS_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!Zx(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=Su(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,lt.ACCESS_TOKEN)}getRefreshTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.REFRESH_TOKEN),null;const r=this.validateAndParseJson(n);return!r||!tR(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,lt.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=Su(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,lt.REFRESH_TOKEN)}getAppMetadata(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!Ete(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=Ite(e);this.setItem(n,JSON.stringify(e))}getServerTelemetry(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!Cte(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(n))}getAuthorityMetadata(e){const n=this.internalStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&Tte(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(n=>this.isAuthorityMetadata(n))}setWrapperMetadata(e,n){this.internalStorage.setItem(gm.WRAPPER_SKU,e),this.internalStorage.setItem(gm.WRAPPER_VER,n)}getWrapperMetadata(){const e=this.internalStorage.getItem(gm.WRAPPER_SKU)||ie.EMPTY_STRING,n=this.internalStorage.getItem(gm.WRAPPER_VER)||ie.EMPTY_STRING;return[e,n]}setAuthorityMetadata(e,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(n))}getActiveAccount(){const e=this.generateCacheKey(Yn.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(e);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const o=this.generateCacheKey(Yn.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const s=this.getAccountInfoFilteredBy({localAccountId:i});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const n=this.generateCacheKey(Yn.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(Yn.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(n,JSON.stringify(o)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(n);return!r||!Ste(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(n))}getTemporaryCache(e,n){const r=n?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.getItemCookie(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===Tn.LocalStorage){const i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,n,r){const o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,n))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(ie.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(ie.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,n){e.addQueueMeasurement(R.ClearTokensAndKeysWithClaims,n);const r=this.getTokenKeys(),o=[];r.accessToken.forEach(i=>{const s=this.getAccessTokenCredential(i);s!=null&&s.requestedClaimsHash&&i.includes(s.requestedClaimsHash.toLowerCase())&&o.push(this.removeAccessToken(i))}),await Promise.all(o),o.length>0&&this.logger.warning(`${o.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,n,r){let o=`${encodeURIComponent(e)}=${encodeURIComponent(n)};path=/;SameSite=Lax;`;if(r){const i=this.getCookieExpirationTime(r);o+=`expires=${i};`}this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o}getItemCookie(e){const n=`${encodeURIComponent(e)}=`,r=document.cookie.split(";");for(let o=0;o<r.length;o++){let i=r[o];for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(n)===0)return decodeURIComponent(i.substring(n.length,i.length))}return ie.EMPTY_STRING}clearMsalCookies(){const e=`${ie.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(r=>{for(;r.charAt(0)===" ";)r=r.substring(1);if(r.indexOf(e)===0){const o=r.split("=")[0];this.clearItemCookie(o)}})}clearItemCookie(e){this.setItemCookie(e,ie.EMPTY_STRING,-1)}getCookieExpirationTime(e){const n=new Date;return new Date(n.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):ai.startsWith(e,ie.CACHE_PREFIX)||ai.startsWith(e,Yn.ADAL_ID_TOKEN)?e:`${ie.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:n}}=ci.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Kt.AUTHORITY}.${n}`)}generateNonceKey(e){const{libraryState:{id:n}}=ci.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Kt.NONCE_IDTOKEN}.${n}`)}generateStateKey(e){const{libraryState:{id:n}}=ci.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Kt.REQUEST_STATE}.${n}`)}getCachedAuthority(e){const n=this.generateStateKey(e),r=this.getTemporaryCache(n);if(!r)return null;const o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)}updateCacheEntries(e,n,r,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,n,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,r,!1),i){const u={credential:i.homeAccountId,type:mo.HOME_ACCOUNT_ID};this.setTemporaryCache(Kt.CCS_CREDENTIAL,JSON.stringify(u),!0)}else if(o){const u={credential:o,type:mo.UPN};this.setTemporaryCache(Kt.CCS_CREDENTIAL,JSON.stringify(u),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(n=>{n.indexOf(e)!==-1&&this.removeTemporaryItem(n)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Kt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Kt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Kt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Kt.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Kt.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Kt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const n=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(n);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||ie.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(n=>{if(n.indexOf(Kt.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(n);if(!r)return;const o=P4(this.cryptoImpl,r);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const n=Hw(JSON.stringify(e));this.setTemporaryCache(Kt.REQUEST_PARAMS,n,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const n=this.getTemporaryCache(Kt.REQUEST_PARAMS,!0);if(!n)throw Qe(a4);let r;try{r=JSON.parse(Gi(n))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${n}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),Qe(c4)}if(this.removeTemporaryItem(this.generateCacheKey(Kt.REQUEST_PARAMS)),!r.authority){const o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Qe(jw);r.authority=i}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Kt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const n=this.validateAndParseJson(e);return n||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const n=this.getInteractionInProgress();return e?n===this.clientId:!!n}getInteractionInProgress(){const e=`${ie.CACHE_PREFIX}.${Kt.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const n=`${ie.CACHE_PREFIX}.${Kt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Qe(Z3);this.setTemporaryCache(n,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(n)}getLegacyLoginHint(){const e=this.getTemporaryCache(Yn.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Yn.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const n=this.getTemporaryCache(Yn.ID_TOKEN,!0);n&&(this.browserStorage.removeItem(this.generateCacheKey(Yn.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=n||e;if(r){const o=vl(r,Gi);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,n){const r=Su(n);if(e!==r){const o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(r,o),this.logger.verbose(`Updated an outdated ${n.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${n.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,n){var a,l,u;const r=nb((a=e.account)==null?void 0:a.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let o;n.claims&&(o=await this.cryptoImpl.hashString(n.claims));const i=rb((u=e.account)==null?void 0:u.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Gi,void 0,e.tokenType,void 0,n.sshKid,n.claims,o),s={idToken:r,accessToken:i};return this.saveCacheRecord(s)}async saveCacheRecord(e,n,r){try{await super.saveCacheRecord(e,n,r)}catch(o){if(o instanceof Ec&&this.performanceClient&&r)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},r)}catch{}throw o}}}const Lre=(t,e)=>{const n={cacheLocation:Tn.MemoryStorage,temporaryCacheLocation:Tn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new W1(t,n,iv,e)};/*! @azure/msal-browser v3.26.1 2024-10-08 */function Dre(t,e,n,r){return t.verbose("getAllAccounts called"),n?e.getAllAccounts(r):[]}function jre(t,e,n){if(e.trace("getAccount called"),Object.keys(t).length===0)return e.warning("getAccount: No accountFilter provided"),null;const r=n.getAccountInfoFilteredBy(t);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function Ure(t,e,n){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const r=n.getAccountInfoFilteredBy({username:t});return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Fre(t,e,n){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=n.getAccountInfoFilteredBy({homeAccountId:t});return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function Bre(t,e,n){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const r=n.getAccountInfoFilteredBy({localAccountId:t});return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function Hre(t,e){e.setActiveAccount(t)}function zre(t){return t.getActiveAccount()}/*! @azure/msal-browser v3.26.1 2024-10-08 */const ce={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.26.1 2024-10-08 */class M4{constructor(e){this.eventCallbacks=new Map,this.logger=e||new hi({})}addEventCallback(e,n,r){if(typeof window<"u"){const o=r||Oo();return this.eventCallbacks.has(o)?(this.logger.error(`Event callback with id: ${o} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(o,[e,n||[]]),this.logger.verbose(`Event callback registered with id: ${o}`),o)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,n,r,o){if(typeof window<"u"){const i={eventType:e,interactionType:n||null,payload:r||null,error:o||null,timestamp:Date.now()};this.eventCallbacks.forEach(([s,a],l)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),s.apply(null,[i]))})}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class O4{constructor(e,n,r,o,i,s,a,l,u){this.config=e,this.browserStorage=n,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.nativeMessageHandler=l,this.correlationId=u||Qi(),this.logger=o.clone(fo.MSAL_SKU,Vc,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Vn.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Vn.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const n=e||this.config.auth.redirectUri||oi();return At.getAbsoluteUrl(n,oi())}initializeServerTelemetryManager(e,n){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:n||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Kf(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:n}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(R.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,s=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=n&&s?this.config.auth.authority.replace(At.getDomainFromUrl(i),n.environment):i,l=mr.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),u=await Oe(B3,R.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(n&&!u.isAlias(n.environment))throw Zt(P3);return u}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Vre=32;async function $re(t,e,n){t.addQueueMeasurement(R.GeneratePkceCodes,n);const r=yl(Gre,R.GenerateCodeVerifier,e,t,n)(t,e,n),o=await Oe(Kre,R.GenerateCodeChallengeFromVerifier,e,t,n)(r,t,e,n);return{verifier:r,challenge:o}}function Gre(t,e,n){try{const r=new Uint8Array(Vre);return yl(pre,R.GetRandomValues,e,t,n)(r),ub(r)}catch{throw Qe(Lw)}}async function Kre(t,e,n,r){e.addQueueMeasurement(R.GenerateCodeChallengeFromVerifier,r);try{const o=await Oe(w4,R.Sha256Digest,n,e,r)(t,e,r);return ub(new Uint8Array(o))}catch{throw Qe(Lw)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function Kw(t,e,n,r){n.addQueueMeasurement(R.InitializeBaseRequest,t.correlationId);const o=t.authority||e.auth.authority,i=[...t&&t.scopes||[]],s={...t,correlationId:t.correlationId,authority:o,scopes:i};if(!s.authenticationScheme)s.authenticationScheme=Vt.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===Vt.SSH){if(!t.sshJwk)throw Zt(ob);if(!t.sshKid)throw Zt(x3)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!ai.isEmptyObj(t.claims)&&(s.requestedClaimsHash=await _4(t.claims)),s}async function qre(t,e,n,r,o){r.addQueueMeasurement(R.InitializeSilentRequest,t.correlationId);const i=await Oe(Kw,R.InitializeBaseRequest,o,r,t.correlationId)(t,n,r,o);return{...t,...i,account:e,forceRefresh:t.forceRefresh||!1}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Hd extends O4{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(R.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const n=await Oe($re,R.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:ie.EMPTY_STRING,codeVerifier:n.verifier};return e.codeChallenge=n.challenge,e.codeChallengeMethod=ie.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const n={correlationId:this.correlationId||Qi(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(e.postLogoutRedirectUri,oi())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,oi())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=At.getAbsoluteUrl(oi(),oi())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n}getLogoutHintFromIdTokenClaims(e){const n=e.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(R.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const n=await Oe(this.getClientConfiguration.bind(this),R.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new V3(n,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:n,requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}=e;this.performanceClient.addQueueMeasurement(R.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await Oe(this.getDiscoveredAuthority.bind(this),R.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:fo.MSAL_SKU,version:Vc,cpu:ie.EMPTY_STRING,os:ie.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,n){this.performanceClient.addQueueMeasurement(R.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),o={interactionType:n},i=ci.setRequestState(this.browserCrypto,e&&e.state||ie.EMPTY_STRING,o),a={...await Oe(Kw,R.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||Qi(),responseMode:this.config.auth.OIDCOptions.serverResponseType},l=e.account||this.browserStorage.getActiveAccount();if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),a.account=l),!a.loginHint&&!l){const u=this.browserStorage.getLegacyLoginHint();u&&(a.loginHint=u)}return a}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const Wre="ContentError",L4="user_switch";/*! @azure/msal-browser v3.26.1 2024-10-08 */const Yre="USER_INTERACTION_REQUIRED",Qre="USER_CANCEL",Jre="NO_NETWORK",Xre="PERSISTENT_ERROR",Zre="DISABLED",eoe="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.26.1 2024-10-08 */const toe=-2147186943,noe={[L4]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Di extends Et{constructor(e,n,r){super(e,n),Object.setPrototypeOf(this,Di.prototype),this.name="NativeAuthError",this.ext=r}}function du(t){if(t.ext&&t.ext.status&&(t.ext.status===Xre||t.ext.status===Zre)||t.ext&&t.ext.error&&t.ext.error===toe)return!0;switch(t.errorCode){case Wre:return!0;default:return!1}}function Y1(t,e,n){if(n&&n.status)switch(n.status){case eoe:return V1(H3);case Yre:return new jr(t,e);case Qre:return Qe(zc);case Jre:return Qe(dv)}return new Di(t,noe[t]||e,n)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class D4 extends Hd{async acquireToken(e){this.performanceClient.addQueueMeasurement(R.SilentCacheClientAcquireToken,e.correlationId);const n=this.initializeServerTelemetryManager(un.acquireTokenSilent_silentFlow),r=await Oe(this.getClientConfiguration.bind(this),R.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new Hne(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const s=(await Oe(o.acquireCachedToken.bind(o),R.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(i){throw i instanceof Bd&&i.errorCode===Fw&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(n==null?void 0:n.account)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */const sS={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"};class Du extends O4{constructor(e,n,r,o,i,s,a,l,u,h,f,p){var v;super(e,n,r,o,i,s,l,u,p),this.apiId=a,this.accountId=h,this.nativeMessageHandler=u,this.nativeStorageManager=f,this.silentCacheClient=new D4(e,this.nativeStorageManager,r,o,i,s,l,u,p),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const g=this.nativeMessageHandler.getExtensionId()===Eu.PREFERRED_EXTENSION_ID?"chrome":(v=this.nativeMessageHandler.getExtensionId())!=null&&v.length?"unknown":void 0;this.skus=Kf.makeExtraSkuString({libraryName:fo.MSAL_SKU,libraryVersion:Vc,extensionName:g,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Tne]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(R.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(R.NativeInteractionClientAcquireToken,e.correlationId),r=Wi();try{const o=await this.initializeNativeRequest(e);try{const u=await this.acquireTokensFromCache(this.accountId,o);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),u}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=o,s={method:gc.GetToken,request:i},a=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(a);return await this.handleNativeResponse(l,o,r).then(u=>(n.end({success:!0,isNativeBroker:!0,requestId:u.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),u)).catch(u=>{throw n.end({success:!1,errorCode:u.errorCode,subErrorCode:u.subError,isNativeBroker:!0}),u})}catch(o){throw o instanceof Di&&this.serverTelemetryManager.setNativeBrokerErrorCode(o.errorCode),o}}createSilentCacheRequest(e,n){return{authority:e.authority,correlationId:this.correlationId,scopes:xn.fromString(e.scope).asArray(),account:n,forceRefresh:!1}}async acquireTokensFromCache(e,n){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Ae(nv);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw Ae(nv);try{const o=this.createSilentCacheRequest(n,r),i=await this.silentCacheClient.acquireToken(o),s={...r,idTokenClaims:i==null?void 0:i.idTokenClaims,idToken:i==null?void 0:i.idToken};return{...i,account:s}}catch(o){throw o}}async acquireTokenRedirect(e,n){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const o=await this.initializeNativeRequest(r),i={method:gc.GetToken,request:o};try{const l=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(l)}catch(l){if(l instanceof Di&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),du(l)))throw l}this.browserStorage.setTemporaryCache(Kt.NATIVE_REQUEST,JSON.stringify(o),!0);const s={apiId:un.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);n.end({success:!0}),await this.navigationClient.navigateExternal(a,s)}async handleRedirectPromise(e,n){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&n&&(e==null||e.addFields({errorCode:"no_cached_request"},n)),null;const{prompt:o,...i}=r;o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Kt.NATIVE_REQUEST));const s={method:gc.GetToken,request:i},a=Wi();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l);const u=this.handleNativeResponse(l,i,a);this.browserStorage.setInteractionInProgress(!1);const h=await u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),h}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,n,r){var h;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=vl(e.id_token,Gi),i=this.createHomeAccountIdentifier(e,o),s=(h=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId}))==null?void 0:h.homeAccountId;if(i!==s&&e.account.id!==n.accountId)throw Y1(L4);const a=await this.getDiscoveredAuthority({requestAuthority:n.authority}),l=Pw(this.browserStorage,a,i,Gi,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),u=await this.generateAuthenticationResult(e,n,o,l,a.canonicalAuthority,r);return this.cacheAccount(l),this.cacheNativeTokens(e,n,i,o,e.access_token,u.tenantId,r),u}createHomeAccountIdentifier(e,n){return Vn.generateHomeAccountId(e.client_info||ie.EMPTY_STRING,Xo.Default,this.logger,this.browserCrypto,n)}generateScopes(e,n){return e.scope?xn.fromString(e.scope):xn.fromString(n.scope)}async generatePopAccessToken(e,n){if(n.tokenType===Vt.POP&&n.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new Bc(this.browserCrypto),o={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce};if(!n.keyId)throw Ae(tb);return r.signPopToken(e.access_token,n.keyId,o)}else return e.access_token}async generateAuthenticationResult(e,n,r,o,i,s){const a=this.addTelemetryFromNativeResponse(e),l=e.scope?xn.fromString(e.scope):xn.fromString(n.scope),u=e.account.properties||{},h=u.UID||r.oid||r.sub||ie.EMPTY_STRING,f=u.TenantId||r.tid||ie.EMPTY_STRING,p=Aw(o.getAccountInfo(),void 0,r,e.id_token);p.nativeAccountId!==e.account.id&&(p.nativeAccountId=e.account.id);const g=await this.generatePopAccessToken(e,n),v=n.tokenType===Vt.POP?Vt.POP:Vt.BEARER;return{authority:i,uniqueId:h,tenantId:f,scopes:l.asArray(),account:p,idToken:e.id_token,idTokenClaims:r,accessToken:g,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:v,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(n=>{this.logger.error(`Error occurred while removing account context from browser storage. ${n}`)})}cacheNativeTokens(e,n,r,o,i,s,a){const l=nb(r,n.authority,e.id_token||"",n.clientId,o.tid||""),u=n.tokenType===Vt.POP?ie.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,h=a+u,f=this.generateScopes(e,n),p=rb(r,n.authority,i,n.clientId,o.tid||s,f.printScopes(),h,0,Gi,void 0,n.tokenType,void 0,n.keyId),g={idToken:l,accessToken:p};this.nativeStorageManager.saveCacheRecord(g,n.storeInCache)}addTelemetryFromNativeResponse(e){const n=this.getMATSFromResponse(e);return n?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:n.broker_version,matsAccountJoinOnStart:n.account_join_on_start,matsAccountJoinOnEnd:n.account_join_on_end,matsDeviceJoin:n.device_join,matsPromptBehavior:n.prompt_behavior,matsApiErrorCode:n.api_error_code,matsUiVisible:n.ui_visible,matsSilentCode:n.silent_code,matsSilentBiSubCode:n.silent_bi_sub_code,matsSilentMessage:n.silent_message,matsSilentStatus:n.silent_status,matsHttpStatus:n.http_status,matsHttpEventCount:n.http_event_count},this.correlationId),n):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw r3(Yy,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const n=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:n,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new At(n);r.validateAsUri();const{scopes:o,...i}=e,s=new xn(o||[]);s.appendScopes(Ea);const a=()=>{switch(this.apiId){case un.ssoSilent:case un.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),er.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case er.NONE:case er.CONSENT:case er.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Qe(b4)}},l={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Qe(S4);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Eu.MATS_TELEMETRY,e.authenticationScheme===Vt.POP){const u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new Bc(this.browserCrypto);let f;if(l.keyId)f=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const p=await Oe(h.generateCnf.bind(h),R.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);f=p.reqCnfString,l.keyId=p.kid,l.signPopToken=!0}l.reqCnf=f}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(sS.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(sS.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(pd)){const n=e.extraParameters[pd],r=e.redirectUri,o=e.extraParameters[sS.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:n,child_redirect_uri:r},e.redirectUri=o}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class Vi{constructor(e,n,r,o){this.logger=e,this.handshakeTimeoutMs=n,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(R.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const n={channel:Eu.CHANNEL_ID,extensionId:this.extensionId,responseId:Qi(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n),new Promise((r,o)=>{this.resolvers.set(n.responseId,{resolve:r,reject:o})})}static async createProvider(e,n,r){e.trace("NativeMessageHandler - createProvider called.");try{const o=new Vi(e,n,r,Eu.PREFERRED_EXTENSION_ID);return await o.sendHandshakeRequest(),o}catch{const i=new Vi(e,n,r);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Eu.CHANNEL_ID,extensionId:this.extensionId,responseId:Qi(),body:{method:gc.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=n=>{this.onChannelMessage(n)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((n,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:n,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Qe(g4)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const n=e.data;if(!(!n.channel||n.channel!==Eu.CHANNEL_ID)&&!(n.extensionId&&n.extensionId!==this.extensionId)&&n.body.method===gc.HandshakeRequest){const r=this.handshakeResolvers.get(n.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${n.responseId}`);return}this.logger.verbose(n.extensionId?`Extension with id: ${n.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(Qe(v4))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const n=e.data,r=this.resolvers.get(n.responseId),o=this.handshakeResolvers.get(n.responseId);try{const i=n.body.method;if(i===gc.Response){if(!r)return;const s=n.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")r.reject(Y1(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?r.reject(Y1(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result);else throw r3(Yy,"Event does not contain result.");this.resolvers.delete(n.responseId)}else if(i===gc.HandshakeResponse){if(!o){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${n.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=n.extensionId,this.extensionVersion=n.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(n.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):o&&o.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,n,r,o){if(n.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return n.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return n.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case Vt.BEARER:case Vt.POP:return n.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return n.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class qw{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async handleCodeResponse(e,n){this.performanceClient.addQueueMeasurement(R.HandleCodeResponse,n.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,n.state)}catch(o){throw o instanceof Yi&&o.subError===zc?Qe(zc):o}return Oe(this.handleCodeResponseFromServer.bind(this),R.HandleCodeResponseFromServer,this.logger,this.performanceClient,n.correlationId)(r,n)}async handleCodeResponseFromServer(e,n,r=!0){if(this.performanceClient.addQueueMeasurement(R.HandleCodeResponseFromServer,n.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Oe(this.authModule.updateAuthority.bind(this.authModule),R.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,n.correlationId)(e.cloud_instance_host_name,n.correlationId),r&&(e.nonce=n.nonce||void 0),e.state=n.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(n);i&&(this.authCodeRequest.ccsCredential=i)}return await Oe(this.authModule.acquireToken.bind(this.authModule),R.AuthClientAcquireToken,this.logger,this.performanceClient,n.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:mo.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:mo.UPN}:null}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function j4(t,e,n){const r=cv(t);if(!r)throw O3(t)?(n.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${e} detected is: ${t}`),Qe(Q3)):(n.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Qe(Y3));return r}function roe(t,e,n){if(!t.state)throw Qe(Dw);const r=P4(e,t.state);if(!r)throw Qe(J3);if(r.interactionType!==n)throw Qe(X3)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class ooe extends Hd{constructor(e,n,r,o,i,s,a,l,u,h){super(e,n,r,o,i,s,a,u,h),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||Ea,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(n){return Promise.reject(n)}}logout(e){try{this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,n){var i;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(un.acquireTokenPopup),o=await Oe(this.initializeAuthorizationRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Se.Popup);N4(o.authority);try{const s=await Oe(this.initializeAuthorizationCodeRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o),a=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),l=Vi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let u;l&&(u=this.performanceClient.startMeasurement(R.FetchAccountIdWithNativeBroker,e.correlationId));const h=await a.getAuthCodeUrl({...o,nativeBroker:l}),f=new qw(a,this.browserStorage,s,this.logger,this.performanceClient),p=this.initiateAuthRequest(h,n);this.eventHandler.emitEvent(ce.POPUP_OPENED,Se.Popup,{popupWindow:p},null);const g=await this.monitorPopupForHash(p,n.popupWindowParent),v=yl(j4,R.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Li.removeThrottle(this.browserStorage,this.config.auth.clientId,s),v.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Qe(wp);const b=new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,v.accountId,this.nativeStorage,o.correlationId),{userRequestState:C}=ci.parseRequestState(this.browserCrypto,o.state);return await b.acquireToken({...o,state:C,prompt:void 0})}return await f.handleCodeResponse(v,o)}catch(s){throw(i=n.popup)==null||i.close(),s instanceof Et&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async logoutPopupAsync(e,n,r,o){var s,a,l,u;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ce.LOGOUT_START,Se.Popup,e);const i=this.initializeServerTelemetryManager(un.logoutPopup);try{await this.clearCacheOnLogout(e.account);const h=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:e.account||void 0});try{h.authority.endSessionEndpoint}catch{if((s=e.account)!=null&&s.homeAccountId&&e.postLogoutRedirectUri&&h.authority.protocolMode===vs.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId),this.eventHandler.emitEvent(ce.LOGOUT_SUCCESS,Se.Popup,e),o){const g={apiId:un.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=At.getAbsoluteUrl(o,oi());await this.navigationClient.navigateInternal(v,g)}(l=n.popup)==null||l.close();return}}const f=h.getLogoutUri(e);this.eventHandler.emitEvent(ce.LOGOUT_SUCCESS,Se.Popup,e);const p=this.openPopup(f,n);if(this.eventHandler.emitEvent(ce.POPUP_OPENED,Se.Popup,{popupWindow:p},null),await this.monitorPopupForHash(p,n.popupWindowParent).catch(()=>{}),o){const g={apiId:un.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=At.getAbsoluteUrl(o,oi());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${v}`),await this.navigationClient.navigateInternal(v,g)}else this.logger.verbose("No main window navigation requested")}catch(h){throw(u=n.popup)==null||u.close(),h instanceof Et&&(h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(ce.LOGOUT_FAILURE,Se.Popup,null,h),this.eventHandler.emitEvent(ce.LOGOUT_END,Se.Popup),h}this.eventHandler.emitEvent(ce.LOGOUT_END,Se.Popup)}initiateAuthRequest(e,n){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,n);throw this.logger.error("Navigate url is empty"),Qe(cb)}monitorPopupForHash(e,n){return new Promise((r,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),o(Qe(zc));return}let s="";try{s=e.location.href}catch{}if(!s||s==="about:blank")return;clearInterval(i);let a="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===Tp.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,n)})}openPopup(e,n){try{let r;if(n.popup?(r=n.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof n.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,n)),!r)throw Qe(t4);return r.focus&&r.focus(),this.currentWindow=r,n.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),Qe(e4)}}openSizedPopup(e,{popupName:n,popupWindowAttributes:r,popupWindowParent:o}){var g,v,y,b;const i=o.screenLeft?o.screenLeft:o.screenX,s=o.screenTop?o.screenTop:o.screenY,a=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let u=(g=r.popupSize)==null?void 0:g.width,h=(v=r.popupSize)==null?void 0:v.height,f=(y=r.popupPosition)==null?void 0:y.top,p=(b=r.popupPosition)==null?void 0:b.left;return(!u||u<0||u>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=fo.POPUP_WIDTH),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=fo.POPUP_HEIGHT),(!f||f<0||f>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,l/2-fo.POPUP_HEIGHT/2+s)),(!p||p<0||p>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,a/2-fo.POPUP_WIDTH/2+i)),o.open(e,n,`width=${u}, height=${h}, top=${f}, left=${p}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(Se.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,n){e.close(),n.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,n){return`${fo.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${n}.${this.correlationId}`}generateLogoutPopupName(e){const n=e.account&&e.account.homeAccountId;return`${fo.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${n}.${this.correlationId}`}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class CR{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async initiateAuthRequest(e,n){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Kt.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Kt.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:un.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1};if(typeof n.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await n.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await n.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Qe(cb)}async handleCodeResponse(e,n){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(n),o=this.browserStorage.getTemporaryCache(r);if(!o)throw Ae($f,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,o)}catch(u){throw u instanceof Yi&&u.subError===zc?Qe(zc):u}const s=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await Oe(this.authModule.updateAuthority.bind(this.authModule),R.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=a||void 0,i.state=o,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const u=this.checkCcsCredentials();u&&(this.authCodeRequest.ccsCredential=u)}const l=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(n),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Kt.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function ioe(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const t=window.performance.getEntriesByType("navigation"),e=t.length?t[0]:void 0;return e==null?void 0:e.type}class soe extends Hd{constructor(e,n,r,o,i,s,a,l,u,h){super(e,n,r,o,i,s,a,u,h),this.nativeStorage=l}async acquireToken(e){const n=await Oe(this.initializeAuthorizationRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Se.Redirect);this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null);const r=this.initializeServerTelemetryManager(un.acquireTokenRedirect),o=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(n.state),this.eventHandler.emitEvent(ce.RESTORE_FROM_BFCACHE,Se.Redirect))};try{const i=await Oe(this.initializeAuthorizationCodeRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n),s=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),a=new CR(s,this.browserStorage,i,this.logger,this.performanceClient),l=await s.getAuthCodeUrl({...n,nativeBroker:Vi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),u=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",o),await a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof Et&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(n.state),i}}async handleRedirectPromise(e="",n){const r=this.initializeServerTelemetryManager(un.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[o,i]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Se.Redirect),ioe()!=="back_forward"?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(Kt.ORIGIN_URI,!0)||ie.EMPTY_STRING,a=At.removeHashFromUrl(s),l=At.removeHashFromUrl(window.location.href);if(a===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&Sre(s),await this.handleResponse(o,r);if(this.config.auth.navigateToLoginRequestUrl){if(!Vw()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Kt.URL_HASH,i,!0);const u={apiId:un.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(!s||s==="null"){const f=Ere();this.browserStorage.setTemporaryCache(Kt.ORIGIN_URI,f,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=await this.navigationClient.navigateInternal(f,u)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),h=await this.navigationClient.navigateInternal(s,u);if(!h)return await this.handleResponse(o,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(o,r);return null}catch(o){throw o instanceof Et&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.browserStorage.cleanRequestByInteractionType(Se.Redirect),o}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let n=e;n||(this.config.auth.OIDCOptions.serverResponseType===Tp.QUERY?n=window.location.search:n=window.location.hash);let r=cv(n);if(r){try{roe(r,this.browserCrypto,Se.Redirect)}catch(i){return i instanceof Et&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return Cre(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,n]}const o=this.browserStorage.getTemporaryCache(Kt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Kt.URL_HASH)),o&&(r=cv(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,n){const r=e.state;if(!r)throw Qe(Dw);const o=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Qe(wp);const l=new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:u}=ci.parseRequestState(this.browserCrypto,r);return l.acquireToken({...o,state:u,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const i=this.browserStorage.getCachedAuthority(r);if(!i)throw Qe(jw);const s=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i});return Li.removeThrottle(this.browserStorage,this.config.auth.clientId,o),new CR(s,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var o,i;this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(un.logout);try{this.eventHandler.emitEvent(ce.LOGOUT_START,Se.Redirect,e),await this.clearCacheOnLogout(n.account);const s={apiId:un.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===vs.OIDC)try{a.authority.endSessionEndpoint}catch{if((o=n.account)!=null&&o.homeAccountId){this.browserStorage.removeAccount((i=n.account)==null?void 0:i.homeAccountId),this.eventHandler.emitEvent(ce.LOGOUT_SUCCESS,Se.Redirect,n);return}}const l=a.getLogoutUri(n);if(this.eventHandler.emitEvent(ce.LOGOUT_SUCCESS,Se.Redirect,n),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}}catch(s){throw s instanceof Et&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),this.eventHandler.emitEvent(ce.LOGOUT_FAILURE,Se.Redirect,null,s),this.eventHandler.emitEvent(ce.LOGOUT_END,Se.Redirect),s}this.eventHandler.emitEvent(ce.LOGOUT_END,Se.Redirect)}getRedirectStartPage(e){const n=e||window.location.href;return At.getAbsoluteUrl(n,oi())}}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function aoe(t,e,n,r,o){if(e.addQueueMeasurement(R.SilentHandlerInitiateAuthRequest,r),!t)throw n.info("Navigate url is empty"),Qe(cb);return o?Oe(loe,R.SilentHandlerLoadFrame,n,e,r)(t,o,e,r):yl(uoe,R.SilentHandlerLoadFrameSync,n,e,r)(t)}async function coe(t,e,n,r,o,i,s){return r.addQueueMeasurement(R.SilentHandlerMonitorIframeForHash,i),new Promise((a,l)=>{e<fv&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${fv}ms). This may result in timeouts.`);const u=window.setTimeout(()=>{window.clearInterval(h),l(Qe(n4))},e),h=window.setInterval(()=>{let f="";const p=t.contentWindow;try{f=p?p.location.href:""}catch{}if(!f||f==="about:blank")return;let g="";p&&(s===Tp.QUERY?g=p.location.search:g=p.location.hash),window.clearTimeout(u),window.clearInterval(h),a(g)},n)}).finally(()=>{yl(doe,R.RemoveHiddenIframe,o,r,i)(t)})}function loe(t,e,n,r){return n.addQueueMeasurement(R.SilentHandlerLoadFrame,r),new Promise((o,i)=>{const s=U4();window.setTimeout(()=>{if(!s){i("Unable to load iframe");return}s.src=t,o(s)},e)})}function uoe(t){const e=U4();return e.src=t,e}function U4(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function doe(t){document.body===t.parentNode&&document.body.removeChild(t)}/*! @azure/msal-browser v3.26.1 2024-10-08 */class hoe extends Hd{constructor(e,n,r,o,i,s,a,l,u,h,f){super(e,n,r,o,i,s,l,h,f),this.apiId=a,this.nativeStorage=u}async acquireToken(e){this.performanceClient.addQueueMeasurement(R.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const n={...e};n.prompt?n.prompt!==er.NONE&&n.prompt!==er.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${er.NONE}`),n.prompt=er.NONE):n.prompt=er.NONE;const r=await Oe(this.initializeAuthorizationRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,Se.Silent);N4(r.authority);const o=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await Oe(this.createAuthCodeClient.bind(this),R.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await Oe(this.silentTokenHelper.bind(this),R.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,r)}catch(s){if(s instanceof Et&&(s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s)),!i||!(s instanceof Et)||s.errorCode!==fo.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);const a=await Oe(this.initializeAuthorizationRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,Se.Silent);return await Oe(this.silentTokenHelper.bind(this),R.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a)}}logout(){return Promise.reject(Qe(lb))}async silentTokenHelper(e,n){const r=n.correlationId;this.performanceClient.addQueueMeasurement(R.SilentIframeClientTokenHelper,r);const o=await Oe(this.initializeAuthorizationCodeRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(n),i=await Oe(e.getAuthCodeUrl.bind(e),R.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...n,nativeBroker:Vi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)}),s=new qw(e,this.browserStorage,o,this.logger,this.performanceClient),a=await Oe(aoe,R.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,u=await Oe(coe,R.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,l),h=yl(j4,R.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(u,l,this.logger);if(h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Qe(wp);const f=new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,r),{userRequestState:p}=ci.parseRequestState(this.browserCrypto,n.state);return Oe(f.acquireToken.bind(f),R.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...n,state:p,prompt:n.prompt||er.NONE})}return Oe(s.handleCodeResponse.bind(s),R.HandleCodeResponse,this.logger,this.performanceClient,r)(h,n)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class foe extends Hd{async acquireToken(e){this.performanceClient.addQueueMeasurement(R.SilentRefreshClientAcquireToken,e.correlationId);const n=await Oe(Kw,R.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...n};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const o=this.initializeServerTelemetryManager(un.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Oe(i.acquireTokenByRefreshToken.bind(i),R.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(s=>{throw s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s),s})}logout(){return Promise.reject(Qe(lb))}async createRefreshTokenClient(e){const n=await Oe(this.getClientConfiguration.bind(this),R.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new $1(n,this.performanceClient)}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class poe{constructor(e,n,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=n,this.logger=r,this.cryptoObj=o}loadExternalTokens(e,n,r){if(!this.isBrowserEnvironment)throw Qe(Uw);const o=n.id_token?vl(n.id_token,Gi):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new mr(mr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Qi()):void 0,a=this.loadAccount(e,r.clientInfo||n.client_info||"",o,s),l=this.loadIdToken(n,a.homeAccountId,a.environment,a.realm),u=this.loadAccessToken(e,n,a.homeAccountId,a.environment,a.realm,r),h=this.loadRefreshToken(n,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:l,accessToken:u,refreshToken:h},o,s)}loadAccount(e,n,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const l=Vn.createFromAccountInfo(e.account);return this.storage.setAccount(l),l}else if(!o||!n&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Qe(d4);const i=Vn.generateHomeAccountId(n,o.authorityType,this.logger,this.cryptoObj,r),s=r==null?void 0:r.tid,a=Pw(this.storage,o,i,Gi,r,n,o.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}loadIdToken(e,n,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=nb(n,r,e.id_token,this.config.auth.clientId,o);return this.storage.setIdTokenCredential(i),i}loadAccessToken(e,n,r,o,i,s){if(n.access_token)if(n.expires_in){if(!n.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const a=n.scope?xn.fromString(n.scope):new xn(e.scopes),l=s.expiresOn||n.expires_in+new Date().getTime()/1e3,u=s.extendedExpiresOn||(n.ext_expires_in||n.expires_in)+new Date().getTime()/1e3,h=rb(r,o,n.access_token,this.config.auth.clientId,i,a.printScopes(),l,u,Gi);return this.storage.setAccessTokenCredential(h),h}loadRefreshToken(e,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=y3(n,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(o),o}generateAuthenticationResult(e,n,r,o){var h,f,p;let i="",s=[],a=null,l;n!=null&&n.accessToken&&(i=n.accessToken.secret,s=xn.fromString(n.accessToken.target).asArray(),a=new Date(Number(n.accessToken.expiresOn)*1e3),l=new Date(Number(n.accessToken.extendedExpiresOn)*1e3));const u=n.account;return{authority:o?o.canonicalAuthority:"",uniqueId:n.account.localAccountId,tenantId:n.account.realm,scopes:s,account:u.getAccountInfo(),idToken:((h=n.idToken)==null?void 0:h.secret)||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((f=n.refreshToken)==null?void 0:f.familyId)||"",tokenType:((p=n==null?void 0:n.accessToken)==null?void 0:p.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class moe extends V3{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.26.1 2024-10-08 */class goe extends Hd{constructor(e,n,r,o,i,s,a,l,u,h){super(e,n,r,o,i,s,l,u,h),this.apiId=a}async acquireToken(e){if(!e.code)throw Qe(h4);const n=await Oe(this.initializeAuthorizationRequest.bind(this),R.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,Se.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const o={...n,code:e.code},i=await Oe(this.getClientConfiguration.bind(this),R.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),s=new moe(i);this.logger.verbose("Auth code client created");const a=new qw(s,this.browserStorage,o,this.logger,this.performanceClient);return await Oe(a.handleCodeResponseFromServer.bind(a),R.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},n,!1)}catch(o){throw o instanceof Et&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}}logout(){return Promise.reject(Qe(lb))}}/*! @azure/msal-browser v3.26.1 2024-10-08 */function Ci(t){const e=t==null?void 0:t.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function ym(t,e){try{ys(t)}catch(n){throw e.end({success:!1},n),n}}class hb{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Gc(this.logger,this.performanceClient):iv,this.eventHandler=new M4(this.logger),this.browserStorage=this.isBrowserEnvironment?new W1(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Nne(this.config.auth),this.performanceClient):Lre(this.config.auth.clientId,this.logger);const n={cacheLocation:Tn.MemoryStorage,temporaryCacheLocation:Tn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new W1(this.config.auth.clientId,n,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new poe(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,n){const r=new hb(e);return await r.initialize(n),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(ce.INITIALIZE_END);return}const n=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(R.InitializeClientApplication,n);if(this.eventHandler.emitEvent(ce.INITIALIZE_START),r)try{this.nativeExtensionProvider=await Vi.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Oe(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),R.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,n)(this.performanceClient,n)),this.initialized=!0,this.eventHandler.emitEvent(ce.INITIALIZE_END),o.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),$w(this.initialized),this.isBrowserEnvironment){const n=e||"";let r=this.redirectResponse.get(n);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(n,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&Vi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(Kt.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(R.AcquireTokenRedirect,i);this.eventHandler.emitEvent(ce.HANDLE_REDIRECT_START,Se.Redirect);let a;if(o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=Oe(l.handleRedirectPromise.bind(l),R.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(i);a=Oe(l.handleRedirectPromise.bind(l),R.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(l=>(l?(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ce.LOGIN_SUCCESS,Se.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_SUCCESS,Se.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:Ci(l.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(ce.HANDLE_REDIRECT_END,Se.Redirect),l)).catch(l=>{const u=l;throw n.length>0?this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Redirect,null,u):this.eventHandler.emitEvent(ce.LOGIN_FAILURE,Se.Redirect,null,u),this.eventHandler.emitEvent(ce.HANDLE_REDIRECT_END,Se.Redirect),s.end({success:!1},u),l})}async acquireTokenRedirect(e){const n=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",n);const r=this.performanceClient.startMeasurement(R.AcquireTokenPreRedirect,n);r.add({accountType:Ci(e.account),scenarioId:e.scenarioId});const o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=s=>{const a=typeof o=="function"?o(s):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const s=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const l=typeof s=="function"?s(a):void 0;return l!==!1?r.end({success:!0}):r.discard(),l}}const i=this.getAllAccounts().length>0;try{yR(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_START,Se.Redirect,e):this.eventHandler.emitEvent(ce.LOGIN_START,Se.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,n).acquireTokenRedirect(e,r).catch(l=>{if(l instanceof Di&&du(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(n).acquireToken(e);if(l instanceof jr)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):s=this.createRedirectClient(n).acquireToken(e),await s}catch(s){throw r.end({success:!1},s),i?this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Redirect,null,s):this.eventHandler.emitEvent(ce.LOGIN_FAILURE,Se.Redirect,null,s),s}}acquireTokenPopup(e){const n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(R.AcquireTokenPopup,n);r.add({scenarioId:e.scenarioId,accountType:Ci(e.account)});try{this.logger.verbose("acquireTokenPopup called",n),ym(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}const o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_START,Se.Popup,e):this.eventHandler.emitEvent(ce.LOGIN_START,Se.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:n},un.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:s.requestId,accountType:Ci(s.account)}),s)).catch(s=>{if(s instanceof Di&&du(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(n).acquireToken(e);if(s instanceof jr)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):i=this.createPopupClient(n).acquireToken(e),i.then(s=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ce.LOGIN_SUCCESS,Se.Popup,s):this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_SUCCESS,Se.Popup,s),r.end({success:!0,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Ci(s.account)}),s)).catch(s=>(o.length>0?this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Popup,null,s):this.eventHandler.emitEvent(ce.LOGIN_FAILURE,Se.Popup,null,s),r.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var i,s;const n=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:n};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(R.SsoSilent,n),(i=this.ssoSilentMeasurement)==null||i.add({scenarioId:e.scenarioId,accountType:Ci(e.account)}),ym(this.initialized,this.ssoSilentMeasurement),(s=this.ssoSilentMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(ce.SSO_SILENT_START,Se.Silent,r);let o;return this.canUseNative(r)?o=this.acquireTokenNative(r,un.ssoSilent).catch(a=>{if(a instanceof Di&&du(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):o=this.createSilentIframeClient(r.correlationId).acquireToken(r),o.then(a=>{var l;return this.eventHandler.emitEvent(ce.SSO_SILENT_SUCCESS,Se.Silent,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:a.fromNativeBroker,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Ci(a.account)}),a}).catch(a=>{var l;throw this.eventHandler.emitEvent(ce.SSO_SILENT_FAILURE,Se.Silent,null,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const n=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",n);const r=this.performanceClient.startMeasurement(R.AcquireTokenByCode,n);ym(this.initialized,r),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_BY_CODE_START,Se.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Qe(p4);if(e.code){const o=e.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",n),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),i=this.acquireTokenByCodeAsync({...e,correlationId:n}).then(s=>(this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Se.Silent,s),this.hybridAuthCodeResponses.delete(o),r.end({success:!0,isNativeBroker:s.fromNativeBroker,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Ci(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_BY_CODE_FAILURE,Se.Silent,null,s),r.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(o,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const o=await this.acquireTokenNative({...e,correlationId:n},un.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Di&&du(i)&&(this.nativeExtensionProvider=void 0),i});return r.end({accountType:Ci(o.account),success:!0}),o}else throw Qe(m4);else throw Qe(f4)}catch(o){throw this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_BY_CODE_FAILURE,Se.Silent,null,o),r.end({success:!1},o),o}}async acquireTokenByCodeAsync(e){var o;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(R.AcquireTokenByCodeAsync,e.correlationId),(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>{var s;return(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker,requestId:i.requestId}),i}).catch(i=>{var s;throw(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,n){switch(this.performanceClient.addQueueMeasurement(R.AcquireTokenFromCache,e.correlationId),n){case Fn.Default:case Fn.AccessToken:case Fn.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return Oe(r.acquireToken.bind(r),R.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ae(ri)}}async acquireTokenByRefreshToken(e,n){switch(this.performanceClient.addQueueMeasurement(R.AcquireTokenByRefreshToken,e.correlationId),n){case Fn.Default:case Fn.AccessTokenAndRefreshToken:case Fn.RefreshToken:case Fn.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return Oe(r.acquireToken.bind(r),R.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Ae(ri)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(R.AcquireTokenBySilentIframe,e.correlationId);const n=this.createSilentIframeClient(e.correlationId);return Oe(n.acquireToken.bind(n),R.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const n=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),this.logoutRedirect({correlationId:n,...e})}async logoutRedirect(e){const n=this.getRequestCorrelationId(e);return yR(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(n).logout(e)}logoutPopup(e){try{const n=this.getRequestCorrelationId(e);return ys(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(n).logout(e)}catch(n){return Promise.reject(n)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const n=this.getRequestCorrelationId(e);return this.createSilentCacheClient(n).logout(e)}getAllAccounts(e){return Dre(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return jre(e,this.logger,this.browserStorage)}getAccountByUsername(e){return Ure(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return Fre(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return Bre(e,this.logger,this.browserStorage)}setActiveAccount(e){Hre(e,this.browserStorage)}getActiveAccount(){return zre(this.browserStorage)}async hydrateCache(e,n){this.logger.verbose("hydrateCache called");const r=Vn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,n)):this.browserStorage.hydrateCache(e,n)}async acquireTokenNative(e,n,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Qe(wp);return new Du(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,n,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,n){if(this.logger.trace("canUseNative called"),!Vi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case er.NONE:case er.CONSENT:case er.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!n&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const n=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return n&&n.nativeAccountId||""}createPopupClient(e){return new ooe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new soe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new hoe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new D4(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new foe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new goe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,un.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,n){return this.eventHandler.addEventCallback(e,n)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return R4(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var n;try{(n=e.key)!=null&&n.includes(Yn.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(ce.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const o=JSON.parse(r);if(typeof o!="object"||!Vn.isAccountEntity(o))return;const s=fd.toObject(new Vn,o).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(ce.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(ce.ACCOUNT_REMOVED,void 0,s))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,n){this.browserStorage.setWrapperMetadata(e,n)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Qi():ie.EMPTY_STRING}async loginRedirect(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",n),this.acquireTokenRedirect({correlationId:n,...e||mR})}loginPopup(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup({correlationId:n,...e||mR})}async acquireTokenSilent(e){const n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(R.AcquireTokenSilent,n);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),ym(this.initialized,r),this.logger.verbose("acquireTokenSilent called",n);const o=e.account||this.getActiveAccount();if(!o)throw Qe(s4);r.add({accountType:Ci(o)});const i={clientId:this.config.auth.clientId,authority:e.authority||ie.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(i),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n);const l=Oe(this.acquireTokenSilentAsync.bind(this),R.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)({...e,correlationId:n},o).then(u=>(this.activeSilentTokenRequests.delete(s),r.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:u.requestId,accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),u)).catch(u=>{throw this.activeSilentTokenRequests.delete(s),r.end({success:!1},u),u});return this.activeSilentTokenRequests.set(s,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,n){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(R.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_START,Se.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const o=await Oe(qre,R.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,n,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||Fn.Default;return this.acquireTokenSilentNoIframe(o,i).catch(async a=>{if(voe(a,i))if(this.activeIframeRequest)if(i!==Fn.Skip){const[u,h]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${h}`,o.correlationId);const f=this.performanceClient.startMeasurement(R.AwaitConcurrentIframe,o.correlationId);f.add({awaitIframeCorrelationId:h});const p=await u;if(f.end({success:p}),p)return this.logger.verbose(`Parallel iframe request with correlationId: ${h} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${h} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Oe(this.acquireTokenBySilentIframe.bind(this),R.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o);else{let u;return this.activeIframeRequest=[new Promise(h=>{u=h}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Oe(this.acquireTokenBySilentIframe.bind(this),R.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(h=>(u(!0),h)).catch(h=>{throw u(!1),h}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_SUCCESS,Se.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker,requestId:a.requestId},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,n){return Vi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,un.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof Di&&du(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Ae(ri)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),Oe(this.acquireTokenFromCache.bind(this),R.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,n).catch(r=>{if(n===Fn.AccessToken)throw r;return this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_NETWORK_START,Se.Silent,e),Oe(this.acquireTokenByRefreshToken.bind(this),R.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,n)}))}}function voe(t,e){const n=!(t instanceof jr&&t.subError!==ab),r=t.errorCode===fo.INVALID_GRANT_ERROR||t.errorCode===ri,o=n&&r||t.errorCode===uv||t.errorCode===Nw,i=sre.includes(e);return o&&i}/*! @azure/msal-browser v3.26.1 2024-10-08 */async function yoe(t,e){const n=new $c(t);return await n.initialize(),hb.createController(n,e)}/*! @azure/msal-browser v3.26.1 2024-10-08 */let boe=class F4{static async createPublicClientApplication(e){const n=await yoe(e);return new F4(e,n)}constructor(e,n){this.controller=n||new hb(new $c(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,n){return this.controller.addEventCallback(e,n)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,n){return this.controller.initializeWrapperLibrary(e,n)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,n){return this.controller.hydrateCache(e,n)}clearCache(e){return this.controller.clearCache(e)}};/*! @azure/msal-browser v3.26.1 2024-10-08 */class SR{constructor(e,n){const r=n&&n.loggerOptions||{};this.logger=new hi(r,pv,Vc),this.cryptoOps=new Gc(this.logger),this.popTokenGenerator=new Bc(this.cryptoOps),this.shrParameters=e}async generatePublicKeyThumbprint(){const{kid:e}=await this.popTokenGenerator.generateKid(this.shrParameters);return e}async signRequest(e,n,r){return this.popTokenGenerator.signPayload(e,n,this.shrParameters,r)}async removeKeys(e){return this.cryptoOps.removeTokenBindingKey(e)}}function IR(){let t;try{t=window[Tn.SessionStorage];const e=t==null?void 0:t.getItem(lre);if(Number(e)===1)return H(()=>import("./BrowserPerformanceMeasurement-CIsv1iQ0.js"),[])}catch{}}function ng(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.now=="function"}function Coe(t){if(!(!t||!ng()))return Math.round(window.performance.now()-t)}class Soe extends Jne{constructor(e,n,r){var o,i;super(e.auth.clientId,e.auth.authority||`${ie.DEFAULT_AUTHORITY}`,new hi(((o=e.system)==null?void 0:o.loggerOptions)||{},pv,Vc),pv,Vc,((i=e.telemetry)==null?void 0:i.application)||{appName:"",appVersion:""},n,r)}generateId(){return Qi()}getPageVisibility(){var e;return((e=document.visibilityState)==null?void 0:e.toString())||null}deleteIncompleteSubMeasurements(e){var n;(n=IR())==null||n.then(r=>{const o=this.eventsByCorrelationId.get(e.event.correlationId),i=o&&o.eventId===e.event.eventId,s=[];i&&(o!=null&&o.incompleteSubMeasurements)&&o.incompleteSubMeasurements.forEach(a=>{s.push({...a})}),r.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,s)})}startMeasurement(e,n){var a;const r=this.getPageVisibility(),o=super.startMeasurement(e,n),i=ng()?window.performance.now():void 0,s=(a=IR())==null?void 0:a.then(l=>new l.BrowserPerformanceMeasurement(e,o.event.correlationId));return s==null||s.then(l=>l.startMeasurement()),{...o,end:(l,u)=>{const h=o.end({...l,startPageVisibility:r,endPageVisibility:this.getPageVisibility(),durationMs:Coe(i)},u);return s==null||s.then(f=>f.endMeasurement()),this.deleteIncompleteSubMeasurements(o),h},discard:()=>{o.discard(),s==null||s.then(l=>l.flushMeasurement()),this.deleteIncompleteSubMeasurements(o)}}}setPreQueueTime(e,n){if(!ng()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);return}if(!n){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);return}const r=this.preQueueTimeByCorrelationId.get(n);r&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${r.name} found`,n),this.addQueueMeasurement(r.name,n,void 0,!0)),this.preQueueTimeByCorrelationId.set(n,{name:e,time:window.performance.now()})}addQueueMeasurement(e,n,r,o){if(!ng()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);return}if(!n){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);return}const i=super.getPreQueueTime(e,n);if(!i)return;const s=window.performance.now(),a=r||super.calculateQueuedTime(i,s);return super.addQueueMeasurement(e,n,a,o)}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const St={...R,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedSSOSilent",EmbeddedClientApplicationSendPopupRequest:"embeddedPopup",EmbeddedClientApplicationSendRedirectRequest:"embeddedRedirect",EmbeddedClientApplicationHandleRedirectRequest:"embeddedHandleRedirect",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedSilentRefresh"},Ioe=new Map([[St.PairwiseBrokerApplicationInitializeBrokering,"PWBInitBrk"],[St.BrokerClientApplicationHandleBrokerHandshake,"BrkClientHandeBrkHandshake"],[St.BrokerClientApplicationBrokeredSSOSilentRequest,"BrkClientBrkSSOReq"],[St.BrokerClientApplicationBrokeredSilentRequest,"BrkClientBrkSltReq"],[St.EmbeddedClientApplicationSendSSOSilentRequest,"EmbClientSendSSOReq"],[St.EmbeddedClientApplicationSendPopupRequest,"EmbClientSendPopupReq"],[St.EmbeddedClientApplicationSendRedirectRequest,"EmbClientSendRedirectReq"],[St.EmbeddedClientApplicationHandleRedirectRequest,"EmbClientHandleRedirectReq"],[St.EmbeddedClientApplicationSendSilentRefreshRequest,"EmbClientSendSltRefreshReq"]]),Eoe=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);var Toe="function",Ww="object",Yw="undefined",ff="prototype",Qw=Object,woe=Qw[ff];/*! https://github.com/nevware21/ts-utils v0.11.5 */function Ds(t,e){return t||e}function zr(t,e){return t[e]}var po=void 0,zn=null,Jw="",fb="function",_p="object",bs="prototype",Q1="__proto__",vc="undefined",vv="constructor",Xw="Symbol",_oe="_polyfill",Tc="length",yv="name",lr="call",pb="toString",Vo=Ds(Object),Zw=zr(Vo,bs),B4=Ds(String),bl=zr(B4,bs),Aoe=Ds(Math),H4=Ds(Array),z4=zr(H4,bs),_s=zr(z4,"slice");function ur(t,e){try{return{v:t.apply(this,e)}}catch(n){return{e:n}}}function koe(t,e){var n=ur(t);return n.e?e:n.v}var aS;function mb(t){return function(e){return typeof e===t}}function V4(t){var e="[object "+t+"]";return function(n){return!!(n&&xoe(n)===e)}}function xoe(t){return Zw[pb].call(t)}function Qt(t){return typeof t===vc||t===vc}function Roe(t){return!e_(t)}function Jt(t){return t===zn||Qt(t)}function Noe(t){return t===zn||!e_(t)}function e_(t){return!!t||t!==po}function Poe(t){return!aS&&(aS=["string","number","boolean",vc,"symbol","bigint"]),t!==_p&&aS.indexOf(t)!==-1}var yr=mb("string"),tn=mb(fb);function md(t){return!t&&Jt(t)?!1:!!t&&typeof t===_p}var kt=zr(H4,"isArray"),Moe=V4("Date"),Ta=mb("number"),Kc=mb("boolean"),Ooe=V4("Error");function gd(t){return!!(t&&t.then&&tn(t.then))}function ER(t){return!(!t||koe(function(){return!(t&&0+t)},!t))}var t_=zr(Vo,"getOwnPropertyDescriptor");function Fo(t,e){return!!t&&Zw.hasOwnProperty[lr](t,e)}var ju=Ds(zr(Vo,"hasOwn"),Loe);function Loe(t,e){return Fo(t,e)||!!t_(t,e)}function nn(t,e,n){if(t&&md(t)){for(var r in t)if(ju(t,r)&&e[lr](t,r,t[r])===-1)break}}var bm={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function $4(t){var e={};if(e[bm.c]=!0,e[bm.e]=!0,t.l){e.get=function(){return t.l.v};var n=t_(t.l,"v");n&&n.set&&(e.set=function(r){t.l.v=r})}return nn(t,function(r,o){e[bm[r]]=Roe(o)?e[bm[r]]:o}),e}var As=zr(Vo,"defineProperty"),Doe=zr(Vo,"defineProperties");function vn(t,e,n){return As(t,e,$4(n))}function G4(t,e){var n={};return nn(e,function(r,o){n[r]=$4(o)}),Doe(t,n)}function K4(t,e,n,r,o){var i={};return nn(t,function(s,a){bv(i,s,e?a:s),bv(i,a,s)}),r?r(i):i}function bv(t,e,n,r){As(t,e,{value:n,enumerable:!0,writable:!1})}var ii=Ds(B4),joe="[object Error]";function Ot(t,e){var n=Jw,r=Zw[pb][lr](t);r===joe&&(t={stack:ii(t.stack),message:ii(t.message),name:ii(t.name)});try{n=JSON.stringify(t,zn,e?typeof e=="number"?e:4:po),n=(n?n.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):zn)||ii(t)}catch(o){n=" - "+Ot(o,e)}return r+": "+n}function Ao(t){throw new Error(t)}function $o(t){throw new TypeError(t)}var q4=zr(Vo,"freeze");function Uoe(t){return t}function Foe(t){return t[Q1]||zn}var TR=zr(Vo,"assign"),Cs=zr(Vo,"keys");function zd(t){return q4&&nn(t,function(e,n){(kt(n)||md(n))&&zd(n)}),qc(t)}var qc=Ds(q4,Uoe),J1=Ds(zr(Vo,"getPrototypeOf"),Foe);function Boe(t){return K4(t,1,0,qc)}function Hoe(t){return K4(t,0,0,qc)}function zoe(t){var e={};return nn(t,function(n,r){bv(e,n,r[1]),bv(e,r[0],r[1])}),qc(e)}function Voe(t){return zoe(t)}var W4=Hoe({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),wR="__tsUtils$gblCfg",cS;function Y4(){var t;return typeof globalThis!==vc&&(t=globalThis),!t&&typeof self!==vc&&(t=self),!t&&typeof window!==vc&&(t=window),!t&&typeof global!==vc&&(t=global),t}function Q4(){if(!cS){var t=ur(Y4).v||{};cS=t[wR]=t[wR]||{}}return cS}var gb=Ap;function Ap(t,e,n){var r=e?e[t]:zn;return function(o){var i=(o?o[t]:zn)||r;if(i||n){var s=arguments;return(i||n).apply(o,i?_s[lr](s,1):s)}$o('"'+ii(t)+'" not defined for '+Ot(o))}}function $oe(t){return function(e){return e[t]}}var Goe=zr(Aoe,"max"),_R=gb("slice",bl),ji=gb("substring",bl),hu=Ap("substr",bl,Koe);function Koe(t,e,n){return Jt(t)&&$o("Invalid "+Ot(t)),n<0?Jw:(e=e||0,e<0&&(e=Goe(e+t[Tc],0)),Qt(n)?_R(t,e):_R(t,e,e+n))}function n_(t,e){return ji(t,0,e)}var AR="_urid",lS;function qoe(){if(!lS){var t=Q4();lS=t.gblSym=t.gblSym||{k:{},s:{}}}return lS}var Cm;function r_(t){var e={description:ii(t),toString:function(){return Xw+"("+t+")"}};return e[_oe]=!0,e}function Woe(t){var e=qoe();if(!ju(e.k,t)){var n=r_(t),r=Cs(e.s).length;n[AR]=function(){return r+"_"+n[pb]()},e.k[t]=n,e.s[n[AR]()]=ii(t)}return e.k[t]}function Yoe(t){!Cm&&(Cm={});var e,n=W4[t];return n&&(e=Cm[n]=Cm[n]||r_(Xw+"."+n)),e}var On;function ja(){On=Q4()}function Qoe(t){var e={};return!On&&ja(),e.b=On.lzy,As(e,"v",{configurable:!0,get:function(){var n=t();return On.lzy||As(e,"v",{value:n}),e.b=On.lzy,n}}),e}function Go(t){return As({toJSON:function(){return t}},"v",{value:t})}var J4="window",pf;function vb(t,e){var n;return function(){return!On&&ja(),(!n||On.lzy)&&(n=Go(ur(t,e).v)),n.v}}function Vd(t){return!On&&ja(),(!pf||t===!1||On.lzy)&&(pf=Go(ur(Y4).v||zn)),pf.v}function Ln(t,e){var n;if(!pf||e===!1?n=Vd(e):n=pf.v,n&&n[t])return n[t];if(t===J4)try{return window}catch{}return zn}function X4(){return!!ks()}var ks=vb(Ln,["document"]);function Joe(){return!!Ua()}var Ua=vb(Ln,[J4]);function Xoe(){return!!es()}var es=vb(Ln,["navigator"]),Zoe=vb(function(){return!!ur(function(){return process&&(process.versions||{}).node}).v}),vd,uS;function yb(){return vd=Go(ur(Ln,[Xw]).v),vd}function eie(t){var e=(On.lzy?0:vd)||yb();return e.v?e.v[t]:po}function tie(){return!!nie()}function nie(){return!On&&ja(),((On.lzy?0:vd)||yb()).v}function o_(t,e){var n=W4[t];!On&&ja();var r=(On.lzy?0:vd)||yb();return r.v?r.v[n||t]:Yoe(t)}function Th(t,e){!On&&ja();var n=(On.lzy?0:vd)||yb();return n.v?n.v(t):r_(t)}function i_(t){return!On&&ja(),uS=(On.lzy?0:uS)||Go(ur(eie,["for"]).v),(uS.v||Woe)(t)}function X1(t){return!!t&&tn(t.next)}function Z4(t){return!Noe(t)&&tn(t[o_(3)])}var Sm;function s_(t,e,n){if(t&&(X1(t)||(!Sm&&(Sm=Go(o_(3))),t=t[Sm.v]?t[Sm.v]():zn),X1(t))){var r=po,o=po;try{for(var i=0;!(o=t.next()).done&&e[lr](n||t,o.value,i,t)!==-1;)i++}catch(s){r={e:s},t.throw&&(o=zn,t.throw(r))}finally{try{o&&!o.done&&t.return&&t.return(o)}finally{if(r)throw r.e}}}}function Tu(t,e,n){return t.apply(e,n)}function la(t,e){return!Qt(e)&&t&&(kt(e)?Tu(t.push,t,e):X1(e)||Z4(e)?s_(e,function(n){t.push(n)}):t.push(e)),t}function Xe(t,e,n){if(t)for(var r=t[Tc]>>>0,o=0;o<r&&!(o in t&&e[lr](t,t[o],o,t)===-1);o++);}var Bo=gb("indexOf",z4);function bb(t,e,n){return((t?t.slice:zn)||_s).apply(t,_s[lr](arguments,1))}var wa=Ds(zr(Vo,"create"),rie);function rie(t){if(!t)return{};var e=typeof t;e!==_p&&e!==fb&&$o("Prototype must be an Object or function: "+Ot(t));function n(){}return n[bs]=t,new n}var dS;function e6(t,e){var n=Vo.setPrototypeOf||function(r,o){var i;!dS&&(dS=Go((i={},i[Q1]=[],i instanceof Array))),dS.v?r[Q1]=o:nn(o,function(s,a){return r[s]=a})};return n(t,e)}function oie(t,e,n){ur(vn,[e,yv,{v:t,c:!0,e:!1}]),e=e6(e,n);function r(){this[vv]=e,ur(vn,[this,yv,{v:t,c:!0,e:!1}])}return e[bs]=n===zn?wa(n):(r[bs]=n[bs],new r),e}function kR(t,e){e&&(t[yv]=e)}function iie(t,e,n){var r=Error,o=r[bs][yv],i=Error.captureStackTrace;return oie(t,function(){var s=this,a=arguments;try{ur(kR,[r,t]);var l=Tu(r,s,_s[lr](a))||s;if(l!==s){var u=J1(s);u!==J1(l)&&e6(l,u)}return i&&i(l,s[vv]),e&&e(l,a),l}finally{ur(kR,[r,o])}},r)}function _a(){return(Date.now||sie)()}function sie(){return new Date().getTime()}function aie(t){return function(n){return Jt(n)&&$o("strTrim called ["+Ot(n)+"]"),n&&n.replace&&(n=n.replace(t,Jw)),n}}var cie=aie(/^\s+|(?=\s)\s+$/g),Qr=Ap("trim",bl,cie),hS,fS,pS;function si(t){if(!t||typeof t!==_p)return!1;pS||(pS=Joe()?Ua():!0);var e=!1;if(t!==pS){fS||(hS=Function[bs][pb],fS=hS[lr](Vo));try{var n=J1(t);e=!n,e||(Fo(n,vv)&&(n=n[vv]),e=!!(n&&typeof n===fb&&hS[lr](n)===fS))}catch{}}return e}function lie(t){return t.value&&n6(t),!0}var xR=[fie,n6,mie,pie];function uie(t,e,n,r){var o;return Xe(t,function(i){if(i.k===e)return o=i,-1}),o||(o={k:e,v:e},t.push(o),r(o)),o.v}function a_(t,e,n,r){var o=n.handler,i=n.path?r?n.path.concat(r):n.path:[],s={handler:n.handler,src:n.src,path:i},a=typeof e,l=!1,u=e===zn;u||(e&&a===_p?l=si(e):u=Poe(a));var h={type:a,isPrim:u,isPlain:l,value:e,result:e,path:i,origin:n.src,copy:function(f,p){return a_(t,f,p?s:n,p)},copyTo:function(f,p){return t6(t,f,p,s)}};return h.isPrim?o&&o[lr](n,h)?h.result:e:uie(t,e,i,function(f){vn(h,"result",{g:function(){return f.v},s:function(v){f.v=v}});for(var p=0,g=o;!(g||(p<xR.length?xR[p++]:lie))[lr](n,h);)g=zn})}function t6(t,e,n,r){if(!Jt(n))for(var o in n)e[o]=a_(t,n[o],r,o);return e}function die(t,e,n){var r={handler:n,src:e,path:[]};return t6([],t,e,r)}function hie(t,e){var n={handler:e,src:t};return a_([],t,n)}function fie(t){var e=t.value;if(kt(e)){var n=t.result=[];return n.length=e.length,t.copyTo(n,e),!0}return!1}function pie(t){var e=t.value;return Moe(e)?(t.result=new Date(e.getTime()),!0):!1}function mie(t){return t.type===fb}function n6(t){var e=t.value;if(e&&t.isPlain){var n=t.result={};return t.copyTo(n,e),!0}return!1}function gie(t,e){return Xe(e,function(n){die(t,n)}),t}function RR(t,e,n,r,o,i,s){return gie(hie(t)||{},_s[lr](arguments))}var vie=$oe(Tc),mS;function yie(){return!On&&ja(),(!mS||On.lzy)&&(mS=Go(ur(Ln,["performance"]).v)),mS.v}function bie(){var t=yie();return t&&t.now?t.now():_a()}var Cie=Ap("endsWith",bl,Sie);function Sie(t,e,n){yr(t)||$o("'"+Ot(t)+"' is not a string");var r=yr(e)?e:ii(e),o=!Qt(n)&&n<t[Tc]?n:t[Tc];return ji(t,o-r[Tc],o)===r}var Cb=gb("indexOf",bl),NR=Ap("startsWith",bl,Iie);function Iie(t,e,n){yr(t)||$o("'"+Ot(t)+"' is not a string");var r=yr(e)?e:ii(e),o=n>0?n:0;return ji(t,o,o+r[Tc])===r}var gS="ref",vS="unref",yS="hasRef",Eie="enabled";function Tie(t,e,n){var r=!0,o=t?e(zn):zn,i;function s(){return r=!1,o&&o[vS]&&o[vS](),i}function a(){o&&n(o),o=zn}function l(){return o=e(o),r||s(),i}function u(h){!h&&o&&a(),h&&!o&&l()}return i={cancel:a,refresh:l},i[yS]=function(){return o&&o[yS]?o[yS]():r},i[gS]=function(){return r=!0,o&&o[gS]&&o[gS](),i},i[vS]=s,i=As(i,Eie,{get:function(){return!!o},set:u}),{h:i,dn:function(){o=zn}}}function c_(t,e,n){var r=kt(e),o=r?e.length:0,i=(o>0?e[0]:r?po:e)||setTimeout,s=(o>1?e[1]:po)||clearTimeout,a=n[0];n[0]=function(){l.dn(),Tu(a,po,_s[lr](arguments))};var l=Tie(t,function(u){if(u){if(u.refresh)return u.refresh(),u;Tu(s,po,[u])}return Tu(i,po,n)},function(u){Tu(s,po,[u])});return l.h}function Wc(t,e){return c_(!0,po,_s[lr](arguments))}function wie(t,e,n){return c_(!0,t,_s[lr](arguments,1))}function _ie(t,e){return c_(!1,po,_s[lr](arguments))}(Vd()||{}).Symbol;(Vd()||{}).Reflect;var Aie="hasOwnProperty",Z1=function(t,e){return Z1=Qw.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r[Aie](o)&&(n[o]=r[o])},Z1(t,e)};function kp(t,e){typeof e!==Toe&&e!==null&&$o("Class extends value "+String(e)+" is not a constructor or null"),Z1(t,e);function n(){this.constructor=t}t[ff]=e===null?wa(e):(n[ff]=e[ff],new n)}function PR(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t}var Im,Cv="constructor",xs="prototype",Sv="function",Iv="_dynInstFuncs",eI="_isDynProxy",Uu="_dynClass",kie="_dynCls$",tI="_dynInstChk",qf=tI,r6="_dfOpts",MR="_unknown_",l_="__proto__",Em="_dyn"+l_,OR="__dynProto$Gbl",bS="_dynInstProto",rg="useBaseInst",nI="setInstFuncs",u_=Object,Wf=u_.getPrototypeOf,LR=u_.getOwnPropertyNames,DR=Vd(),rI=DR[OR]||(DR[OR]={o:(Im={},Im[nI]=!0,Im[rg]=!0,Im),n:1e3});function og(t){return t&&(t===u_[xs]||t===Array[xs])}function d_(t){return og(t)||t===Function[xs]}function Yc(t){var e;if(t){if(Wf)return Wf(t);var n=t[l_]||t[xs]||(t[Cv]?t[Cv][xs]:null);e=t[Em]||n,Fo(t,Em)||(delete t[bS],e=t[Em]=t[bS]||t[Em],t[bS]=n)}return e}function Ev(t,e){var n=[];if(LR)n=LR(t);else for(var r in t)typeof r=="string"&&Fo(t,r)&&n.push(r);if(n&&n.length>0)for(var o=0;o<n.length;o++)e(n[o])}function h_(t,e,n){return e!==Cv&&typeof t[e]===Sv&&(n||Fo(t,e))&&e!==l_&&e!==xs}function Tv(t){$o("DynamicProto: "+t)}function xie(t){var e=wa(null);return Ev(t,function(n){!e[n]&&h_(t,n,!1)&&(e[n]=t[n])}),e}function f_(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}function Rie(t,e,n,r){function o(l,u,h){var f=u[h];if(f[eI]&&r){var p=l[Iv]||{};p[qf]!==!1&&(f=(p[u[Uu]]||{})[h]||f)}return function(){return f.apply(l,arguments)}}var i=wa(null);Ev(n,function(l){i[l]=o(e,n,l)});for(var s=Yc(t),a=[];s&&!d_(s)&&!f_(a,s);)Ev(s,function(l){!i[l]&&h_(s,l,!Wf)&&(i[l]=o(e,s,l))}),a.push(s),s=Yc(s);return i}function Nie(t,e,n,r){var o=null;if(t&&Fo(n,Uu)){var i=t[Iv]||wa(null);if(o=(i[n[Uu]]||wa(null))[e],o||Tv("Missing ["+e+"] "+Sv),!o[tI]&&i[qf]!==!1){for(var s=!Fo(t,e),a=Yc(t),l=[];s&&a&&!d_(a)&&!f_(l,a);){var u=a[e];if(u){s=u===r;break}l.push(a),a=Yc(a)}try{s&&(t[e]=o),o[tI]=1}catch{i[qf]=!1}}}return o}function Pie(t,e,n){var r=e[t];return r===n&&(r=Yc(e)[t]),typeof r!==Sv&&Tv("["+t+"] is not a "+Sv),r}function Mie(t,e,n,r,o){function i(l,u){var h=function(){var f=Nie(this,u,l,h)||Pie(u,l,h);return f.apply(this,arguments)};return h[eI]=1,h}if(!og(t)){var s=n[Iv]=n[Iv]||wa(null);if(!og(s)){var a=s[e]=s[e]||wa(null);s[qf]!==!1&&(s[qf]=!!o),og(a)||Ev(n,function(l){h_(n,l,!1)&&n[l]!==r[l]&&(a[l]=n[l],delete n[l],(!Fo(t,l)||t[l]&&!t[l][eI])&&(t[l]=i(t,l)))})}}}function Oie(t,e){if(Wf){for(var n=[],r=Yc(e);r&&!d_(r)&&!f_(n,r);){if(r===t)return!0;n.push(r),r=Yc(r)}return!1}return!0}function CS(t,e){return Fo(t,xs)?t.name||e||MR:((t||{})[Cv]||{}).name||e||MR}function fn(t,e,n,r){Fo(t,xs)||Tv("theClass is an invalid class definition.");var o=t[xs];Oie(o,e)||Tv("["+CS(t)+"] not in hierarchy of ["+CS(e)+"]");var i=null;Fo(o,Uu)?i=o[Uu]:(i=kie+CS(t,"_")+"$"+rI.n,rI.n++,o[Uu]=i);var s=fn[r6],a=!!s[rg];a&&r&&r[rg]!==void 0&&(a=!!r[rg]);var l=xie(e),u=Rie(o,e,l,a);n(e,u);var h=!!Wf&&!!s[nI];h&&r&&(h=!!r[nI]),Mie(o,i,e,l,h!==!1)}fn[r6]=rI.o;var o6=Boe,to=Voe,Ka=o6({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),Kl=o6({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),p_="toLowerCase",wv="blkVal",gt="length",_v="rdOnly",Av="notify",kv="warnToConsole",xp="throwInternal",$d="setDf",va="watch",kn="logger",Sb="apply",zt="push",Rp="splice",i6="hdlr",wu="cancel",Np="initialize",ra="identifier",xv="removeNotificationListener",Rv="addNotificationListener",$i="isInitialized",jR="instrumentationKey",SS="INACTIVE",mf="value",Tm="getNotifyMgr",Yf="getPlugin",wc="name",wh="iKey",Fu="time",Pr="processNext",s6="getProcessTelContext",UR="pollInternalLogs",_u="enabled",FR="stopPollingInternalLogs",Aa="unload",wm="onComplete",BR="version",a6="loggingLevelConsole",Qc="createNew",fs="teardown",Nv="messageId",_c="message",yd="isAsync",Ss="diagLog",Pv="_doTeardown",Qf="update",Ki="getNext",Jf="setNextPlugin",c6="protocol",oI="userAgent",Ib="split",IS="nodeType",Ac="replace",Lie="logInternalMessage",Is="type",m_="handler",qh="status",HR="getResponseHeader",zR="getAllResponseHeaders",iI="isChildEvt",fu="data",Bu="getCtx",_i="setCtx",sI="complete",_h="urlString",VR="sendPOST",ES="headers",ql="timeout",$R="setRequestHeader",GR="traceId",KR="spanId",qR="traceFlags",TS;function Die(t,e){TS||(TS=iie("AggregationError",function(r,o){o[gt]>1&&(r.errors=o[1])}));var n=t;throw Xe(e,function(r,o){n+=`
`.concat(o," > ").concat(Ot(r))}),new TS(n,e||[])}/*!
 * NevWare21 Solutions LLC - ts-async, 0.5.2
 * https://github.com/nevware21/ts-async
 * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.
 * Licensed under the MIT license.
 */var Mv="Promise",g_="rejected";function bd(t,e){return l6(t,function(n){return e?e({status:"fulfilled",rejected:!1,value:n}):n},function(n){return e?e({status:g_,rejected:!0,reason:n}):n})}function l6(t,e,n,r){var o=t;try{if(gd(t))(e||n)&&(o=t.then(e,n));else try{e&&(o=e(t))}catch(i){if(n)o=n(i);else throw i}}finally{}return o}var u6=["pending","resolving","resolved",g_],WR="dispatchEvent",_m;function jie(t){var e;return t&&t.createEvent&&(e=t.createEvent("Event")),!!e&&e.initEvent}function Uie(t,e,n,r){var o=ks();!_m&&(_m=Go(!!ur(jie,[o]).v));var i=_m.v?o.createEvent("Event"):r?new Event(e):{};if(n&&n(i),_m.v&&i.initEvent(e,!1,!0),i&&t[WR])t[WR](i);else{var s=t["on"+e];if(s)s(i);else{var a=Ln("console");a&&(a.error||a.log)(e,Ot(i))}}}var d6="unhandledRejection",Fie=d6.toLowerCase(),YR=[],Bie=0,Hie=10,wS;function QR(t){return tn(t)?t.toString():Ot(t)}function h6(t,e,n){var r=bb(arguments,3),o=0,i=!1,s,a=[],l=Bie++,u=!1,h=null,f;function p(E,T){try{YR.push(l),u=!0,h&&h.cancel(),h=null;var w=t(function(A,_){a.push(function(){try{var L=o===2?E:T,N=Qt(L)?s:tn(L)?L(s):L;gd(N)?N.then(A,_):L?A(N):o===3?_(N):A(N)}catch(K){_(K)}}),i&&b()},r);return w}finally{YR.pop()}}function g(E){return p(void 0,E)}function v(E){var T=E,w=E;return tn(E)&&(T=function(A){return E&&E(),A},w=function(A){throw E&&E(),A}),p(T,w)}function y(){return u6[o]}function b(){if(a.length>0){var E=a.slice();a=[],u=!0,h&&h.cancel(),h=null,e(E)}}function C(E,T){return function(w){if(o===T){if(E===2&&gd(w)){o=1,w.then(C(2,1),C(3,1));return}o=E,i=!0,s=w,b(),!u&&E===3&&!h&&(h=Wc(S,Hie))}}}function S(){if(!u)if(u=!0,Zoe())process.emit(d6,s,f);else{var E=Ua()||Vd();!wS&&(wS=Go(ur(Ln,[Mv+"RejectionEvent"]).v)),Uie(E,Fie,function(T){return vn(T,"promise",{g:function(){return f}}),T.reason=s,T},!!wS.v)}}f={then:p,catch:g,finally:v},As(f,"state",{get:y}),tie()&&(f[o_(11)]="IPromise");function I(){return"IPromise "+y()+(i?" - "+QR(s):"")}return f.toString=I,function(){tn(n)||$o(Mv+": executor is not a function - "+QR(n));var T=C(3,0);try{n.call(f,C(2,0),T)}catch(w){T(w)}}(),f}function zie(t){return function(e){var n=bb(arguments,1);return t(function(r,o){try{var i=[],s=1;s_(e,function(a,l){a&&(s++,l6(a,function(u){i[l]=u,--s===0&&r(i)},o))}),s--,s===0&&r(i)}catch(a){o(a)}},n)}}function Vie(t){return Go(function(e){var n=bb(arguments,1);return t(function(r,o){var i=[],s=1;function a(l,u){s++,bd(l,function(h){h.rejected?i[u]={status:g_,reason:h.reason}:i[u]={status:"fulfilled",value:h.value},--s===0&&r(i)})}try{kt(e)?Xe(e,a):Z4(e)?s_(e,a):$o("Input is not an iterable"),s--,s===0&&r(i)}catch(l){o(l)}},n)})}function f6(t){Xe(t,function(e){try{e()}catch{}})}function $ie(t){var e=Ta(t)?t:0;return function(n){Wc(function(){f6(n)},e)}}function p6(t,e){return h6(p6,$ie(e),t,e)}var _S;function Gie(t,e){!_S&&(_S=Go(ur(Ln,[Mv]).v||null));var n=_S.v;if(!n)return p6(t);tn(t)||$o(Mv+": executor is not a function - "+Ot(t));var r=0;function o(){return u6[r]}var i=new n(function(s,a){function l(h){r=2,s(h)}function u(h){r=3,a(h)}t(l,u)});return As(i,"state",{get:o}),i}var AS;function m6(t){return h6(m6,f6,t)}function Kie(t,e){return!AS&&(AS=Vie(m6)),AS.v(t,e)}var kS;function Jc(t,e){return!kS&&(kS=Go(Gie)),kS.v.call(this,t,e)}var qie=zie(Jc),Oi=void 0,Mt="",cc="channels",Bn="core",aI="createPerfMgr",cI="disabled",Hu="extensionConfig",pu="extensions",Ji="processTelemetry",Ov="priority",ig="eventsSent",gf="eventsDiscarded",sg="eventsSendRequest",yc="perfEvent",xS="offlineEventsStored",RS="offlineBatchSent",NS="offlineBatchDrop",Lv="getPerfMgr",lI="domain",PS="path",Wie="Not dynamic - ",Yie=/-([a-z])/g,Qie=/([^\w\d_$])/g,Jie=/^(\d+[\w\d_$])/;function Dv(t){return!Jt(t)}function uI(t){var e=t;return e&&yr(e)&&(e=e[Ac](Yie,function(n,r){return r.toUpperCase()}),e=e[Ac](Qie,"_"),e=e[Ac](Jie,function(n,r){return"_"+r})),e}function Gr(t,e){return t&&e?Cb(t,e)!==-1:!1}function dI(t){return t&&t.toISOString()||""}function g6(t){return Ooe(t)?t[wc]:Mt}function Wl(t,e,n,r,o){var i=n;return t&&(i=t[e],i!==n&&(!o||o(i))&&(!r||r(n))&&(i=n,t[e]=i)),i}function Xie(t,e,n){var r;return t?(r=t[e],!r&&Jt(r)&&(r=Qt(n)?{}:n,t[e]=r)):r=Qt(n)?{}:n,r}function Zie(t,e){var n=null,r=null;return tn(t)?n=t:r=t,function(){var o=arguments;if(n&&(r=n()),r)return r[e][Sb](r,o)}}function jv(t,e,n,r,o){t&&e&&n&&(t[e]=Zie(n,r))}function v6(t,e,n,r){return t&&e&&md(t)&&kt(n)&&Xe(n,function(o){yr(o)&&jv(t,o,e,o)}),t}function mu(t){return t&&TR&&(t=Qw(TR({},t))),t}function Cd(t){try{return t.responseText}catch{}return null}function ese(t,e){return t?"XDomainRequest,Response:"+Cd(t)||"":e}function JR(t,e){return t?"XMLHttpRequest,Status:"+t[qh]+",Response:"+Cd(t)||t.response||"":e}function XR(t,e){return e&&(Ta(e)?t=[e].concat(t):kt(e)&&(t=e.concat(t))),t}var tse="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ZR="withCredentials",nse="timeout";function rse(t,e,n,r,o,i){o===void 0&&(o=!1);function s(l,u,h){try{l[u]=h}catch{}}var a=new XMLHttpRequest;return s(a,tse,r),n&&s(a,ZR,n),a.open(t,e,!o),n&&s(a,ZR,n),!o&&i&&s(a,nse,i),a}function ose(t){var e={};if(yr(t)){var n=Qr(t)[Ib](/[\r\n]+/);Xe(n,function(r){if(r){var o=r.indexOf(": ");if(o!==-1){var i=Qr(r.substring(0,o))[p_](),s=Qr(r.substring(o+1));e[i]=s}else e[Qr(r)]=1}})}return e}function MS(t,e,n){if(!t[n]&&e&&e[HR]){var r=e[HR](n);r&&(t[n]=Qr(r))}return t}var ise="kill-duration",sse="kill-duration-seconds",ase="time-delta-millis";function ag(t,e){var n={};return t[zR]?n=ose(t[zR]()):e&&(n=MS(n,t,ase),n=MS(n,t,ise),n=MS(n,t,sse)),n}var cse="location",lse="console",y6="JSON",use="crypto",dse="msCrypto",hse="ReactNative",fse="msie",pse="trident/",b6="XMLHttpRequest",OS=null,LS=null,Yl=null,DS=null;function C6(t,e){var n=!1;if(t){try{if(n=e in t,!n){var r=t[ff];r&&(n=e in r)}}catch{}if(!n)try{var o=new t;n=!Qt(o[e])}catch{}}return n}function Eb(t){return typeof location===Ww&&location?location:Ln(cse)}function mse(){return typeof console!==Yw?console:Ln(lse)}function S6(){return!!(typeof JSON===Ww&&JSON||Ln(y6)!==null)}function gse(){return S6()?JSON||Ln(y6):null}function vse(){return Ln(use)}function yse(){return Ln(dse)}function hI(){var t=es();return t&&t.product?t.product===hse:!1}function fI(){var t=es();if(t&&(t[oI]!==LS||OS===null)){LS=t[oI];var e=(LS||Mt)[p_]();OS=Gr(e,fse)||Gr(e,pse)}return OS}function I6(t){return(DS===null||t===!1)&&(DS=Xoe()&&!!es().sendBeacon),DS}function E6(t){var e=!1;try{e=!!Ln("fetch");var n=Ln("Request");e&&t&&n&&(e=C6(n,"keepalive"))}catch{}return e}function bse(){return Yl===null&&(Yl=typeof XDomainRequest!==Yw,Yl&&T6()&&(Yl=Yl&&!C6(Ln(b6),"withCredentials"))),Yl}function T6(){var t=!1;try{var e=Ln(b6);t=!!e}catch{}return t}var w6=4294967296,kc=4294967295,_6=123456789,A6=987654321,k6=!1,Wh=_6,Yh=A6;function Cse(t){t<0&&(t>>>=0),Wh=_6+t&kc,Yh=A6-t&kc,k6=!0}function Sse(){try{var t=_a()&2147483647;Cse((Math.random()*w6^t)+t)}catch{}}function Xf(t){var e=0,n=vse()||yse();return n&&n.getRandomValues&&(e=n.getRandomValues(new Uint32Array(1))[0]&kc),e===0&&fI()&&(k6||Sse(),e=Ise()&kc),e===0&&(e=Math.floor(w6*Math.random()|0)),t||(e>>>=0),e}function Ise(t){Yh=36969*(Yh&65535)+(Yh>>16)&kc,Wh=18e3*(Wh&65535)+(Wh>>16)&kc;var e=(Yh<<16)+(Wh&65535)>>>0&kc|0;return e>>>=0,e}function v_(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=Xf()>>>0,r=0,o=Mt;o[gt]<t;)r++,o+=e.charAt(n&63),n>>>=6,r===5&&(n=(Xf()<<2&4294967295|n&3)>>>0,r=0);return o}var x6="3.3.3",Ese="."+v_(6),Tse=0;function R6(t){return t[IS]===1||t[IS]===9||!+t[IS]}function wse(t,e){var n=e[t.id];if(!n){n={};try{R6(e)&&vn(e,t.id,{e:!1,v:n})}catch{}}return n}function Gd(t,e){return e===void 0&&(e=!1),uI(t+Tse+++(e?"."+x6:Mt)+Ese)}function N6(t){var e={id:Gd("_aiData-"+(t||Mt)+"."+x6),accept:function(n){return R6(n)},get:function(n,r,o,i){var s=n[e.id];return s?s[uI(r)]:(i&&(s=wse(e,n),s[uI(r)]=o),o)},kill:function(n,r){if(n&&n[r])try{delete n[r]}catch{}}};return e}function cg(t){return t&&md(t)&&(t.isVal||t.fb||ju(t,"v")||ju(t,"mrg")||ju(t,"ref")||t.set)}function P6(t,e,n){var r,o=n.dfVal||e_;if(e&&n.fb){var i=n.fb;kt(i)||(i=[i]);for(var s=0;s<i[gt];s++){var a=i[s],l=e[a];if(o(l)?r=l:t&&(l=t.cfg[a],o(l)&&(r=l),t.set(t.cfg,ii(a),l)),o(r))break}}return!o(r)&&o(n.v)&&(r=n.v),r}function pI(t,e,n){var r=n;if(n&&cg(n)&&(r=P6(t,e,n)),r){cg(r)&&(r=pI(t,e,r));var o;kt(r)?(o=[],o[gt]=r[gt]):si(r)&&(o={}),o&&(nn(r,function(i,s){s&&cg(s)&&(s=pI(t,e,s)),o[i]=s}),r=o)}return r}function y_(t,e,n,r){var o,i,s,a=r,l,u,h,f;cg(a)?(o=a.isVal,i=a.set,h=a[_v],f=a[wv],l=a.mrg,u=a.ref,!u&&Qt(u)&&(u=!!l),s=P6(t,e,a)):s=r,f&&t[wv](e,n);var p,g=!0,v=e[n];(v||!Jt(v))&&(p=v,g=!1,o&&p!==s&&!o(p)&&(p=s,g=!0),i&&(p=i(p,s,e),g=p===s)),g?s?p=pI(t,e,s):p=s:(si(p)||kt(s))&&l&&s&&(si(s)||kt(s))&&nn(s,function(y,b){y_(t,p,y,b)}),t.set(e,n,p),u&&t.ref(e,n),h&&t[_v](e,n)}var ka=i_("[[ai_dynCfg_1]]"),M6=i_("[[ai_blkDynCfg_1]]"),_se=i_("[[ai_frcDynCfg_1]]");function O6(t){if(t){var e;if(kt(t)?(e=[],e[gt]=t[gt]):si(t)&&(e={}),e)return nn(t,function(n,r){e[n]=O6(r)}),e}return t}function Ase(t){if(t){var e=t[ka]||t;if(e.cfg&&(e.cfg===t||e.cfg[ka]===e))return e}return null}function kse(t){if(t&&(si(t)||kt(t)))try{t[M6]=!0}catch{}return t}function jS(t,e,n){var r=!1;return n&&!t[e.blkVal]&&(r=n[_se],!r&&!n[M6]&&(r=si(n)||kt(n))),r}function L6(t){$o("InvalidAccess:"+t)}var xse=["push","pop","shift","unshift","splice"],Zf=function(t,e,n,r){t&&t[xp](3,108,"".concat(n," [").concat(e,"] failed - ")+Ot(r))};function Rse(t,e,n){kt(e)&&Xe(xse,function(r){var o=e[r];e[r]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=o[Sb](this,i);return Fv(t,e,n,"Patching"),a}})}function Uv(t,e){var n=t_(t,e);return n&&n.get}function Nse(t,e,n,r){var o={n,h:[],trk:function(u){u&&u.fn&&(Bo(o.h,u)===-1&&o.h[zt](u),t.trk(u,o))},clr:function(u){var h=Bo(o.h,u);h!==-1&&o.h[Rp](h,1)}},i=!0,s=!1;function a(){i&&(s=s||jS(a,t,r),r&&!r[ka]&&s&&(r=Fv(t,r,n,"Converting")),i=!1);var u=t.act;return u&&o.trk(u),r}a[t.prop]={chng:function(){t.add(o)}};function l(u){if(r!==u){a[t.ro]&&!t.upd&&L6("["+n+"] is read-only:"+Ot(e)),i&&(s=s||jS(a,t,r),i=!1);var h=s&&a[t.rf];if(s)if(h){nn(r,function(p){r[p]=u?u[p]:Oi});try{nn(u,function(p,g){Tb(t,r,p,g)}),u=r}catch(p){Zf((t.hdlr||{})[kn],n,"Assigning",p),s=!1}}else r&&r[ka]&&nn(r,function(p){var g=Uv(r,p);if(g){var v=g[t.prop];v&&v.chng()}});if(u!==r){var f=u&&jS(a,t,u);!h&&f&&(u=Fv(t,u,n,"Converting")),r=u,s=f}t.add(o)}}vn(e,o.n,{g:a,s:l})}function Tb(t,e,n,r){if(e){var o=Uv(e,n),i=o&&!!o[t.prop];i?e[n]=r:Nse(t,e,n,r)}return e}function US(t,e,n,r){if(e){var o=Uv(e,n),i=o&&!!o[t.prop],s=r&&r[0],a=r&&r[1],l=r&&r[2];if(!i){if(l)try{kse(e)}catch(u){Zf((t.hdlr||{})[kn],n,"Blocking",u)}try{Tb(t,e,n,e[n]),o=Uv(e,n)}catch(u){Zf((t.hdlr||{})[kn],n,"State",u)}}s&&(o[t.rf]=s),a&&(o[t.ro]=a),l&&(o[t.blkVal]=!0)}return e}function Fv(t,e,n,r){try{nn(e,function(o,i){Tb(t,e,o,i)}),e[ka]||(As(e,ka,{get:function(){return t[i6]}}),Rse(t,e,n))}catch(o){Zf((t.hdlr||{})[kn],n,r,o)}return e}var Ah="[[ai_",kh="]]";function Pse(t){var e,n=Th(Ah+"get"+t.uid+kh),r=Th(Ah+"ro"+t.uid+kh),o=Th(Ah+"rf"+t.uid+kh),i=Th(Ah+"blkVal"+t.uid+kh),s=Th(Ah+"dtl"+t.uid+kh),a=null,l=null,u;function h(v,y){var b=u.act;try{u.act=v,v&&v[s]&&(Xe(v[s],function(S){S.clr(v)}),v[s]=[]),y({cfg:t.cfg,set:t.set.bind(t),setDf:t[$d].bind(t),ref:t.ref.bind(t),rdOnly:t[_v].bind(t)})}catch(S){var C=t[kn];throw C&&C[xp](1,107,Ot(S)),S}finally{u.act=b||null}}function f(){if(a){var v=a;a=null,l&&l[wu](),l=null;var y=[];if(Xe(v,function(b){if(b&&(b[s]&&(Xe(b[s],function(C){C.clr(b)}),b[s]=null),b.fn))try{h(b,b.fn)}catch(C){y[zt](C)}}),a)try{f()}catch(b){y[zt](b)}y[gt]>0&&Die("Watcher error(s): ",y)}}function p(v){if(v&&v.h[gt]>0){a||(a=[]),l||(l=Wc(function(){l=null,f()},0));for(var y=0;y<v.h[gt];y++){var b=v.h[y];b&&Bo(a,b)===-1&&a[zt](b)}}}function g(v,y){if(v){var b=v[s]=v[s]||[];Bo(b,y)===-1&&b[zt](y)}}return u=(e={prop:n,ro:r,rf:o},e[wv]=i,e[i6]=t,e.add=p,e[Av]=f,e.use=h,e.trk=g,e),u}function Mse(t,e){var n={fn:e,rm:function(){n.fn=null,t=null,e=null}};return vn(n,"toJSON",{v:function(){return"WatcherHandler"+(n.fn?"":"[X]")}}),t.use(n,e),n}function Ose(t,e,n){var r,o=Ase(e);if(o)return o;var i=Gd("dyncfg",!0),s=e&&n!==!1?e:O6(e),a;function l(){a[Av]()}function u(C,S,I){try{C=Tb(a,C,S,I)}catch(E){Zf(t,S,"Setting value",E)}return C[S]}function h(C){return Mse(a,C)}function f(C,S){a.use(null,function(I){var E=a.upd;try{Qt(S)||(a.upd=S),C(I)}finally{a.upd=E}})}function p(C,S){var I;return US(a,C,S,(I={},I[0]=!0,I))[S]}function g(C,S){var I;return US(a,C,S,(I={},I[1]=!0,I))[S]}function v(C,S){var I;return US(a,C,S,(I={},I[2]=!0,I))[S]}function y(C,S){return S&&nn(S,function(I,E){y_(b,C,I,E)}),C}var b=(r={uid:null,cfg:s},r[kn]=t,r[Av]=l,r.set=u,r[$d]=y,r[va]=h,r.ref=p,r[_v]=g,r[wv]=v,r._block=f,r);return vn(b,"uid",{c:!1,e:!1,w:!1,v:i}),a=Pse(b),Fv(a,s,"config","Creating"),b}function Lse(t,e){t?(t[kv](e),t[xp](2,108,e)):L6(e)}function yo(t,e,n,r){var o=Ose(n,t||{},r);return e&&o[$d](o.cfg,e),o}function Ir(t,e,n){var r=t[ka]||t;return r.cfg&&(r.cfg===t||r.cfg[ka]===r)?r[va](e):(Lse(n,Wie+Ot(t)),yo(t,null,n)[va](e))}function Qh(t,e){if(t&&t[Aa])return t[Aa](e)}function D6(t,e,n){var r;return n||(r=Jc(function(o){n=o})),t&&vie(t)>0?bd(Qh(t[0],e),function(){D6(bb(t,1),e,n)}):n(),r}var Dse=500,e2="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function mI(t){return{mrg:!0,v:t}}function qa(t){return{isVal:yr,v:ii(Mt)}}var FS=[ig,gf,sg,yc],Bv=null,Am;function jse(t,e){return function(){var n=arguments,r=j6(e);if(r){var o=r.listener;o&&o[t]&&o[t][Sb](o,n)}}}function Use(){var t=Ln("Microsoft");return t&&(Bv=t.ApplicationInsights),Bv}function j6(t){var e=Bv;return!e&&t.disableDbgExt!==!0&&(e=Bv||Use()),e?e.ChromeDbgExt:null}function Fse(t){if(!Am){Am={};for(var e=0;e<FS[gt];e++)Am[FS[e]]=jse(FS[e],t)}return Am}var Ql,U6="warnToConsole",Bse="AI (Internal): ",Hse="AI: ",zse="AITR_",Vse={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},$se=(Ql={},Ql[0]=null,Ql[1]="errorToConsole",Ql[2]=U6,Ql[3]="debugToConsole",Ql);function t2(t){return t?'"'+t[Ac](/\"/g,Mt)+'"':Mt}function BS(t,e){var n=mse();if(n){var r="log";n[t]&&(r=t),tn(n[r])&&n[r](e)}}var gI=function(){function t(e,n,r,o){r===void 0&&(r=!1);var i=this;i[Nv]=e,i[_c]=(r?Hse:Bse)+e;var s=Mt;S6()&&(s=gse().stringify(o));var a=(n?" message:"+t2(n):Mt)+(o?" props:"+t2(s):Mt);i[_c]+=a}return t.dataType="MessageData",t}();function b_(t,e){return(t||{})[kn]||new Hv(e)}var Hv=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={},o,i,s,a,l;fn(t,this,function(u){l=f(e||{}),u.consoleLoggingLevel=function(){return o},u[xp]=function(v,y,b,C,S){S===void 0&&(S=!1);var I=new gI(y,b,S,C);if(a)throw Ot(I);var E=$se[v]||U6;if(Qt(I[_c]))g("throw"+(v===1?"Critical":"Warning"),I);else{if(S){var T=+I[Nv];!r[T]&&o>=v&&(u[E](I[_c]),r[T]=!0)}else o>=v&&u[E](I[_c]);h(v,I)}},u.debugToConsole=function(v){BS("debug",v),g("warning",v)},u[kv]=function(v){BS("warn",v),g("warning",v)},u.errorToConsole=function(v){BS("error",v),g("error",v)},u.resetInternalMessageCount=function(){n=0,r={}},u[Lie]=h,u[Aa]=function(v){l&&l.rm(),l=null};function h(v,y){if(!p()){var b=!0,C=zse+y[Nv];if(r[C]?b=!1:r[C]=!0,b&&(v<=i&&(u.queue[zt](y),n++,g(v===1?"error":"warn",y)),n===s)){var S="Internal events throttle limit per PageView reached for this app.",I=new gI(23,S,!1);u.queue[zt](I),v===1?u.errorToConsole(S):u[kv](S)}}}function f(v){return Ir(yo(v,Vse,u).cfg,function(y){var b=y.cfg;o=b[a6],i=b.loggingLevelTelemetry,s=b.maxMessageLimit,a=b.enableDebug})}function p(){return n>=s}function g(v,y){var b=j6(e||{});b&&b[Ss]&&b[Ss](v,y)}})}return t.__ieDyn=1,t}();function F6(t){return t||new Hv}function en(t,e,n,r,o,i){i===void 0&&(i=!1),F6(t)[xp](e,n,r,o,i)}function vf(t,e){F6(t)[kv](e)}var HS,Wa,n2="toGMTString",r2="toUTCString",C_="cookie",zS="expires",o2="isCookieUseDisabled",vI="disableCookiesUsage",Au="_ckMgr",km=null,VS=null,i2=null,qi,s2={},zv={},Gse=(HS={cookieCfg:mI((Wa={},Wa[lI]={fb:"cookieDomain",dfVal:Dv},Wa.path={fb:"cookiePath",dfVal:Dv},Wa.enabled=Oi,Wa.ignoreCookies=Oi,Wa.blockedCookies=Oi,Wa)),cookieDomain:Oi,cookiePath:Oi},HS[vI]=Oi,HS);function S_(){!qi&&(qi=Qoe(function(){return ks()}))}function Kse(t,e){var n=lg[Au]||zv[Au];return n||(n=lg[Au]=lg(t,e),zv[Au]=n),n}function xm(t){return t?t.isEnabled():!0}function B6(t,e){return e&&t&&kt(t.ignoreCookies)?Bo(t.ignoreCookies,e)!==-1:!1}function qse(t,e){return e&&t&&kt(t.blockedCookies)&&Bo(t.blockedCookies,e)!==-1?!0:B6(t,e)}function a2(t,e){var n=e[_u];if(Jt(n)){var r=void 0;Qt(t[o2])||(r=!t[o2]),Qt(t[vI])||(r=!t[vI]),n=r}return n}function H6(t,e){var n;return t&&(n=t.getCookieMgr()),n||(n=Kse(e,(t||{})[kn])),n}function lg(t,e){var n,r,o,i,s,a,l,u,h;t=yo(t||zv,null,e).cfg,s=Ir(t,function(p){p[$d](p.cfg,Gse),r=p.ref(p.cfg,"cookieCfg"),o=r[PS]||"/",i=r[lI],a=a2(t,r)!==!1,l=r.getCookie||Wse,u=r.setCookie||d2,h=r.delCookie||d2},e);var f=(n={isEnabled:function(){var p=a2(t,r)!==!1&&a&&c2(e),g=zv[Au];return p&&g&&f!==g&&(p=xm(g)),p},setEnabled:function(p){a=p!==!1,r[_u]=p},set:function(p,g,v,y,b){var C=!1;if(xm(f)&&!qse(r,p)){var S={},I=Qr(g||Mt),E=Cb(I,";");if(E!==-1&&(I=Qr(n_(g,E)),S=z6(ji(g,E+1))),Wl(S,lI,y||i,ER,Qt),!Jt(v)){var T=fI();if(Qt(S[zS])){var w=_a(),A=w+v*1e3;if(A>0){var _=new Date;_.setTime(A),Wl(S,zS,l2(_,T?n2:r2)||l2(_,T?n2:r2)||Mt,ER)}}T||Wl(S,"max-age",Mt+v,null,Qt)}var L=Eb();L&&L[c6]==="https:"&&(Wl(S,"secure",null,null,Qt),VS===null&&(VS=!Yse((es()||{})[oI])),VS&&Wl(S,"SameSite","None",null,Qt)),Wl(S,PS,b||o,null,Qt),u(p,u2(I,S)),C=!0}return C},get:function(p){var g=Mt;return xm(f)&&!B6(r,p)&&(g=l(p)),g},del:function(p,g){var v=!1;return xm(f)&&(v=f.purge(p,g)),v},purge:function(p,g){var v,y=!1;if(c2(e)){var b=(v={},v[PS]=g||"/",v[zS]="Thu, 01 Jan 1970 00:00:01 GMT",v);fI()||(b["max-age"]="0"),h(p,u2(Mt,b)),y=!0}return y}},n[Aa]=function(p){s&&s.rm(),s=null},n);return f[Au]=f,f}function c2(t){if(km===null){km=!1,!qi&&S_();try{var e=qi.v||{};km=e[C_]!==void 0}catch(n){en(t,2,68,"Cannot access document.cookie - "+g6(n),{exception:Ot(n)})}}return km}function z6(t){var e={};if(t&&t[gt]){var n=Qr(t)[Ib](";");Xe(n,function(r){if(r=Qr(r||Mt),r){var o=Cb(r,"=");o===-1?e[r]=null:e[Qr(n_(r,o))]=Qr(ji(r,o+1))}})}return e}function l2(t,e){return tn(t[e])?t[e]():null}function u2(t,e){var n=t||Mt;return nn(e,function(r,o){n+="; "+r+(Jt(o)?Mt:"="+o)}),n}function Wse(t){var e=Mt;if(!qi&&S_(),qi.v){var n=qi.v[C_]||Mt;i2!==n&&(s2=z6(n),i2=n),e=Qr(s2[t]||Mt)}return e}function d2(t,e){!qi&&S_(),qi.v&&(qi.v[C_]=t+"="+e)}function Yse(t){return yr(t)?!!(Gr(t,"CPU iPhone OS 12")||Gr(t,"iPad; CPU OS 12")||Gr(t,"Macintosh; Intel Mac OS X 10_14")&&Gr(t,"Version/")&&Gr(t,"Safari")||Gr(t,"Macintosh; Intel Mac OS X 10_14")&&Cie(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Gr(t,"Chrome/5")||Gr(t,"Chrome/6")||Gr(t,"UnrealEngine")&&!Gr(t,"Chrome")||Gr(t,"UCBrowser/12")||Gr(t,"UCBrowser/11")):!1}var Qse={perfEvtsSendAll:!1};function Jse(t){t.h=null;var e=t.cb;t.cb=[],Xe(e,function(n){ur(n.fn,[n.arg])})}function Ks(t,e,n,r){Xe(t,function(o){o&&o[e]&&(n?(n.cb[zt]({fn:r,arg:o}),n.h=n.h||Wc(Jse,0,n)):ur(r,[o]))})}var Xse=function(){function t(e){this.listeners=[];var n,r,o=[],i={h:null,cb:[]},s=yo(e,Qse);r=s[va](function(a){n=!!a.cfg.perfEvtsSendAll}),fn(t,this,function(a){vn(a,"listeners",{g:function(){return o}}),a[Rv]=function(l){o[zt](l)},a[xv]=function(l){for(var u=Bo(o,l);u>-1;)o[Rp](u,1),u=Bo(o,l)},a[ig]=function(l){Ks(o,ig,i,function(u){u[ig](l)})},a[gf]=function(l,u){Ks(o,gf,i,function(h){h[gf](l,u)})},a[sg]=function(l,u){Ks(o,sg,u?i:null,function(h){h[sg](l,u)})},a[yc]=function(l){l&&(n||!l[iI]())&&Ks(o,yc,null,function(u){l[yd]?Wc(function(){return u[yc](l)},0):u[yc](l)})},a[xS]=function(l){l&&l[gt]&&Ks(o,xS,i,function(u){u[xS](l)})},a[RS]=function(l){l&&l[fu]&&Ks(o,RS,i,function(u){u[RS](l)})},a[NS]=function(l,u){if(l>0){var h=u||0;Ks(o,NS,i,function(f){f[NS](l,h)})}},a[Aa]=function(l){var u=function(){r&&r.rm(),r=null,o=[],i.h&&i.h[wu](),i.h=null,i.cb=[]},h;if(Ks(o,"unload",null,function(f){var p=f[Aa](l);p&&(h||(h=[]),h[zt](p))}),h)return Jc(function(f){return bd(qie(h),function(){u(),f()})});u()}})}return t.__ieDyn=1,t}(),zu="ctx",yI="ParentContextKey",yf="ChildrenContextKey",Zse=null,ug=function(){function t(e,n,r){var o=this;if(o.start=_a(),o[wc]=e,o[yd]=r,o[iI]=function(){return!1},tn(n)){var i;vn(o,"payload",{g:function(){return!i&&tn(n)&&(i=n(),n=null),i}})}o[Bu]=function(s){return s?s===t[yI]||s===t[yf]?o[s]:(o[zu]||{})[s]:null},o[_i]=function(s,a){if(s)if(s===t[yI])o[s]||(o[iI]=function(){return!0}),o[s]=a;else if(s===t[yf])o[s]=a;else{var l=o[zu]=o[zu]||{};l[s]=a}},o[sI]=function(){var s=0,a=o[Bu](t[yf]);if(kt(a))for(var l=0;l<a[gt];l++){var u=a[l];u&&(s+=u[Fu])}o[Fu]=_a()-o.start,o.exTime=o[Fu]-s,o[sI]=function(){}}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),eae=function(){function t(e){this.ctx={},fn(t,this,function(n){n.create=function(r,o,i){return new ug(r,o,i)},n.fire=function(r){r&&(r[sI](),e&&tn(e[yc])&&e[yc](r))},n[_i]=function(r,o){if(r){var i=n[zu]=n[zu]||{};i[r]=o}},n[Bu]=function(r){return(n[zu]||{})[r]}})}return t.__ieDyn=1,t}(),$S="CoreUtils.doPerf";function qr(t,e,n,r,o){if(t){var i=t;if(i[Lv]&&(i=i[Lv]()),i){var s=void 0,a=i[Bu]($S);try{if(s=i.create(e(),r,o),s){if(a&&s[_i]&&(s[_i](ug[yI],a),a[Bu]&&a[_i])){var l=a[Bu](ug[yf]);l||(l=[],a[_i](ug[yf],l)),l[zt](s)}return i[_i]($S,s),n(s)}}catch(u){s&&s[_i]&&s[_i]("exception",u)}finally{s&&i.fire(s),i[_i]($S,a)}}}return n()}function tae(){return Zse}function V6(){var t=bI();return ji(t,0,8)+"-"+ji(t,8,12)+"-"+ji(t,12,16)+"-"+ji(t,16,20)+"-"+ji(t,20)}function bI(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Mt,n,r=0;r<4;r++)n=Xf(),e+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var o=t[8+(Xf()&3)|0];return hu(e,0,8)+hu(e,9,4)+"4"+hu(e,13,3)+o+hu(e,16,3)+hu(e,19,12)}var nae="00000000000000000000000000000000",rae="0000000000000000";function $6(t,e,n){return t&&t[gt]===e&&t!==n?!!t.match(/^[\da-f]*$/i):!1}function G6(t){return $6(t,32,nae)}function K6(t){return $6(t,16,rae)}var oae=N6("plugin");function xc(t){return oae.get(t,"state",{},!0)}function h2(t,e){for(var n=[],r=null,o=t[Ki](),i;o;){var s=o[Yf]();if(s){r&&r[Jf]&&s[Ji]&&r[Jf](s),i=xc(s);var a=!!i[$i];s[$i]&&(a=s[$i]()),a||n[zt](s),r=s,o=o[Ki]()}}Xe(n,function(l){var u=t[Bn]();l[Np](t.getCfg(),u,e,t[Ki]()),i=xc(l),!l[Bn]&&!i[Bn]&&(i[Bn]=u),i[$i]=!0,delete i[fs]})}function GS(t){return t.sort(function(e,n){var r=0;if(n){var o=n[Ji];e[Ji]?r=o?e[Ov]-n[Ov]:1:o&&(r=-1)}else r=e?1:-1;return r})}function iae(t){var e={};return{getName:function(){return e[wc]},setName:function(n){e[wc]=n},getTraceId:function(){return e[GR]},setTraceId:function(n){G6(n)&&(e[GR]=n)},getSpanId:function(){return e[KR]},setSpanId:function(n){K6(n)&&(e[KR]=n)},getTraceFlags:function(){return e[qR]},setTraceFlags:function(n){e[qR]=n}}}var sae="TelemetryPluginChain",f2="_hasRun",p2="_getTelCtx",m2=0;function aae(t,e,n){for(;t;){if(t[Yf]()===n)return t;t=t[Ki]()}return Zc([n],e.config||{},e)}function I_(t,e,n,r){var o=null,i=[];e||(e=yo({},null,n[kn])),r!==null&&(o=r?aae(t,n,r):t);var s={_next:l,ctx:{core:function(){return n},diagLog:function(){return b_(n,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:h,getConfig:f,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(g){o=g},iterate:p,onComplete:a}};function a(g,v){for(var y=[],b=2;b<arguments.length;b++)y[b-2]=arguments[b];g&&i[zt]({func:g,self:Qt(v)?s.ctx:v,args:y})}function l(){var g=o;if(o=g?g[Ki]():null,!g){var v=i;v&&v[gt]>0&&(Xe(v,function(y){try{y.func.call(y.self,y.args)}catch(b){en(n[kn],2,73,"Unexpected Exception during onComplete - "+Ot(b))}}),i=[])}return g}function u(g,v){var y=null,b=e.cfg;if(b&&g){var C=b[Hu];!C&&v&&(C={}),b[Hu]=C,C=e.ref(b,Hu),C&&(y=C[g],!y&&v&&(y={}),C[g]=y,y=e.ref(C,g))}return y}function h(g,v){var y=u(g,!0);return v&&nn(v,function(b,C){if(Jt(y[b])){var S=e.cfg[b];(S||!Jt(S))&&(y[b]=S)}y_(e,y,b,C)}),e[$d](y,v)}function f(g,v,y){y===void 0&&(y=!1);var b,C=u(g,!1),S=e.cfg;return C&&(C[v]||!Jt(C[v]))?b=C[v]:(S[v]||!Jt(S[v]))&&(b=S[v]),b||!Jt(b)?b:y}function p(g){for(var v;v=s._next();){var y=v[Yf]();y&&g(y)}}return s}function Xc(t,e,n,r){var o=yo(e),i=I_(t,o,n,r),s=i.ctx;function a(u){var h=i._next();return h&&h[Ji](u,s),!h}function l(u,h){return u===void 0&&(u=null),kt(u)&&(u=Zc(u,o.cfg,n,h)),Xc(u||s[Ki](),o.cfg,n,h)}return s[Pr]=a,s[Qc]=l,s}function Vv(t,e,n){var r=yo(e.config),o=I_(t,r,e,n),i=o.ctx;function s(l){var u=o._next();return u&&u[Aa](i,l),!u}function a(l,u){return l===void 0&&(l=null),kt(l)&&(l=Zc(l,r.cfg,e,u)),Vv(l||i[Ki](),e,u)}return i[Pr]=s,i[Qc]=a,i}function E_(t,e,n){var r=yo(e.config),o=I_(t,r,e,n),i=o.ctx;function s(l){return i.iterate(function(u){tn(u[Qf])&&u[Qf](i,l)})}function a(l,u){return l===void 0&&(l=null),kt(l)&&(l=Zc(l,r.cfg,e,u)),E_(l||i[Ki](),e,u)}return i[Pr]=s,i[Qc]=a,i}function Zc(t,e,n,r){var o=null,i=!r;if(kt(t)&&t[gt]>0){var s=null;Xe(t,function(a){if(!i&&r===a&&(i=!0),i&&a&&tn(a[Ji])){var l=cae(a,e,n);o||(o=l),s&&s._setNext(l),s=l}})}return r&&!o?Zc([r],e,n):o}function cae(t,e,n){var r=null,o=tn(t[Ji]),i=tn(t[Jf]),s;t?s=t[ra]+"-"+t[Ov]+"-"+m2++:s="Unknown-0-"+m2++;var a={getPlugin:function(){return t},getNext:function(){return r},processTelemetry:h,unload:f,update:p,_id:s,_setNext:function(g){r=g}};function l(){var g;return t&&tn(t[p2])&&(g=t[p2]()),g||(g=Xc(a,e,n)),g}function u(g,v,y,b,C){var S=!1,I=t?t[ra]:sae,E=g[f2];return E||(E=g[f2]={}),g.setNext(r),t&&qr(g[Bn](),function(){return I+":"+y},function(){E[s]=!0;try{var T=r?r._id:Mt;T&&(E[T]=!1),S=v(g)}catch(A){var w=r?E[r._id]:!0;w&&(S=!0),(!r||!w)&&en(g[Ss](),1,73,"Plugin ["+I+"] failed during "+y+" - "+Ot(A)+", run flags: "+Ot(E))}},b,C),S}function h(g,v){v=v||l();function y(b){if(!t||!o)return!1;var C=xc(t);return C[fs]||C[cI]?!1:(i&&t[Jf](r),t[Ji](g,b),!0)}u(v,y,"processTelemetry",function(){return{item:g}},!g.sync)||v[Pr](g)}function f(g,v){function y(){var b=!1;if(t){var C=xc(t),S=t[Bn]||C[Bn];t&&(!S||S===g.core())&&!C[fs]&&(C[Bn]=null,C[fs]=!0,C[$i]=!1,t[fs]&&t[fs](g,v)===!0&&(b=!0))}return b}u(g,y,"unload",function(){},v[yd])||g[Pr](v)}function p(g,v){function y(){var b=!1;if(t){var C=xc(t),S=t[Bn]||C[Bn];t&&(!S||S===g.core())&&!C[fs]&&t[Qf]&&t[Qf](g,v)===!0&&(b=!0)}return b}u(g,y,"update",function(){},!1)||g[Pr](v)}return qc(a)}function q6(){var t=[];function e(r){r&&t[zt](r)}function n(r,o){Xe(t,function(i){try{i(r,o)}catch(s){en(r[Ss](),2,73,"Unexpected error calling unload handler - "+Ot(s))}}),t=[]}return{add:e,run:n}}function W6(){var t=[];function e(r){var o=t;t=[],Xe(o,function(i){try{(i.rm||i.remove).call(i)}catch(s){en(r,2,73,"Unloading:"+Ot(s))}})}function n(r){r&&la(t,r)}return{run:e,add:n}}var KS,qs="getPlugin",lae=(KS={},KS[Hu]={isVal:Dv,v:{}},KS),T_=function(){function t(){var e=this,n,r,o,i,s;u(),fn(t,e,function(h){h[Np]=function(f,p,g,v){l(f,p,v),n=!0},h[fs]=function(f,p){var g,v=h[Bn];if(!v||f&&v!==f[Bn]())return;var y,b=!1,C=f||Vv(null,v,o&&o[qs]?o[qs]():o),S=p||(g={reason:0},g[yd]=!1,g);function I(){b||(b=!0,i.run(C,p),s.run(C[Ss]()),y===!0&&C[Pr](S),u())}return!h[Pv]||h[Pv](C,S,I)!==!0?I():y=!0,y},h[Qf]=function(f,p){var g=h[Bn];if(!g||f&&g!==f[Bn]())return;var v,y=!1,b=f||E_(null,g,o&&o[qs]?o[qs]():o),C=p||{reason:0};function S(){y||(y=!0,l(b.getCfg(),b.core(),b[Ki]()))}return!h._doUpdate||h._doUpdate(b,C,S)!==!0?S():v=!0,v},jv(h,"_addUnloadCb",function(){return i},"add"),jv(h,"_addHook",function(){return s},"add"),vn(h,"_unloadHooks",{g:function(){return s}})}),e[Ss]=function(h){return a(h)[Ss]()},e[$i]=function(){return n},e.setInitialized=function(h){n=h},e[Jf]=function(h){o=h},e[Pr]=function(h,f){f?f[Pr](h):o&&tn(o[Ji])&&o[Ji](h,null)},e._getTelCtx=a;function a(h){h===void 0&&(h=null);var f=h;if(!f){var p=r||Xc(null,{},e[Bn]);o&&o[qs]?f=p[Qc](null,o[qs]):f=p[Qc](null,o)}return f}function l(h,f,p){yo(h,lae,b_(f)),!p&&f&&(p=f[s6]()[Ki]());var g=o;o&&o[qs]&&(g=o[qs]()),e[Bn]=f,r=Xc(p,h,f,g)}function u(){n=!1,e[Bn]=null,r=null,o=null,s=W6(),i=q6()}}return t.__ieDyn=1,t}();function uae(t,e,n){var r={id:e,fn:n};la(t,r);var o={remove:function(){Xe(t,function(i,s){if(i.id===r.id)return t[Rp](s,1),-1})}};return o}function dae(t,e,n){for(var r=!1,o=t[gt],i=0;i<o;++i){var s=t[i];if(s)try{if(s.fn[Sb](null,[e])===!1){r=!0;break}}catch(a){en(n,2,64,"Telemetry initializer failed: "+g6(a),{exception:Ot(a)},!0)}}return!r}var hae=function(t){kp(e,t);function e(){var n=t.call(this)||this;n.identifier="TelemetryInitializerPlugin",n.priority=199;var r,o;i(),fn(e,n,function(s,a){s.addTelemetryInitializer=function(l){return uae(o,r++,l)},s[Ji]=function(l,u){dae(o,l,u?u[Ss]():s[Ss]())&&s[Pr](l,u)},s[Pv]=function(){i()}});function i(){r=0,o=[]}return n}return e.__ieDyn=1,e}(T_),Ws,Y6="Plugins must provide initialize method",fae="_notificationManager",g2="SDK is still unloading...",pae="SDK is not initialized",mae=100,gae=5e4,qS=zd((Ws={cookieCfg:{}},Ws[pu]={rdOnly:!0,ref:!0,v:[]},Ws[cc]={rdOnly:!0,ref:!0,v:[]},Ws[Hu]={ref:!0,v:{}},Ws[aI]=Oi,Ws.loggingLevelConsole=0,Ws.diagnosticLogInterval=Oi,Ws));function vae(t,e){return new eae(e)}function yae(t,e,n){var r,o=[],i=[],s={};return Xe(n,function(a){(Jt(a)||Jt(a[Np]))&&Ao(Y6);var l=a[Ov],u=a[ra];a&&l&&(Jt(s[l])?s[l]=u:vf(t,"Two extensions have same priority #"+l+" - "+s[l]+", "+u)),!l||l<e?o[zt](a):i[zt](a)}),r={},r[Bn]=o,r[cc]=i,r}function v2(t,e){var n=!1;return Xe(e,function(r){if(r===t)return n=!0,-1}),n}function CI(t,e,n,r){n&&nn(n,function(o,i){r&&si(i)&&si(e[o])&&CI(t,e[o],i,r),r&&si(i)&&si(e[o])?CI(t,e[o],i,r):t.set(e,o,i)})}function y2(t,e){var n=null,r=-1;return Xe(t,function(o,i){if(o.w===e)return n=o,r=i,-1}),{i:r,l:n}}function bae(t,e){var n=y2(t,e).l;return n||(n={w:e,rm:function(){var r=y2(t,e);r.i!==-1&&t[Rp](r.i,1)}},t[zt](n)),n}function Cae(t,e,n){Xe(e,function(r){var o=Ir(t,r.w,n);delete r.w,r.rm=function(){o.rm()}})}function Sae(t,e,n,r){return e.add(t[va](function(o){var i=o.cfg.disableDbgExt;i===!0&&r&&(n[xv](r),r=null),n&&!r&&i!==!0&&(r=Fse(o.cfg),n[Rv](r))})),r}function Iae(t){return vn({rm:function(){t.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(t)+">"}})}var Eae=function(){function t(){var e,n,r,o,i,s,a,l,u,h,f,p,g,v,y,b,C,S,I,E,T,w,A,_,L,N,K,q,ae,O,W,te;fn(t,this,function(D){X(),D._getDbgPlgTargets=function(){return[A,o]},D[$i]=function(){return n},D.activeStatus=function(){return N},D._setPendingStatus=function(){N=3},D[Np]=function(M,Q,fe,z){g&&Ao(g2),D[$i]()&&Ao("Core cannot be initialized more than once"),e=yo(M,qS,fe||D[kn],!1),M=e.cfg,ge(e[va](function(tt){var ht=tt.cfg,mt=N===3;if(!mt){q=ht.initInMemoMaxSize||mae;var Ve=ht[jR],rt=ht.endpointUrl;if(Jt(Ve)){T=null,N=Kl[SS];var xt="Please provide instrumentation key";n?(en(r,1,100,xt),re()):Ao(xt);return}var qt=[];if(gd(Ve)?(qt[zt](Ve),T=null):T=Ve,gd(rt)?(qt[zt](rt),K=null):K=rt,qt[gt]){ae=!1,N=3;var Wt=Dv(ht.initTimeOut)?ht.initTimeOut:gae,Yt=Kie(qt);Wc(function(){ae||G()},Wt),bd(Yt,function(V){try{if(ae)return;if(!V.rejected){var ye=V[mf];if(ye&&ye[gt]){var _e=ye[0];if(T=_e&&_e[mf],ye[gt]>1){var Pe=ye[1];K=Pe&&Pe[mf]}}T&&(M[jR]=T,M.endpointUrl=K)}G()}catch{ae||G()}})}else G();var nr=tt.ref(tt.cfg,Hu);nn(nr,function(V){tt.ref(nr,V)})}})),i=z,I=Sae(e,S,i&&D[Tm](),I),we(),D[kn]=fe;var Z=M[pu];if(h=[],h[zt].apply(h,PR(PR([],Q,!1),Z)),f=M[cc],Ce(null),(!p||p[gt]===0)&&Ao("No "+cc+" available"),f&&f[gt]>1){var Ee=D[Yf]("TeeChannelController");(!Ee||!Ee.plugin)&&en(r,1,28,"TeeChannel required")}Cae(M,w,r),w=null,n=!0,N===Kl.ACTIVE&&re()},D.getChannels=function(){var M=[];return p&&Xe(p,function(Q){M[zt](Q)}),qc(M)},D.track=function(M){qr(D[Lv](),function(){return"AppInsightsCore:track"},function(){M===null&&(B(M),Ao("Invalid telemetry item")),!M[wc]&&Jt(M[wc])&&(B(M),Ao("telemetry name required")),M[wh]=M[wh]||T,M[Fu]=M[Fu]||dI(new Date),M.ver=M.ver||"4.0",!g&&D[$i]()&&N===Kl.ACTIVE?Ie()[Pr](M):N!==Kl[SS]&&o[gt]<=q&&o[zt](M)},function(){return{item:M}},!M.sync)},D[s6]=Ie,D[Tm]=function(){return i||(i=new Xse(e.cfg),D[fae]=i),i},D[Rv]=function(M){D.getNotifyMgr()[Rv](M)},D[xv]=function(M){i&&i[xv](M)},D.getCookieMgr=function(){return l||(l=lg(e.cfg,D[kn])),l},D.setCookieMgr=function(M){l!==M&&(Qh(l,!1),l=M)},D[Lv]=function(){return s||a||tae()},D.setPerfMgr=function(M){s=M},D.eventCnt=function(){return o[gt]},D.releaseQueue=function(){if(n&&o[gt]>0){var M=o;o=[],N===2?Xe(M,function(Q){Q[wh]=Q[wh]||T,Ie()[Pr](Q)}):en(r,2,20,"core init status is not active")}},D[UR]=function(M){return y=M||null,te=!1,O&&O[wu](),J(!0)};function G(){ae=!0,Jt(T)?(N=Kl[SS],en(r,1,112,"ikey can't be resolved from promises")):N=Kl.ACTIVE,re()}function re(){n&&(D.releaseQueue(),D[UR]())}function J(M){if((!O||!O[_u])&&!te){var Q=M||r&&r.queue[gt]>0;Q&&(W||(W=!0,ge(e[va](function(fe){var z=fe.cfg.diagnosticLogInterval;(!z||!(z>0))&&(z=1e4);var Z=!1;O&&(Z=O[_u],O[wu]()),O=_ie(Ye,z),O.unref(),O[_u]=Z}))),O[_u]=!0)}return O}D[FR]=function(){te=!0,O&&O[wu](),Ye()},v6(D,function(){return v},["addTelemetryInitializer"]),D[Aa]=function(M,Q,fe){var z;M===void 0&&(M=!0),n||Ao(pae),g&&Ao(g2);var Z=(z={reason:50},z[yd]=M,z.flushComplete=!1,z),Ee;M&&!Q&&(Ee=Jc(function(mt){Q=mt}));var tt=Vv(ue(),D);tt[wm](function(){S.run(D[kn]),D6([l,i,r],M,function(){X(),Q&&Q(Z)})},D);function ht(mt){Z.flushComplete=mt,g=!0,C.run(tt,Z),D[FR](),tt[Pr](Z)}return Ye(),le(M,ht,6,fe),Ee},D[Yf]=be,D.addPlugin=function(M,Q,fe,z){if(!M){z&&z(!1),k(Y6);return}var Z=be(M[ra]);if(Z&&!Q){z&&z(!1),k("Plugin ["+M[ra]+"] is already loaded!");return}var Ee={reason:16};function tt(Ve){h[zt](M),Ee.added=[M],Ce(Ee),z&&z(!0)}if(Z){var ht=[Z.plugin],mt={reason:2,isAsync:!!fe};Me(ht,mt,function(Ve){Ve?(Ee.removed=ht,Ee.reason|=32,tt()):z&&z(!1)})}else tt()},D.updateCfg=function(M,Q){Q===void 0&&(Q=!0);var fe;if(D[$i]()){fe={reason:1,cfg:e.cfg,oldCfg:RR({},e.cfg),newConfig:RR({},M),merge:Q},M=fe.newConfig;var z=e.cfg;M[pu]=z[pu],M[cc]=z[cc]}e._block(function(Z){var Ee=Z.cfg;CI(Z,Ee,M,Q),Q||nn(Ee,function(tt){ju(M,tt)||Z.set(Ee,tt,Oi)}),Z[$d](Ee,qS)},!0),e[Av](),fe&&Ke(fe)},D.evtNamespace=function(){return b},D.flush=le,D.getTraceCtx=function(M){return E||(E=iae()),E},D.setTraceCtx=function(M){E=M||null},D.addUnloadHook=ge,jv(D,"addUnloadCb",function(){return C},"add"),D.onCfgChange=function(M){var Q;return n?Q=Ir(e.cfg,M,D[kn]):Q=bae(w,M),Iae(Q)},D.getWParam=function(){return X4()||e.cfg.enableWParam?0:-1};function ne(){var M={};_=[];var Q=function(fe){fe&&Xe(fe,function(z){if(z[ra]&&z[BR]&&!M[z.identifier]){var Z=z[ra]+"="+z[BR];_[zt](Z),M[z.identifier]=z}})};Q(p),f&&Xe(f,function(fe){Q(fe)}),Q(h)}function X(){n=!1,e=yo({},qS,D[kn]),e.cfg[a6]=1,vn(D,"config",{g:function(){return e.cfg},s:function(Q){D.updateCfg(Q,!1)}}),vn(D,"pluginVersionStringArr",{g:function(){return _||ne(),_}}),vn(D,"pluginVersionString",{g:function(){return L||(_||ne(),L=_.join(";")),L||Mt}}),vn(D,"logger",{g:function(){return r||(r=new Hv(e.cfg),e[kn]=r),r},s:function(Q){e[kn]=Q,r!==Q&&(Qh(r,!1),r=Q)}}),D[kn]=new Hv(e.cfg),A=[];var M=D.config[pu]||[];M.splice(0,M[gt]),la(M,A),v=new hae,o=[],Qh(i,!1),i=null,s=null,a=null,Qh(l,!1),l=null,u=null,h=[],f=null,p=null,g=!1,y=null,b=Gd("AIBaseCore",!0),C=q6(),E=null,T=null,S=W6(),w=[],L=null,_=null,te=!1,O=null,W=!1,N=0,K=null,q=null,ae=!1}function Ie(){var M=Xc(ue(),e.cfg,D);return M[wm](J),M}function Ce(M){var Q=yae(D[kn],Dse,h);u=null,L=null,_=null,p=(f||[])[0]||[],p=GS(la(p,Q[cc]));var fe=la(GS(Q[Bn]),p);A=qc(fe);var z=D.config[pu]||[];z.splice(0,z[gt]),la(z,A);var Z=Ie();p&&p[gt]>0&&h2(Z[Qc](p),fe),h2(Z,fe),M&&Ke(M)}function be(M){var Q=null,fe=null,z=[];return Xe(A,function(Z){if(Z[ra]===M&&Z!==v)return fe=Z,-1;Z.getChannel&&z[zt](Z)}),!fe&&z[gt]>0&&Xe(z,function(Z){if(fe=Z.getChannel(M),!fe)return-1}),fe&&(Q={plugin:fe,setEnabled:function(Z){xc(fe)[cI]=!Z},isEnabled:function(){var Z=xc(fe);return!Z[fs]&&!Z[cI]},remove:function(Z,Ee){var tt;Z===void 0&&(Z=!0);var ht=[fe],mt=(tt={reason:1},tt[yd]=Z,tt);Me(ht,mt,function(Ve){Ve&&Ce({reason:32,removed:ht}),Ee&&Ee(Ve)})}}),Q}function ue(){if(!u){var M=(A||[]).slice();Bo(M,v)===-1&&M[zt](v),u=Zc(GS(M),e.cfg,D)}return u}function Me(M,Q,fe){if(M&&M[gt]>0){var z=Zc(M,e.cfg,D),Z=Vv(z,D);Z[wm](function(){var Ee=!1,tt=[];Xe(h,function(mt,Ve){v2(mt,M)?Ee=!0:tt[zt](mt)}),h=tt,L=null,_=null;var ht=[];f&&(Xe(f,function(mt,Ve){var rt=[];Xe(mt,function(xt){v2(xt,M)?Ee=!0:rt[zt](xt)}),ht[zt](rt)}),f=ht),fe&&fe(Ee),J()}),Z[Pr](Q)}else fe(!1)}function Ye(){if(r&&r.queue){var M=r.queue.slice(0);r.queue[gt]=0,Xe(M,function(Q){var fe,z=(fe={},fe[wc]=y||"InternalMessageId: "+Q[Nv],fe[wh]=T,fe[Fu]=dI(new Date),fe.baseType=gI.dataType,fe.baseData={message:Q[_c]},fe);D.track(z)})}}function le(M,Q,fe,z){var Z=1,Ee=!1,tt=null;z=z||5e3;function ht(){Z--,Ee&&Z===0&&(tt&&tt[wu](),tt=null,Q&&Q(Ee),Q=null)}if(p&&p[gt]>0){var mt=Ie()[Qc](p);mt.iterate(function(Ve){if(Ve.flush){Z++;var rt=!1;Ve.flush(M,function(){rt=!0,ht()},fe)||rt||(M&&tt==null?tt=Wc(function(){tt=null,ht()},z):ht())}})}return Ee=!0,ht(),!0}function we(){var M;ge(e[va](function(Q){var fe=Q.cfg.enablePerfMgr;if(fe){var z=Q.cfg[aI];M!==z&&(z||(z=vae),Xie(Q.cfg,aI,z),M=z,a=null),!s&&!a&&tn(z)&&(a=z(D,D[Tm]()))}else a=null,M=null}))}function Ke(M){var Q=E_(ue(),D);Q[wm](J),(!D._updateHook||D._updateHook(Q,M)!==!0)&&Q[Pr](M)}function k(M){var Q=D[kn];Q?(en(Q,2,73,M),J()):Ao(M)}function B(M){var Q=D[Tm]();Q&&Q[gf]([M],2)}function ge(M){S.add(M)}})}return t.__ieDyn=1,t}(),Si="",Tae="NoResponseBody",b2="&"+Tae+"=true",WS="POST",wae=function(){function t(){var e=0,n,r,o,i,s,a,l,u,h,f,p,g,v,y;fn(t,this,function(b,C){var S=!0;ae(),b[Np]=function(O,W){o=W,r&&en(o,1,28,"Sender is already initialized"),b.SetConfig(O),r=!0},b._getDbgPlgTargets=function(){return[r,i,a,n]},b.SetConfig=function(O){try{if(s=O.senderOnCompleteCallBack||{},a=!!O.disableCredentials,l=O.fetchCredentials,i=!!O.isOneDs,n=!!O.enableSendPromise,h=!!O.disableXhr,f=!!O.disableBeacon,p=!!O.disableBeaconSync,y=O.timeWrapper,v=!!O.addNoResponse,g=!!O.disableFetchKeepAlive,u={sendPOST:N},i||(S=!1),a){var W=Eb();W&&W.protocol&&W.protocol[p_]()==="file:"&&(S=!1)}return!0}catch{}return!1},b.getSyncFetchPayload=function(){return e},b.getSenderInst=function(O,W){return O&&O[gt]?w(O,W):null},b.getFallbackInst=function(){return u},b[Pv]=function(O,W){ae()};function I(O,W){A(W,200,{},O)}function E(O,W){en(o,2,26,"Failed to send telemetry.",{message:O}),A(W,400,{})}function T(O){E("No endpoint url is provided for the batch",O)}function w(O,W){for(var te,D=0,G=null,re=0;G==null&&re<O[gt];)D=O[re],!h&&D===1?bse()?G=q:T6()&&(G=N):D===2&&E6(W)&&(!W||!g)?G=K:D===3&&I6()&&(W?!p:!f)&&(G=L),re++;return G?(te={_transport:D,_isSync:W},te[VR]=G,te):null}function A(O,W,te,D){try{O&&O(W,te,D)}catch{}}function _(O,W){var te=es(),D=O[_h];if(!D)return T(W),!0;D=O[_h]+(v?b2:Si);var G=O[fu],re=i?G:new Blob([G],{type:"text/plain;charset=UTF-8"}),J=te.sendBeacon(D,re);return J}function L(O,W,te){var D=O[fu];try{if(D)if(_(O,W))I(Si,W);else{var G=s&&s.beaconOnRetry;G&&tn(G)?G(O,W,_):(u&&u[VR](O,W,!0),en(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(re){i&&vf(o,"Failed to send telemetry using sendBeacon API. Ex:"+Ot(re)),A(W,i?0:400,{},Si)}}function N(O,W,te){var D,G,re,J=O[ES]||{};!te&&n&&(D=Jc(function(Ce,be){G=Ce,re=be})),i&&te&&O.disableXhrSync&&(te=!1);var ne=O[_h];if(!ne){T(W),G&&G(!1);return}var X=rse(WS,ne,S,!0,te,O[ql]);i||X[$R]("Content-type","application/json"),Xe(Cs(J),function(Ce){X[$R](Ce,J[Ce])}),X.onreadystatechange=function(){i||(Ie(X),X.readyState===4&&G&&G(!0))},X.onload=function(){i&&Ie(X)};function Ie(Ce){var be=s&&s.xhrOnComplete,ue=be&&tn(be);if(ue)be(Ce,W,O);else{var Me=Cd(Ce);A(W,Ce[qh],ag(Ce,i),Me)}}return X.onerror=function(Ce){A(W,i?X[qh]:400,ag(X,i),i?Si:JR(X)),re&&re(Ce)},X.ontimeout=function(){A(W,i?X[qh]:500,ag(X,i),i?Si:JR(X)),G&&G(!1)},X.send(O[fu]),D}function K(O,W,te){var D,G=O[_h],re=O[fu],J=i?re:new Blob([re],{type:"application/json"}),ne,X,Ie,Ce=new Headers,be=re[gt],ue=!1,Me=!1,Ye=O[ES]||{},le=(D={method:WS,body:J},D[e2]=!0,D);O.headers&&Cs(O.headers)[gt]>0&&(Xe(Cs(Ye),function(B){Ce.append(B,Ye[B])}),le[ES]=Ce),l?le.credentials=l:S&&i&&(le.credentials="include"),te&&(le.keepalive=!0,e+=be,i?O._sendReason===2&&(ue=!0,v&&(G+=b2)):ue=!0);var we=new Request(G,le);try{we[e2]=!0}catch{}if(!te&&n&&(ne=Jc(function(B,ge){X=B,Ie=ge})),!G){T(W),X&&X(!1);return}function Ke(B){A(W,i?0:400,{},i?Si:B)}function k(B,ge,M){var Q=B[qh],fe=s.fetchOnComplete;fe&&tn(fe)?fe(B,W,M||Si,ge):A(W,Q,{},M||Si)}try{bd(fetch(i?G:we,i?le:null),function(B){if(te&&(e-=be,be=0),!Me)if(Me=!0,B.rejected)Ke(B.reason&&B.reason[_c]),Ie&&Ie(B.reason);else{var ge=B[mf];try{!i&&!ge.ok?(Ke(ge.statusText),X&&X(!1)):i&&!ge.body?(k(ge,null,Si),X&&X(!0)):bd(ge.text(),function(M){k(ge,O,M[mf]),X&&X(!0)})}catch(M){Ke(Ot(M)),Ie&&Ie(M)}}})}catch(B){Me||(Ke(Ot(B)),Ie&&Ie(B))}return ue&&!Me&&(Me=!0,A(W,200,{}),X&&X(!0)),i&&!Me&&O[ql]>0&&y&&y.set(function(){Me||(Me=!0,A(W,500,{}),X&&X(!0))},O[ql]),ne}function q(O,W,te){var D=Ua(),G=new XDomainRequest,re=O[fu];G.onload=function(){var Ce=Cd(G),be=s&&s.xdrOnComplete;be&&tn(be)?be(G,W,O):A(W,200,{},Ce)},G.onerror=function(){A(W,400,{},i?Si:ese(G))},G.ontimeout=function(){A(W,500,{})},G.onprogress=function(){};var J=D&&D.location&&D.location[c6]||"",ne=O[_h];if(!ne){T(W);return}if(!i&&ne.lastIndexOf(J,0)!==0){var X="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";en(o,2,40,". "+X),E(X,W);return}var Ie=i?ne:ne[Ac](/^(https?:)/,"");G.open(WS,Ie),O[ql]&&(G[ql]=O[ql]),G.send(re),i&&te?y&&y.set(function(){G.send(re)},0):G.send(re)}function ae(){e=0,r=!1,n=!1,o=null,i=null,s=null,a=null,l=null,u=null,h=!1,f=!1,p=!1,g=!1,v=!1,y=null}})}return t.__ieDyn=1,t}(),Q6="on",C2="attachEvent",S2="addEventListener",I2="detachEvent",E2="removeEventListener",SI="events",ep="visibilitychange",wb="pagehide",J6="pageshow",X6="unload",Z6="beforeunload",ej=Gd("aiEvtPageHide"),tj=Gd("aiEvtPageShow"),_ae=/\.[\.]+/g,Aae=/[\.]+$/,kae=1,$v=N6("events"),xae=/^([^.]*)(?:\.(.+)|)/;function T2(t){return t&&t[Ac]?t[Ac](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Mt):t}function w_(t,e){var n;if(e){var r=Mt;kt(e)?(r=Mt,Xe(e,function(i){i=T2(i),i&&(i[0]!=="."&&(i="."+i),r+=i)})):r=T2(e),r&&(r[0]!=="."&&(r="."+r),t=(t||Mt)+r)}var o=xae.exec(t||Mt)||[];return n={},n[Is]=o[1],n.ns=(o[2]||Mt).replace(_ae,".").replace(Aae,Mt)[Ib](".").sort().join("."),n}function nj(t,e,n){n===void 0&&(n=!0);var r=$v.get(t,SI,{},n),o=r[e];return o||(o=r[e]=[]),o}function rj(t,e,n,r){t&&e&&e[Is]&&(t[E2]?t[E2](e[Is],n,r):t[I2]&&t[I2](Q6+e[Is],n))}function Rae(t,e,n,r){var o=!1;return t&&e&&e[Is]&&n&&(t[S2]?(t[S2](e[Is],n,r),o=!0):t[C2]&&(t[C2](Q6+e[Is],n),o=!0)),o}function w2(t,e,n,r){for(var o=e[gt];o--;){var i=e[o];i&&(!n.ns||n.ns===i.evtName.ns)&&(!r||r(i))&&(rj(t,i.evtName,i[m_],i.capture),e[Rp](o,1))}}function Nae(t,e,n){if(e[Is])w2(t,nj(t,e[Is]),e,n);else{var r=$v.get(t,SI,{});nn(r,function(o,i){w2(t,i,e,n)}),Cs(r)[gt]===0&&$v.kill(t,SI)}}function Pp(t,e){var n;return e?(kt(e)?n=[t].concat(e):n=[t,e],n=w_("xx",n).ns[Ib](".")):n=t,n}function YS(t,e,n,r,o){var i;o===void 0&&(o=!1);var s=!1;if(t)try{var a=w_(e,r);if(s=Rae(t,a,n,o),s&&$v.accept(t)){var l=(i={guid:kae++,evtName:a},i[m_]=n,i.capture=o,i);nj(t,a.type)[zt](l)}}catch{}return s}function QS(t,e,n,r,o){if(o===void 0&&(o=!1),t)try{var i=w_(e,r),s=!1;Nae(t,i,function(a){return i.ns&&!n||a[m_]===n?(s=!0,!0):!1}),s||rj(t,i,n,o)}catch{}}function Pae(t,e,n){var r=!1,o=Ua();o&&(r=YS(o,t,e,n),r=YS(o.body,t,e,n)||r);var i=ks();return i&&(r=YS(i,t,e,n)||r),r}function Mae(t,e,n){var r=Ua();r&&(QS(r,t,e,n),QS(r.body,t,e,n));var o=ks();o&&QS(o,t,e,n)}function Sd(t,e,n,r){var o=!1;return e&&t&&t[gt]>0&&Xe(t,function(i){i&&(!n||Bo(n,i)===-1)&&(o=Pae(i,e,r)||o)}),o}function Oae(t,e,n,r){var o=!1;return e&&t&&kt(t)&&(o=Sd(t,e,n,r),!o&&n&&n[gt]>0&&(o=Sd(t,e,null,r))),o}function tp(t,e,n){t&&kt(t)&&Xe(t,function(r){r&&Mae(r,e,n)})}function Lae(t,e,n){return Oae([Z6,X6,wb],t,e,n)}function Dae(t,e){tp([Z6,X6,wb],t,e)}function oj(t,e,n){function r(s){var a=ks();t&&a&&a.visibilityState==="hidden"&&t(s)}var o=Pp(ej,n),i=Sd([wb],t,e,o);return(!e||Bo(e,ep)===-1)&&(i=Sd([ep],r,e,o)||i),!i&&e&&(i=oj(t,null,n)),i}function jae(t,e){var n=Pp(ej,e);tp([wb],t,n),tp([ep],null,n)}function ij(t,e,n){function r(s){var a=ks();t&&a&&a.visibilityState==="visible"&&t(s)}var o=Pp(tj,n),i=Sd([J6],t,e,o);return i=Sd([ep],r,e,o)||i,!i&&e&&(i=ij(t,null,n)),i}function Uae(t,e){var n=Pp(tj,e);tp([J6],t,n),tp([ep],null,n)}var Kd="",Fae="https://browser.events.data.microsoft.com/OneCollector/1.0/",_2="version",JS="properties",A2="initialize",k2="logger",dg="indexOf",oa="timings",x2="pollInternalLogs",To="value",R2="kind",__="length",XS="processTelemetryStart",cs,Bae="4.3.3",sj="1DS-Web-JS-"+Bae,aj=woe.hasOwnProperty,Hae=(cs={},cs[0]=0,cs[2]=6,cs[1]=1,cs[3]=7,cs[4098]=6,cs[4097]=1,cs[4099]=7,cs),ZS=null;function ia(t){return!(t===Kd||Jt(t))}function zae(t){if(t){var e=Cb(t,"-");if(e>-1)return n_(t,e)}return Kd}function MNe(){return ZS===null&&(ZS=!Qt(Uint8Array)&&!qae()&&!hI()),ZS}function Vae(t){return!!(t&&Ta(t)&&t>=1&&t<=4)}function $ae(t,e,n){if(!e&&!ia(e)||typeof t!="string")return null;var r=typeof e;if(r==="string"||r==="number"||r==="boolean"||kt(e))e={value:e};else if(r==="object"&&!aj.call(e,"value"))e={value:n?JSON.stringify(e):e};else if(Jt(e[To])||e[To]===Kd||!yr(e[To])&&!Ta(e[To])&&!Kc(e[To])&&!kt(e[To]))return null;if(kt(e[To])&&!Wae(e[To]))return null;if(!Jt(e[R2])){if(kt(e[To])||!Gae(e[R2]))return null;e[To]=e[To].toString()}return e}function cj(t,e,n){var r=-1;if(!Qt(t))if(e>0&&(e===32?r=8192:e<=13&&(r=e<<5)),Kae(n))r===-1&&(r=0),r|=n;else{var o=Hae[EI(t)]||-1;r!==-1&&o!==-1?r|=o:o===6&&(r=o)}return r}function Id(t,e,n){n===void 0&&(n=!0);var r;return t&&(r=t.get(e),n&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||Kd}function N2(t){t===void 0&&(t="D");var e=V6();return t==="B"?e="{"+e+"}":t==="P"?e="("+e+")":t==="N"&&(e=e.replace(/-/g,Kd)),e}function Gv(t,e,n,r,o){var i={},s=!1,a=0,l=arguments[__],u=arguments;for(Kc(u[0])&&(s=u[0],a++);a<l;a++){var t=u[a];nn(t,function(f,p){s&&p&&md(p)?kt(p)?(i[f]=i[f]||[],Xe(p,function(g,v){g&&md(g)?i[f][v]=Gv(!0,i[f][v],g):i[f][v]=g})):i[f]=Gv(!0,i[f],p):i[f]=p})}return i}var Ai=bie;function Gae(t){return t===0||t>0&&t<=13||t===32}function Kae(t){return t>=0&&t<=9}function qae(){var t=es();if(!Qt(t)&&t.userAgent){var e=t.userAgent.toLowerCase();if((e[dg]("safari")>=0||e[dg]("firefox")>=0)&&e[dg]("chrome")<0)return!0}return!1}function Wae(t){return t[__]>0}function II(t,e){var n=t;n[oa]=n[oa]||{},n[oa][XS]=n[oa][XS]||{},n[oa][XS][e]=Ai()}function EI(t){var e=0;if(t!=null){var n=typeof t;n==="string"?e=1:n==="number"?e=2:n==="boolean"?e=3:n===Ww&&(e=4,kt(t)?(e=4096,t[__]>0&&(e|=EI(t[0]))):aj.call(t,"value")&&(e=8192|EI(t[To])))}return e}function Yae(){return!!Ln("chrome")}function bf(t){return t>0}var Qae=zd({endpointUrl:Fae,propertyStorageOverride:{isVal:Jae}});function Jae(t){return t&&(!t.getProperty||!t.setProperty)&&Ao("Invalid property storage override passed."),!0}var Xae=function(t){kp(e,t);function e(){var n=t.call(this)||this;return fn(e,n,function(r,o){r[A2]=function(i,s,a,l){qr(r,function(){return"AppInsightsCore.initialize"},function(){try{o[A2](yo(i,Qae,a||r[k2],!1).cfg,s,a,l)}catch(f){var u=r[k2],h=Ot(f);h[dg]("channels")!==-1&&(h+=`
 - Channels must be provided through config.channels only!`),en(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+h)}},function(){return{config:i,extensions:s,logger:a,notificationManager:l}})},r.track=function(i){qr(r,function(){return"AppInsightsCore.track"},function(){var s=i;if(s){s[oa]=s[oa]||{},s[oa].trackStart=Ai(),Vae(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=sj;var l=s.baseData=s.baseData||{};l[JS]=l[JS]||{};var u=l[JS];u[_2]=u[_2]||r.pluginVersionString||Kd}o.track(s)},function(){return{item:i}},!i.sync)},r[x2]=function(i){return o[x2](i||"InternalLog")}}),n}return e.__ieDyn=1,e}(Eae),Zae="device",lj="locale",A_="ver",ece="browser",tce="browserVer",nce="popSample",rce="eventFlags",k_="name",oce="serviceName",io=to({UserExt:[0,"user"],DeviceExt:[1,Zae],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),ice=to({id:[0,"id"],ver:[1,A_],appName:[2,k_],locale:[3,lj],expId:[4,"expId"],env:[5,"env"]}),sce=to({domain:[0,"domain"],browser:[1,ece],browserVer:[2,tce],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),ace=to({locale:[0,lj],localId:[1,"localId"],id:[2,"id"]}),cce=to({osName:[0,k_],ver:[1,A_]}),lce=to({ver:[0,A_],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),uce=to({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,oce]}),dce=to({popSample:[0,nce],eventFlags:[1,rce]}),hce=to({tz:[0,"tz"]}),fce=to({sessionId:[0,"sesId"]}),pce=to({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),mce=to({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),gce=to({traceId:[0,"traceID"],traceName:[1,k_],parentId:[2,"parentID"]}),vce=to({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]}),Cf;function uj(){return Cf===void 0&&(Cf=!!hj(0)),Cf}function dj(){return uj()?hj(0):null}function hj(t){var e=null,n,r;try{var o=Vd();if(!o)return null;r=new Date,e=t===0?o.localStorage:o.sessionStorage,e&&tn(e.setItem)&&(e.setItem(r,r),n=e.getItem(r)!==r,e.removeItem(r),n&&(e=null))}catch{e=null}return e}function yce(t,e,n){var r=dj();if(r!==null)try{return r.setItem(e,n),!0}catch(o){Cf=!1,en(t,1,504,"Browser failed write to local storage. "+o)}return!1}function bce(t,e){var n=dj();if(n!==null)try{return n.getItem(e)}catch(r){Cf=!1,en(t,1,503,"Browser failed read of local storage. "+r)}return null}function Cce(){return this.getId()}function Sce(t){this.setId(t)}var fj=function(){function t(){fn(t,this,function(e){e.setId=function(n){e.customId=n},e.getId=function(){return yr(e.customId)?e.customId:e.automaticId}})}return t._staticInit=function(){vn(t.prototype,"id",{g:Cce,s:Sce})}(),t}(),P2="ai_session",Ice=function(){function t(e,n,r){var o,i=b_(e),s=H6(e),a,l;fn(t,this,function(u){var h=Ir(n,function(){l=n,u.config=l});r&&r.add(h),a=function(){return u.config.namePrefix?P2+u.config.namePrefix:P2},u.automaticSession=new fj,u.update=function(){u.automaticSession.getId()||f();var b=u.automaticSession,C=u.config,S=new Date().getTime(),I=S-b.acquisitionDate>C.sessionExpirationMs,E=S-b.renewalDate>C.sessionRenewalMs;if(I||E)g();else{var T=o;(!T||S-T>t.cookieUpdateInterval)&&(b.renewalDate=S,v(b.getId(),b.acquisitionDate,b.renewalDate))}},u.backup=function(){var b=u.automaticSession;y(b.getId(),b.acquisitionDate,b.renewalDate)};function f(){var b=s.get(a());if(b&&tn(b.split))p(b);else{var C=bce(i,a());C&&p(C)}u.automaticSession.getId()||g()}function p(b){var C=u.automaticSession,S=b.split("|");S.length>0&&C.setId(S[0]);try{if(S.length>1){var I=+S[1];C.acquisitionDate=+new Date(I),C.acquisitionDate=C.acquisitionDate>0?C.acquisitionDate:0}if(S.length>2){var E=+S[2];C.renewalDate=+new Date(E),C.renewalDate=C.renewalDate>0?C.renewalDate:0}}catch(T){en(i,1,510,"Error parsing ai_session cookie, session will be reset: "+T)}C.renewalDate===0&&en(i,2,517,"AI session renewal date is 0, session will be reset.")}function g(){var b=u.automaticSession,C=new Date().getTime(),S=u.config.sessionAsGuid;!Qt(S)&&S?Kc(S)?b.setId(N2()):b.setId(N2(S)):b.setId(v_(l.idLength||22)),b.acquisitionDate=C,b.renewalDate=C,v(b.getId(),b.acquisitionDate,b.renewalDate),uj()||en(i,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function v(b,C,S){var I=C+u.config.sessionExpirationMs,E=S+u.config.sessionRenewalMs,T=new Date,w=[b,C,S];I<E?T.setTime(I):T.setTime(E);var A=u.config.cookieDomain||null;s.set(a(),w.join("|")+";expires="+T.toUTCString(),null,A),o=new Date().getTime()}function y(b,C,S){yce(i,a(),[b,C,S].join("|"))}})}return t.cookieUpdateInterval=6e4,t}(),x_=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function M2(t,e){e===void 0&&(e=x_);var n=null;if(t)for(var r=t.split(","),o=0;o<r.length;o++)Ece(r[o],e)&&(n?n+=","+r[o]:n=r[o]);return n}function Ece(t,e){if(e===void 0&&(e=x_),!t||t.length<4)return!1;for(var n=!1,r=256,o=t.substring(0,3).toString().toUpperCase(),i=0;i<e.length;i++)if(e[i]+":"===o&&t.length<=r){n=!0;break}return n}function Tce(){return this.getExpId()}var wce=function(){function t(e,n,r){var o=null,i=x_.slice(0),s="Treatments",a,l=null;fn(t,this,function(u){if(y(e),X4()){var h=ks().documentElement;h&&(u.locale=h.lang)}u.getExpId=function(){return l.expId?v(l.expId):g()};function f(b){var C,S={},I=ks();if(I){C=I&&I.querySelectorAll("meta");for(var E=0;E<C.length;E++){var T=C[E];if(T.name){var w=T.name.toLowerCase();if(w.indexOf(b)===0){var A=T.name.replace(b,"");S[A]=T.content}}}}return S}function p(b){b!==o&&(o=M2(b,i))}function g(){var b=Id(a,s);return p(b),o}function v(b){return p(b),o}function y(b){var C=Ir(b,function(){a=n&&n.getCookieMgr(),l=b||{},u.env=l.env||f("awa-").env});r&&r.add(C)}})}return t.validateAppExpId=M2,t._staticInit=function(){vn(t.prototype,"expId",{g:Tce})}(),t}(),_ce=function(){function t(){}return t}(),Ace=function(){function t(){}return t}();function kce(){return this.getMsfpc()}function xce(){return this.getAnid()}var Rce=function(){function t(e,n,r){var o;fn(t,this,function(i){s(e),i.getMsfpc=function(){return Id(o,"MSFPC")},i.getAnid=function(){return Id(o,"ANON").slice(0,34)};function s(a){var l=Ir(a,function(){o=n&&n.getCookieMgr();var u=a||{};u.serviceName&&(i.serviceName=u.serviceName)});r&&r.add(l)}})}return t._staticInit=function(){var e=t.prototype;vn(e,"msfpc",{g:kce}),vn(e,"anid",{g:xce})}(),t}(),Nce=function(){function t(){var e=new Date().getTimezoneOffset(),n=e%60,r=(e-n)/60,o="+";r>0&&(o="-"),r=Math.abs(r),n=Math.abs(n),this.tz=o+(r<10?"0"+r:r.toString())+":"+(n<10?"0"+n:n.toString())}return t}(),Ys={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},O2={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","10.0":"10"},Pce="([\\d,.]+)",pj="([\\d,_,.]+)",qd="Unknown",L2=[{r:Ys.WINPHONE,os:"Windows Phone"},{r:Ys.WINRT,os:"Windows RT"},{r:Ys.WIN,os:"Windows"},{r:Ys.IOS,os:"iOS"},{r:Ys.ANDROID,os:"Android"},{r:Ys.LINUX,os:"Linux"},{r:Ys.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Ys.OSX,os:"Mac OS X"}];function Mce(t){for(var e=0;e<L2.length;e++){var n=L2[e];if(n.r&&t.match(n.r))return n.os;if(n.s&&t.indexOf(n.s)!==-1)return n.os}return qd}function Oce(t,e){return e==="Windows"?D2(t,"Windows NT"):e==="Android"?D2(t,e):e==="Mac OS X"?Lce(t):e==="iOS"?Dce(t):qd}function D2(t,e){var n=t.match(new RegExp(e+" "+Pce));return n?O2[n[1]]?O2[n[1]]:n[1]:qd}function Lce(t){var e=t.match(new RegExp("Mac OS X "+pj));if(e){var n=e[1].replace(/_/g,".");if(n){var r=mj(n);if(r){var o=n.split(r);return o[0]}else return n}}return qd}function Dce(t){var e=t.match(new RegExp("OS "+pj));if(e){var n=e[1].replace(/_/g,".");if(n){var r=mj(n);if(r){var o=n.split(r);return o[0]}else return n}}return qd}function mj(t){return t.indexOf(".")>-1?".":t.indexOf("_")>-1?"_":null}var jce=function(){function t(e,n){var r=this,o,i=null,s=null,a=null,l=null,u=function(v){a=v},h=function(v){l=v},f=function(){return a||i},p=function(){return l||s},g=Ir(e,function(){if(o=e||{},o.populateOperatingSystemInfo){var v=es()||{},y=e.userAgent||v.userAgent||"",b=(e.userAgentData||{}).platform||(v.userAgentData||{}).platform;if(y){var C=Mce(y.toLowerCase());i=C,s=Oce(y,C)}(!i||i===qd)&&yr(b)&&(i=b)}});n&&n.add(g),vn(r,"name",{s:u,g:f}),vn(r,"ver",{s:h,g:p})}return t}(),e0="MicrosoftApplicationsTelemetryDeviceId";function Uce(t,e,n,r){e?e.setProperty(n,r):t.set(n,r,31536e3)}function Fce(t,e,n){return e?e.getProperty(n)||"":Id(t,n)}var Bce=function(){function t(e,n,r){var o=0,i;fn(t,this,function(s){s.seq=o,s.epoch=Xf(!1).toString(),s.getSequenceId=function(){return++o};var a=Ir(e,function(l){i=n&&n.getCookieMgr();var u=l.cfg,h=u.propertyStorageOverride,f=i.isEnabled();if(f||h){var p=Fce(i,h,e0);p||(p=V6()),Uce(i,h,e0,p),s.installId=p}else i.purge(e0)});r&&r.add(a)})}return t.__ieDyn=1,t}(),Hce=function(){function t(e,n,r,o,i){var s=this;s.traceId=n||bI();var a=Ir(e,function(){var l=e;if(l.enableDistributedTracing&&!r&&(r=bI().substring(0,16)),s.parentId=s.parentId||r,l.enableApplicationInsightsTrace&&!o){var u=Eb();u&&u.pathname&&(o=u.pathname)}s.name=s.name||o});i&&i.add(a)}return t}(),gj="setLocalId";function zce(){return this.getLocalId()}function Vce(t){this[gj](t)}var $ce=function(){function t(e,n,r,o){var i,s,a;fn(t,this,function(l){if(f(n),typeof navigator<"u"){var u=navigator;l.locale=u.userLanguage||u.language}l.getLocalId=function(){return s||h()},l[gj]=function(p){s=p};function h(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var p=Id(a,"MUID");p&&(s="t:"+p)}return s}function f(p){var g=Ir(p,function(){if(a=r&&r.getCookieMgr(),i=p,s=null,a&&a.isEnabled()&&(h(),i.enableApplicationInsightsUser)){var v=Id(a,t.userCookieName);if(v){var y=v.split(t.cookieSeparator);y.length>0&&(l.id=y[0])}if(!l.id){l.id=v_(e&&!Qt(e.idLength)?e.idLength:22);var b=dI(new Date);l.accountAcquisitionDate=b;var C=[l.id,b],S=i.cookieDomain?i.cookieDomain:void 0;a.set(t.userCookieName,C.join(t.cookieSeparator),31536e3,S)}}});o&&o.add(g)}})}return t.cookieSeparator="|",t.userCookieName="ai_user",t._staticInit=function(){vn(t.prototype,"localId",{g:zce,s:Vce})}(),t}(),Gce=1048576,Kce=2097152,qce=4194304,Wce=function(){function t(e,n){var r=this;r.popSample=100;var o=Ir(e,function(){r.eventFlags=0,e.hashIdentifiers&&(r.eventFlags=r.eventFlags|Gce),e.dropIdentifiers&&(r.eventFlags=r.eventFlags|Kce),e.scrubIpOnly&&(r.eventFlags=r.eventFlags|qce)});n&&n.add(o)}return t}(),j2=["Required","Analytics","SocialMedia","Advertising"],Kv="([\\d,.]+)",vj="Unknown",yj="Edg/",bj="EdgiOS/",t0=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:yj,b:"Edge"},{ua:bj,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],n0=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function TI(t,e){return e.indexOf(t)>-1}function Yce(t,e){for(var n=0;n<e.length;n++)if(t==e[n].brand)return e[n].version;return null}function Qce(t){if(t)for(var e=0;e<t0.length;e++){var n=t0[e].ua;if(TI(n,t))return t0[e].b}return vj}function Jce(t,e){return e==="MSIE"?Xce(t):Zce(e,t)}function Xce(t){var e=t.match(new RegExp("MSIE "+Kv));if(e)return e[1];var n=t.match(new RegExp("rv:"+Kv));if(n)return n[1]}function Zce(t,e){t==="Safari"?t="Version":t==="Edge"&&(TI(yj,e)?t="Edg":TI(bj,e)&&(t="EdgiOS"));var n=e.match(new RegExp(t+"/"+Kv));return n||t==="Opera"&&(n=e.match(new RegExp("OPR/"+Kv)),n)?n[1]:vj}function ele(){var t={h:0,w:0},e=Ua();return e&&e.screen&&(t.h=screen.height,t.w=screen.width),t}function tle(){return this.getUserConsent()}var nle=function(){function t(e,n,r){H6(n);var o=e||{},i=null,s=null,a=null,l=null,u=null,h=null,f=null;fn(t,this,function(p){A(e);var g=Eb();if(g){var v=g.hostname;v&&(p.domain=g.protocol==="file:"?"local":v)}var y=ele();p.screenRes=y.w+"X"+y.h,p.getUserConsent=function(){return!1},p.getUserConsentDetails=function(){var _=null;try{var L=o.callback;if(L&&L.userConsentDetails){var N=L.userConsentDetails();if(N){o.disableConsentDetailsSanitize?_=N:_={};for(var K=0;K<j2.length;K++){var q=j2[K];_[q]=N[q]||!1}}}return f!==null&&(_=_||{},_.GPC_DataSharingOptIn=!!f),_?JSON.stringify(_):null}catch{}};function b(_,L){if(kt(L))try{for(var N=0;N<n0.length;N++){var K=Yce(n0[N].br,L);if(K){u=n0[N].b,h=K;return}}}catch{}if(_){var q=Qce(_);u=q,h=Jce(_,q)}}function C(_){a=_}function S(_){l=_}function I(){return a||u}function E(){return l||h}var T=function(){return f},w=function(_){f=Kc(_)?_:null,o.gpcDataSharingOptIn=f};function A(_){var L=Ir(_,function(){if(o=_,o.populateBrowserInfo){var N=o.userAgent,K=(o.userAgentData||{}).brands;if(N!==i||K!==s){if(!N||!K||K.length===0){var q=es();q&&(N=N||q.userAgent||"",K=K||(q.userAgentData||{}).brands)}b(N,K),i=N,s=K}}f=Kc(o.gpcDataSharingOptIn)?o.gpcDataSharingOptIn:null});r&&r.add(L)}G4(p,{userConsent:{g:p.getUserConsent},browser:{s:C,g:I},browserVer:{s:S,g:E},gpcDataSharingOptIn:{g:T,s:w}})})}return t._staticInit=function(){vn(t.prototype,"userConsent",{g:tle})}(),t}();function ro(t,e,n,r,o){var i=e.ext[io[t]];if(i)try{nn(r,function(s,a){if(yr(a)||Ta(a)||Kc(a)){var l=i[n[s]];!o&&(l||yr(l)||Ta(l)||Kc(l))&&(a=l),i[n[s]]=a}})}catch{}return i}var rle=function(){function t(e,n,r,o){fn(t,this,function(i){i.app=new wce(n,r,o),i.cloud=new _ce,i.user=new $ce(e,n,r,o),i.os=new jce(n,o),i.web=new nle(n,r,o);var s=new Bce(e,r,o),a=new Rce(n,r,o),l=new Wce(n,o);i.loc=new Nce,i.device=new Ace;var u=new Ice(r,n,o);i.session=new fj;var h=void 0,f=ole(new Hce(n,h,h,h,o),v()),p=!(n||{}).eventContainExtFields;function g(){var y=i.session;if(y&&yr(y.customId))return y.customId;u.update();var b=u.automaticSession;if(b){var C=b.getId();C&&yr(C)&&(y.automaticId=C)}return y.automaticId}i.getTraceCtx=function(){return f},i.getSessionId=g,i.applyApplicationContext=function(y){var b,C=i.app;ro(4,y,ice,(b={},b[0]=C.id,b[1]=C.ver,b[2]=C.name,b[3]=C.locale,b[4]=C.getExpId(),b[5]=C.env,b),p)},i.applyUserContext=function(y){var b,C=i.user;ro(0,y,ace,(b={},b[1]=C.getLocalId(),b[0]=C.locale,b[2]=C.id,b),p)},i.applyWebContext=function(y){var b,C=i.web;ro(3,y,sce,(b={},b[0]=C.domain,b[1]=C.browser,b[2]=C.browserVer,b[3]=C.screenRes,b[5]=C.getUserConsentDetails(),b[4]=!1,b),p)},i.applyOsContext=function(y){var b,C=i.os;ro(5,y,cce,(b={},b[0]=C.name,b[1]=C.ver,b),p)},i.applySdkContext=function(y){var b;ro(6,y,lce,(b={},b[2]=s.installId,b[1]=s.getSequenceId(),b[3]=s.epoch,b),p)},i.applyIntWebContext=function(y){var b;ro(7,y,uce,(b={},b[0]=a.getMsfpc(),b[1]=a.getAnid(),b[2]=a.serviceName,b),p)},i.applyUtcContext=function(y){var b,C=(b={},b[0]=l.popSample,b);l.eventFlags>0&&(C[1]=l.eventFlags),ro(8,y,dce,C,p)},i.applyLocContext=function(y){var b;ro(9,y,hce,(b={},b[0]=i.loc.tz,b),p)},i.applySessionContext=function(y){var b;ro(4,y,fce,(b={},b[0]=g(),b),p)},i.applyDeviceContext=function(y){var b,C=i.device;ro(1,y,pce,(b={},b[0]=C.localId,b[2]=C.make,b[3]=C.model,b[1]=C.deviceClass,b),p)},i.applyCloudContext=function(y){var b,C=i.cloud;ro(10,y,mce,(b={},b[0]=C.role,b[1]=C.roleInstance,b[2]=C.roleVer,b),p)},i.applyAITraceContext=function(y){var b;if(n.enableApplicationInsightsTrace){var C=v();C&&ro(2,y,gce,(b={},b[0]=C.getTraceId(),b[1]=C.getName(),b[2]=C.getSpanId(),b),!1)}},i.applyDistributedTraceContext=function(y){var b,C=v();if(C){var S=(b={},b[0]=C.getTraceId(),b[1]=C.getSpanId(),b),I=C.getTraceFlags();Jt(I)||(S[2]=I),ro(11,y,vce,S,!1)}};function v(){var y=f;return r&&r.getTraceCtx&&(y=r.getTraceCtx(!1)||f),y}})}return t.__ieDyn=1,t}();function ole(t,e){var n=t||{};return{getName:function(){return n.name},setName:function(r){e&&e.setName(r),n.name=r},getTraceId:function(){return n.traceId},setTraceId:function(r){e&&e.setTraceId(r),G6(r)&&(n.traceId=r)},getSpanId:function(){return n.parentId},setSpanId:function(r){e&&e.setSpanId(r),K6(r)&&(n.parentId=r)},getTraceFlags:function(){return n.traceFlags},setTraceFlags:function(r){e&&e.setTraceFlags(r),n.traceFlags=r}}}var Rm,ile=[io[4],io[0],io[3],io[5],io[6],io[7],io[8],io[9],io[1],io[2],io[11],io[10]],sle=zd({populateBrowserInfo:!1,populateOperatingSystemInfo:!1,userAgent:qa(),userAgentData:mI({brands:Rm,mobile:Rm,platform:Rm}),userConsentCookieName:qa(),userConsented:!1,serviceName:qa(),env:qa(),expId:qa(),sessionRenewalMs:18e5,sessionExpirationMs:864e5,sessionAsGuid:null,cookieDomain:qa(),namePrefix:qa(),enableApplicationInsightsTrace:!1,enableApplicationInsightsUser:!1,hashIdentifiers:!1,dropIdentifiers:!1,scrubIpOnly:!1,callback:mI({userConsentDetails:null}),gpcDataSharingOptIn:Rm,idLength:22,enableDistributedTracing:!1,eventContainExtFields:!1}),ale=function(t){kp(e,t);function e(){var n=t.call(this)||this;n.identifier="SystemPropertiesCollector",n.priority=3,n.version="4.3.3";var r,o,i;return fn(e,n,function(s,a){l(),s.initialize=function(f,p,g){a.initialize(f,p,g),u(f)},s.processTelemetry=function(f,p){II(f,s.identifier),p=s._getTelCtx(p);var g=f.ext=f.ext?f.ext:{};f.data=f.data?f.data:{},Xe(ile,function(v){g[v]=g[v]||{}}),r&&(r.applyUtcContext(f),r.applyApplicationContext(f),r.applyUserContext(f),r.applyWebContext(f),r.applyOsContext(f),r.applySdkContext(f),r.applyIntWebContext(f),r.applyLocContext(f),r.applySessionContext(f),r.applyDeviceContext(f),i.enableApplicationInsightsTrace&&r.applyAITraceContext(f),i.enableDistributedTracing&&r.applyDistributedTraceContext(f),r.applyCloudContext(f)),Xe(Cs(g),function(v){Cs(g[v]).length===0&&delete g[v]}),h(o,f.data),s.processNext(f,p)},s.getPropertiesContext=function(){return r},s.setProperty=function(f,p){o[f]=p},s._doTeardown=function(f,p){var g=(f||{}).core();if(g&&g.getTraceCtx&&r){var v=g.getTraceCtx(!1);v&&v===r.getTraceCtx()&&g.setTraceCtx(null)}l()},s._getDbgPlgTargets=function(){return[i]};function l(){r=null,o={}}function u(f){var p=s.identifier,g=s.core;s._addHook(Ir(f,function(){var v=Xc(null,f,g);i=v.getExtCfg(p,sle)})),r=new rle(f,i,g,s._unloadHooks),g&&g.setTraceCtx&&g.setTraceCtx(r.getTraceCtx())}function h(f,p){f&&nn(f,function(g,v){p[g]||(p[g]=v)})}}),n}return e.__ieDyn=1,e}(T_),Nm="REAL_TIME",cle="NEAR_REAL_TIME",lle="BEST_EFFORT",ta="",wI="drop",ule="send",U2="requeue",dle="rspFail",hle="oth",F2="no-cache, no-store",_I="application/x-json-stream",Pm="cache-control",Jh="content-type",fle="kill-tokens",ple="kill-duration",mle="time-delta-millis",AI="client-version",Cj="client-id",kI="time-delta-to-apply-millis",xI="upload-time",RI="apikey",NI="AuthMsaDeviceTicket",B2="WebAuthToken",H2="AuthXToken",gle="NoResponseBody",qv="msfpc",z2="trace",r0="user",PI="allowRequestSending",Sj="firstRequestSent",Ij="shouldAddClockSkewHeaders",Ej="getClockSkewHeaderValue",MI="setClockSkew",Ct="length",Rc="concat",Ui="iKey",Un="count",bc="events",xr="push",Vu="split",_b="splice",OI="toLowerCase",gu="hdrs",LI="useHdrs",Sf="initialize",Tj="setTimeoutOverride",wj="clearTimeoutOverride",vle="payloadPreprocessor",V2="overrideEndpointUrl",$2="avoidOptions",yle="disableEventTimings",ble="stringifyObjects",o0="enableCompoundKey",G2="disableXhrSync",K2="disableFetchKeepAlive",Cle="addNoResponse",Sle="excludeCsMetaData",q2="useSendBeacon",W2="fetchCredentials",Y2="alwaysUseXhrOverride",Ile="unloadTransports",_j="serializeOfflineEvt",Aj="getOfflineRequestDetails",i0="createPayload",DI="createOneDSPayload",Q2="payloadBlob",Ii="headers",xh="_thePayload",J2="urlString",Kr="batches",oo="sendType",jI="addHeader",UI="canSendRequest",Wv="sendQueuedRequests",kj="isCompletelyIdle",FI="setUnloading",Ele="isTenantKilled",hg="resume",xj="sendSynchronousBatch",s0="_transport",Yv="getWParam",X2="isBeacon",Mm="timings",a0="isTeardown",c0="isSync",fg="data",Tle="timeout",l0="_sendReason",Rj="setKillSwitchTenants",Nj="_backOffTransmission",Om="identifier",wle="disableOptimizeObj",_le="ignoreMc1Ms0CookieProcessing",Z2="eventsLimitInMem",eN="autoFlushEventsLimit",Ale="disableAutoBatchFlushLimit",kle="overrideInstrumentationKey",xle="disableTelemetry",u0="baseData",Lm="sendAttempt",Ya="latency",Jl="sync";function Pj(t){var e=(t.ext||{}).intweb;return e&&ia(e[qv])?e[qv]:null}function tN(t){for(var e=null,n=0;e===null&&n<t[Ct];n++)e=Pj(t[n]);return e}var np=function(){function t(e,n){var r=n?[][Rc](n):[],o=this,i=tN(r);o[Ui]=function(){return e},o.Msfpc=function(){return i||ta},o[Un]=function(){return r[Ct]},o[bc]=function(){return r},o.addEvent=function(s){return s?(r[xr](s),i||(i=Pj(s)),!0):!1},o[Vu]=function(s,a){var l;if(s<r[Ct]){var u=r[Ct]-s;Jt(a)||(u=a<u?a:u),l=r[_b](s,u),i=tN(r)}return new t(e,l)}}return t.create=function(e,n){return new t(e,n)},t}(),Rle=function(){function t(){var e=!0,n=!0,r=!0,o="use-collector-delta",i=!1;fn(t,this,function(s){s[PI]=function(){return e},s[Sj]=function(){r&&(r=!1,i||(e=!1))},s[Ij]=function(){return n},s[Ej]=function(){return o},s[MI]=function(a){i||(a?(o=a,n=!0,i=!0):n=!1,e=!0)}})}return t.__ieDyn=1,t}(),Nle=1e3,Ple=function(){function t(){var e={};function n(r){var o=[];return r&&Xe(r,function(i){o[xr](Qr(i))}),o}fn(t,this,function(r){r[Rj]=function(o,i){if(o&&i)try{var s=n(o[Vu](","));if(i==="this-request-only")return s;for(var a=parseInt(i,10)*Nle,l=0;l<s[Ct];++l)e[s[l]]=_a()+a}catch{return[]}return[]},r[Ele]=function(o){var i=e,s=Qr(o);return i[s]!==void 0&&i[s]>_a()?!0:(delete i[s],!1)}})}return t.__ieDyn=1,t}(),Mle=.8,Ole=1.2,nN=3e3,Lle=6e5;function Dle(t){return!(t>=300&&t<500&&t!=429||t==501||t==505)}function Mj(t){var e=0,n=nN*Mle,r=nN*Ole,o=Math.floor(Math.random()*(r-n))+n;return e=Math.pow(2,t)*o,Math.min(e,Lle)}var jle=20,Ule=3984588,Oj=65e3,Lj=2e6,Fle=Math.min(Lj,Oj),rN="metadata",Dm="f",Ble=/\./,Hle=function(){function t(e,n,r,o,i,s){var a="data",l="baseData",u="ext",h=!!o,f=!0,p=n,g={},v=!!s,y=i||cj;fn(t,this,function(b){b.createPayload=function(I,E,T,w,A,_){return{apiKeys:[],payloadBlob:ta,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:I,isTeardown:E,isSync:T,isBeacon:w,sendType:_,sendReason:A}},b.appendPayload=function(I,E,T){var w=I&&E&&!I.overflow;return w&&qr(e,function(){return"Serializer:appendPayload"},function(){for(var A=E.events(),_=I.payloadBlob,L=I.numEvents,N=!1,K=[],q=[],ae=I.isBeacon,O=ae?Oj:Ule,W=ae?Fle:Lj,te=0,D=0;te<A.length;){var G=A[te];if(G){if(L>=T){I.overflow=E.split(te);break}var re=b.getEventBlob(G);if(re&&re.length<=W){var J=re.length,ne=_.length;if(ne+J>O){I.overflow=E.split(te);break}_&&(_+=`
`),_+=re,D++,D>jle&&(hu(_,0,1),D=0),N=!0,L++}else re?K.push(G):q.push(G),A.splice(te,1),te--}te++}if(K.length>0&&I.sizeExceed.push(np.create(E.iKey(),K)),q.length>0&&I.failedEvts.push(np.create(E.iKey(),q)),N){I.batches.push(E),I.payloadBlob=_,I.numEvents=L;var X=E.iKey();Bo(I.apiKeys,X)===-1&&I.apiKeys.push(X)}},function(){return{payload:I,theBatch:{iKey:E.iKey(),evts:E.events()},max:T}}),w},b.getEventBlob=function(I){try{return qr(e,function(){return"Serializer.getEventBlob"},function(){var E={};E.name=I.name,E.time=I.time,E.ver=I.ver,E.iKey="o:"+zae(I.iKey);var T={},w;v||(w=function(N,K,q){zle(y,T,N,K,q)});var A=I[u];A&&(E[u]=T,nn(A,function(N,K){var q=T[N]={};S(K,q,"ext."+N,!0,null,null,!0)}));var _=E[a]={};_.baseType=I.baseType;var L=_[l]={};return S(I.baseData,L,l,!1,[l],w,f),S(I.data,_,a,!1,[],w,f),JSON.stringify(E)},function(){return{item:I}})}catch{return null}};function C(I,E){var T=g[I];return T===void 0&&(I.length>=7&&(T=NR(I,"ext.metadata")||NR(I,"ext.web")),g[I]=T),T}function S(I,E,T,w,A,_,L){nn(I,function(N,K){var q=null;if(K||ia(K)){var ae=T,O=N,W=A,te=E;if(h&&!w&&Ble.test(N)){var D=N.split("."),G=D.length;if(G>1){W&&(W=W.slice());for(var re=0;re<G-1;re++){var J=D[re];te=te[J]=te[J]||{},ae+="."+J,W&&W.push(J)}O=D[G-1]}}var ne=w&&C(ae);if(!ne&&p&&p.handleField(ae,O)?q=p.value(ae,O,K,r):q=$ae(O,K,r),q){var X=q.value;if(te[O]=X,_&&_(W,O,q),typeof X=="object"&&!kt(X)){var Ie=W;Ie&&(Ie=Ie.slice(),Ie.push(O)),S(K,X,ae+"."+O,w,Ie,_)}}}})}})}return t.__ieDyn=1,t}();function zle(t,e,n,r,o){if(o&&e){var i=t(o.value,o.kind,o.propertyType);if(i>-1){var s=e[rN];s||(s=e[rN]={f:{}});var a=s[Dm];if(a||(a=s[Dm]={}),n)for(var l=0;l<n.length;l++){var u=n[l];a[u]||(a[u]={f:{}});var h=a[u][Dm];h||(h=a[u][Dm]={}),a=h}a=a[r]={},kt(o.value)?a.a={t:i}:a.t=i}}}function Qv(t,e){return{set:function(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return wie([t,e],n,r,o)}}}var Qa,d0="sendAttempt",Vle="&"+gle+"=true",$le="?cors=true&"+Jh[OI]()+"="+_I,Gle=(Qa={},Qa[1]=U2,Qa[100]=U2,Qa[200]="sent",Qa[8004]=wI,Qa[8003]=wI,Qa),BI={},HI={};function Cl(t,e,n){BI[t]=e,n!==!1&&(HI[e]=t)}Cl(NI,NI,!1);Cl(AI,AI);Cl(Cj,"Client-Id");Cl(RI,RI);Cl(kI,kI);Cl(xI,xI);Cl(H2,H2);function jm(t,e){var n=!1;if(t&&e){var r=Cs(t);if(r&&r[Ct]>0)for(var o=e[OI](),i=0;i<r[Ct];i++){var s=r[i];if(s&&Fo(e,s)&&s[OI]()===o){n=!0;break}}}return n}function Xl(t,e,n,r){e&&n&&n[Ct]>0&&(r&&BI[e]?(t[gu][BI[e]]=n,t[LI]=!0):t.url+="&"+e+"="+n)}function Kle(t,e,n){for(var r=0;r<t[Ct];r++)if(t[r].name===e){t[r].value=n;return}t[xr]({name:e,value:n})}function qle(t,e){for(var n=0;n<t[Ct];n++)if(t[n].name===e){t[_b](n,1);return}}var Wle=function(){function t(e,n,r,o){var i,s,a,l,u=!1,h,f,p,g,v,y,b,C,S,I,E,T,w,A,_,L,N,K,q,ae,O,W,te,D,G,re,J,ne;fn(t,this,function(X){Me();var Ie=!0;X[Sf]=function(V,ye,_e){D||(v=ye,T=ye.getCookieMgr(),f=_e,p=f.diagLog(),la(ae,Ir(V,function(Pe){var We,ut=Pe.cfg,He=Pe.cfg.extensionConfig[_e.identifier];G=Qv(He[Tj],He[wj]),ia(ut.anonCookieName)?Kle(b,"anoncknm",ut.anonCookieName):qle(b,"anoncknm"),O=He[vle],W=He.payloadListener;var F=He.httpXHROverride,oe=He[V2]?He[V2]:ut.endpointUrl;i=oe+$le,A=Qt(He[$2])?!0:!He[$2],E=!He[yle];var de=He.valueSanitizer,je=He[ble],Le=!!ut[o0];Qt(He[o0])||(Le=!!He[o0]),_=He.xhrTimeout,L=!!He[G2],N=!!He[K2],q=He[Cle]!==!1,re=!!He[Sle],ye.getPlugin("LocalStorage")&&(N=!0),u=!hI(),I=new Hle(v,de,je,Le,cj,re),Jt(He[q2])||(u=!!He[q2]),He[W2]&&(ne=He[W2]);var Je=be();J?J.SetConfig(Je):(J=new wae,J[Sf](Je,p));var dt=F,ct=He[Y2]?F:null,st=He[Y2]?F:null,dr=[3,2];if(!F){y=!1;var Gn=[];hI()?(Gn=[2,1],dr=[2,1,3]):Gn=[1,2,3],Gn=XR(Gn,He.transports),F=Ce(Gn,!1),F||vf(p,"No available transport to send events"),dt=Ce(Gn,!0)}ct||(dr=XR(dr,He[Ile]),ct=Ce(dr,!0)),K=!y&&(u&&I6()||!N&&E6(!0)),g=(We={},We[0]=F,We[1]=dt||Ce([1,2,3],!0),We[2]=ct||dt||Ce([1],!0),We[3]=st||Ce([2,3],!0)||dt||Ce([1],!0),We)})),D=!0)},X.addResponseHandler=function(V){return te[xr](V),{rm:function(){var ye=te.indexOf(V);ye>=0&&te[_b](ye,1)}}},X[_j]=function(V){try{if(I)return I.getEventBlob(V)}catch{}return ta},X[Aj]=function(){try{var V=I&&I[i0](0,!1,!1,!1,1,0);return Z(V,A)}catch{}return null},X[DI]=function(V,ye){try{var _e=[];Xe(V,function(F){ye&&(F=mu(F));var oe=np.create(F[Ui],[F]);_e[xr](oe)});for(var Pe=null;_e[Ct]>0&&I;){var We=_e.shift();We&&We[Un]()>0&&(Pe=Pe||I[i0](0,!1,!1,!1,1,0),I.appendPayload(Pe,We,e))}var ut=Z(Pe,A),He={data:Pe[Q2],urlString:ut.url,headers:ut[gu],timeout:_,disableXhrSync:L,disableFetchKeepAlive:N};return A&&(jm(He[Ii],Pm)||(He[Ii][Pm]=F2),jm(He[Ii],Jh)||(He[Ii][Jh]=_I)),He}catch{}return null};function Ce(V,ye){try{return J&&J.getSenderInst(V,ye)}catch{}return null}X._getDbgPlgTargets=function(){return[g[0],s,I,g,be(),i]};function be(){try{var V={xdrOnComplete:ue,fetchOnComplete:Ye,xhrOnComplete:le,beaconOnRetry:Ke},ye={enableSendPromise:!1,isOneDs:!0,disableCredentials:!Ie,fetchCredentials:ne,disableXhr:!1,disableBeacon:!u,disableBeaconSync:!u,disableFetchKeepAlive:N,timeWrapper:G,addNoResponse:q,senderOnCompleteCallBack:V};return ye}catch{}return null}function ue(V,ye,_e){var Pe=Cd(V);we(ye,200,{},Pe),Wt(Pe)}function Me(){var V;i=null,s=new Ple,a=!1,l=new Rle,u=!1,h=0,f=null,p=null,g=null,v=null,y=!0,b=[],C={},S=[],I=null,E=!1,T=null,w=!1,A=!1,_=V,L=V,N=V,K=V,q=V,ae=[],O=V,W=V,te=[],D=!1,G=Qv(),re=!1,J=null}function Ye(V,ye,_e,Pe){var We=function(F,oe,de){we(ye,F,oe,de),Wt(de)},ut={},He=V[Ii];He&&He.forEach(function(F,oe){ut[oe]=F}),We(V.status,ut,_e||ta)}function le(V,ye,_e){var Pe=Cd(V);we(ye,V.status,ag(V,!0),Pe),Wt(Pe)}function we(V,ye,_e,Pe){try{V(ye,_e,Pe)}catch(We){en(p,2,518,Ot(We))}}function Ke(V,ye,_e){var Pe=V,We=200,ut=Pe[xh],He=V[J2]+(q?Vle:ta);try{var F=es();if(ut){var oe=!!v.getPlugin("LocalStorage"),de=[],je=[];Xe(ut[Kr],function(Le){if(de&&Le&&Le[Un]()>0)for(var Je=Le[bc](),dt=0;dt<Je[Ct];dt++)if(F.sendBeacon(He,I.getEventBlob(Je[dt])))je[xr](Le[dt]);else{de[xr](Le[Vu](dt));break}else de[xr](Le[Vu](0))}),je[Ct]>0&&(ut.sentEvts=je),oe||Yt(de,8003,ut[oo],!0)}else We=0}catch(Le){vf(p,"Failed to send telemetry using sendBeacon API. Ex:"+Ot(Le)),We=0}finally{we(ye,We,{},ta)}}function k(V){return V===2||V===3}function B(V){return w&&k(V)&&(V=2),V}X[jI]=function(V,ye){C[V]=ye},X.removeHeader=function(V){delete C[V]},X[UI]=function(){return ge()&&l[PI]()},X[Wv]=function(V,ye){Qt(V)&&(V=0),w&&(V=B(V),ye=2),Q(S,V,0)&&z(M(),0,!1,V,ye||0)},X[kj]=function(){return!a&&h===0&&S[Ct]===0},X[FI]=function(V){w=V},X.addBatch=function(V){if(V&&V[Un]()>0){if(s.isTenantKilled(V[Ui]()))return!1;S[xr](V)}return!0},X.teardown=function(){S[Ct]>0&&z(M(),0,!0,2,2),Xe(ae,function(V){V&&V.rm&&V.rm()}),ae=[]},X.pause=function(){a=!0},X[hg]=function(){a=!1,X[Wv](0,4)},X[xj]=function(V,ye,_e){V&&V[Un]()>0&&(Jt(ye)&&(ye=1),w&&(ye=B(ye),_e=2),z([V],0,!1,ye,_e||0))};function ge(){return!a&&h<n}function M(){var V=S;return S=[],V}function Q(V,ye,_e){var Pe=!1;return V&&V[Ct]>0&&!a&&g[ye]&&I&&(Pe=ye!==0||ge()&&(_e>0||l[PI]())),Pe}function fe(V){var ye={};return V&&Xe(V,function(_e,Pe){ye[Pe]={iKey:_e[Ui](),evts:_e[bc]()}}),ye}function z(V,ye,_e,Pe,We){if(!(!V||V[Ct]===0)){if(a){Yt(V,1,Pe);return}Pe=B(Pe);try{var ut=V,He=Pe!==0;qr(v,function(){return"HttpManager:_sendBatches"},function(F){F&&(V=V.slice(0));for(var oe=[],de=null,je=Ai(),Le=g[Pe]||(He?g[1]:g[0]),Je=Le&&Le[s0],dt=K&&(w||k(Pe)||Je===3||Le._isSync&&Je===2);Q(V,Pe,ye);){var ct=V.shift();ct&&ct[Un]()>0&&(s.isTenantKilled(ct[Ui]())?oe[xr](ct):(de=de||I[i0](ye,_e,He,dt,We,Pe),I.appendPayload(de,ct,e)?de.overflow!==null&&(V=[de.overflow][Rc](V),de.overflow=null,tt(de,je,Ai(),We),je=Ai(),de=null):(tt(de,je,Ai(),We),je=Ai(),V=[ct][Rc](V),de=null)))}de&&tt(de,je,Ai(),We),V[Ct]>0&&(S=V[Rc](S)),Yt(oe,8004,Pe)},function(){return{batches:fe(ut),retryCount:ye,isTeardown:_e,isSynchronous:He,sendReason:We,useSendBeacon:k(Pe),sendType:Pe}},!He)}catch(F){en(p,2,48,"Unexpected Exception sending batch: "+Ot(F))}}}function Z(V,ye){var _e={url:i,hdrs:{},useHdrs:!1};ye?(_e[gu]=Gv(_e[gu],C),_e.useHdrs=Cs(_e.hdrs)[Ct]>0):nn(C,function(F,oe){HI[F]?Xl(_e,HI[F],oe,!1):(_e[gu][F]=oe,_e[LI]=!0)}),Xl(_e,Cj,"NO_AUTH",ye),Xl(_e,AI,sj,ye);var Pe=ta;Xe(V.apiKeys,function(F){Pe[Ct]>0&&(Pe+=","),Pe+=F}),Xl(_e,RI,Pe,ye),Xl(_e,xI,_a().toString(),ye);var We=qt(V);if(ia(We)&&(_e.url+="&ext.intweb.msfpc="+We),l[Ij]()&&Xl(_e,kI,l[Ej](),ye),v[Yv]){var ut=v[Yv]();ut>=0&&(_e.url+="&w="+ut)}for(var He=0;He<b[Ct];He++)_e.url+="&"+b[He].name+"="+b[He].value;return _e}function Ee(V,ye,_e){V[ye]=V[ye]||{},V[ye][f.identifier]=_e}function tt(V,ye,_e,Pe){if(V&&V.payloadBlob&&V.payloadBlob[Ct]>0){var We=!!O,ut=g[V.sendType];!k(V[oo])&&V[X2]&&V.sendReason===2&&(ut=g[2]||g[3]||ut);var He=A;(V.isBeacon||ut[s0]===3)&&(He=!1);var F=Z(V,He);He=He||F[LI];var oe=Ai();qr(v,function(){return"HttpManager:_doPayloadSend"},function(){for(var de=0;de<V.batches[Ct];de++)for(var je=V[Kr][de],Le=je[bc](),Je=0;Je<Le[Ct];Je++){var dt=Le[Je];if(E){var ct=dt[Mm]=dt[Mm]||{};Ee(ct,"sendEventStart",oe),Ee(ct,"serializationStart",ye),Ee(ct,"serializationCompleted",_e)}dt[d0]>0?dt[d0]++:dt[d0]=1}Yt(V[Kr],1e3+(Pe||0),V[oo],!0);var st={data:V[Q2],urlString:F.url,headers:F[gu],_thePayload:V,_sendReason:Pe,timeout:_,disableXhrSync:L,disableFetchKeepAlive:N};He&&(jm(st[Ii],Pm)||(st[Ii][Pm]=F2),jm(st[Ii],Jh)||(st[Ii][Jh]=_I));var dr=null;ut&&(dr=function(Gn){l[Sj]();var hr=function(rs,rh){mt(rs,rh,V,Pe)},Rn=V[a0]||V[c0];try{ut.sendPOST(Gn,hr,Rn),W&&W(st,Gn,Rn,V[X2])}catch(rs){vf(p,"Unexpected exception sending payload. Ex:"+Ot(rs)),we(hr,0,{})}}),qr(v,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(dr)if(V[oo]===0&&h++,We&&!V.isBeacon&&ut[s0]!==3){var Gn={data:st[fg],urlString:st[J2],headers:Gv({},st[Ii]),timeout:st[Tle],disableXhrSync:st[G2],disableFetchKeepAlive:st[K2]},hr=!1;qr(v,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{O(Gn,function(Rn){hr=!0,!y&&!Rn[xh]&&(Rn[xh]=Rn[xh]||st[xh],Rn[l0]=Rn[l0]||st[l0]),dr(Rn)},V.isSync||V[a0])}catch{hr||dr(st)}})}else dr(st)})},function(){return{thePayload:V,serializationStart:ye,serializationCompleted:_e,sendReason:Pe}},V[c0])}V.sizeExceed&&V.sizeExceed[Ct]>0&&Yt(V.sizeExceed,8003,V[oo]),V.failedEvts&&V.failedEvts[Ct]>0&&Yt(V.failedEvts,8002,V[oo])}function ht(V,ye){E&&Xe(V,function(_e){var Pe=_e[Mm]=_e[Mm]||{};Ee(Pe,"sendEventCompleted",ye)})}function mt(V,ye,_e,Pe){var We=9e3,ut=null,He=!1,F=!1;try{var oe=!0;if(typeof V!==Yw){if(ye){l[MI](ye[mle]);var de=ye[ple]||ye["kill-duration-seconds"];Xe(s[Rj](ye[fle],de),function(Le){Xe(_e[Kr],function(Je){if(Je[Ui]()===Le){ut=ut||[];var dt=Je[Vu](0);_e.numEvents-=dt[Un](),ut[xr](dt)}})})}if(V==200||V==204){We=200;return}(!Dle(V)||_e.numEvents<=0)&&(oe=!1),We=9e3+V%1e3}if(oe){We=100;var je=_e.retryCnt;_e[oo]===0&&(je<r?(He=!0,xt(function(){_e[oo]===0&&h--,z(_e[Kr],je+1,_e[a0],w?2:_e[oo],5)},w,Mj(je))):(F=!0,w&&(We=8001)))}}finally{He||(l[MI](),Ve(_e,We,Pe,F)),Yt(ut,8004,_e[oo])}}function Ve(V,ye,_e,Pe){try{Pe&&f[Nj]();var We=V[Kr];ye===200&&(We=V.sentEvts||V[Kr],!Pe&&!V[c0]&&f._clearBackOff(),rt(We)),Yt(We,ye,V[oo],!0)}finally{V[oo]===0&&(h--,_e!==5&&X.sendQueuedRequests(V[oo],_e))}}function rt(V){if(E){var ye=Ai();Xe(V,function(_e){_e&&_e[Un]()>0&&ht(_e[bc](),ye)})}}function xt(V,ye,_e){ye?V():G.set(V,_e)}function qt(V){for(var ye=0;ye<V.batches[Ct];ye++){var _e=V[Kr][ye].Msfpc();if(_e)return encodeURIComponent(_e)}return ta}function Wt(V){var ye=te;try{for(var _e=0;_e<ye[Ct];_e++)try{ye[_e](V)}catch(We){en(p,1,519,"Response handler failed: "+We)}if(V){var Pe=JSON.parse(V);ia(Pe.webResult)&&ia(Pe.webResult[qv])&&T.set("MSFPC",Pe.webResult[qv],365*86400)}}catch{}}function Yt(V,ye,_e,Pe){if(V&&V[Ct]>0&&o){var We=o[nr(ye)];if(We){var ut=_e!==0;qr(v,function(){return"HttpManager:_sendBatchesNotification"},function(){xt(function(){try{We.call(o,V,ye,ut,_e)}catch(He){en(p,1,74,"send request notification failed: "+He)}},Pe||ut,0)},function(){return{batches:fe(V),reason:ye,isSync:ut,sendSync:Pe,sendType:_e}},!ut)}}}function nr(V){var ye=Gle[V];return ia(ye)||(ye=hle,V>=9e3&&V<=9999?ye=dle:V>=8e3&&V<=8999?ye=wI:V>=1e3&&V<=1999&&(ye=ule)),ye}})}return t.__ieDyn=1,t}(),Yle=.25,oN=500,Qle=20,Dj=6,jj=2,Jle=4,iN=2,Xle=1,zI=1e4,Ja="eventsDiscarded",sN="",Pn=void 0,Zle=zd({eventsLimitInMem:{isVal:bf,v:zI},immediateEventLimit:{isVal:bf,v:500},autoFlushEventsLimit:{isVal:bf,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:eue,v:Pn},overrideInstrumentationKey:Pn,overrideEndpointUrl:Pn,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:Pn,clearTimeoutOverride:Pn,payloadPreprocessor:Pn,payloadListener:Pn,disableEventTimings:Pn,valueSanitizer:Pn,stringifyObjects:Pn,enableCompoundKey:Pn,disableOptimizeObj:!1,fetchCredentials:Pn,transports:Pn,unloadTransports:Pn,useSendBeacon:Pn,disableFetchKeepAlive:Pn,avoidOptions:!1,xhrTimeout:Pn,disableXhrSync:Pn,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:Ta,v:Dj},maxUnloadEventRetryAttempts:{isVal:Ta,v:jj},addNoResponse:Pn,excludeCsMetaData:Pn});function eue(t){return t&&t.sendPOST}var tue=function(t){kp(e,t);function e(){var n=t.call(this)||this;n.identifier="PostChannel",n.priority=1011,n.version="4.3.3";var r,o=!1,i=[],s,a=!1,l=0,u,h=0,f,p={},g=Nm,v,y,b,C,S,I,E,T,w,A,_,L,N,K,q,ae,O,W,te,D,G,re;return fn(e,n,function(J,ne){B(),J._getDbgPlgTargets=function(){return[S,r]},J[Sf]=function(F,oe,de){qr(oe,function(){return"PostChannel:initialize"},function(){ne[Sf](F,oe,de),te=oe.getNotifyMgr();try{q=Pp(Gd(J[Om]),oe.evtNamespace&&oe.evtNamespace()),J._addHook(Ir(F,function(je){var Le=je.cfg,Je=Xc(null,Le,oe);r=Je.getExtCfg(J[Om],Zle),ae=Qv(r[Tj],r[wj]),_=!r[wle]&&Yae(),O=r[_le],Ie(oe),f=r[Z2],u=r.immediateEventLimit,E=r[eN],N=r.maxEventRetryAttempts,K=r.maxUnloadEventRetryAttempts,W=r[Ale],gd(Le.endpointUrl)?J.pause():a&&J[hg](),He(),G=r[kle],re=!!r[xle],D&&X();var dt=Le.disablePageUnloadEvents||[];D=Lae(ue,dt,q),D=oj(ue,dt,q)||D,D=ij(Me,Le.disablePageShowEvents,q)||D})),S[Sf](F,J.core,J)}catch(je){throw J.setInitialized(!1),je}},function(){return{theConfig:F,core:oe,extensions:de}})},J.processTelemetry=function(F,oe){II(F,J[Om]),oe=oe||J._getTelCtx(oe);var de=F;!re&&!o&&(G&&(de[Ui]=G),le(de,!0),L?Q(2,2):k()),J.processNext(de,oe)},J.getOfflineSupport=function(){try{var F=S&&S[Aj]();if(S)return{getUrl:function(){return F?F.url:null},serialize:be,batch:Ce,shouldProcess:function(oe){return!re},createPayload:function(oe){return null},createOneDSPayload:function(oe){if(S[DI])return S[DI](oe,_)}}}catch{}return null},J._doTeardown=function(F,oe){Q(2,2),o=!0,S.teardown(),X(),B()};function X(){Dae(null,q),jae(null,q),Uae(null,q)}function Ie(F){var oe=F[Yv];F[Yv]=function(){var de=0;return O&&(de=de|2),de|oe.call(F)}}function Ce(F){var oe=sN;return F&&F[Ct]&&Xe(F,function(de){oe&&(oe+=`
`),oe+=de}),oe}function be(F){var oe=sN;try{Ye(F),oe=S[_j](F)}catch{}return oe}function ue(F){var oe=F||Ua().event;oe.type!=="beforeunload"&&(L=!0,S[FI](L)),Q(2,2)}function Me(F){L=!1,S[FI](L)}function Ye(F){F.ext&&F.ext[z2]&&delete F.ext[z2],F.ext&&F.ext[r0]&&F.ext[r0].id&&delete F.ext[r0].id,_&&(F.ext=mu(F.ext),F[u0]&&(F[u0]=mu(F[u0])),F[fg]&&(F[fg]=mu(F[fg])))}function le(F,oe){if(F[Lm]||(F[Lm]=0),F[Ya]||(F[Ya]=1),Ye(F),F[Jl]){if(b||a)F[Ya]=3,F[Jl]=!1;else if(S){_&&(F=mu(F)),S[xj](np.create(F[Ui],[F]),F[Jl]===!0?1:F[Jl],3);return}}var de=F[Ya],je=h,Le=f;de===4&&(je=l,Le=u);var Je=!1;if(je<Le)Je=!Ee(F,oe);else{var dt=1,ct=Qle;de===4&&(dt=4,ct=1),Je=!0,tt(F[Ui],F[Ya],dt,ct)&&(Je=!Ee(F,oe))}Je&&nr(Ja,[F],Ka.QueueFull)}J.setEventQueueLimits=function(F,oe){r[Z2]=f=bf(F)?F:zI,r[eN]=E=bf(oe)?oe:0,He();var de=h>F;if(!de&&T>0)for(var je=1;!de&&je<=3;je++){var Le=I[je];Le&&Le[Kr]&&Xe(Le[Kr],function(Je){Je&&Je[Un]()>=T&&(de=!0)})}Z(!0,de)},J.pause=function(){M(),a=!0,S&&S.pause()},J[hg]=function(){a=!1,S&&S[hg](),k()},J._loadTransmitProfiles=function(F){xt(),nn(F,function(oe,de){var je=de[Ct];if(je>=2){var Le=je>2?de[2]:0;if(de[_b](0,je-2),de[1]<0&&(de[0]=-1),de[1]>0&&de[0]>0){var Je=de[0]/de[1];de[0]=Math.ceil(Je)*de[1]}Le>=0&&de[1]>=0&&Le>de[1]&&(Le=de[1]),de[xr](Le),p[oe]=de}})},J.flush=function(F,oe,de){F===void 0&&(F=!0);var je;if(!a)if(de=de||1,F)oe||(je=Jc(function(Je){oe=Je})),s==null?(M(),mt(1,0,de),s=ge(function(){s=null,Ve(oe,de)},0)):i[xr](oe);else{var Le=M();we(1,1,de),oe&&oe(),Le&&k()}return je},J.setMsaAuthTicket=function(F){S[jI](NI,F)},J.setAuthPluginHeader=function(F){S[jI](B2,F)},J.removeAuthPluginHeader=function(){S.removeHeader(B2)},J.hasEvents=Ke,J._setTransmitProfile=function(F){g!==F&&p[F]!==void 0&&(M(),g=F,k())},v6(J,function(){return S},["addResponseHandler"]);function we(F,oe,de){var je=mt(F,oe,de);return S[Wv](oe,de),je}function Ke(){return h>0}function k(){if(w>=0&&mt(w,0,A)&&S[Wv](0,A),l>0&&!y&&!a){var F=p[g][2];F>=0&&(y=ge(function(){y=null,we(4,0,1),k()},F))}var oe=p[g][1];!v&&!s&&oe>=0&&!a&&(Ke()?v=ge(function(){v=null,we(C===0?3:1,0,1),C++,C%=2,k()},oe):C=0)}J[Nj]=function(){b<Jle&&(b++,M(),k())},J._clearBackOff=function(){b&&(b=0,M(),k())};function B(){r=null,o=!1,i=[],s=null,a=!1,l=0,u=500,h=0,f=zI,p={},g=Nm,v=null,y=null,b=0,C=0,I={},E=0,D=!1,T=0,w=-1,A=null,_=!0,L=!1,N=Dj,K=jj,q=null,G=null,re=!1,ae=Qv(),S=new Wle(oN,iN,Xle,{requeue:Wt,send:ye,sent:_e,drop:Pe,rspFail:We,oth:ut}),qt(),fe(),He()}function ge(F,oe){oe===0&&b&&(oe=1);var de=1e3;return b&&(de=Mj(b-1)),ae.set(F,oe*de)}function M(){return v!==null?(v.cancel(),v=null,C=0,!0):!1}function Q(F,oe){M(),s&&(s.cancel(),s=null),a||we(1,F,oe)}function fe(){I[4]={batches:[],iKeyMap:{}},I[3]={batches:[],iKeyMap:{}},I[2]={batches:[],iKeyMap:{}},I[1]={batches:[],iKeyMap:{}}}function z(F,oe,de){var je=I[oe];je||(oe=1,je=I[oe]);var Le=je.iKeyMap[F];return!Le&&de&&(Le=np.create(F),je.batches[xr](Le),je.iKeyMap[F]=Le),Le}function Z(F,oe){S[UI]()&&!b&&(E>0&&h>E&&(oe=!0),oe&&s==null&&J.flush(F,function(){},20))}function Ee(F,oe){_&&(F=mu(F));var de=F[Ya],je=z(F[Ui],de,!0);return je.addEvent(F)?(de!==4?(h++,oe&&F[Lm]===0&&Z(!F.sync,T>0&&je[Un]()>=T)):l++,!0):!1}function tt(F,oe,de,je){for(;de<=oe;){var Le=z(F,oe,!0);if(Le&&Le[Un]()>0){var Je=Le[Vu](0,je),dt=Je[Un]();if(dt>0)return de===4?l-=dt:h-=dt,V(Ja,[Je],Ka.QueueFull),!0}de++}return ht(),!1}function ht(){for(var F=0,oe=0,de=function(Le){var Je=I[Le];Je&&Je[Kr]&&Xe(Je[Kr],function(dt){Le===4?F+=dt[Un]():oe+=dt[Un]()})},je=1;je<=4;je++)de(je);h=oe,l=F}function mt(F,oe,de){var je=!1,Le=oe===0;return!Le||S[UI]()?qr(J.core,function(){return"PostChannel._queueBatches"},function(){for(var Je=[],dt=4;dt>=F;){var ct=I[dt];ct&&ct.batches&&ct.batches[Ct]>0&&(Xe(ct[Kr],function(st){S.addBatch(st)?je=je||st&&st[Un]()>0:Je=Je[Rc](st[bc]()),dt===4?l-=st[Un]():h-=st[Un]()}),ct[Kr]=[],ct.iKeyMap={}),dt--}Je[Ct]>0&&nr(Ja,Je,Ka.KillSwitch),je&&w>=F&&(w=-1,A=0)},function(){return{latency:F,sendType:oe,sendReason:de}},!Le):(w=w>=0?Math.min(w,F):F,A=Math.max(A,de)),je}function Ve(F,oe){we(1,0,oe),ht(),rt(function(){F&&F(),i[Ct]>0?s=ge(function(){s=null,Ve(i.shift(),oe)},0):(s=null,k())})}function rt(F){S[kj]()?F():s=ge(function(){s=null,rt(F)},Yle)}function xt(){M(),qt(),g=Nm,k()}function qt(){p={},p[Nm]=[2,1,0],p[cle]=[6,3,0],p[lle]=[18,9,0]}function Wt(F,oe){var de=[],je=N;L&&(je=K),Xe(F,function(Le){Le&&Le[Un]()>0&&Xe(Le[bc](),function(Je){Je&&(Je[Jl]&&(Je[Ya]=4,Je[Jl]=!1),Je[Lm]<je?(II(Je,J[Om]),le(Je,!1)):de[xr](Je))})}),de[Ct]>0&&nr(Ja,de,Ka.NonRetryableStatus),L&&Q(2,2)}function Yt(F,oe){var de=te||{},je=de[F];if(je)try{je.apply(de,oe)}catch(Le){en(J.diagLog(),1,74,F+" notification failed: "+Le)}}function nr(F,oe){for(var de=[],je=2;je<arguments.length;je++)de[je-2]=arguments[je];oe&&oe[Ct]>0&&Yt(F,[oe][Rc](de))}function V(F,oe){for(var de=[],je=2;je<arguments.length;je++)de[je-2]=arguments[je];oe&&oe[Ct]>0&&Xe(oe,function(Le){Le&&Le[Un]()>0&&Yt(F,[Le.events()][Rc](de))})}function ye(F,oe,de){F&&F[Ct]>0&&Yt("eventsSendRequest",[oe>=1e3&&oe<=1999?oe-1e3:0,de!==!0])}function _e(F,oe){V("eventsSent",F,oe),k()}function Pe(F,oe){V(Ja,F,oe>=8e3&&oe<=8999?oe-8e3:Ka.Unknown)}function We(F){V(Ja,F,Ka.NonRetryableStatus),k()}function ut(F,oe){V(Ja,F,Ka.Unknown),k()}function He(){W?T=0:T=Math.max(oN*(iN+1),f/6)}}),n}return e.__ieDyn=1,e}(T_),nue=zd({cookieCfg:{ref:!0,v:{}},extensions:{rdOnly:!0,ref:!0,v:[]},channels:{rdOnly:!0,ref:!0,v:[]},extensionConfig:{ref:!0,v:{}}}),Uj=function(t){kp(e,t);function e(){var n=t.call(this)||this,r,o;return fn(e,n,function(i,s){i.initialize=function(a,l){var u=n;qr(n,function(){return"ApplicationInsights:initialize"},function(){a=yo(a,nue,u.logger,!1).cfg,r=new tue,o=new ale;var h=[o];l&&(h=h.concat(l)),a||Ao("You must provide a config object!");var f=a.channels;if(f&&f.length>0){for(var p=!1,g=0;g<f[0].length;g++)if(f[0][g].identifier===r.identifier){p=!0;break}p||la(f[0],r)}else a.channels.push([r]);var v=a.extensionConfig;v[r.identifier]=v[r.identifier]||a&&a.channelConfiguration||{},v[o.identifier]=v[o.identifier]||a&&a.propertyConfiguration||{};try{s.initialize(a,h),u.isInitialized()&&G4(a,{channelConfiguration:{g:function(){return a.extensionConfig[r.identifier]}},propertyConfiguration:{g:function(){return a.extensionConfig[o.identifier]}}})}catch(y){en(u.logger,1,514,"Failed to initialize SDK."+Ot(y))}},function(){return{config:a,extensions:l}})},i.getPropertyManager=function(){return o},i.getPostChannel=function(){return r}}),n}return e.__ieDyn=1,e}(Xae);/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Fj="msal.request";function pg(t){var e;try{return new gv(((e=t.cache)==null?void 0:e.temporaryCacheLocation)||Tn.SessionStorage)}catch{return new mv}}function VI(t){return`${Fj}.${t}`}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const rue="faab4ead691e451eb230afc98a28e0f2-698cf73d-7930-426b-87d8-d36936f6912f-7401",oue="https://eu-mobile.events.data.microsoft.com/OneCollector/1.0/",aN=`${Fj}.mats-telemetry-profile-id`;class iue{constructor(e,n,r,o){this.logger=e,this.appName=r,this.appVersion=o,this.eventsToEmit=new Set(n),this.sessionId=Oo();const i={instrumentationKey:rue,endpointUrl:oue,extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0};this.appInsightsMATS=new Uj,this.appInsightsMATS.initialize(i,[]),this.logger.verbose("MATSTelemetryReporter: Initialized");try{const s=new gv(Tn.LocalStorage),a=s.getItem(aN);if(a!=null&&a.length)this.profileTelemetryId=a;else{const l=Oo();this.profileTelemetryId=l,s.setItem(aN,l)}}catch{e.warning("MATSTelemetryReporter: local storage is not available"),this.profileTelemetryId=""}}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)){this.logger.verbose(`MATSTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);return}const n={...e,appName:this.appName,appVersion:this.appVersion,libraryName:"MSAL-JS",profileTelemetryId:this.profileTelemetryId,sessionId:this.sessionId};delete n.context,delete n.errorStack;const r={name:"actionmsaljs".concat(e.name.toLowerCase()||""),data:n};this.logger.verbose(`MATSTelemetryReporter: Sending ${r.name} for tracking`),this.appInsightsMATS.track(r),e.name===St.AcquireTokenPreRedirect&&this.appInsightsMATS.flush()}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const sue="d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725";function aue(t){return Math.random()<=t}class cue{constructor(e,n,r){this.synthetic=!1,this.redactionRatio=.1,this.logger=e,this.eventsToEmit=new Set(n);const o={instrumentationKey:sue,extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0};this.appInsights=new Uj,this.appInsights.initialize(o,[]),this.synthetic=r||!1,this.logger.verbose("PerformanceTelemetryReporter: Initialized")}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)){this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);return}let n;!e.success||aue(this.redactionRatio)?(n={...e,appName:void 0,synthetic:this.synthetic},this.logger.verbose(`PerformanceTelemetryReporter: Sending ${n.name} for tracking`)):(n={name:e.name,eventId:e.eventId,correlationId:e.correlationId,requestId:e.requestId,success:e.success,status:e.status,fromCache:e.fromCache,startPageVisibility:e.startPageVisibility,endPageVisibility:e.endPageVisibility,authority:e.authority,durationMs:e.durationMs,startTimeMs:e.startTimeMs,clientId:e.clientId,libraryName:e.libraryName,libraryVersion:e.libraryVersion,accountType:e.accountType,synthetic:this.synthetic,isBroker:e.isBroker,isBackground:e.isBackground},this.logger.verbose(`PerformanceTelemetryReporter: Sending redacted ${n.name} for tracking`));const r={name:e.name,data:n};this.appInsights.track(r),e.name===St.AcquireTokenPreRedirect&&this.appInsights.flush()}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Um=new Set([St.AcquireTokenSilent,St.AcquireTokenByCode,St.AcquireTokenPopup,St.AcquireTokenRedirect,St.AcquireTokenPreRedirect,St.PairwiseBrokerApplicationInitializeBrokering,St.SsoSilent,St.EmbeddedClientApplicationSendSSOSilentRequest,St.EmbeddedClientApplicationSendPopupRequest,St.EmbeddedClientApplicationSendRedirectRequest,St.EmbeddedClientApplicationHandleRedirectRequest,St.EmbeddedClientApplicationSendSilentRefreshRequest]);class lue{constructor(e,n){var o;this.logger=e;const r=((o=n==null?void 0:n.eventsToEmit)==null?void 0:o.filter(i=>Um==null?void 0:Um.has(i)))||[...Um];this.matsTelemetryReporter=n!=null&&n.enableMATS?new iue(e,r,n==null?void 0:n.appName,n==null?void 0:n.appVersion):null,this.perfTelemetryReporter=new cue(e,r,n==null?void 0:n.synthetic)}sendCustomEvent(e){var n;this.perfTelemetryReporter.sendCustomEvent(e),(n=this.matsTelemetryReporter)==null||n.sendCustomEvent(e)}getTelemetryCallback(){this.logger.trace("TelemetryReporter: Attaching callback to send custom metrics.");const e=n=>{n.forEach(r=>{r.name===St.AcquireTokenByBroker&&(r.name=r.brokerEventName||r.name,r.isBroker=!0,delete r.brokerEventName,this.logger.verbosePii(`TelemetryReporter: Updated broker event ${JSON.stringify(r)}`,r.correlationId)),this.sendCustomEvent(r)})};return this.logger.verbose("TelemetryReporter: Returning callback as telemetry emitted."),e}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const uue=[Gf.AzurePublic,Gf.AzurePpe];function due(t){return t.auth.authority?uue.some(e=>{var n;return((n=t.auth.authority)==null?void 0:n.indexOf(e.toString()))===0}):!0}class Mp extends boe{constructor(e,n){var i;let r;const o=typeof window<"u";if(!(n!=null&&n.disabled)&&due(e)&&o?(r=((i=e.telemetry)==null?void 0:i.client)||new Soe(e,new Set(Eoe),new Map(Ioe)),super({...e,telemetry:{...e.telemetry,client:r}})):(super(e),r=new q3),this.performanceClient=r,o){const s=new lue(this.getLogger(),n);this.addPerformanceCallback(s.getTelemetryCallback())}}static async createPublicClientApplication(e,n,r){const o=new Mp(e,n);return await o.initialize({correlationId:r}),o}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Pt={BROKER_READY:"BrokerReady",HANDSHAKE_REQUEST:"BrokerHandshakeRequest",HANDSHAKE_RESPONSE:"BrokerHandshakeResponse",AUTH_REQUEST:"BrokerAuthRequest",REDIRECT_RESPONSE:"BrokerRedirectResponse",HANDLE_REDIRECT_REQUEST:"BrokerHandleRedirectRequest",AUTH_RESULT:"BrokerAuthResult",EMBEDDED_LOGOUT_REQUEST:"EmbeddedLogoutRequest",EMBEDDED_LOGOUT_RESPONSE:"EmbeddedLogoutResponse"},ds={BROKER_AUTH_ERROR_NAME:"BrokerAuthError",INTERACTION_REQ_ERROR_NAME:"InteractionRequiredAuthError",SERVER_ERROR_NAME:"ServerError",CLIENT_AUTH_ERR_NAME:"ClientAuthError",CLIENT_CONFIG_ERROR_NAME:"ClientConfigurationError",BROWSER_AUTH_ERROR_NAME:"BrowserAuthError",BROWSER_CONFIG_ERROR_NAME:"BrowserConfigurationError",AUTH_ERROR_NAME:"AuthError"},hue=2e3,fue=6e3,pue=3e5;/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class fi{constructor(e){this.messageType=e}static validateMessage(e){if(e.data&&e.data.messageType)switch(e.data.messageType){case Pt.HANDSHAKE_REQUEST:case Pt.HANDSHAKE_RESPONSE:case Pt.HANDLE_REDIRECT_REQUEST:case Pt.AUTH_REQUEST:case Pt.AUTH_RESULT:case Pt.REDIRECT_RESPONSE:case Pt.EMBEDDED_LOGOUT_REQUEST:return e;default:return null}else return null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Ab extends fi{constructor(e,n,r=!1,o){super(Pt.HANDSHAKE_REQUEST),this.embeddedClientId=e,this.version=n,this.allowTelemetry=r,this.nonce=o}static validate(e){return e.data&&e.data.messageType===Pt.HANDSHAKE_REQUEST&&e.data.embeddedClientId&&e.data.version?new Ab(e.data.embeddedClientId,e.data.version,e.data.allowTelemetry,e.data.nonce):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class kb extends fi{constructor(e,n,r){super(Pt.HANDSHAKE_RESPONSE),this.version=e,this.brokerOrigin=n,this.nonce=r}static validate(e,n){if(!n.includes(e.origin))return null;const r=fi.validateMessage(e);return r&&r.data.messageType===Pt.HANDSHAKE_RESPONSE&&r.data.version?new kb(r.data.version,r.origin,r.data.nonce):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class xb extends fi{get embeddedAppOrigin(){return this._embeddedAppOrigin}constructor(e,n,r,o){super(Pt.AUTH_REQUEST),this.embeddedClientId=e,this._embeddedAppOrigin=o,this.interactionType=n,this.request=r}static validate(e,n){return e.data&&e.data.messageType===Pt.AUTH_REQUEST&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new xb(e.data.embeddedClientId,e.data.interactionType,e.data.request,n):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Rb extends fi{constructor(){super(Pt.REDIRECT_RESPONSE)}static validate(e){return e.data&&e.data.messageType===Pt.REDIRECT_RESPONSE?new Rb:null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Wn={noEmbeddedAppError:{code:"no_embedded_app",desc:"The embedded application object was not created. Please ensure you have configured your application correctly for an embedded application: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/broker-v2/lib/msal-browser/docs/broker.md#brokered-application-configuration"},brokerResponseInvalidError:{code:"broker_response_invalid",desc:"The broker response did not have the expected values."},brokeredPopupRequestRedirecting:{code:"broker_popup_will_redirect",desc:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs."},brokerTimeoutError:{code:"broker_timeout",desc:"Message broker timed out."},brokerHandshakeTimeoutError:{code:"broker_handshake_timeout",desc:"Broker handshake response timed out."},brokerHandshakeFailed:{code:"broker_handshake_failed",desc:"Broker handshake failed. Please see logs for details."},noTrustedBrokersProvided:{code:"no_trusted_brokers_provided",desc:"No trusted brokers provided."},brokeringDisabledError:{code:"brokering_disabled",desc:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed."},shrGenerationError:{code:"shr_generation_error",desc:"Error generating SHRs. Kid is missing in the request."}};class ln extends Et{constructor(e,n){super(e,n),Object.setPrototypeOf(this,ln.prototype),this.name=ds.BROKER_AUTH_ERROR_NAME}static createNoEmbeddedAppError(){return new ln(Wn.noEmbeddedAppError.code,Wn.noEmbeddedAppError.desc)}static createBrokerResponseInvalidError(){return new ln(Wn.brokerResponseInvalidError.code,`${Wn.brokerResponseInvalidError.desc}`)}static createBrokerPopupRequestRedirectingError(){return new ln(Wn.brokeredPopupRequestRedirecting.code,Wn.brokeredPopupRequestRedirecting.desc)}static createNoTrustedBrokersProvidedError(){return new ln(Wn.noTrustedBrokersProvided.code,Wn.noTrustedBrokersProvided.desc)}static createBrokeringDisabledError(){return new ln(Wn.brokeringDisabledError.code,`${Wn.brokeringDisabledError.desc}`)}static createMessageBrokerTimeoutError(){return new ln(Wn.brokerTimeoutError.code,Wn.brokerTimeoutError.desc)}static createMessageBrokerHandshakeTimeoutError(){return new ln(Wn.brokerHandshakeTimeoutError.code,Wn.brokerHandshakeTimeoutError.desc)}static createBrokerHandshakeFailedError(){return new ln(Wn.brokerHandshakeFailed.code,Wn.brokerHandshakeFailed.desc)}static createShrGenerationError(){return new ln(Wn.shrGenerationError.code,Wn.shrGenerationError.desc)}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class xo extends fi{constructor(e,n,r){if(super(Pt.AUTH_RESULT),this.interactionType=e,this.result=n,r){const{setCorrelationId:o,...i}=r;this.errorPayload=i}}static validate(e){return e.data&&e.data.messageType===Pt.AUTH_RESULT&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new xo(e.data.interactionType,e.data.result,e.data.errorPayload):null}static detectError(e){let n;switch(e.name){case ds.INTERACTION_REQ_ERROR_NAME:n=new jr(e.errorCode,e.errorMessage,e.subError);break;case ds.SERVER_ERROR_NAME:n=new Yi(e.errorCode,e.errorMessage,e.subError);break;case ds.CLIENT_AUTH_ERR_NAME:n=new Fd(e.errorCode,e.errorMessage);break;case ds.CLIENT_CONFIG_ERROR_NAME:n=new ib(e.errorCode);break;case ds.BROWSER_AUTH_ERROR_NAME:n=new Bd(e.errorCode);break;case ds.BROWSER_CONFIG_ERROR_NAME:n=new db(e.errorCode,e.errorMessage);break;case ds.BROKER_AUTH_ERROR_NAME:n=new ln(e.errorCode,e.errorMessage);break;case ds.AUTH_ERROR_NAME:n=new Et(e.errorCode,e.errorMessage,e.subError);break;default:n=new Et(Yy,JSON.stringify(e));break}return n.setCorrelationId(e.correlationId),n}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Nb extends fi{constructor(e,n){super(Pt.HANDLE_REDIRECT_REQUEST),this.embeddedClientId=e,this.version=n}static validate(e){return e.data&&e.data.messageType===Pt.HANDLE_REDIRECT_REQUEST&&e.data.embeddedClientId&&e.data.version?new Nb(e.data.embeddedClientId,e.data.version):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function Bj(t){return{...{preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:(t==null?void 0:t.brokerHandshakeTimeout)||hue,brokerMessageTimeout:(t==null?void 0:t.brokerMessageTimeout)||fue,brokerInteractionTimeout:(t==null?void 0:t.brokerInteractionTimeout)||pue},...t}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Pb extends fi{constructor(e,n){super(Pt.EMBEDDED_LOGOUT_REQUEST),this.version=e,this.correlationId=n}static validate(e){const n=fi.validateMessage(e);return n&&n.data&&n.data.version?new Pb(n.data.version,n.data.correlationId):null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function mue(t,e){const n={userState:e,brokerState:{requestOrigin:t.embeddedAppOrigin,requestClientId:t.embeddedClientId}},r=JSON.stringify(n),o=new TextEncoder().encode(r);return window.btoa(Array.from(o,i=>String.fromCodePoint(i)).join(""))}function gue(t){if(!t)return null;try{const e=window.atob(t),n=new Uint8Array(e.length);for(let i=0;i<n.length;i++)n[i]=e.charCodeAt(i);const r=new TextDecoder().decode(n),o=JSON.parse(r);return o.hasOwnProperty("brokerState")?o:null}catch{return null}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const vue="@azure/msal-browser-1p",$u="3.26.0";/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */function Hj(t){const e=t.split("-",1)[0].split(".",3);return{major:parseInt(e[0]),minor:parseInt(e[1]),patch:parseInt(e[2])}}function Zl(t){t.port1.close(),t.port2.close()}function zj(t,e,n,r=20){if(t.length===0||n>r)return[0,n-1];let o=n,i=t.length;for(let s=0;s<t.length;s++){t[s].postMessage(e,"*");const[a,l]=zj(t[s],e,n+1,r);i+=a,l>o&&(o=l)}return[i,o]}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class yue extends Mp{constructor(e,n,r){var o;super(e),this.currentBrokerRedirectResponse=void 0,this.hybridAuthPromise=void 0,this.pwbBrokerAppConfiguration=Bj(n),this.redirectResponseMap=new Map,this.embeddedAppConfigMap=new Map,this.telemetryAllowedEmbeddedClients=new Set,this.logger=new hi(((o=e.system)==null?void 0:o.loggerOptions)||{},vue,$u),this.eventHandler=r,this.messageListener=this.handleBrokerMessage.bind(this)}getRedirectCorrelationId(){const e=`msal.${this.getConfiguration().auth.clientId}`,n=pg(this.getConfiguration()).getItem(`${e}.request.native`);try{if(n){const r=JSON.parse(n);return r&&typeof r=="object"?r.correlationId:null}}catch{this.logger.error("BrokerClientApplication.getRedirectCorrelationId: Unable to parse native request")}return pg(this.getConfiguration()).getItem(`${e}.request.correlationId`)||""}async handleRedirectPromise(e){const n=this.getRedirectCorrelationId(),r=this.performanceClient.startMeasurement(St.AcquireTokenByBroker,n);r.add({brokerEventName:St.AcquireTokenRedirect});try{const o=super.handleRedirectPromise(e);this.currentBrokerRedirectResponse=o;const i=await this.currentBrokerRedirectResponse;if(this.currentBrokerRedirectResponse=void 0,i){const s=gue(i.state);if(this.setActiveAccount(i.account),s){const a={...i,state:s.userState};this.redirectResponseMap.set(s.brokerState.requestOrigin,a),r.add({embeddedClientId:s.brokerState.requestClientId,embeddedRedirectUri:s.brokerState.requestOrigin}),this.endBrokerPerformanceEvent(s.brokerState.requestClientId,r)}else return r.end({success:!0}),i}else r.discard();return null}catch(o){throw o instanceof Et&&o.setCorrelationId(n),r.end({success:!1},o),o}}async listenForBrokerMessage(e,n){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.messageListener),this.broadcastBrokerReadyMessage(window.frames,e,n),e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),this.hybridAuthPromise}broadcastBrokerReadyMessage(e,n,r){this.logger.trace("Broadcasting broker ready message to child frames.");const o={messageType:Pt.BROKER_READY};window.postMessage(o,"*");const[i,s]=zj(e,o,1,n==null?void 0:n.maxChildFrameDepth);r==null||r.add({maxFrameDepthReached:s,framesNotified:i,maxFrameDepthConfigured:n==null?void 0:n.maxChildFrameDepth}),this.logger.trace(`Broadcasted broker ready message to ${i} child frames with a max depth of ${s}`)}stopListeningForBrokerMessage(){this.logger.verbose("stop listening for child broker messages."),window.removeEventListener("message",this.messageListener),this.embeddedAppConfigMap.forEach(([e,n])=>{this.logger.verbose(`closing message port for ${e}`),n.close()}),this.embeddedAppConfigMap.clear()}async handleBrokerMessage(e){var r,o;const n=fi.validateMessage(e);if(!(!n||!n.data.messageType))switch(this.logger.verbose(`Broker received message with type: ${n.data.messageType}`),n.data.messageType){case Pt.HANDSHAKE_REQUEST:return this.handleBrokerHandshake(n);case Pt.HANDLE_REDIRECT_REQUEST:const i=Nb.validate(n);return i?this.handleBrokerRedirectResponse(i,n):void 0;case Pt.AUTH_REQUEST:const s=xb.validate(n,((r=this.embeddedAppConfigMap.get(n.data.embeddedClientId))==null?void 0:r[0])||n.origin);if(!s)return;s.request.correlationId||(s.request.correlationId=Oo());const a=this.performanceClient.startMeasurement(St.AcquireTokenByBroker,s.request.correlationId),l=(o=n.ports)==null?void 0:o[0];try{await this.handleBrokerAuthRequest(s,l),this.endBrokerPerformanceEvent(s.embeddedClientId,a);return}catch(u){throw this.endBrokerPerformanceEvent(s.embeddedClientId,a,u),u}default:return}}isDescendantFrame(e){const n=[];for(n.push(e.sourceFrame);n.length>0;){const r=n.pop();if(r)for(let o=0;o<r.frames.length;o++){const i=r.frames[o];if(i===e.targetFrame)return!0;i!==r&&n.push(i)}}return!1}async handleBrokerHandshake(e){var s,a;if(!(e.source&&e.source.window&&e.source.window===e.source)){this.logger.warning("Broker handshake request validation failed. Message origin is not an iframe");return}const n=e.source;window!==n&&!this.isDescendantFrame({sourceFrame:window,targetFrame:n})&&this.logger.warning("Broker handshake request validation failed. Message origin is not a descendant iframe");const r=Ab.validate(e);if(!r){this.logger.warning("Broker handshake request validation failed. Message may not have come from MSAL.js.");return}const o=Oo(),i=this.performanceClient.startMeasurement(St.BrokerClientApplicationHandleBrokerHandshake,o);try{if(i.add({embeddedClientId:r.embeddedClientId}),r.allowTelemetry&&this.telemetryAllowedEmbeddedClients.add(r.embeddedClientId),this.logger.verbose(`${r.messageType} validated for AppId: ${r.embeddedClientId}`),this.hybridAuthPromise)try{await this.hybridAuthPromise}catch(f){this.logger.error(`Broker could not obtain tokens using authorization code initializer: ${f}`)}const l=new kb($u,"",e.data.nonce);this.logger.verbose(`Sending handshake response to ${e.origin}`);const u=(s=e.ports)==null?void 0:s[0];u&&(u.onmessage=this.messageListener,this.embeddedAppConfigMap.set(e.data.embeddedClientId,[e.origin,u]));const h=Hj(e.data.version);u&&h.major===3&&h.minor>=15&&h.minor<=19?u==null||u.postMessage(l):(a=e.source)==null||a.postMessage(l,e.origin)}catch(l){throw this.endBrokerPerformanceEvent(r.embeddedClientId,i,l),l}}async handleBrokerRedirectResponse(e,n){var r;if(e){const o=this.embeddedAppConfigMap.get(e.embeddedClientId);let i,s;o?[s,i]=o:(s=n.origin,i=(r=n.ports)==null?void 0:r[0]),this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse;const a=this.redirectResponseMap.get(s),l=new xo(Se.Redirect,a||null);this.logger.verbose("Sending auth response"),i==null||i.postMessage(l);const u=`msal.${this.getConfiguration().auth.clientId}`;pg(this.getConfiguration()).removeItem(`${u}.request.native`);return}}async handleBrokerAuthRequest(e,n){this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse,e.request.correlationId||(e.request.correlationId=Oo());const r=e.request.correlationId,o=e.request.account||this.getActiveAccount();let i;switch(e.interactionType){case Se.Silent:if(o){this.performanceClient.addFields({brokerEventName:St.AcquireTokenSilent},r),i=this.brokeredSilentRequest(e,o,n);break}this.performanceClient.addFields({brokerEventName:St.SsoSilent},r),i=this.brokeredSsoSilentRequest(e,n);break;case Se.Redirect:case Se.Popup:default:const s=this.getInteractionType(e.interactionType);this.performanceClient.addFields({brokerEventName:s===Se.Redirect?St.AcquireTokenRedirect:St.AcquireTokenPopup},r),i=this.interactiveBrokerRequest(s,e,n);break}return i}getInteractionType(e){const n=this.pwbBrokerAppConfiguration.preferredInteractionType;return n||e}async interactiveBrokerRequest(e,n,r){switch(e){case Se.Redirect:return this.brokeredRedirectRequest(n,r);case Se.Popup:return this.brokeredPopupRequest(n,r);case Se.Silent:this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");return;case Se.None:this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first.");return;default:this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");return}}async brokeredRedirectRequest(e,n){var i;this.logger.verbose("Brokered redirect request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(r.length===0?ce.LOGIN_START:ce.ACQUIRE_TOKEN_START,Se.Redirect,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||n;try{const s=new Rb;o==null||o.postMessage(s),this.logger.verbose(`Sending redirect response: ${s}`);const a=this.addBrokerRequestProperties(e);return a.state=mue(e,a.state),await super.acquireTokenRedirect(a)}catch(s){const a=new xo(Se.Redirect,null,s);this.logger.verbose(`Found auth error in redirect: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(r.length===0?ce.LOGIN_FAILURE:ce.ACQUIRE_TOKEN_FAILURE,Se.Redirect,null,s)}}async brokeredPopupRequest(e,n){var i;this.logger.verbose("Brokered popup request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(r.length===0?ce.LOGIN_START:ce.ACQUIRE_TOKEN_START,Se.Popup,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||n;try{const s=this.addBrokerRequestProperties(e),a=await super.acquireTokenPopup(s),l=new xo(Se.Popup,a);this.logger.verbosePii("Sending auth response"),o==null||o.postMessage(l);const u=r.length<this.getAllAccounts().length;this.eventHandler.emitEvent(u?ce.LOGIN_SUCCESS:ce.ACQUIRE_TOKEN_SUCCESS,Se.Popup,a)}catch(s){const a=new xo(Se.Popup,null,s);this.logger.verbose(`Found auth error in popup: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(r.length===0?ce.LOGIN_FAILURE:ce.ACQUIRE_TOKEN_FAILURE,Se.Popup,null,s)}}async brokeredSsoSilentRequest(e,n){var o;this.logger.verbose("Brokered SSO Silent request initiated."),this.eventHandler.emitEvent(ce.SSO_SILENT_START,Se.Silent,e.request);const r=((o=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:o[1])||n;try{const i=this.addBrokerRequestProperties(e),s=await super.ssoSilent(i),a=new xo(Se.Silent,s);this.logger.verbosePii("Sending auth response"),r==null||r.postMessage(a),this.eventHandler.emitEvent(ce.SSO_SILENT_SUCCESS,Se.Silent,s)}catch(i){const s=new xo(Se.Silent,null,i);this.logger.verbose(`Found auth error in ssoSilent: ${i}`),r==null||r.postMessage(s),this.eventHandler.emitEvent(ce.SSO_SILENT_FAILURE,Se.Silent,null,i)}}async brokeredSilentRequest(e,n,r){var i;this.logger.verbose("Brokered Silent request initiated."),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_START,Se.Silent,e.request);const o=((i=this.embeddedAppConfigMap.get(e.embeddedClientId))==null?void 0:i[1])||r;try{const s=this.addBrokerRequestProperties(e,n);s.cacheLookupPolicy=Fn.RefreshTokenAndNetwork;const a=await super.acquireTokenSilent(s),l=new xo(Se.Silent,a);o==null||o.postMessage(l),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_SUCCESS,Se.Silent,a)}catch(s){const a=new xo(Se.Silent,null,s);this.logger.verbose(`Found auth error in silent: ${s}`),o==null||o.postMessage(a),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Silent,null,s)}}getEmbeddedAppRedirectUri(e){const n=new At(e);return`brk-${this.getConfiguration().auth.clientId}://${n.getUrlComponents().HostNameAndPort}`}addBrokerRequestProperties(e,n){const r={...e.request};r.redirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),r.extraQueryParameters={...r.extraQueryParameters,client_id:e.embeddedClientId,brk_client_id:this.getConfiguration().auth.clientId,brk_redirect_uri:this.getConfiguration().auth.redirectUri||oi()},r.tokenBodyParameters={...r.tokenBodyParameters,client_id:e.embeddedClientId,brk_client_id:this.getConfiguration().auth.clientId,brk_redirect_uri:this.getConfiguration().auth.redirectUri||oi()},r.storeInCache={idToken:!1,accessToken:!1};const o=n||this.getActiveAccount();return o&&(r.account=o),e.request.correlationId&&this.performanceClient.addFields({embeddedClientId:e.embeddedClientId,embeddedRedirectUri:e.embeddedAppOrigin},e.request.correlationId),r}async sendLogoutRequestToEmbeddedApps(e){this.logger.verbose("sendLogoutRequestToEmbeddedApps called"),await this.messageEmbeddedAppsToLogout(new Pb($u,(e==null?void 0:e.correlationId)||Oo()))}async messageEmbeddedAppsToLogout(e){const n=[];this.embeddedAppConfigMap.forEach(r=>{n.push(new Promise((o,i)=>{var a;const s=window.setTimeout(()=>{o()},200);try{(a=r[1])==null||a.postMessage(e),r[1].addEventListener("message",l=>{l.data.messageType===Pt.EMBEDDED_LOGOUT_RESPONSE&&(this.logger.info(`Received logout response from embedded app: ${l.data.embeddedClientId}`),o(),clearTimeout(s))})}catch(l){this.logger.error(`Could not logout application ${r[0]}. Error in message channel: ${l}`),i(l)}}))}),await Promise.all(n)}endBrokerPerformanceEvent(e,n,r){this.telemetryAllowedEmbeddedClients.has(e)||(this.logger.verbosePii(`TelemetryReporter: Skipping brokered event as not allowed by the client ${e}`,n.event.correlationId),n.discard()),r?n.end({success:!1},r):n.end({success:!0})}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class bue extends fi{constructor(e,n,r){super(Pt.EMBEDDED_LOGOUT_RESPONSE),this.version=e,this.correlationId=r,this.embeddedClientId=n}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */const Rh={Interaction:"brokerInteractionTimeoutMs",Message:"brokerMessageTimeoutMs",Iframe:"brokerIframeTimeoutMs"},Nh={Interaction:"brokerInteractionTimedOut",Message:"brokerMessageTimedOut",Iframe:"brokerIframeTimedOut"};class Cue{get trustedBrokersProvided(){return!!this.pwbBrokeredAppConfiguration.trustedBrokerDomains&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.length>=1}get brokerConnectionEstablished(){return!!this.brokerMetadata}constructor(e,n,r,o,i,s,a,l){this.pwbBrokeredAppConfiguration=r,this.clientId=e,this.logger=o,this.brokerMetadata=null,this.performanceClient=i,this.hydrateCache=a,this.clearCache=l,this.messageChannelList=[],this.messageChannel=new MessageChannel,this.resolvers=new Map,this.temporaryBrokerStorage=s,this.onWindowMessageCb=this.onWindowMessage.bind(this),this.handshakeMetadata={correlationId:n}}getAncestors(){var r;const e=[];let n=window;for(;n&&n.parent&&n.parent.window!==n;)n=(r=n.parent)==null?void 0:r.window,e.push(n);return this.logger.verbose(`Attempting to send handshake request to ${e.length} ancestors`),e}async initiateHandshake(e){if(!this.trustedBrokersProvided)throw ln.createNoTrustedBrokersProvidedError();return this.initMeasurement&&this.initMeasurement.discard(),this.initMeasurement=e,new Promise((n,r)=>{const o=setTimeout(()=>{this.logger.warning("Broker handshake timed out"),e==null||e.add({brokerHandshakeTimedOut:!0,brokerHandshakeTimeoutMs:this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout}),r(ln.createMessageBrokerHandshakeTimeoutError())},this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout);this.handshakeMetadata.resolve=n,this.handshakeMetadata.reject=r,this.handshakeMetadata.timeoutId=o,window.addEventListener("message",this.onWindowMessageCb);const i=[];i.push(window),i.push(...this.getAncestors());for(let s=0;s<i.length;s++){const a=i[s],l=i.length-s-1;this.logger.verbose(`Sending handshake request to frame with depth = ${l}`),this.sendHandshakeRequest(a,l,void 0,e)}}).catch(n=>{const r=n;this.logger.error(r.message)})}async onWindowMessage(e){if(e.data&&e.origin&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.includes(e.origin))if(e.data.messageType===Pt.BROKER_READY){this.logger.verbose("Broker is available.");const n=this.performanceClient.startMeasurement(St.PairwiseBrokerApplicationInitializeBrokering,this.handshakeMetadata.correlationId);return this.handshakeMetadata.performanceEvent&&this.handshakeMetadata.performanceEvent.discard(),this.handshakeMetadata.performanceEvent=n,n.add({isBackground:!0}),this.sendHandshakeRequest(e.source,this.getFrameDepth(e.source),e.origin,n)}else e.data.messageType===Pt.HANDSHAKE_RESPONSE&&(this.handshakeMetadata.performanceEvent=this.initMeasurement,this.onHandshakeResponse(e))}getFrameDepth(e){const n=[];n.push(window),n.push(...this.getAncestors());for(let r=0;r<n.length;r++)if(n[r]===e)return n.length-r-1;return 0}closeBrokerConnection(){this.logger.verbose("Closing broker connection."),this.brokerMetadata=null,Zl(this.messageChannel),this.messageChannelList.forEach(e=>Zl(e.channel)),window.removeEventListener("message",this.onWindowMessageCb)}async sendSsoSilentRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(St.EmbeddedClientApplicationSendSSOSilentRequest,e.correlationId),ys(!0),this.performanceEvent.increment({visibilityChangeCount:0});const n=()=>{this.trackPageVisibility()};document.addEventListener("visibilitychange",n);try{const r=await this.sendRequest(e,Se.Silent,{type:Rh.Iframe,error:Nh.Iframe,value:fv}),o=await this.handleResponse(r,e);if(o)this.performanceEvent.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId},e.correlationId);else throw this.logger.errorPii(`Broker response is empty in brokered ssoSilent request: ${JSON.stringify(o)}`),ln.createBrokerResponseInvalidError();return o}catch(r){throw this.performanceEvent.end({success:!1},r),r}finally{document.removeEventListener("visibilitychange",n)}}async sendPopupRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(St.EmbeddedClientApplicationSendPopupRequest,e.correlationId),ys(!0);try{const n=await this.sendRequest(e,Se.Popup,{type:Rh.Interaction,error:Nh.Interaction,value:this.pwbBrokeredAppConfiguration.brokerInteractionTimeout}),r=await this.handleResponse(n,e);if(r)this.performanceEvent.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker,requestId:r.requestId});else throw Rb.validate(n)?(this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),ln.createBrokerPopupRequestRedirectingError()):(this.logger.errorPii(`Broker response is empty in brokered popup request: ${JSON.stringify(r)}`),ln.createBrokerResponseInvalidError());return r}catch(n){throw this.performanceEvent.end({success:!1},n),n}}async sendHandleRedirectRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(St.EmbeddedClientApplicationHandleRedirectRequest);try{const n=new Nb(this.clientId,$u),r=await this.messageBroker(n,e.correlationId,{type:Rh.Message,error:Nh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}),o=await this.handleResponse(r,e);return this.performanceEvent.end({success:!0,fromCache:o==null?void 0:o.fromCache,accessTokenSize:o==null?void 0:o.accessToken.length,idTokenSize:o==null?void 0:o.idToken.length,isNativeBroker:o==null?void 0:o.fromNativeBroker}),o}catch(n){throw this.performanceEvent.end({success:!1},n),n}}async sendSilentRefreshRequest(e){this.performanceEvent=this.performanceClient.startMeasurement(St.EmbeddedClientApplicationSendSilentRefreshRequest,e.correlationId),ys(!0),this.performanceEvent.increment({visibilityChangeCount:0});const n=()=>this.trackPageVisibility();document.addEventListener("visibilitychange",n);try{const r=await this.sendRequest(e,Se.Silent,{type:Rh.Message,error:Nh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}),o=await this.handleResponse(r,e);if(o)this.performanceEvent.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId});else throw this.logger.errorPii(`Broker response is empty in brokered silent refresh request: ${JSON.stringify(o)}`),ln.createBrokerResponseInvalidError();return o}catch(r){throw this.performanceEvent.end({success:!1},r),r}finally{document.removeEventListener("visibilitychange",n)}}async sendRequest(e,n,r){if(e.authenticationScheme===Vt.POP){const i=new SR(e);e.popKid=await i.generatePublicKeyThumbprint();const s=VI(this.clientId);this.temporaryBrokerStorage.containsKey(s)&&this.temporaryBrokerStorage.setItem(s,JSON.stringify(e))}const o=new xb(this.clientId,n,e,"");return this.messageBroker(o,e.correlationId,r)}getMessageChannelProperties(e){return e?this.messageChannelList.find(n=>n.nonce===e):this.getMessageChannelPropertiesByDepth(0)}getMessageChannelPropertiesByDepth(e){return this.messageChannelList.find(n=>n.depth===e)}onHandshakeResponse(e){const{resolve:n,reject:r,performanceEvent:o,timeoutId:i}=this.handshakeMetadata;try{const s=kb.validate(e,this.pwbBrokeredAppConfiguration.trustedBrokerDomains);if(s){const a=this.getMessageChannelProperties(s.nonce);if(!a){this.logger.trace("No MessageChannel found, ignoring this response"),o==null||o.increment({handshakeIgnoredCount:1});return}if(s.nonce&&s.nonce!==a.nonce){this.logger.trace("Received handshake response but there is a newer handshake request in flight, ignoring this one"),o==null||o.increment({handshakeIgnoredCount:1});return}i&&clearTimeout(i),this.logger.verbose("Received handshake response");const l=Hj(s.version);this.brokerMetadata={origin:s.brokerOrigin,version:s.version,semver:l,frameDepth:a.depth},l.major<=3&&l.minor<15&&Zl(a.channel),Zl(this.messageChannel),this.messageChannel=a.channel,n&&n(),o==null||o.add({brokerFrameDepth:a.depth}),o==null||o.end({success:!0})}}catch(s){const a=s;r&&r(a),this.logger.error(a.message),o==null||o.end({success:!1},a)}}sendHandshakeRequest(e=window.top,n,r,o){if(this.logger.trace("Pairwise Broker - sendHandshakeRequest called."),!e)throw this.logger.error("Target frame is undefined."),ln.createBrokerHandshakeFailedError();let i=new MessageChannel;const s=Oo();i.port1.onmessage=async u=>{u.data&&(u.data.messageType===Pt.HANDSHAKE_RESPONSE?(this.logger.warning("Received handshake response but the broker app is using a version of MSAL.js that does not report its origin, attempting direct communication with each trusted broker domain to resolve. This is a known issue with versions 3.15.0-3.19.1, consider asking the broker app to upgrade."),this.pwbBrokeredAppConfiguration.trustedBrokerDomains.forEach(h=>{const f=new MessageChannel;f.port1.onmessage=p=>{Zl(i),i=f,this.onHandshakeResponse({...p,data:{...p.data},origin:h})},this.logger.verbose(`Sending handshake request to ${h}`),e==null||e.postMessage(a,h,[f.port2])})):await this.handleBrokerMessage(u))};const a=new Ab(this.clientId,$u,!0,s),l=this.getMessageChannelPropertiesByDepth(n);l?(Zl(l.channel),l.channel=i,l.nonce=s):this.messageChannelList.push({channel:i,nonce:s,depth:n}),this.logger.verbose("Sending handshake request"),o==null||o.increment({handshakeSentCount:1}),e==null||e.postMessage(a,r||"*",[i.port2])}async handleBrokerMessage(e){var s,a,l,u;const n=((a=(s=e.data)==null?void 0:s.result)==null?void 0:a.correlationId)||((u=(l=e.data)==null?void 0:l.errorPayload)==null?void 0:u.correlationId),r=e.data.messageType;if(this.logger.verbose(`Received message from broker of type: ${r} with correlationId: ${n}`),!r)return;let o;if(r===Pt.EMBEDDED_LOGOUT_REQUEST){this.logger.verbose("Received logout message from broker."),await this.handleLogoutMessageFromBroker(e),this.messageChannel.port1.postMessage(new bue($u,this.clientId,n));return}else if(r===Pt.AUTH_RESULT&&e.data.interactionType===Se.Redirect)this.logger.verbose("Received redirect response from broker."),o=Se.Redirect;else if(n)this.logger.verbose(`Resolving message for ${n}.`),o=n;else{this.logger.verbose(`No correlationId found in message: ${r}.`);return}const i=this.resolvers.get(o);i?(clearTimeout(i.timeoutId),i.resolve(e),this.resolvers.delete(o)):this.logger.warning(`Cannot resolve message for ${n}. Ignoring.`)}async messageBroker(e,n,r={type:Rh.Message,error:Nh.Message,value:this.pwbBrokeredAppConfiguration.brokerMessageTimeout}){return new Promise((o,i)=>{var h,f;if(!this.brokerMetadata){i(ln.createBrokeringDisabledError());return}const s=setTimeout(()=>{var v;const p={},g=r.error.toString();p[g]=!0,(v=this.performanceEvent)==null||v.add(p),i(ln.createMessageBrokerTimeoutError())},r.value),a={},l=r.type.toString();a[l]=r.value,(h=this.performanceEvent)==null||h.add(a);const u=e.messageType===Pt.HANDLE_REDIRECT_REQUEST?Se.Redirect:n;if(this.resolvers.set(u,{resolve:o,reject:i,timeoutId:s}),this.brokerMetadata.semver.major>=3&&this.brokerMetadata.semver.minor>=15)this.messageChannel.port1.postMessage(e);else{const p=new MessageChannel;p.port1.onmessage=this.handleBrokerMessage.bind(this),(f=window.top)==null||f.postMessage(e,this.brokerMetadata.origin,[p.port2])}})}async handleResponse(e,n){const r=xo.validate(e);if(!r)return null;if(r.errorPayload)throw xo.detectError(r.errorPayload);if(!r.result)throw ln.createBrokerResponseInvalidError();await this.hydrateCache(r.result,n);let o;if(n.authenticationScheme===Vt.POP){if(!n.popKid)throw ln.createShrGenerationError();o=await new SR(n).signRequest(r.result.accessToken,n.popKid)}return{...r.result,accessToken:o||r.result.accessToken}}async handleLogoutMessageFromBroker(e){Pb.validate(e)&&(this.logger.verbose("Logout request received from broker and validated. Logging out embedded app."),await this.clearCache())}trackPageVisibility(){this.performanceEvent&&(this.logger.info("Embedded client: Visibility change detected"),this.performanceEvent.increment({visibilityChangeCount:1}))}}/*! @azure/msal-browser-1p v3.26.0 2024-10-08 */class Sue extends Mp{constructor(e,n,r){super(e,r),this.pwbBrokerAppConfig=Bj(n),this.temporaryBrokerStorage=pg(e),this.eventHandler=new M4(this.getLogger()),this.redirectResponse=new Map,this.initialized=!1}async initialize(e){await super.initialize(e),this.initialized=!0}async initializeBrokering(e,n){if(typeof window>"u")return;const r={...n,correlationId:(n==null?void 0:n.correlationId)||Oo()},o=this.performanceClient.startMeasurement(St.PairwiseBrokerApplicationInitializeBrokering,r.correlationId);o.add({isBackground:!1});try{this.pwbBrokerAppConfig.actAsBroker?(this.pwbBrokerAppConfig.allowBrokering&&this.getLogger().verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),this.broker=new yue(this.getConfiguration(),this.pwbBrokerAppConfig,this.eventHandler),this.getLogger().verbose("Acting as Broker"),this.getLogger().verbose("Initialize the extension for the new broker instance"),o.add({isBroker:!0}),await this.broker.initialize(r),await this.broker.listenForBrokerMessage(e,o),o.end({success:!0})):this.pwbBrokerAppConfig.allowBrokering&&(this.embeddedApp=new Cue(this.getConfiguration().auth.clientId,r.correlationId,this.pwbBrokerAppConfig,this.getLogger(),this.performanceClient,this.temporaryBrokerStorage,this.hydrateCache.bind(this),this.clearCache.bind(this)),this.getLogger().verbose("Acting as child"),o.add({isBroker:!1}),await this.embeddedApp.initiateHandshake(o))}catch(i){throw o.end({success:!1},i),i}}async handleRedirectPromise(e){if($w(this.initialized),typeof window<"u"){const n=e||"";let r=this.redirectResponse.get(n);if(typeof r>"u"){this.eventHandler.emitEvent(ce.HANDLE_REDIRECT_START,Se.Redirect);const o=this.getAllAccounts();r=this.handleRedirectPromiseInternal(e).then(i=>{if(!i)return null;const s=o.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(s?ce.LOGIN_SUCCESS:ce.ACQUIRE_TOKEN_SUCCESS,Se.Redirect,i),i}).catch(i=>{throw this.eventHandler.emitEvent(o.length>0?ce.ACQUIRE_TOKEN_FAILURE:ce.LOGIN_FAILURE,Se.Redirect,null,i),i}).finally(()=>{this.eventHandler.emitEvent(ce.HANDLE_REDIRECT_END,Se.Redirect)}),this.redirectResponse.set(n,r)}return r}return null}async handleRedirectPromiseInternal(e){var n;if((n=this.embeddedApp)!=null&&n.brokerConnectionEstablished){const r=VI(this.controller.getConfiguration().auth.clientId),o=this.temporaryBrokerStorage.getItem(r);if(o){const i=JSON.parse(o);return await this.embeddedApp.sendHandleRedirectRequest(i).catch(a=>{throw a instanceof Et&&a.setCorrelationId(i.correlationId),a}).finally(()=>{this.temporaryBrokerStorage.removeItem(r)})}else return null}else return this.broker?this.broker.handleRedirectPromise(e):super.handleRedirectPromise(e)}async loginRedirect(e){return this.acquireTokenRedirect(e||{scopes:Ea})}async acquireTokenRedirect(e){const n=this.getAllAccounts().length===0;return this.eventHandler.emitEvent(n?ce.LOGIN_START:ce.ACQUIRE_TOKEN_START,Se.Redirect,e),super.acquireTokenRedirect(e).catch(r=>(this.eventHandler.emitEvent(n?ce.LOGIN_FAILURE:ce.ACQUIRE_TOKEN_FAILURE,Se.Redirect,null,r),Promise.reject(r)))}async loginPopup(e){return this.acquireTokenPopup(e||{scopes:Ea})}async acquireTokenPopup(e){ys(!0);const n={...e,correlationId:e.correlationId||Oo()},r=this.getAllAccounts();return this.eventHandler.emitEvent(r.length===0?ce.LOGIN_START:ce.ACQUIRE_TOKEN_START,Se.Popup,n),this.acquireTokenPopupInternal(n).then(o=>{const i=r.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(i?ce.LOGIN_SUCCESS:ce.ACQUIRE_TOKEN_SUCCESS,Se.Popup,o),o}).catch(o=>{o instanceof Et&&o.setCorrelationId(n.correlationId);const i=r.length===0;return this.eventHandler.emitEvent(i?ce.LOGIN_FAILURE:ce.ACQUIRE_TOKEN_FAILURE,Se.Popup,null,o),Promise.reject(o)})}async acquireTokenPopupInternal(e){var n;if((n=this.embeddedApp)!=null&&n.brokerConnectionEstablished){if(this.getLogger().verbose("pairwise broker (embedded app) acquireTokenPopup called",e.correlationId),!this.embeddedApp)throw ln.createNoEmbeddedAppError();const r=VI(this.controller.getConfiguration().auth.clientId);return this.temporaryBrokerStorage.setItem(r,JSON.stringify(e)),this.embeddedApp.sendPopupRequest(e).then(o=>(this.temporaryBrokerStorage.removeItem(r),o))}return super.acquireTokenPopup(e)}async ssoSilent(e){ys(!0);const n={...e,correlationId:e.correlationId||Oo()};return this.eventHandler.emitEvent(ce.SSO_SILENT_START,Se.Silent,n),this.ssoSilentInternal(n).then(r=>(this.eventHandler.emitEvent(ce.SSO_SILENT_SUCCESS,Se.Silent,r),r)).catch(r=>{throw r instanceof Et&&r.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(ce.SSO_SILENT_FAILURE,Se.Silent,null,r),r})}async ssoSilentInternal(e){return this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished?(this.getLogger().verbose("ssoSilent called",e.correlationId),this.embeddedApp.sendSsoSilentRequest(e)):super.ssoSilent(e)}async acquireTokenSilent(e){ys(!0);const n={...e,correlationId:e.correlationId||Oo()};return this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_START,Se.Silent,n),this.acquireTokenSilentInternal(n).then(r=>(this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_SUCCESS,Se.Silent,r),r)).catch(r=>(r instanceof Et&&r.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(ce.ACQUIRE_TOKEN_FAILURE,Se.Silent,null,r),Promise.reject(r)))}async acquireTokenSilentInternal(e){var o;if(!((o=this.embeddedApp)!=null&&o.brokerConnectionEstablished))return super.acquireTokenSilent(e);this.getLogger().verbose("acquireTokenSilent - attempting to acquire token from web flow");const n={...e,cacheLookupPolicy:Fn.AccessToken};let r;return e.cacheLookupPolicy===Fn.RefreshToken||e.cacheLookupPolicy===Fn.RefreshTokenAndNetwork||e.cacheLookupPolicy===Fn.Skip||e.forceRefresh?r=Promise.reject(new Fd(ri)):r=super.acquireTokenSilent(n),r.catch(async i=>{if(e.cacheLookupPolicy===Fn.AccessToken)throw i;if(!this.embeddedApp)throw ln.createNoEmbeddedAppError();return this.embeddedApp.sendSilentRefreshRequest(e)})}async logoutRedirect(e){if(this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished)this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutRedirect(e)}async logoutPopup(e){if(this.embeddedApp&&this.embeddedApp.brokerConnectionEstablished)this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutPopup(e)}setActiveAccount(e){this.broker&&this.broker.setActiveAccount(e),super.setActiveAccount(e)}addEventCallback(e,n=Object.values(ce)){const r=[ce.ACQUIRE_TOKEN_START,ce.ACQUIRE_TOKEN_SUCCESS,ce.ACQUIRE_TOKEN_FAILURE,ce.LOGIN_START,ce.LOGIN_SUCCESS,ce.LOGIN_FAILURE,ce.SSO_SILENT_START,ce.SSO_SILENT_SUCCESS,ce.SSO_SILENT_FAILURE,ce.HANDLE_REDIRECT_START,ce.HANDLE_REDIRECT_END],o=[],i=[];n.forEach(a=>{r.includes(a)?o.push(a):i.push(a)});const s=super.addEventCallback(e,i);return s?(this.eventHandler.addEventCallback(e,o,s),s):null}removeEventCallback(e){super.removeEventCallback(e),this.eventHandler.removeEventCallback(e)}}class Iue{supportsNaa(){return!1}supportsPwBBroker(){return!1}async handleInteractionRequiredError(e,n){var r;En(Sn,null),En(ei,{reason:"token-expired",provider:"microsoft",loginHint:(r=n.account)==null?void 0:r.username})}}class Eue extends Iue{supportsPwBBroker(){return me.instance().config().useMSALPwBApp??!1}async instantiateMsal(){const e=this.supportsPwBBroker();HD({apiName:ce.INITIALIZE_START,providerType:"microsoft",extraInfo:{eventInfo_isPwB:e}});let n;return e?(n=new Sue(zk,i$,$k),await n.initialize(),await n.initializeBrokering()):n=await Mp.createPublicClientApplication(zk,$k),zD({apiName:ce.INITIALIZE_END,providerType:"microsoft",extraInfo:{eventInfo_isPwB:e}}),n}}const $I=new gl(Tue);async function Tue(){return new Eue}function wue(t){return!(t instanceof jr||t instanceof Et&&(t.errorMessage===TO||parseInt(t.errorCode,10)===DE))}const gr=new gl(_ue);async function _ue(){const t=await $I.get(),e=await t.instantiateMsal(),n=new Map([["login",null],["graph",null],["oneDrive",null]]);async function r(i,s){const a=o$(i),l={account:s,...a},u=dd(gee,"any");try{if(!u)return{accessToken:(await e.acquireTokenSilent(l)).accessToken};const f={...PD(),shouldRetry:g=>wue(g),onSuccess:g=>qD(g,i,"microsoft"),onFailure:g=>WD(g,i,"microsoft")};return await ew(async()=>({accessToken:(await e.acquireTokenSilent(l)).accessToken}),f)}catch(h){if(h instanceof jr)return U.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenRedirect",eventInfo_requestType:i,eventInfo_traceId:h.traceId,eventInfo_errorMessage:h.errorMessage,eventInfo_errorCode:h.errorCode,eventInfo_correlationId:h.correlationId,eventInfo_timeSinceStartMs:performance.now()-window.appStart}}),t.handleInteractionRequiredError(e,l);if(h instanceof Et&&(h.errorMessage===TO||parseInt(h.errorCode,10)===DE))throw U.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenUnderaged",eventInfo_requestType:i,eventInfo_errorMessage:h.errorMessage,eventInfo_errorCode:h.errorCode,eventInfo_correlationId:h.correlationId}}),new Error(jE);return}}return{msal:e,getMsalAccessToken:async i=>{const s=e.getActiveAccount();if(!s&&!t.supportsNaa())return;const a=n.get(i);if(!a){const l=r(i,s??void 0);n.set(i,l);const u=await l;return n.set(i,null),u}return a}}}function Aue(t){var n;const e=(n=t.payload)==null?void 0:n.scopes;return Array.isArray(e)?e.some(r=>typeof r!="string"?!1:r==="ConsumerStore.Purchase"||r.endsWith("purchase.create")):!1}function Vj(t){const e=Aue(t);if(t.eventType===ce.LOGIN_START){const n=t.payload;VD({apiName:ce.LOGIN_START,authWorkflowAccountType:"microsoft",interactionType:t.interactionType??void 0,correlationId:n.correlationId,prompt:n.prompt,redirectUri:n.redirectUri,extraInfo:{eventInfo_isBrokered:e}})}else if(t.eventType===ce.LOGIN_SUCCESS||t.eventType===ce.SSO_SILENT_SUCCESS){const n=t.payload&&"account"in t.payload?t.payload.account:null,r=n?!ti(n.tenantId):void 0,o=t.payload;D1({apiName:t.eventType,authWorkflowAccountType:"microsoft",interactionType:t.interactionType??void 0,correlationId:o.correlationId,authority:o.authority,isMSA:r,extraInfo:{eventInfo_isBrokered:e}})}else if(t.eventType===ce.LOGOUT_SUCCESS)$D({apiName:ce.LOGOUT_SUCCESS,providerType:"microsoft",extraInfo:{eventInfo_isBrokered:e}});else if(t.eventType===ce.ACQUIRE_TOKEN_START||t.eventType===ce.ACQUIRE_TOKEN_NETWORK_START){ba("msalAcquireTokenStartTime",Date.now().toString());const n=t.payload;fa({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_correlationId:n.correlationId,eventInfo_redirectUri:n.redirectUri,eventInfo_cacheLookupPolicy:n.cacheLookupPolicy,eventInfo_prompt:n.prompt,eventInfo_isBrokered:e}})}else if(t.eventType===ce.ACQUIRE_TOKEN_SUCCESS){const n=Date.now()-parseInt(li("msalAcquireTokenStartTime")??"0",10);ba("msalAcquireTokenStartTime","");const r=t.payload;fa({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_correlationId:r.correlationId,eventInfo_expiresOn:r.expiresOn,eventInfo_extExpiresOn:r.extExpiresOn,eventInfo_refreshOn:r.refreshOn,eventInfo_duration:n,eventInfo_fromCache:r.fromCache,eventInfo_isBrokered:e}})}else if(t.eventType===ce.LOGIN_FAILURE||t.eventType===ce.ACQUIRE_TOKEN_FAILURE||t.eventType===ce.SSO_SILENT_FAILURE||t.eventType===ce.ACQUIRE_TOKEN_BY_CODE_FAILURE||t.eventType===ce.LOGOUT_FAILURE){let n;t.eventType===ce.ACQUIRE_TOKEN_FAILURE&&(n=Date.now()-parseInt(li("msalAcquireTokenStartTime")??"0",10));const r=t.error;Ia({authWorkflowAccountType:"microsoft",apiName:t.eventType,errorType:(r==null?void 0:r.name)??"",errorMessage:(r==null?void 0:r.message)??"",extraInfo:{eventInfo_isBrokered:e},errorExtraInfo:{eventInfo_correlationId:r==null?void 0:r.correlationId,eventInfo_errorMessage:r==null?void 0:r.errorMessage,eventInfo_errorCode:r==null?void 0:r.errorCode,eventInfo_name:r==null?void 0:r.name,eventInfo_interactionType:t.interactionType??void 0,eventInfo_subError:r==null?void 0:r.subError,eventInfo_duration:n}})}else fa({authWorkflowAccountType:"microsoft",apiName:t.eventType,extraInfo:{eventInfo_interactionType:t.interactionType??void 0,eventInfo_isBrokered:e}})}function ti(t){return t!==Rg}function kue(t){fa({apiName:"msal:silentSSOCustomSuccess",authWorkflowAccountType:"microsoft",duration:t.duration,extraInfo:{eventInfo_accountUpdate:t.accountUpdate,eventInfo_accountType:t.accountType,eventInfo_message:t.message}})}function h0(t){Ia({apiName:"msal:silentSsoCustomError",authWorkflowAccountType:"microsoft",errorMessage:t.message,errorCode:t.errorCode})}class xue{constructor(){j(this,"hasTrackedRedirectError",!1);j(this,"isHandlingRedirect",!1)}async handleRedirect(){var e;try{const{msal:n}=await gr.get();this.isHandlingRedirect&&Ia({authWorkflowAccountType:"microsoft",apiName:Wg.INTERACTION_IN_PROGRESS,errorType:"interaction_in_progress",errorMessage:"Attempted to call handleRedirectPromise while already handling a redirect"}),this.isHandlingRedirect=!0;try{await n.handleRedirectPromise()&&GD({authWorkflowAccountType:"microsoft",apiName:"msal:reauthSuccess"});const o=await this.getAccount();return o?(n.setActiveAccount(o),{id:((e=o.idTokenClaims)==null?void 0:e.oid)??"",tenantId:o.tenantId,provider:"microsoft",accountType:ti(o.tenantId)?"AAD":"MSA"}):null}finally{this.isHandlingRedirect=!1}}catch(n){this.trackRedirectErrorOncePerSession(n)}return null}async handleRedirectWithoutAccount(){try{const{msal:e}=await gr.get();this.isHandlingRedirect&&Ia({authWorkflowAccountType:"microsoft",apiName:Wg.INTERACTION_IN_PROGRESS,errorType:"interaction_in_progress",errorMessage:"Attempted to call handleRedirectPromise while already handling a redirect"}),this.isHandlingRedirect=!0;try{const n=await e.handleRedirectPromise();n&&e.setActiveAccount(n.account)}finally{this.isHandlingRedirect=!1}}catch(e){this.trackRedirectErrorOncePerSession(e)}}async maybeInitializeAccountWithToken(){var s;const{msal:e}=await gr.get(),n=e.getActiveAccount(),r=e.getAllAccounts(),o=Ue(Sn);fa({authWorkflowAccountType:"microsoft",apiName:"msal:maybeInitializeAccountWithToken",extraInfo:{eventInfo_tenantId:n==null?void 0:n.tenantId,eventInfo_isAadTenant:n!=null&&n.tenantId?ti(n.tenantId):!1,eventInfo_accounts:r.map(a=>({type:ti(a.tenantId)?"AAD":"MSA"})),eventInfo_userAccount:o}});const i=await this.getAuthToken();if(i){const a=await this.getAccount();return a?(e.setActiveAccount(a),{userAccount:{id:((s=a.idTokenClaims)==null?void 0:s.oid)??"",tenantId:a.tenantId,provider:"microsoft",accountType:ti(a.tenantId)?"AAD":"MSA"},authToken:i}):null}return null}async logIn(){const{msal:e}=await gr.get(),n={...qE},r=this.buildRedirectUri();return r&&(n.redirectUri=r),e.loginRedirect(n)}buildRedirectUri(){const{surfaceQueryParam:e}=me.instance().config(),n=new URLSearchParams;let r;if(e!=null&&e.useForLoginRedirect)for(const[i,s]of Object.entries(e.params))n.set(i,s);const o=new URLSearchParams(window.location.search).get("back");return o&&n.set("back",o),n.toString()&&(r=`${window.location.origin}?${n}`),r}async logOut(){const{msal:e}=await gr.get(),n=e.getAllAccounts(),r=e.getActiveAccount();try{if(ze("auth-rf-account-selection")){await e.logoutRedirect({account:r,onRedirectNavigate:()=>!1}),U.setPicassoId(null);return}for(const o of n)o.tenantId!==Rg&&(await e.logoutRedirect({account:o,onRedirectNavigate:()=>!1}),U.setPicassoId(null))}catch(o){console.error(o)}await e.logoutRedirect({account:r,onRedirectNavigate:()=>!1}),U.setPicassoId(null)}async getAuthToken(){return(await gr.get()).getMsalAccessToken("login")}async getUserInfo(){const e=await(await gr.get()).getMsalAccessToken("graph");if(e)return qx(e.accessToken)}async getUserInfoFromToken(e){return qx(e)}supportsTokenType(e){return e===void 0}trackRedirectErrorOncePerSession(e){this.hasTrackedRedirectError||U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"msalHandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${e}`}}),this.hasTrackedRedirectError=!0}async getAccount(){var o;const{msal:e}=await gr.get(),n=e.getAllAccounts(),r=e.getActiveAccount();if((n.length>1||n.length===1&&(r==null?void 0:r.homeAccountId)!==((o=n[0])==null?void 0:o.homeAccountId))&&fa({authWorkflowAccountType:"microsoft",apiName:"msal:getAllAccounts",extraInfo:{eventInfo_accountCount:n.length,eventInfo_accountTypes:n.map(i=>ti(i.tenantId)?"AAD":"MSA")}}),n.length!==0){if(ze("auth-rf-account-selection"))return n.length===0?void 0:n.length===1?n[0]:n.length>1&&r?r:void 0;for(const i of n)if(i.tenantId===Rg)return i;return n[0]}}async getCurrentActiveUserAccount(){var n;const e=await this.getAccount();return e?{id:((n=e.idTokenClaims)==null?void 0:n.oid)??"",tenantId:e.tenantId,provider:"microsoft",accountType:ti(e.tenantId)?"AAD":"MSA"}:null}}class Er{constructor(){j(this,"middlewares",[])}add(e){this.middlewares.push(e)}async run(e){let n={...e};for(const r of this.middlewares)try{n=await r(n)}catch{continue}return n}}const Rue=new Er,cN=new Er,ONe=new Er,LNe=new Er,Nue=new Er,Pue=new Er,Mue=new Er,Oue=new Er,Lue=new Er,Due=new Er,jue=new Er,Uue=new Er,Fue=new Er,Bue=new Er,Hue=new Er,zue=new Er;var qu;const dc=class dc{constructor(){j(this,"providers");this.providers={microsoft:new xue,auth0:new Fee}}async handleRedirect(){const e=await this.providers.microsoft.handleRedirect();if(e)return e;if(!me.instance().config().enableAuth0)return null;const n=await this.providers.auth0.handleRedirect();return n||null}async handleRedirectWithoutAccount(){await this.providers.microsoft.handleRedirectWithoutAccount(),me.instance().config().enableAuth0&&await this.providers.auth0.handleRedirectWithoutAccount()}async getCurrentActiveUserAccountAndSetGlobalUserAccount(){const e=await this.providers.microsoft.getCurrentActiveUserAccount();if(e){this.setUserAccount(e);return}if(!me.instance().config().enableAuth0)return;const n=await this.providers.auth0.getCurrentActiveUserAccount();n&&this.setUserAccount(n)}static instance(){return he(dc,qu)||Ft(dc,qu,new dc),he(dc,qu)}getCurrentProvider(){const e=Ue(Sn);return e?this.providers[e.provider]:null}async getAccountFromProviders(){var e;return j1()?((e=this.getCurrentProvider())==null?void 0:e.getCurrentActiveUserAccount())??null:this.handleRedirect()}async maybeInitialize(){try{const e=await this.providers.microsoft.maybeInitializeAccountWithToken();if(e)return e;if(!me.instance().config().enableAuth0)return null;const n=await this.providers.auth0.maybeInitializeAccountWithToken();if(n)return n}catch(e){e instanceof Error&&Dr({feature:"accountInitialization",errorType:e.name,errorMessage:e.message,exception:e.stack})}return null}setUserAccount(e){En(Sn,e),U.setUserAccountType(e==null?void 0:e.accountType)}async getAuthToken(){var r;const e=await cN.run({type:"login"});if(e.isHandled){if(((r=e.authToken)==null?void 0:r.tokenType)!==void 0){const o=Uee(e.authToken.tokenType);U.setUserAccountType(o)}return e.authToken}if(j1()){const o=this.getCurrentProvider();return o?o.getAuthToken():void 0}const n=this.getCurrentProvider();if(!n){const o=await this.handleRedirect();if(o)return this.setUserAccount(o),this.providers[o.provider].getAuthToken();const i=await this.maybeInitialize();if(i){const{authToken:s,userAccount:a}=i;return this.setUserAccount(a),s}return}return n.getAuthToken()}async getUserInfo(){const e=await cN.run({type:"graph"});if(e.isHandled){if(!e.authToken)return;const{tokenType:r,accessToken:o}=e.authToken,i=r!=="msa"?r:void 0;if(this.providers.microsoft.supportsTokenType(i))return this.providers.microsoft.getUserInfoFromToken(o);if(this.providers.auth0.supportsTokenType(i)){const s=await this.providers.auth0.getUserInfoFromToken(o);if(s)return s}return}const n=this.getCurrentProvider();if(n)return n.getUserInfo()}logIn(e,n){return this.providers[e].logIn(n)}async logOut(){const e=this.getCurrentProvider();return e&&(await e.logOut(),this.setUserAccount(null)),Promise.resolve()}async initAuthAccount(){await this.handleRedirectWithoutAccount(),await this.getCurrentActiveUserAccountAndSetGlobalUserAccount()}};qu=new WeakMap,on(dc,qu,null);let Rs=dc;function $j(){return null}function Gj({featureOverrides:t,localFeatureOverrides:e,serverFeatures:n,surfaceConfig:r}){var i,s,a;const o=new Set([...n]);(i=r.settingsOverrides)!=null&&i.shouldHideShopping&&o.delete("shopping-card"),r.startInVoice&&o.add("start-in-voice"),(s=r.pages)!=null&&s.enabled?o.add("pages"):((a=r.pages)==null?void 0:a.enabled)===!1&&o.delete("pages");for(const l of t)o.add(l);for(const l of e)o.add(l);return Array.from(o)}function Kj(){return[]}async function R_(){const{msal:t}=await gr.get();return t.getActiveAccount()}async function N_(){const t=await R_();return t?ti(t.tenantId):!1}async function lN(){const t=await R_();if(!(!t||!ti(t.tenantId)))return t}async function Vue(){const t=await R_();if(!(!t||ti(t.tenantId)))return t}async function $ue(){return(await gr.get()).getMsalAccessToken("oneDrive")}async function Gue(){if(!await N_())return;const{msal:t}=await gr.get(),e=t.getActiveAccount();e&&t.clearCache({account:e})}const qj="urlFeatureOverrides";function Kue(){return typeof window>"u"?null:sessionStorage.getItem(qj)}function Wj(){const t=Kue();return t?t.split(",").map(n=>n):[]}function que(){const t=mn("features");return t!=null&&t.trim()&&typeof window<"u"&&sessionStorage.setItem(qj,t.trim()),Wj()}const Wue={VITE_API_URL:"copilot.microsoft.com/c/api"};async function Yue(t,e){try{return await t.json()}catch(n){throw(n instanceof SyntaxError||n instanceof TypeError||n instanceof DOMException)&&RG(n,t,e),n}}function Yj(t={}){const{query:e={}}=t,n=new URLSearchParams;for(const[s,a]of Object.entries(e))n.append(s,a);const r=Gj({featureOverrides:Wj(),localFeatureOverrides:Kj(),serverFeatures:[],surfaceConfig:me.instance().config()}).join(",");r&&(n.append("features",r),n.append("setflight",r));const o=$j();o&&n.append("promptBranch",o);const{surfaceQueryParam:i}=me.instance().config();if(i)for(const[s,a]of Object.entries(i.params))n.append(s,a);return n}function Qj(t){return t!==void 0&&t.tokenType!==void 0&&t.tokenType!=="msa"}async function uN(t,e){const{VITE_API_URL:n}=Wue;let r;if(AO()?r=`${window.location.host}/c/api`:r=n,!r)throw new Error("Cannot initialize websocket because the required env vars are not set: VITE_API_URL");const o={...e,"api-version":"2"},i=await Rs.instance().getAuthToken(),s=await N_();i&&!s&&(o.accessToken=i.accessToken,Qj(i)&&(o["X-UserIdentityType"]=i.tokenType)),i===void 0?FD(t,"getWssAPIUrl"):BD(t,"getWssAPIUrl"),Ue(cd)&&(o.appFlavor="beta");const a=Yj({query:o});return`wss://${r}/${t}?${a}`}function Que(t,e){const n=[kO(),t],r=Yj({query:e});return r.toString()&&n.push("?",String(r)),n.join("")}function Jue(t,e,n){t.attemptCount>1&&U.trackEvent({name:"system",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:"apiRetry",eventInfo_scenario:e,eventInfo_duration:t.endTime-t.startTime,eventInfo_customData:JSON.stringify({attemptCount:t.attemptCount,errorCount:t.errors.length,delayTimings:t.delayTimings})}}),n==null||n(t)}function Xue(t,e,n){var o,i;const r={path:e,attemptCount:t.attemptCount,totalDuration:t.endTime-t.startTime,exitReason:t.exitReason,errorCount:t.errors.length,lastErrorType:(o=t.errors[t.errors.length-1])==null?void 0:o.errorType,lastErrorMessage:(i=t.errors[t.errors.length-1])==null?void 0:i.errorMessage,delayTimings:t.delayTimings};U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ApiRetryFailure",eventInfo_errorMessage:`API retry failed after ${t.attemptCount} attempts. Exit reason: ${t.exitReason}`,eventInfo_details:JSON.stringify(r)}}),n==null||n(t)}async function xa(t,e={}){const{options:n,query:r,analytics:o,retry:i}=e;if(i){const{onSuccess:s,onFailure:a}=i,l={...i,onSuccess:u=>{Jue(u,(o==null?void 0:o.anonymousPath)??t,s)},onFailure:u=>{Xue(u,(o==null?void 0:o.anonymousPath)??t,a)}};return ew(()=>dN({path:t,options:n,query:r,analytics:o}),l)}return dN({path:t,options:n,query:r,analytics:o})}async function dN(t){const{path:e,options:n,query:r,analytics:o}=t,i=new Headers(n==null?void 0:n.headers);Rt.resolvedLanguage?i.set("X-Search-UILang",Rt.resolvedLanguage.toLowerCase()):Rt.language&&i.set("X-Search-UILang",Rt.language.toLowerCase());const s=await Rs.instance().getAuthToken(),a=await N_();s&&!a&&(i.set("Authorization",`Bearer ${s.accessToken}`),Qj(s)&&i.set("X-UserIdentityType",s.tokenType)),s===void 0?FD(e,"fetchApi"):BD(e,"fetchApi"),Ue(cd)&&i.set("X-Copilot-App-Flavor","beta");const l=performance.now(),u=await fetch(Que(e,r),{...n,credentials:"include",headers:i}),h=performance.now();return UD((o==null?void 0:o.anonymousPath)??e,(n==null?void 0:n.method)??"GET",h-l,u.clone()),Lf.trackLatestApiAssignment(u.headers),u}async function Ur({path:t,args:e={}}){var r;const n={method:"POST",...e.options,headers:{"Content-Type":"application/json",...(r=e.options)==null?void 0:r.headers},body:e.body?JSON.stringify(e.body):void 0};return xa(t,{...e,options:n})}async function $n(t,e,n={}){const{analytics:r,onFailedRequest:o}=n,i=(r==null?void 0:r.anonymousPath)??t,s=await xa(t,n);let a=!0;if(!s.ok&&o&&(a=!!o(s)),!a)return{data:void 0,response:{ok:s.ok,status:s.status,headers:s.headers},zodError:void 0};const l=await Yue(s,i);let u,h;const{safe:f}=n.parseOptions??{};if(f){const p=e.safeParse(l);p.error&&jf(p.error,i,!0),u=l,h=p.error}else try{u=e.parse(l)}catch(p){throw p instanceof kg&&jf(p,i,!1),p}return{data:u,response:{ok:s.ok,status:s.status,headers:s.headers},zodError:h}}const Zue={headers:{"content-type":"application/json"},body:JSON.stringify({type:"private"})};function Jj(t,{arg:e}={}){const r=(e==null?void 0:e.isPrivate)??!1?Zue:void 0;return $n(t,WQ,{options:{method:"POST",...r}}).then(o=>o.data)}function P_(){const t=x(xT),{trigger:e}=tT("/conversations",Jj),n=x(bn),r=gp(bn),o=ve(jy),i=ve(kT),s=ve(YX),a=yZ(),{isLivingPortraitEnabled:l}=KT(),u=x(pD),[h,f]=m.useState(!1);return{startConversationDisabled:h,createConversation:m.useCallback(async p=>{const{shouldNavigateToChat:g=!0,characterId:v,portraitId:y,isPrivate:b=!1}=p??{};if(t){const C=n.get(t);if(l?(u==null?void 0:u.id)!==void 0&&u.id===y:(C==null?void 0:C.characterId)===v)return a({id:t,shouldNavigateToChat:g}),t}if(!h)try{f(!0);const{id:C}=await e({isPrivate:b}),S={id:C,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:v,streamingState:"idle",continuedAt:null};return b&&i(C),r(E=>{E.set(C,S)}),a({id:C,shouldNavigateToChat:!b&&g}),o(!0),aZ(),s(),C}catch(C){console.error(C)}finally{f(!1)}},[t,h,n,l,u,a,e,r,i,o,s])}}function Mb(){const[t,e]=Ze(tX),n=$t();return m.useEffect(()=>{n.endsWith("/chats/new/talk")&&(U.setLandingPage("deepLinkVoiceCall"),e("audioCall"))},[n,e]),[t,()=>e(null)]}function Sl(){const t=$t(),e=se("enable-private-chat");return t===_O&&e}function Ob(t){const e=t!=null&&t.length?t.includes("enable-private-chat"):ze("enable-private-chat");return window.location.pathname===_O&&e}const ede=P(0),tde=P(null),nde=P(null),Lb=P("center"),Xj=P(void 0),Zr=P(null),rde=P(null),Op=P(null),Db=P(null),ode=P(t=>{var r;const e=t(Zi),n=qT(e);return((r=n==null?void 0:n.part.task)==null?void 0:r.type)==="research"}),Zj=P(null),ide=P(!1);P(new Map);const sde=P(!1),DNe=P(!1),M_=P(null),jb=P(!1),GI=P(!1),O_="shouldPerformUserMerge";function ade(t){ba(O_,String(t))}function cde(){eL(O_)}function lde(){return li(O_)!=="false"}function jNe(){const t=x(Zi),e=Sr(),[n,r]=Ze(mee),o=se("user-conversation-merge"),i=o&&!e&&t.length>0;return m.useEffect(()=>{o&&ade(n)},[o,n]),{shouldShowMergeCheckbox:i,shouldMerge:n,setShouldMerge:r}}function eU(t){try{return new URL(t,window.location.origin).origin!==window.location.origin}catch{return!1}}function Lp(t){Ue(hl)&&eU(t)?at().set(Fy,t.toString()):window.location.href=t}function Dp(){ude()}function ude(t){const{surfaceQueryParam:e}=me.instance().config(),n=new URL(window.location.href);if(e)for(const[r,o]of Object.entries(e.params))n.searchParams.delete(r),n.searchParams.append(r,o);Lp(n.href)}const js=P(null),tU=P([]);function L_(){var l;const[t,e]=Ze(tU),n=m.useRef([]);m.useEffect(()=>{const u=n.current,h=t;if(u.length>h.length){const f=u.filter((g,v)=>v>=h.length),p=f.length;for(let g=p-1;g>=0;g-=1){const v=f[g];v!=null&&v.onPopPage&&v.onPopPage()}}n.current=t},[t]);const r=t.length>0?(l=t[t.length-1])==null?void 0:l.page:void 0,o=u=>i([u]),i=u=>{const h=u.map(f=>({page:f,onPopPage:void 0}));e(f=>[...f,...h])};return{currentPage:r,pushPage:o,pushPages:i,goBackOrClose:()=>{e(u=>u.length<=0?u:u.slice(0,-1))},closeSettings:()=>{e([])}}}function dde(t,e){const n={page:t,onPopPage:e==null?void 0:e.onPopPageCallback};at().set(tU,r=>[...r,n])}function Ub(t){const{pages:e,className:n,children:r,disableLink:o,clickSource:i,onClick:s}=t,{pushPages:a}=L_(),l=()=>{wt.emit("disclaimer:open-settings"),a(e),s==null||s(),nt({source:i??"settingsLink",destination:e[e.length-1]})};return o?d.jsx("span",{children:r}):d.jsx("button",{className:n,type:"button",title:"",onClick:l,children:r})}function hde(){const t=ve(js);return d.jsx("p",{children:d.jsx(co,{i18nKey:"settings.copilotBeta.announcementSubtitle",components:{settingsLink:d.jsx(Ub,{pages:["menu","copilot-beta"],className:"underline",clickSource:"disclaimerSettingsLink",onClick:()=>t(null)})}})})}function fde(){if(!ze("copilot-beta-automatic-opt-in"))return;const t=Ue(cd);if(t===void 0)En(BC,!0),En(cd,!0),Dp();else if(t&&Ue(BC)){const n={title:ee("settings.copilotBeta.announcementTitle"),subtitle:d.jsx(hde,{})};En(js,n),En(BC,void 0)}}function KI(t){if(window.clarity)for(const[e,n]of Object.entries(t))window.clarity("set",e,n)}function hN(t){if(window.clarity)for(const e of t)window.clarity("event",e)}function D_(t){const e=py(),n=m.useRef(t);n.current=t,m.useEffect(()=>e.subscribe("onBeforeNavigate",r=>{const{pathChanged:o}=r;o&&n.current(r)}),[e])}let nU=!0,rU=!0;function pde(t){rU=t}function j_(){return nU}function mde(){D_(()=>{rU||(nU=!1)})}const gde=(t,e,n)=>{const r=t[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((o,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},{slice:vde,forEach:yde}=[];function bde(t){return yde.call(vde.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}const fN=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Cde=(t,e,n)=>{const r=n||{};r.path=r.path||"/";const o=encodeURIComponent(e);let i=`${t}=${o}`;if(r.maxAge>0){const s=r.maxAge-0;if(Number.isNaN(s))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(s)}`}if(r.domain){if(!fN.test(r.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${r.domain}`}if(r.path){if(!fN.test(r.path))throw new TypeError("option path is invalid");i+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},pN={create(t,e,n,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+n*60*1e3)),r&&(o.domain=r),document.cookie=Cde(t,encodeURIComponent(e),o)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let o=n[r];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(e)===0)return o.substring(e.length,o.length)}return null},remove(t){this.create(t,"",-1)}};var Sde={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return pN.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:r,cookieDomain:o,cookieOptions:i}=e;n&&typeof document<"u"&&pN.create(n,t,r,o,i)}},Ide={name:"querystring",lookup(t){var r;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:o}=window.location;!window.location.search&&((r=window.location.hash)==null?void 0:r.indexOf("?"))>-1&&(o=window.location.hash.substring(window.location.hash.indexOf("?")));const s=o.substring(1).split("&");for(let a=0;a<s.length;a++){const l=s[a].indexOf("=");l>0&&s[a].substring(0,l)===e&&(n=s[a].substring(l+1))}}return n}};let Ph=null;const mN=()=>{if(Ph!==null)return Ph;try{Ph=window!=="undefined"&&window.localStorage!==null;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Ph=!1}return Ph};var Ede={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&mN())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&mN()&&window.localStorage.setItem(n,t)}};let Mh=null;const gN=()=>{if(Mh!==null)return Mh;try{Mh=window!=="undefined"&&window.sessionStorage!==null;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Mh=!1}return Mh};var Tde={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&gN())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&gN()&&window.sessionStorage.setItem(n,t)}},wde={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:r,language:o}=navigator;if(n)for(let i=0;i<n.length;i++)e.push(n[i]);r&&e.push(r),o&&e.push(o)}return e.length>0?e:void 0}},_de={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},Ade={name:"path",lookup(t){var o;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(o=n[typeof e=="number"?e:0])==null?void 0:o.replace("/",""):void 0}},kde={name:"subdomain",lookup(t){var o,i;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,r=typeof window<"u"&&((i=(o=window.location)==null?void 0:o.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(r)return r[n]}};function xde(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t}}class oU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e||{languageUtils:{}},this.options=bde(n,this.options||{},xde()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=o=>o.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(Sde),this.addDetector(Ide),this.addDetector(Ede),this.addDetector(Tde),this.addDetector(wde),this.addDetector(_de),this.addDetector(Ade),this.addDetector(kde)}addDetector(e){return this.detectors[e.name]=e,this}detect(e){e||(e=this.options.order);let n=[];return e.forEach(r=>{if(this.detectors[r]){let o=this.detectors[r].lookup(this.options);o&&typeof o=="string"&&(o=[o]),o&&(n=n.concat(o))}}),n=n.map(r=>this.options.convertDetectedLanguage(r)),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e,n){n||(n=this.options.caches),n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}oU.type="languageDetector";const iU=[{name:"Arabic",i18nCode:"ar",direction:"rtl"},{name:"Basque",i18nCode:"eu",direction:"ltr"},{name:"Bengali",i18nCode:"bn-IN",direction:"ltr"},{name:"Bulgarian",i18nCode:"bg",direction:"ltr"},{name:"Catalan",i18nCode:"ca",direction:"ltr"},{name:"Chinese (Simplified)",i18nCode:"zh-Hans",direction:"ltr"},{name:"Chinese (Traditional)",i18nCode:"zh-Hant",direction:"ltr"},{name:"Croatian",i18nCode:"hr",direction:"ltr"},{name:"Czech",i18nCode:"cs",direction:"ltr"},{name:"Danish",i18nCode:"da",direction:"ltr"},{name:"Dutch",i18nCode:"nl",direction:"ltr"},{name:"English (US)",i18nCode:"en-US",direction:"ltr"},{name:"English (UK)",i18nCode:"en-GB",direction:"ltr"},{name:"Estonian",i18nCode:"et",direction:"ltr"},{name:"Finnish",i18nCode:"fi",direction:"ltr"},{name:"French",i18nCode:"fr",direction:"ltr"},{name:"Galician",i18nCode:"gl",direction:"ltr"},{name:"German",i18nCode:"de",direction:"ltr"},{name:"Gujarati",i18nCode:"gu",direction:"ltr"},{name:"Hebrew",i18nCode:"he",direction:"rtl"},{name:"Hindi",i18nCode:"hi",direction:"ltr"},{name:"Hungarian",i18nCode:"hu",direction:"ltr"},{name:"Icelandic",i18nCode:"is",direction:"ltr"},{name:"Indonesian",i18nCode:"id",direction:"ltr"},{name:"Italian",i18nCode:"it",direction:"ltr"},{name:"Japanese",i18nCode:"ja",direction:"ltr"},{name:"Kannada",i18nCode:"kn",direction:"ltr"},{name:"Korean",i18nCode:"ko",direction:"ltr"},{name:"Latvian",i18nCode:"lv",direction:"ltr"},{name:"Lithuanian",i18nCode:"lt",direction:"ltr"},{name:"Malay",i18nCode:"ms",direction:"ltr"},{name:"Malayalam",i18nCode:"ml",direction:"ltr"},{name:"Marathi",i18nCode:"mr",direction:"ltr"},{name:"Norwegian (Bokmål)",i18nCode:"nb-NO",direction:"ltr"},{name:"Polish",i18nCode:"pl",direction:"ltr"},{name:"Portuguese (Brazil)",i18nCode:"pt-BR",direction:"ltr"},{name:"Portuguese (Portugal)",i18nCode:"pt-PT",direction:"ltr"},{name:"Punjabi",i18nCode:"pa",direction:"ltr"},{name:"Romanian",i18nCode:"ro",direction:"ltr"},{name:"Russian",i18nCode:"ru",direction:"ltr"},{name:"Serbian (Latin)",i18nCode:"sr-Latn-RS",direction:"ltr"},{name:"Slovak",i18nCode:"sk",direction:"ltr"},{name:"Slovenian",i18nCode:"sl",direction:"ltr"},{name:"Spanish",i18nCode:"es",direction:"ltr"},{name:"Swedish",i18nCode:"sv",direction:"ltr"},{name:"Tamil",i18nCode:"ta",direction:"ltr"},{name:"Telugu",i18nCode:"te",direction:"ltr"},{name:"Thai",i18nCode:"th",direction:"ltr"},{name:"Turkish",i18nCode:"tr",direction:"ltr"},{name:"Ukrainian",i18nCode:"uk",direction:"ltr"},{name:"Vietnamese",i18nCode:"vi",direction:"ltr"}],sU=iU.map(t=>t.i18nCode);function Rde(t){return U_(t)[0]??t}async function aU(t={}){const e=Rt.use(oU).use(FH);return me.instance().config().useI18nHttpApi&&H(()=>import("./index-DpS4JTDc.js"),__vite__mapDeps([218,2,1])).then(n=>{e.use(n.default)}),e.init({supportedLngs:iU.map(({i18nCode:n})=>n),fallbackLng:U_,detection:{caches:["cookie"],convertDetectedLanguage:Rde,...t},interpolation:{escapeValue:!1}}).then(async n=>(await Nde(Rt.language),Rt.on("languageChanged",r=>{typeof document<"u"&&(document.body.dir=Rt.dir(r.toLowerCase()),document.documentElement.lang=r.toLowerCase())}),n))}async function Nde(t){t&&(await Promise.all(U_(t).map(async e=>{try{const n=await gde(Object.assign({"../../config/strings/af/strings.json":()=>H(()=>import("./strings-Du1bXIpP.js"),[]),"../../config/strings/am/strings.json":()=>H(()=>import("./strings-BGuAHeBK.js"),[]),"../../config/strings/ar/strings.json":()=>H(()=>import("./strings-OhreVweI.js"),[]),"../../config/strings/as/strings.json":()=>H(()=>import("./strings-B1zzT0cy.js"),[]),"../../config/strings/az/strings.json":()=>H(()=>import("./strings-BPVmu5Fj.js"),[]),"../../config/strings/bg/strings.json":()=>H(()=>import("./strings-GJogD35t.js"),[]),"../../config/strings/bn-IN/strings.json":()=>H(()=>import("./strings-BeHzg968.js"),[]),"../../config/strings/bs/strings.json":()=>H(()=>import("./strings-F70nnTUJ.js"),[]),"../../config/strings/ca-Es-VALENCIA/strings.json":()=>H(()=>import("./strings-DCbutsFe.js"),[]),"../../config/strings/ca/strings.json":()=>H(()=>import("./strings-CrC1rBRQ.js"),[]),"../../config/strings/cs/strings.json":()=>H(()=>import("./strings-DsX33GI8.js"),[]),"../../config/strings/cy/strings.json":()=>H(()=>import("./strings-DexaXGbd.js"),[]),"../../config/strings/da/strings.json":()=>H(()=>import("./strings-vG0A52_a.js"),[]),"../../config/strings/de/strings.json":()=>H(()=>import("./strings-8wuQzkgi.js"),[]),"../../config/strings/el/strings.json":()=>H(()=>import("./strings-BtHCdl5e.js"),[]),"../../config/strings/en-GB/strings.json":()=>H(()=>import("./strings-D7AZSuTc.js"),[]),"../../config/strings/en-US/strings.json":()=>H(()=>import("./strings-C1nW1TzB.js"),[]),"../../config/strings/es-MX/strings.json":()=>H(()=>import("./strings-CeLke9I-.js"),[]),"../../config/strings/es/strings.json":()=>H(()=>import("./strings-BhJpwlVz.js"),[]),"../../config/strings/et/strings.json":()=>H(()=>import("./strings-lsL9oJn2.js"),[]),"../../config/strings/eu/strings.json":()=>H(()=>import("./strings-BIo4o5I1.js"),[]),"../../config/strings/fa/strings.json":()=>H(()=>import("./strings-C3GHKMs4.js"),[]),"../../config/strings/fi/strings.json":()=>H(()=>import("./strings-BSSVICgb.js"),[]),"../../config/strings/fil/strings.json":()=>H(()=>import("./strings-DDvg9hmL.js"),[]),"../../config/strings/fr-CA/strings.json":()=>H(()=>import("./strings-BahsPHM7.js"),[]),"../../config/strings/fr/strings.json":()=>H(()=>import("./strings-C9JEOyKm.js"),[]),"../../config/strings/ga/strings.json":()=>H(()=>import("./strings-C5p6ydKb.js"),[]),"../../config/strings/gd/strings.json":()=>H(()=>import("./strings-CDlSWRC-.js"),[]),"../../config/strings/gl/strings.json":()=>H(()=>import("./strings-C6W39ube.js"),[]),"../../config/strings/gu/strings.json":()=>H(()=>import("./strings-C4Jm86Dt.js"),[]),"../../config/strings/he/strings.json":()=>H(()=>import("./strings-DtSu8FR-.js"),[]),"../../config/strings/hi/strings.json":()=>H(()=>import("./strings-D49_nG0K.js"),[]),"../../config/strings/hr/strings.json":()=>H(()=>import("./strings-B7pd9Ydi.js"),[]),"../../config/strings/hu/strings.json":()=>H(()=>import("./strings-DfFIQl_n.js"),[]),"../../config/strings/hy/strings.json":()=>H(()=>import("./strings-gEpSqjOj.js"),[]),"../../config/strings/id/strings.json":()=>H(()=>import("./strings-BqtSzn7N.js"),[]),"../../config/strings/is/strings.json":()=>H(()=>import("./strings-C3ELiShh.js"),[]),"../../config/strings/it/strings.json":()=>H(()=>import("./strings-D5fxauNL.js"),[]),"../../config/strings/ja/strings.json":()=>H(()=>import("./strings-B7i9w0bj.js"),[]),"../../config/strings/ka/strings.json":()=>H(()=>import("./strings-ByQ73SmY.js"),[]),"../../config/strings/kk/strings.json":()=>H(()=>import("./strings-DI_EP-jx.js"),[]),"../../config/strings/km-KH/strings.json":()=>H(()=>import("./strings-BkTMX_ng.js"),[]),"../../config/strings/kn/strings.json":()=>H(()=>import("./strings-Ch6xoBi-.js"),[]),"../../config/strings/ko/strings.json":()=>H(()=>import("./strings-C_OHDqVL.js"),[]),"../../config/strings/kok/strings.json":()=>H(()=>import("./strings-BeN5WCuE.js"),[]),"../../config/strings/lb/strings.json":()=>H(()=>import("./strings-D8OOTatH.js"),[]),"../../config/strings/lo/strings.json":()=>H(()=>import("./strings-swC25_tQ.js"),[]),"../../config/strings/lt/strings.json":()=>H(()=>import("./strings-WXsvK_UX.js"),[]),"../../config/strings/lv/strings.json":()=>H(()=>import("./strings-CIiSjasA.js"),[]),"../../config/strings/mi/strings.json":()=>H(()=>import("./strings-JTVRrNgk.js"),[]),"../../config/strings/mk/strings.json":()=>H(()=>import("./strings-BEdMLbzH.js"),[]),"../../config/strings/ml/strings.json":()=>H(()=>import("./strings-CICVq5pY.js"),[]),"../../config/strings/mr/strings.json":()=>H(()=>import("./strings-Gdi1ng3c.js"),[]),"../../config/strings/ms/strings.json":()=>H(()=>import("./strings-FbbY4wJv.js"),[]),"../../config/strings/mt/strings.json":()=>H(()=>import("./strings-DYjIBKKq.js"),[]),"../../config/strings/nb-NO/strings.json":()=>H(()=>import("./strings-DFFzYFm0.js"),[]),"../../config/strings/ne/strings.json":()=>H(()=>import("./strings-C99WO-Cf.js"),[]),"../../config/strings/nl/strings.json":()=>H(()=>import("./strings-D74f2uj-.js"),[]),"../../config/strings/nn-NO/strings.json":()=>H(()=>import("./strings-8y7PmMZf.js"),[]),"../../config/strings/or/strings.json":()=>H(()=>import("./strings-D8R2DSR9.js"),[]),"../../config/strings/pa/strings.json":()=>H(()=>import("./strings-BYmeiOnt.js"),[]),"../../config/strings/pl/strings.json":()=>H(()=>import("./strings-CnclYRoT.js"),[]),"../../config/strings/pt-BR/strings.json":()=>H(()=>import("./strings-B5ND35xg.js"),[]),"../../config/strings/pt-PT/strings.json":()=>H(()=>import("./strings-P2po1T1M.js"),[]),"../../config/strings/quz/strings.json":()=>H(()=>import("./strings-D_tvzhjx.js"),[]),"../../config/strings/ro/strings.json":()=>H(()=>import("./strings-DxLpCqZa.js"),[]),"../../config/strings/ru/strings.json":()=>H(()=>import("./strings-DlnH8hhb.js"),[]),"../../config/strings/sk/strings.json":()=>H(()=>import("./strings-C7IDHLBt.js"),[]),"../../config/strings/sl/strings.json":()=>H(()=>import("./strings-BgPReH2w.js"),[]),"../../config/strings/sq/strings.json":()=>H(()=>import("./strings-DG21_I8M.js"),[]),"../../config/strings/sr-Cyrl-BA/strings.json":()=>H(()=>import("./strings-DV-7OnP3.js"),[]),"../../config/strings/sr-Cyrl-RS/strings.json":()=>H(()=>import("./strings-9ZyVNfBd.js"),[]),"../../config/strings/sr-Latn-RS/strings.json":()=>H(()=>import("./strings-D1642G7B.js"),[]),"../../config/strings/sv/strings.json":()=>H(()=>import("./strings-CUHVaNrs.js"),[]),"../../config/strings/ta/strings.json":()=>H(()=>import("./strings-DRq6chTX.js"),[]),"../../config/strings/te/strings.json":()=>H(()=>import("./strings-DnA3HUOk.js"),[]),"../../config/strings/th/strings.json":()=>H(()=>import("./strings-DwOohNIa.js"),[]),"../../config/strings/tr/strings.json":()=>H(()=>import("./strings-Hih4giqo.js"),[]),"../../config/strings/tt/strings.json":()=>H(()=>import("./strings-DRVyCI1S.js"),[]),"../../config/strings/ug/strings.json":()=>H(()=>import("./strings-tC6WoqPn.js"),[]),"../../config/strings/uk/strings.json":()=>H(()=>import("./strings-BaOuAZXP.js"),[]),"../../config/strings/ur/strings.json":()=>H(()=>import("./strings-DIn7rjc6.js"),[]),"../../config/strings/uz-Latn-UZ/strings.json":()=>H(()=>import("./strings-Cv7tw0cP.js"),[]),"../../config/strings/vi/strings.json":()=>H(()=>import("./strings-DMZkcUlz.js"),[]),"../../config/strings/zh-Hans/strings.json":()=>H(()=>import("./strings-CISLK1Xb.js"),[]),"../../config/strings/zh-Hant/strings.json":()=>H(()=>import("./strings-B_-69c8h.js"),[])}),`../../config/strings/${e}/strings.json`,6);Rt.addResourceBundle(e,"translation",n,!0,!0)}catch{console.warn(`Translation file for '${e}' not found.`)}})),await Rt.changeLanguage(t))}function UNe(){return Rt.resolvedLanguage?Rt.resolvedLanguage.split("-")[0]==="en":!1}function U_(t){const e="en-US";if(!t)return[e];const n=Pde(t),r=Mde(t),o=Ode(t);return[n,r,o,e].filter(i=>!!i).filter((i,s,a)=>a.indexOf(i)===s)}function Pde(t){return sU.find(e=>e.toLowerCase()===t.toLowerCase())}function Mde(t){if(["en-AU","en-NZ","en-IE"].includes(t))return"en-GB";if(t.startsWith("zh-")){const e=t.toLocaleLowerCase();return e==="zh-TW".toLocaleLowerCase()||e==="zh-HK".toLocaleLowerCase()?"zh-Hant":"zh-Hans"}}function Ode(t){var n;const e=(n=t.split("-")[0])==null?void 0:n.toLowerCase();if(e){const r=sU.find(o=>o.toLowerCase()===e||o.toLowerCase().startsWith(`${e}-`));if(r)return r}}async function Lde(t){try{return(await $n(`/conversations/${t}/history`,f5,{analytics:{anonymousPath:"/conversations/*/history"}}).then(n=>n.data)).results.length>0}catch{return!1}}function cU(){const t=$t();return lU(t)}function lU(t){return/^\/shares\/[a-zA-Z0-9_-]+$/.test(t)}async function Dde(t){const{conversationIdFromUrl:e,conversationIdFromStart:n}=t;return e&&e!=="new"&&await Lde(e)?{conversationId:e,isNew:!1}:n?{conversationId:n,isNew:!0}:{conversationId:null,isNew:!0}}async function jde(t){const{pathname:e,conversationIdFromUrl:n,conversationFromUrlExists:r,urlPrompt:o,features:i,isBanned:s,enablePageRedirect:a,deepLinkTarget:l,search:u}=t;if(!a||s||Ob(i)||navigator.userAgent.toLowerCase().includes("googlebot")&&e==="/")return null;if(o||n==="new")return{to:l==="audioCall"?"/chats/$conversationId/talk":"/chats/$conversationId",from:e,needsConversationId:!0};if(e.startsWith("/shares"))return e.startsWith("/shares/pages")?i.includes("pages")&&!i.includes("kill-shared-page")?null:In(e):e.startsWith("/shares/podcasts")?null:e.startsWith("/shares/3d-generations")?i.includes("kill-share-3d-generations")?In(e):null:i.includes("kill-share-conversation")||!lU(e)?In(e):null;if(e.startsWith("/campaigns"))if(e.startsWith("/campaigns/gallery")){if(!i.includes("share-campaign-gallery"))return In(e)}else if(e.startsWith("/campaigns/image-expression-tool")){if(!i.includes("gallery-expression-tool"))return In(e)}else return i.includes("share-campaign")?null:In(e);if(["/pro/subscribe","/pro/ewallet/return"].includes(e)||e==="/fang")return null;if(e.startsWith("/referrals")&&!i.includes("user-referral")||e.startsWith("/connector")&&!i.includes("google-drive-connector")||e.startsWith("/subscription")&&!i.includes("cmc-m365-sku"))return In(e);if(e.startsWith("/memory/narrative"))return i.includes("memory-narrative")?null:In(e);if(e.endsWith("/talk"))return e.startsWith("/labs/portrait/talk")&&i.includes("labs-portrait-enabled")?{from:e,to:"/labs/portrait",needsConversationId:!1}:In(e);if(e.startsWith("/chats")&&!r)return In(e);if(e.startsWith("/pages"))return i.includes("pages")?null:In(e);if(e.startsWith("/labs")&&(e.startsWith("/labs/portrait")&&!i.includes("labs-portrait-enabled")||e.startsWith("/labs/audio-expression")&&!i.includes("labs-audio-expression")||!me.instance().config().enableLabs)||e.startsWith("/login"))return In(e);if(e.startsWith("/podcasts"))return e.startsWith("/podcasts/user")||e.startsWith("/podcasts/public")?null:In(e);if(e.startsWith("/library")&&!i.includes("library"))return In(e);if(e.includes("/w/landing"))return i.includes("cmc-landing")?null:In(e);if(e==="/"){if(i.includes("start-in-voice"))return null;const h=u==null?void 0:u.get("back");return Ude(h)&&me.instance().config().redirectBackEnabled?{from:"/login",to:new URL(h).pathname,needsConversationId:!1}:In(e)}return e.startsWith("/gallery")?i.includes("creator-gallery")?null:In(e):null}function Ude(t){if(!t)return!1;try{if(new URL(t).origin===window.location.origin)return!0;throw new Error("Invalid redirect URL: not from same origin")}catch{throw new Error("Invalid redirect URL, malformed URL")}}function In(t){return me.instance().config().neverStartInChat?{from:t,to:"/"}:{from:t,to:"/chats/$conversationId",needsConversationId:!0}}function Fde(){try{const{timeZone:t}=Intl.DateTimeFormat().resolvedOptions();return t}catch{return}}function Bde(t){return e=>{const r=(t?Math[t]:Math.trunc)(e);return r===0?0:r}}const Hde=864e5,FNe=6e4,zde=36e5,BNe=43200,HNe=1440,zNe=60;function Vde(t,e){return+rn(t)-+rn(e)}function $de(t,e,n){const r=Vde(t,e)/zde;return Bde(n==null?void 0:n.roundingMethod)(r)}function F_(t){if(!t)return null;let e=null;const n=new Date(t).toISOString(),r=new Date().toISOString(),o=$de(n,r,{roundingMethod:"ceil"});return o>24?e="permanent":o>1&&o<=24?e="24-hr":o>0&&o<=1&&(e="1-hr"),e}function B_(t,e,n){if(!t){tr(p1);return}const r=at();U.trackEvent({name:"system",data:{eventName:"copilotUserBan",eventInfo_banDuration:t,eventInfo_banSource:e,eventInfo_banExpiryTimestamp:n}}),r.set(K5,t),r.set(Ff,"user-banned")}const Gde=oG(),vN=1e4;function Kde(){return setTimeout(()=>{Dr({feature:"start",scenario:"callStartTimeout",errorType:"timeout",errorMessage:`Start call exceeded ${vN}ms timeout`})},vN)}async function qde(t){let e=li("sessionId");const n=li("referralCode");!e&&n&&(e=crypto.randomUUID(),ba("sessionId",e));const r=lde(),o={timeZone:Fde(),startNewConversation:!0,teenSupportEnabled:!0,deviceFingerprint:e??void 0,referralCode:n??void 0,correctPersonalizationSetting:!0,performUserMerge:r},i={};Gde&&(i.overrideFeatures="1");const a=Co(y1,c.boolean())?{maxRetries:3,initialDelayMs:100,maxDelayMs:500,backoffFactor:2,jitterFactor:.1}:void 0,{data:l,response:u,zodError:h}=await $n(t,bQ,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},parseOptions:{safe:!0},query:i,...a&&{retry:a}});if(Lf.trackClientExperimentationAssignment(u.headers),Lf.trackLatestApiAssignment(u.headers),u.status===DE)throw new Error(jE);if(h)throw h;return l}function uU(){const{i18n:t}=xe(),{showBoundary:e}=lO(),n=ve(Ff),r=ve(vO),o=ve(bn),i=ve(kT),s=ve(Dc),a=ve(it),l=ve(W5),u=ve(lT),h=gi(),[f]=Mb(),p=$t(),g=m.useRef(p);g.current=p;const v=AE({strict:!1}),y=m.useRef(v);y.current=v;const b=m.useRef(J$()),C=x(Op),S=m.useRef(C);S.current=C;const I=m.useRef(!0),E=m.useRef(!1),{trigger:T}=tT("/start",qde);return m.useCallback(async w=>{var N;if(!t.language||E.current&&!w.eventDriven)return!1;E.current=!0;const A=que(),{enablePageRedirect:_,overwriteData:L}=w;try{const K=Kde(),{isNewUser:q,banExpiresAt:ae,remainingTurns:O,features:W,currentConversationId:te,allowBeta:D,userId:G}=await T();clearTimeout(K),await aU(),wt.emit("app:start-complete");const re=U.getPicassoId();re!==null&&G!==null&&re!==G&&U.trackEvent({name:"health",data:{eventName:"userIdMismatch",eventInfo_customData:JSON.stringify({existingPicassoId:re,newPicassoId:G??"",origin:"start"})}}),U.setFeatures(W),U.setIsNewUser(q),KI({isNewUser:q.toString()});const J=Gj({featureOverrides:[],localFeatureOverrides:Kj(),serverFeatures:W,surfaceConfig:me.instance().config()});J.includes("kill-picasso-id-on-start")||U.setPicassoId(G??null),J.includes("eager-msal")&&(Ro(v1,c.boolean(),!0),J.includes("msal-silent-sso")&&Ro(sL,c.boolean(),!0)),J.includes("kill-eager-msal")&&tr(v1),J.includes("auth-module-refactor")?Ro(sx,c.boolean(),!0):tr(sx),J.includes("auth-rf-init-auth-account")?Ro(S1,c.boolean(),!0):tr(S1),J.includes("auth-rf-msal-event-removal")?Ro(I1,c.boolean(),!0):tr(I1),J.includes("start-retry")?Ro(y1,c.boolean(),!0):tr(y1);const ne=F_(ae),X=Ob(J),Ie=await Dde({conversationIdFromUrl:X?void 0:y.current.conversationId,conversationIdFromStart:X?void 0:te});let{conversationId:Ce}=Ie;if(!Ce){const{id:ue}=await Jj("/conversations",{arg:{isPrivate:X}});Ce=ue,X&&i(ue)}const be=await jde({pathname:g.current,conversationIdFromUrl:y.current.conversationId,conversationFromUrlExists:y.current.conversationId===Ce,urlPrompt:((N=S.current)==null?void 0:N.prompt)??null,features:J,enablePageRedirect:_,isBanned:!!ne,deepLinkTarget:f,search:new URLSearchParams(window.location.search)});o(ue=>{if(!L&&ue.size>0)return ue;const Me=new Map([[Ce,{id:Ce,updatedAt:new Date().toISOString(),history:[],isNew:Ie.isNew,characterId:null,streamingState:"idle",continuedAt:null}]]);return!Ie.isNew&&te&&Me.set(te,{id:te,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:null,streamingState:"idle",continuedAt:null}),Me}),a(ue=>ue&&!L?ue:Ce),r(ue=>ue.length>0&&!L?ue:J),s(O),l(q),u(D??!1),D&&fde(),B_(ne,"start",ae),I.current&&(I.current=!1,be&&await h({...be,params:be.needsConversationId?{conversationId:Ce}:{},search:b.current}))}catch(K){if(U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"StartEndpointError",eventInfo_errorMessage:K instanceof Error?K.message:"",eventInfo_details:K instanceof Error?K.stack??"":""}}),K instanceof Error&&K.message===jE)return n("age-verification"),!0;console.error(K),e(K)}finally{pde(!1)}return!0},[T,o,a,i,n,r,s,l,u,h,t.language,e,f])}const yN=nl.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),f0={dedupe:!0},Wde=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:l,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:p}=n,[g,v,y,b]=No.get(r),[C,S]=Ts(t),I=m.useRef(!1),E=m.useRef(!1),T=m.useRef(C),w=m.useRef(e),A=m.useRef(n),_=()=>A.current,L=()=>_().isVisible()&&_().isOnline(),[N,K,q,ae]=Pi(r,C),O=m.useRef({}).current,W=De(s)?n.fallback[C]:s,te=(k,B)=>{for(const ge in O){const M=ge;if(M==="data"){if(!o(k[M],B[M])&&(!De(k[M])||!o(be,B[M])))return!1}else if(B[M]!==k[M])return!1}return!0},D=m.useMemo(()=>{const k=!C||!e?!1:De(a)?_().isPaused()||i?!1:De(l)?!0:l:a,B=Z=>{const Ee=go(Z);return delete Ee._k,k?{isValidating:!0,isLoading:!0,...Ee}:Ee},ge=N(),M=ae(),Q=B(ge),fe=ge===M?Q:B(M);let z=Q;return[()=>{const Z=B(N());return te(Z,z)?(z.data=Z.data,z.isLoading=Z.isLoading,z.isValidating=Z.isValidating,z.error=Z.error,z):(z=Z,Z)},()=>fe]},[r,C]),G=Sy.useSyncExternalStore(m.useCallback(k=>q(C,(B,ge)=>{te(ge,B)||k()}),[r,C]),D[0],D[1]),re=!I.current,J=g[C]&&g[C].length>0,ne=G.data,X=De(ne)?W:ne,Ie=G.error,Ce=m.useRef(X),be=p?De(ne)?Ce.current:ne:X,ue=J&&!De(Ie)?!1:re&&!De(a)?a:_().isPaused()?!1:i?De(X)?!1:l:De(X)||l,Me=!!(C&&e&&re&&ue),Ye=De(G.isValidating)?Me:G.isValidating,le=De(G.isLoading)?Me:G.isLoading,we=m.useCallback(async k=>{const B=w.current;if(!C||!B||E.current||_().isPaused())return!1;let ge,M,Q=!0;const fe=k||{},z=!y[C]||!fe.dedupe,Z=()=>Mc?!E.current&&C===T.current&&I.current:C===T.current,Ee={isValidating:!1,isLoading:!1},tt=()=>{K(Ee)},ht=()=>{const Ve=y[C];Ve&&Ve[1]===M&&delete y[C]},mt={isValidating:!0};De(N().data)&&(mt.isLoading=!0);try{if(z&&(K(mt),n.loadingTimeout&&De(N().data)&&setTimeout(()=>{Q&&Z()&&_().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[B(S),Oc()]),[ge,M]=y[C],ge=await ge,z&&setTimeout(ht,n.dedupingInterval),!y[C]||y[C][1]!==M)return z&&Z()&&_().onDiscarded(C),!1;Ee.error=dn;const Ve=v[C];if(!De(Ve)&&(M<=Ve[0]||M<=Ve[1]||Ve[1]===0))return tt(),z&&Z()&&_().onDiscarded(C),!1;const rt=N().data;Ee.data=o(rt,ge)?rt:ge,z&&Z()&&_().onSuccess(ge,C,n)}catch(Ve){ht();const rt=_(),{shouldRetryOnError:xt}=rt;rt.isPaused()||(Ee.error=Ve,z&&Z()&&(rt.onError(Ve,C,rt),(xt===!0||Rr(xt)&&xt(Ve))&&(!_().revalidateOnFocus||!_().revalidateOnReconnect||L())&&rt.onErrorRetry(Ve,C,rt,qt=>{const Wt=g[C];Wt&&Wt[0]&&Wt[0](Nr.ERROR_REVALIDATE_EVENT,qt)},{retryCount:(fe.retryCount||0)+1,dedupe:!0})))}return Q=!1,tt(),!0},[C,r]),Ke=m.useCallback((...k)=>Ey(r,T.current,...k),[]);if(Do(()=>{w.current=e,A.current=n,De(ne)||(Ce.current=ne)}),Do(()=>{if(!C)return;const k=we.bind(dn,f0);let B=0;const M=eT(C,g,(Q,fe={})=>{if(Q==Nr.FOCUS_EVENT){const z=Date.now();_().revalidateOnFocus&&z>B&&L()&&(B=z+_().focusThrottleInterval,k())}else if(Q==Nr.RECONNECT_EVENT)_().revalidateOnReconnect&&L()&&k();else{if(Q==Nr.MUTATE_EVENT)return we();if(Q==Nr.ERROR_REVALIDATE_EVENT)return we(fe)}});return E.current=!1,T.current=C,I.current=!0,K({_k:S}),ue&&(De(X)||Es?k():QE(k)),()=>{E.current=!0,M()}},[C]),Do(()=>{let k;function B(){const M=Rr(u)?u(N().data):u;M&&k!==-1&&(k=setTimeout(ge,M))}function ge(){!N().error&&(h||_().isVisible())&&(f||_().isOnline())?we(f0).then(B):B()}return B(),()=>{k&&(clearTimeout(k),k=-1)}},[u,h,f,C]),m.useDebugValue(be),i&&De(X)&&C){if(!Mc&&Es)throw new Error("Fallback data is required when using suspense in SSR.");w.current=e,A.current=n,E.current=!1;const k=b[C];if(!De(k)){const B=Ke(k);yN(B)}if(De(Ie)){const B=we(f0);De(be)||(B.status="fulfilled",B.value=!0),yN(B)}else throw Ie}return{mutate:Ke,get data(){return O.data=!0,be},get error(){return O.error=!0,Ie},get isValidating(){return O.isValidating=!0,Ye},get isLoading(){return O.isLoading=!0,le}}},Il=ZE(Wde);function Yde(){const{cache:t,mutate:e}=XE(),n=m.useCallback(async()=>{for(const o of t.keys())await e(o,void 0,{revalidate:!1})},[t,e]),r=m.useCallback(async o=>{await e(o,void 0,{revalidate:!1})},[e]);return{clearAllSWRCache:n,clearOneSWRCache:r}}function Qde(){tr(aL),tr(f1),tr(ad),tr(Ry)}function Wd(){const t=uU(),e=$t(),n=gi(),{clearAllSWRCache:r}=Yde(),o=async a=>{const{provider:l,opts:u={},onAuthComplete:h,onAuthError:f}=a;await Rs.instance().logIn(l,u).catch(p=>{console.error(p),f==null||f()})},i=async(a=!0)=>{await r(),Qde(),cde(),await Rs.instance().logOut().then(async()=>{a&&(await n({to:"/",from:e}),await t({enablePageRedirect:!1,overwriteData:!0}))})};return{login:o,logout:i,switchMicrosoftAccount:async()=>{await i(),await o({provider:"microsoft"})}}}function Jde({accountActionRequired:t,onReload:e}){const{t:n}=xe(),r=rl(),{login:o}=Wd(),{reason:i,provider:s,loginHint:a}=t,l=async p=>{nt({source:"sessionExpired",scenario:"continueWithMicrosoftWithLoginHint",destination:"continueWithMicrosoftRedirect"}),XC({authWorkflowAccountType:"microsoft",apiName:"msal:reauthStart"});const{msal:g}=await gr.get();await g.acquireTokenRedirect({...qE,loginHint:p,account:g.getAccountByUsername(p)??void 0,prompt:void 0})},u=async()=>{if(i==="token-expired"&&t.provider==="microsoft"){const{msal:p}=await gr.get();if(!ze("auth-rf-logout-clear"))await p.clearCache();else{const g=p.getActiveAccount();await p.clearCache({account:g})}}},h=async(p,g)=>{await u();let v="";switch(p==="microsoft"?(v="MSA",XC({authWorkflowAccountType:"microsoft",apiName:"msal:reauthStart"})):p==="auth0"&&(v=(g==null?void 0:g.connection)==="apple"?"Apple":"Google",XC({authWorkflowAccountType:(g==null?void 0:g.connection)??"google",apiName:lo.REAUTH_START})),nt({source:"sessionExpired",scenario:`continueWith${v}`,destination:`continueWith${v}Redirect`}),p){case"microsoft":o({provider:p});break;case"auth0":o({provider:p,opts:g});break}},f=async()=>{gn({source:"signin",scenario:"sessionExpired"}),await u(),o({provider:"microsoft"})};return d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"pb-3 text-lg",children:n("authentication.sessionExpired")}),d.jsx("p",{className:"pb-7",children:n("authentication.sessionExpiredMessage")}),i==="token-expired"&&s==="microsoft"&&a&&d.jsx(Te,{onClick:()=>l(a),title:`${n("signInPrompt.continueAs",{name:a})}`,variant:"pill",size:"48-lg",className:"w-full",children:`${n("signInPrompt.continueAs",{name:a})}`}),r?d.jsxs(d.Fragment,{children:[d.jsxs(Te,{onClick:()=>h("microsoft"),title:n("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(Cy,{className:"size-6"}),n("signInPrompt.continueWithMicrosoft")]}),d.jsxs(Te,{onClick:()=>h("auth0",{connection:"apple"}),title:n("signInPrompt.continueWithApple"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(GE,{className:"size-6 text-black dark:text-white"}),n("signInPrompt.continueWithApple")]}),d.jsxs(Te,{onClick:()=>h("auth0",{connection:"google"}),title:n("signInPrompt.continueWithGoogle"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[d.jsx(KE,{className:"size-6"}),n("signInPrompt.continueWithGoogle")]})]}):d.jsx(Te,{onClick:f,title:n("common.loginText"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:n("common.loginText")}),d.jsx(Te,{onClick:e,title:n("signInPrompt.continueWithoutSignIn"),variant:"pill",color:"subtle-dimmed-inverted",size:"48-lg",className:"mt-3 w-full",children:n("signInPrompt.continueWithoutSignIn")})]})}const H_={type:"spring",mass:.5,stiffness:450,damping:35},Xde={type:"spring",mass:.5,stiffness:450,damping:35},VNe={type:"spring",mass:1.8,stiffness:440,damping:40},qI={type:"spring",mass:1.4,stiffness:320,damping:40},dU={type:"spring",mass:1,stiffness:1200,damping:40},hU={type:"spring",mass:1.8,stiffness:640,damping:40},$Ne={type:"spring",mass:3.2,stiffness:640,damping:40},Ho={type:"spring",mass:.5,stiffness:450,damping:35},bN={duration:1.2,ease:"easeInOut",repeat:3,repeatType:"reverse",type:"tween"},fU=.2,pU=.25,Zde=1.5,ehe=[.16,1,.3,1];function the(t,e){const{children:n,id:r,role:o,className:i,mode:s="wait",duration:a=jo.default,exitDuration:l=jo.default,exitDelay:u=0,delay:h=0,delayChildren:f=0,onAnimationComplete:p,"data-testid":g,initial:v="initial"}=t;return d.jsx(Mn,{mode:s,children:n&&d.jsx(Ne.div,{animate:"animate",exit:"exit",ref:e,role:o,initial:v,variants:{initial:ot,animate:Lt,exit:{...ot,transition:{duration:l,delay:u}}},transition:{duration:a,ease:"easeInOut",delay:h,delayChildren:f},className:i,onAnimationComplete:p,"data-testid":g,children:n},r)})}const wn=m.forwardRef(the),jp=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M4.20889 10.7327C3.9232 11.0326 3.93475 11.5074 4.23467 11.7931C4.5346 12.0788 5.00933 12.0672 5.29502 11.7673L11.2495 5.516V20.25C11.2495 20.6642 11.5853 21 11.9995 21C12.4137 21 12.7495 20.6642 12.7495 20.25V5.51565L18.7043 11.7673C18.99 12.0672 19.4648 12.0788 19.7647 11.7931C20.0646 11.5074 20.0762 11.0326 19.7905 10.7327L12.7238 3.31379C12.5627 3.14474 12.3573 3.04477 12.1438 3.01386C12.0971 3.00477 12.0489 3 11.9995 3C11.9498 3 11.9012 3.00483 11.8543 3.01406C11.6412 3.04518 11.4363 3.14509 11.2756 3.31379L4.20889 10.7327Z"})),GNe=Object.freeze(Object.defineProperty({__proto__:null,default:jp},Symbol.toStringTag,{value:"Module"})),Mr=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M4.39705 4.55379L4.46967 4.46967C4.73594 4.2034 5.1526 4.1792 5.44621 4.39705L5.53033 4.46967L12 10.939L18.4697 4.46967C18.7626 4.17678 19.2374 4.17678 19.5303 4.46967C19.8232 4.76256 19.8232 5.23744 19.5303 5.53033L13.061 12L19.5303 18.4697C19.7966 18.7359 19.8208 19.1526 19.6029 19.4462L19.5303 19.5303C19.2641 19.7966 18.8474 19.8208 18.5538 19.6029L18.4697 19.5303L12 13.061L5.53033 19.5303C5.23744 19.8232 4.76256 19.8232 4.46967 19.5303C4.17678 19.2374 4.17678 18.7626 4.46967 18.4697L10.939 12L4.46967 5.53033C4.2034 5.26406 4.1792 4.8474 4.39705 4.55379L4.46967 4.46967L4.39705 4.55379Z",fill:"currentColor"})),KNe=Object.freeze(Object.defineProperty({__proto__:null,default:Mr},Symbol.toStringTag,{value:"Module"}));function Yd(){const[t,e]=m.useState(document.body.dir==="rtl");return m.useEffect(()=>{const n=new MutationObserver(()=>{e(document.body.dir==="rtl")});return n.observe(document.body,{attributes:!0,attributeFilter:["dir"]}),()=>n.disconnect()},[]),t}const p0=jo.default,pi=m.forwardRef((t,e)=>{const{isOpen:n,onBack:r,headerText:o,children:i,onClose:s,className:a,disableCloseOutside:l,headerTextClassName:u,headerClassName:h,trapFocus:f=!1,variant:p="modal"}=t,{t:g}=xe(),v=m.useId(),{modalAttributes:y}=ZM({trapFocus:f,legacyTrapFocus:f,alwaysFocusable:f}),b=f?y:{},C=Yd()?-1:1,S=w=>{(l??!s)||w.target===w.currentTarget&&s()},I=w=>{w.stopPropagation()},E=p==="drawer",T=E?{initial:{x:`${C*100}%`},animate:{x:0,transition:qI},exit:{x:`${C*100}%`,transition:{duration:p0}}}:void 0;return d.jsx(wn,{id:String(n),mode:"sync",duration:p0,exitDuration:p0,className:Y("fixed inset-0",jt.modal),children:n&&d.jsxs("div",{...b,role:"dialog","aria-modal":"true","aria-labelledby":o?v:void 0,children:[d.jsx("div",{className:Y("fixed inset-0 bg-stone-850/30 backdrop-blur-[10px] dark:bg-midnight-850/70",jt.modalBackground)}),d.jsx("div",{className:Y("fixed inset-0 flex",E?"items-start justify-end":"items-center justify-center",jt.modal),onClick:S,children:d.jsxs(Ne.div,{...T,className:Be("t-custom-scrollbar flex flex-col gap-3 border border-white/10 bg-background-150 p-6 shadow-xl dark:bg-background-250",E?"h-full w-96":"min-h-[150px] rounded-4xl",a),onClick:I,ref:w=>{typeof e=="function"?e(w):e&&(e.current=w)},children:[d.jsxs("div",{className:Y("flex items-center justify-between gap-2",h),children:[r&&d.jsx(Te,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:g("common.backText"),"aria-label":g("common.backText"),onClick:r,children:d.jsx(jp,{className:"size-5 -rotate-90"})}),o&&d.jsx("h2",{id:v,className:Y("text-foreground-800 text-md-strong",u),children:o}),s&&d.jsx(Te,{className:!r&&!o?"ms-auto":"",variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:g("common.closeText"),"aria-label":g("common.closeText"),onClick:s,children:d.jsx(Mr,{className:"size-5"})})]}),i]})})]})})});pi.displayName="Modal";function mU(t){const{accountActionRequired:e}=t;return d.jsx(pi,{isOpen:!0,children:d.jsx(nhe,{accountActionRequired:e})})}function nhe(t){const{accountActionRequired:e}=t,{reason:n}=e;m.useEffect(()=>{U.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"shown",eventInfo_reason:n}})},[n]);const r=async()=>{if(U.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"reload",eventInfo_reason:n}}),n==="token-expired"&&e.provider==="microsoft"){const{msal:o}=await gr.get();if(!ze("auth-rf-logout-clear"))await o.clearCache();else{const i=o.getActiveAccount();await o.clearCache({account:i})}}Dp()};return n==="login"||n==="logout"?d.jsx("div",{className:"flex max-w-72 flex-col items-center p-1 text-center",children:d.jsx(JV,{reason:n,onReload:r})}):d.jsx("div",{className:"flex max-w-96 flex-col items-center p-1 text-center",children:d.jsx(Jde,{accountActionRequired:e,onReload:r})})}function rhe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function ohe(t){if(!rhe(t)&&typeof t!="number")return!1;const e=rn(t);return!isNaN(Number(e))}function gU(t,e){const n=rn(t);if(isNaN(e))return d1(t,NaN);if(!e)return n;const r=n.getDate(),o=d1(t,n.getTime());o.setMonth(n.getMonth()+e+1,0);const i=o.getDate();return r>=i?o:(n.setFullYear(o.getFullYear(),o.getMonth(),r),n)}function ihe(t,e){return gU(t,e*12)}function she(t,e){return ihe(t,-13)}function Nc(t,e,n="en-US"){var o,i;let r;if(t instanceof Date)r=t;else if(typeof t=="number")r=new Date(t<1e12?t*1e3:t);else if(typeof t=="string")r=new Date(t);else throw new Error(`Invalid date input: ${t}`);if(Number.isNaN(r.getTime()))throw new Error(`Invalid date: ${String(t)}`);switch(e){case"yyyyMMdd":{const s=r.getFullYear(),a=(r.getMonth()+1).toString().padStart(2,"0"),l=r.getDate().toString().padStart(2,"0");return`${s}${a}${l}`}case"yyyyMMdd_HHmmss":{const s=r.getFullYear(),a=(r.getMonth()+1).toString().padStart(2,"0"),l=r.getDate().toString().padStart(2,"0"),u=r.getHours().toString().padStart(2,"0"),h=r.getMinutes().toString().padStart(2,"0"),f=r.getSeconds().toString().padStart(2,"0");return`${s}${a}${l}_${u}${h}${f}`}case"h:mm aa":case"h:mm a":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(r);case"h":return((o=new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(r).find(l=>l.type==="hour"))==null?void 0:o.value)??"";case"mm":return new Intl.DateTimeFormat(n,{minute:"2-digit"}).format(r).padStart(2,"0");case"a":return((i=new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(r).find(l=>l.type==="dayPeriod"))==null?void 0:i.value)??"";case"PP":return new Intl.DateTimeFormat(n,{year:"numeric",month:"short",day:"numeric"}).format(r);case"EEEE":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(r);case"eeee":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(r);case"MMMM":return new Intl.DateTimeFormat(n,{month:"long"}).format(r);case"d":return r.getDate().toString();case"MM/dd":{const s=(r.getMonth()+1).toString().padStart(2,"0"),a=r.getDate().toString().padStart(2,"0");return`${s}/${a}`}case"MMM d":return new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(r);case"MMM":return new Intl.DateTimeFormat(n,{month:"short"}).format(r);case"eee, MMM d":return new Intl.DateTimeFormat(n,{weekday:"short",month:"short",day:"numeric"}).format(r);case"eee":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(r);case"EE":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(r);case"h:mma":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(r).replace(" ","");case"haaa":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).format(r).replace(/\s+/g,"").toLowerCase();case"yyyy":return r.getFullYear().toString();case"MM":return(r.getMonth()+1).toString().padStart(2,"0");case"dd":return r.getDate().toString().padStart(2,"0");case"HH":return r.getHours().toString().padStart(2,"0");case"HH:mm":{const s=r.getHours().toString().padStart(2,"0"),a=r.getMinutes().toString().padStart(2,"0");return`${s}:${a}`}case"HH:mm:ss":{const s=r.getHours().toString().padStart(2,"0"),a=r.getMinutes().toString().padStart(2,"0"),l=r.getSeconds().toString().padStart(2,"0");return`${s}:${a}:${l}`}case"ss":return r.getSeconds().toString().padStart(2,"0");default:return r.toLocaleString(n)}}function z_(t,e){if(t){if(t.indexOf("-")!==-1)return t;if(e)return`${t}-${e}`}else if(e)return e;return"en-US"}const El=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{id:"Chevron"},m.createElement("path",{id:"Shape",d:"M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z",fill:"currentColor"}))),qNe=Object.freeze(Object.defineProperty({__proto__:null,default:El},Symbol.toStringTag,{value:"Module"})),ahe={top:36,bottom:36,left:24,right:24};function Fm(t){const{ariaLabelId:e,options:n,renderOption:r,onSelect:o,value:i,id:s,actionLabel:a,placeholder:l,className:u,menuClassName:h,expandIconClassName:f,disabled:p=!1,isValid:g=!0,supportsBrowserAutofill:v,supportsTypeahead:y=!1,autoComplete:b,boundary:C,padding:S=ahe}=t,[I,E]=m.useState(!1),[T,w]=m.useState(null),A=n.findIndex(ue=>ue.key===i),_=m.useRef([]),L=m.useRef([]),N=m.useCallback(ue=>{var Ye;const Me=(Ye=n[ue])==null?void 0:Ye.key;Me&&o(Me)},[o,n]),{refs:K,floatingStyles:q,context:ae}=dp({placement:"bottom-start",strategy:"absolute",open:I,onOpenChange:E,whileElementsMounted:wd,middleware:[hp({padding:S}),eO({boundary:C,apply({rects:ue,elements:Me,availableHeight:Ye}){Object.assign(Me.floating.style,{maxHeight:`${Ye}px`,minWidth:`${ue.reference.width}px`})},padding:S})]}),O=kE(ae,{event:"mousedown",enabled:!p}),W=xE(ae),te=RE(ae,{role:"listbox"}),D=JB(ae,{listRef:_,activeIndex:T,selectedIndex:A,onNavigate:w,loop:!0,focusItemOnHover:!1,openOnArrowKeyDown:!p}),G=XB(ae,{enabled:y,listRef:L,activeIndex:T,onMatch:I?w:N}),{getReferenceProps:re,getFloatingProps:J,getItemProps:ne}=NE([W,te,D,O,G]),X=m.useCallback(ue=>{o(ue),E(!1)},[o]),Ie=A>-1?r(n[A]):d.jsx("div",{className:"truncate text-foreground-550 dark:text-slate-400",children:l}),Ce=m.useCallback(ue=>{p||o(ue.currentTarget.value)},[o,p]),be=m.useRef(null);return d.jsxs(d.Fragment,{children:[v&&d.jsx("select",{"aria-hidden":!0,className:"hidden",onChange:Ce,autoComplete:b,disabled:p,children:n.map(ue=>d.jsx("option",{value:ue.key,children:ue.text},ue.key))}),d.jsxs("button",{role:"combobox",type:"button",id:s,ref:K.setReference,"aria-labelledby":e,"aria-expanded":I,"aria-haspopup":"listbox","aria-autocomplete":"none","aria-invalid":!g,"aria-disabled":p,className:Y("flex w-full cursor-pointer items-center justify-between gap-2 rounded-2xl bg-black/5 px-[1.125rem] py-4 dark:bg-midnight-550/25",u,p&&"pointer-events-none opacity-50"),...re(),children:[d.jsx("div",{className:"min-w-0",children:Ie}),d.jsxs("div",{className:Y("flex min-h-[26px] shrink-0 grow items-center justify-end gap-2",f),children:[a&&d.jsx("span",{children:a}),d.jsx(El,{className:"size-6 rotate-90"})]})]}),d.jsx("div",{ref:be}),I&&d.jsx(my,{root:be.current,children:d.jsx(gy,{context:ae,modal:!1,children:d.jsx("div",{ref:K.setFloating,style:q,className:Y("flex overflow-hidden rounded-2xl shadow-md",h),...J(),children:d.jsx("div",{className:Y("flex w-full flex-col p-2",PV),children:d.jsx("div",{className:Y("vertical-scrollbar overflow-y-auto py-1 pe-1"),children:n.map((ue,Me)=>d.jsx("div",{ref:Ye=>{_.current[Me]=Ye,L.current[Me]=ue.text},role:"option",tabIndex:Me===T?0:-1,"aria-selected":Me===A&&Me===T,className:"relative cursor-default rounded-xl px-3 py-2 -outline-offset-2 hover:bg-black/5 dark:hover:bg-white/8",...ne({onClick(){X(ue.key)},onKeyDown(Ye){Ye.key==="Enter"&&(Ye.preventDefault(),X(ue.key))}}),children:r(ue)},ue.key))})})})})})]})}function CN(t){const{htmlFor:e,content:n,required:r,className:o,afterContent:i}=t;return d.jsxs("div",{className:"flex items-center",children:[d.jsxs("label",{htmlFor:e,className:Y("flex items-center gap-0.5 text-foreground-900",o),children:[n,r&&d.jsx("span",{className:"text-system-red-550 dark:text-system-red-350",children:"*"})]}),i]})}function Fb(){const t=$t();return t==="/discover"||t==="/"}const Jv={CLOSE_BUTTON:"closeButton",ONE_LINE_COMPOSER:"oneLineComposer",IMAGE_VIEWER:"imageViewer"},V_=P(),che=P(t=>{const e=t(V_);if(!(!e||!Array.isArray(e.media)||typeof e.currentMediaIndex!="number"))return e.media[e.currentMediaIndex]});function vU(){return x(che)}function lhe(t){var e;gn({source:"mediaViewerOpen",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type})}function uhe(){var e,n;const t=$_();t&&gn({source:"mediaViewerNext",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type,destination:(n=t.media[t.currentMediaIndex+1])==null?void 0:n.type})}function dhe(){var e,n;const t=$_();t&&gn({source:"mediaViewerPrevious",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type,destination:(n=t.media[t.currentMediaIndex-1])==null?void 0:n.type})}function SN(){var e;const t=$_();t&&gn({source:"mediaViewerClose",scenario:(e=t.media[t.currentMediaIndex])==null?void 0:e.type})}function $_(){return at().get(V_)}const Up=P(!1),hhe=P();function yU(){const[t,e]=Ze(hhe);return{isPictureInPictureOpen:se("video-picture-in-picture")&&t!==void 0,openPictureInPicture:i=>{e(i),nt({source:"mediaViewer",scenario:"PictureInPictureOpen"})},closePictureInPicture:()=>e(void 0)}}function Us(){var p;const[t,e]=Ze(V_),n=ve(Up),{openPictureInPicture:r}=yU(),o=se("video-picture-in-picture"),i=m.useCallback(()=>{const{onClose:g}=t??{};SN(),n(!1),e(void 0),g==null||g()},[e,t,n]),s=m.useCallback(()=>{uhe(),e(g=>{if(!g)return g;if(g.currentMediaIndex<g.media.length-1){const v=g.currentMediaIndex+1;return{...g,currentMediaIndex:v,isCurrentMediaLoading:m0(g.media[v])}}return g})},[e]),a=m.useCallback(()=>{dhe(),e(g=>{if(!g)return g;if(g.currentMediaIndex>0){const v=g.currentMediaIndex-1;return{...g,currentMediaIndex:v,isCurrentMediaLoading:m0(g.media[v])}}return g})},[e]),l=m.useCallback(g=>{lhe(g),n(!1),e({...g,isCurrentMediaLoading:m0(g.media[g.currentMediaIndex])})},[e,n]),u=o&&((p=t==null?void 0:t.media[t.currentMediaIndex])==null?void 0:p.type)==="video",h=m.useCallback(()=>{var v;const g=t==null?void 0:t.media[t.currentMediaIndex];if(g&&g.type==="video"){const{player:y}=g;r({url:g.url,title:((v=g.source)==null?void 0:v.title)??"",startTime:(y==null?void 0:y.getCurrentTime())??0}),SN(),e(void 0)}},[t,r,e]),f=(t==null?void 0:t.contentComposerType)??Jv.CLOSE_BUTTON;return m.useMemo(()=>({openMediaViewer:l,closeMediaViewer:i,isMediaViewerOpen:t!==void 0,next:s,previous:a,isPictureInPictureSupported:u,triggerPictureInPicture:h,contentComposerType:f,showOneLineComposerWhenMediaViewerOpen:f===Jv.ONE_LINE_COMPOSER,contentPageType:t==null?void 0:t.contentPageType}),[l,i,t,s,a,u,h,f])}function m0(t){if(t&&"initLoading"in t)return t.initLoading}const IN="bg-gradient-discover-light dark:bg-gradient-discover-dark",fhe="bg-gradient-authentication-light dark:bg-gradient-authentication-dark";function phe(t={}){const{forceGradient:e=!1,gradientType:n}=t,{isMediaViewerOpen:r,contentPageType:o}=Us(),i=Fb(),s=$t()==="/login",a=o==="newsArticle"||o==="newsVideo"||o==="newsGem",l=()=>e?!0:r&&a?!1:i||s,u=()=>n==="discover"?IN:n==="authentication"||s?fhe:IN;return{shouldShowGradient:l(),gradientClass:u()}}const EN="absolute size-full";function Tl(t){const{isBottomFade:e,forceGradient:n,isFixed:r,overrideGradientType:o,customColor:i}=t,s=$t(),{shouldShowGradient:a,gradientClass:l}=phe({forceGradient:n,gradientType:o});return d.jsxs("div",{className:Y(r?"fixed":"absolute",e?"-inset-x-4 bottom-0 h-dvh":"inset-0","overflow-hidden"),children:[d.jsx("div",{className:Y(EN,"bg-none",i??"bg-background-150")}),d.jsx(Mn,{children:a&&d.jsx(Ne.div,{className:Y(EN,l),initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:H_},s)})]})}const bU=P(void 0);function mhe(t){const{buttonClassName:e}=t,{t:n}=xe(),{closeSettings:r}=L_(),o=ve(bU),i=x(it);function s(){gn({source:"complianceLinks",scenario:"cookies",conversationId:i,destination:"#"}),o("more-options"),r()}return d.jsx(Te,{role:"menuitem",variant:"rect",size:"28-xxs",color:"subtle-dimmed-inverted",className:e,title:n("settings.cookies"),onClick:()=>s(),testId:"cookies-compliance-button",children:d.jsx("span",{children:n("settings.cookies")})})}function Bb(t){const e=se("force-cookie-banner-location");return(t&&yy.includes(t))===!0||e}function wl(t,e={}){const{preventReferrer:n=!1}=e,r=n?"noopener,noreferrer":"noopener";return window.open(t,"_blank",r)}const rp="https://www.bing.com/new/termsofuse",Ed="https://go.microsoft.com/fwlink/?LinkId=521839",Xv="https://www.microsoft.com/microsoft-copilot/learn/?form=MG0AUO&OCID=MG0AUO#faqs",mg="hover:underline focus:underline";function TN(t){var e,n;return((n=(e=me.instance().config()).textOverrides)==null?void 0:n.call(e,t))??t}function WNe(t){const{component:e="link",buttonClassName:n}=t,r=x(it),{pushPage:o}=L_(),i=x(Cr),s=Bb(i),a=(u,h)=>{gn({source:"complianceLinks",scenario:u,conversationId:r,destination:h})},l=se("manage-cookies");return d.jsxs("div",{className:Y("flex w-full flex-wrap justify-center gap-x-3 gap-y-1 text-black/80 text-2xs dark:text-white/80",e==="button"?"flex-col p-0":"px-5 py-2"),children:[e==="link"?d.jsx(ghe,{handleAnalytics:a}):d.jsx(vhe,{handleAnalytics:a,className:n??"",setPage:o}),l&&s&&d.jsx(mhe,{buttonClassName:Be(mg,{"text-2xs p-0 min-h-0 mx-0 min-w-0 gap-x-0 safe-hover:bg-transparent dark:safe-hover:bg-transparent dark:text-white/80":e==="link",[n??""]:e==="button"})})]})}function ghe(t){const{handleAnalytics:e}=t;return d.jsxs(d.Fragment,{children:[d.jsx(ha,{href:Ed,title:ee(TN("settings.privacyLink")),className:mg,onClick:()=>e("privacy",Ed),children:ee(TN("settings.privacyLink"))}),d.jsx(ha,{href:rp,title:ee("settings.termsOfServiceLink"),className:mg,onClick:()=>e("terms",rp),children:ee("settings.termsOfServiceLink")}),d.jsx(ha,{href:Xv,title:ee("settings.faqLink"),className:mg,onClick:()=>e("faq",Xv),children:ee("settings.faqLink")})]})}function vhe(t){const{handleAnalytics:e,className:n,setPage:r}=t,o=(i,s)=>{var h;e(i,s);const l=(h=me.instance().config().settingsOverrides)==null?void 0:h.shouldShowPolicyTermsQRCodes,u={privacy:"privacyStatement",terms:"terms",faq:"faq",cookies:void 0};l&&i in u?r==null||r(u[i]):wl(s)};return d.jsxs(d.Fragment,{children:[d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:ee("settings.privacyLink"),onClick:()=>o("privacy",Ed),children:d.jsx("span",{children:ee("settings.privacyLink")})}),d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:ee("settings.termsOfServiceLink"),onClick:()=>o("terms",rp),children:d.jsx("span",{children:ee("settings.termsOfServiceLink")})}),d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:ee("settings.faqLink"),onClick:()=>o("faq",Xv),children:d.jsx("span",{children:ee("settings.faqLink")})})]})}const wN={...fp,"United Kingdom":"UK"},_N={termsLink:d.jsx(AN,{link:rp}),privacyLink:d.jsx(AN,{link:Ed})};function AN(t){const{children:e,link:n}=t;return d.jsx(ha,{className:"underline",href:n,title:"",children:e})}function yhe(t,e,n){const r=new Date(n,e-1,t);return ohe(r)&&r.getFullYear()===n&&r.getMonth()===e-1&&r.getDate()===t}function bhe(t,e,n){const r=new Date(n,e-1,t),o=she(new Date);return r<=o}const g0="border-2 border-system-red-550/50 bg-system-red-550/10 text-system-red-550 dark:text-system-red-350";function Che(){const[t,e]=m.useState(!1),[n,r]=m.useState(void 0),[o,i]=m.useState(void 0);m.useEffect(()=>{async function _(){const L=await jee();i(L)}_()},[]),m.useEffect(()=>{const _=new URLSearchParams(window.location.search);_.delete("code"),_.delete("state"),_.delete("error"),window.history.replaceState({},document.title,`${window.location.pathname}?${_}`)},[]),m.useEffect(()=>{o&&Ls({page:"auth0AccountVerificationPage",scenario:"auth0Verification",customData:JSON.stringify({accountType:o})})},[o]);const[s,a]=m.useState(""),[l,u]=m.useState(""),[h,f]=m.useState(""),[p,g]=m.useState(wN["United States"]),{i18n:v}=xe(),y=z_(v.resolvedLanguage),b=new Intl.NumberFormat(y,{minimumIntegerDigits:2,useGrouping:!1}),C=new Intl.NumberFormat(y,{minimumIntegerDigits:4,useGrouping:!1});m.useEffect(()=>{e(!!!(l&&h&&s&&p))},[l,h,s,p]);const S=[{key:"01",text:ee("common.date.month.january")},{key:"02",text:ee("common.date.month.february")},{key:"03",text:ee("common.date.month.march")},{key:"04",text:ee("common.date.month.april")},{key:"05",text:ee("common.date.month.may")},{key:"06",text:ee("common.date.month.june")},{key:"07",text:ee("common.date.month.july")},{key:"08",text:ee("common.date.month.august")},{key:"09",text:ee("common.date.month.september")},{key:"10",text:ee("common.date.month.october")},{key:"11",text:ee("common.date.month.november")},{key:"12",text:ee("common.date.month.december")}],I=Object.entries(wN).sort().map(([_,L])=>({key:L,text:_})),E=Array.from({length:31},(_,L)=>{const N=L+1,K=b.format(N);return{key:N.toString(),text:K}}),T=Array.from({length:125},(_,L)=>{const N=new Date().getFullYear()-L,K=C.format(N);return{key:`${new Date().getFullYear()-L}`,text:K}}),w=_=>d.jsx("p",{children:_.text}),A=async()=>{const _=parseInt(s,10),L=parseInt(l,10),N=parseInt(h,10);if(!yhe(N,L,_)){nt({source:"auth0AccountVerificationPage",scenario:"auth0VerificationInvalidDate",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}if(!bhe(N,L,_)){nt({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotAdult",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}const ae=Nc(new Date(_,L-1,N),"yyyy-MM-dd");r(!0);const O=await Dee(ae,p);if(!O){nt({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotSuccessfulInvalidToken",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}const{ageGroup:W}=O,te=W===sc.NOT_ADULT,D=W===sc.ADULT;if(!(te||D)){nt({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotSuccessfulNotTeenOrAdult",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),r(!1);return}nt({source:"auth0AccountVerificationPage",scenario:"auth0VerificationSuccessful",destination:"auth0AccountVerificationPage",customData:JSON.stringify({accountType:o})}),Dp()};return d.jsxs(d.Fragment,{children:[d.jsx(Tl,{forceGradient:!0,overrideGradientType:"authentication"}),d.jsxs("section",{className:"relative m-auto flex min-h-dvh max-w-[500px] flex-col items-center justify-center gap-3 overflow-y-auto px-5 py-12 text-center",children:[d.jsx("h1",{className:"mb-4 text-center font-semibold text-xl sm:text-3xl",children:ee("error.auth0VerificationTitle")}),d.jsx("p",{children:ee("error.auth0VerificationDescription")}),d.jsxs("div",{className:"mt-12 w-full",children:[d.jsx(CN,{className:"mb-2 text-base",htmlFor:"birthdate-month",content:ee("error.auth0VerificationBirthdate"),required:!0}),d.jsxs("div",{id:"birthdate-group",className:"flex gap-2",children:[d.jsx("span",{id:"month-label",className:"sr-only",children:l||ee("dates.month")}),d.jsx("span",{id:"day-label",className:"sr-only",children:h||ee("dates.day")}),d.jsx("span",{id:"year-label",className:"sr-only",children:s||ee("dates.year")}),d.jsx(Fm,{renderOption:w,options:S,onSelect:_=>u(_),id:"birthdate-month",ariaLabelId:"month-label",placeholder:ee("dates.month"),className:Y("flex-1",aa,n===!1&&g0),value:l,isValid:n,menuClassName:jt.dropdownMenuOverModal}),d.jsx(Fm,{renderOption:w,options:E,onSelect:_=>f(_),id:"birthdate-day",ariaLabelId:"day-label",placeholder:ee("dates.day"),className:Y("flex-1",aa,n===!1&&g0),value:h,menuClassName:jt.dropdownMenuOverModal}),d.jsx(Fm,{renderOption:w,options:T,onSelect:_=>a(_),id:"birthdate-year",ariaLabelId:"year-label",placeholder:ee("dates.year"),className:Y("flex-1",aa,n===!1&&g0),value:s,menuClassName:jt.dropdownMenuOverModal})]}),n===!1&&d.jsx("div",{className:Y("mt-2 text-start text-system-red-550 text-sm dark:text-system-red-350"),children:ee("error.authh0VerificationAgeError")})]}),d.jsxs("div",{className:"mt-12 w-full",children:[d.jsx(CN,{className:"mb-2 text-base",htmlFor:"country",content:ee("error.auth0VerificationCountryRegion"),required:!0}),d.jsx(Fm,{renderOption:w,options:I,onSelect:_=>g(_),id:"country","aria-labelledby":"country-group",placeholder:ee("error.auth0VerificationCountryRegion"),className:Y("flex-1",aa),value:p,menuClassName:jt.dropdownMenuOverModal})]}),d.jsxs("div",{className:"mt-12 w-full text-black text-2xs dark:text-white/90",children:[d.jsx(co,{i18nKey:ee("error.auth0VerificationDisclaimer"),components:{termsLink:_N.termsLink,privacyLink:_N.privacyLink}}),d.jsx(Te,{className:"mt-4 w-full",color:"strong",size:"56-xl",variant:"rect",onClick:A,title:ee("common.continue"),disabled:t,children:ee("common.continue")})]})]})]})}function kN(t){var e,n;return((n=(e=me.instance().config()).textOverrides)==null?void 0:n.call(e,t))??t}const v0="w-full";function She(){const{switchMicrosoftAccount:t,logout:e,login:n}=Wd(),{t:r}=xe(),o=rl(),i=async()=>{await t()},s=async(u,h)=>{switch(await e(),u){case"microsoft":n({provider:u});break;case"auth0":n({provider:u,opts:h});break}},a=me.instance().config().hideAgeVerificationButton!==!0,l=me.instance().config().hideAgeVerificationSwitchAccountButton!==!0;return d.jsxs(d.Fragment,{children:[d.jsx(Tl,{forceGradient:!0}),d.jsxs("section",{className:"relative z-10 m-auto flex h-dvh max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[d.jsx("h1",{className:"text-3xl",children:r(kN("error.ageVerificationTitle"))}),d.jsx("h2",{className:"text-foreground-600",children:r(kN("error.ageVerification"))}),a&&d.jsx(Te,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",title:r("error.ageVerificationVerifyAge"),onClick:()=>{Lp(az)},children:r("error.ageVerificationVerifyAge")}),a&&d.jsx("div",{className:"text-balance text-foreground-600",children:r("error.ageVerificationOr")}),o?d.jsxs(d.Fragment,{children:[d.jsxs(Te,{onClick:()=>s("microsoft"),color:"default",title:r("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"56-xl",className:Y(v0),children:[d.jsx(Cy,{className:"size-6"}),r("signInPrompt.continueWithMicrosoft")]}),d.jsxs(Te,{onClick:()=>s("auth0",{connection:"apple"}),color:"default",variant:"pill",size:"56-xl",title:r("signInPrompt.continueWithApple"),className:Y(v0),children:[d.jsx(GE,{className:"size-6 text-black dark:text-white"}),r("signInPrompt.continueWithApple")]}),d.jsxs(Te,{onClick:()=>s("auth0",{connection:"google"}),color:"default",variant:"pill",size:"56-xl",title:r("signInPrompt.continueWithGoogle"),className:Y(v0),children:[d.jsx(KE,{className:"size-6"}),r("signInPrompt.continueWithGoogle")]})]}):l&&d.jsx(Te,{className:"w-full",color:"default",size:"56-xl",variant:"rect",title:r("error.ageVerificationSwitchAccount"),onClick:i,children:r("error.ageVerificationSwitchAccount")})]})]})}function Ihe(){const t=x(Sn);return(t==null?void 0:t.provider)==="auth0"?d.jsx(Che,{}):d.jsx(She,{})}const CU=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M12 4.5C7.85786 4.5 4.5 7.85786 4.5 12C4.5 16.1421 7.85786 19.5 12 19.5C16.1421 19.5 19.5 16.1421 19.5 12C19.5 11.6236 19.4723 11.2538 19.4188 10.8923C19.3515 10.4382 19.6839 10 20.1429 10C20.5138 10 20.839 10.2562 20.8953 10.6228C20.9642 11.0718 21 11.5317 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C14.3051 3 16.4077 3.86656 18 5.29168V4.25C18 3.83579 18.3358 3.5 18.75 3.5C19.1642 3.5 19.5 3.83579 19.5 4.25V7.25C19.5 7.66421 19.1642 8 18.75 8H15.75C15.3358 8 15 7.66421 15 7.25C15 6.83579 15.3358 6.5 15.75 6.5H17.0991C15.7609 5.25883 13.9691 4.5 12 4.5Z",fill:"currentColor"})),YNe=Object.freeze(Object.defineProperty({__proto__:null,default:CU},Symbol.toStringTag,{value:"Module"}));function Ehe(t){const{t:e}=xe(),{onBtnClick:n=()=>{}}=t;return d.jsxs("section",{className:"relative z-10 m-auto flex h-full max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[d.jsx("h1",{className:"text-3xl",children:e("error.unhandledErrorTitle")}),d.jsx("h2",{className:"text-foreground-600",children:e("error.unhandledError")}),d.jsxs(Te,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",title:e("error.unhandledErrorReload"),onClick:n,children:[d.jsx(CU,{className:"size-6"}),e("error.unhandledErrorReload")]})]})}function G_(){return d.jsxs("main",{className:"relative size-full overflow-hidden",children:[d.jsx(Tl,{forceGradient:!0}),d.jsx(Ehe,{onBtnClick:()=>{Dp()}})]})}function The(t,e){return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function K_(t){const e=typeof window<"u"?window.matchMedia(t):null,[n,r]=m.useState(e==null?void 0:e.matches);return m.useEffect(()=>{e&&The(e,o=>r(o.matches))},[t,e]),!!n}const SU={sm:"640",md:"768",lg:"1024",xl:"1280",xxl:"1920"};function ar(t){const{breakpoint:e}=t,n=SU[e];return!K_(`(min-width: ${n}px)`)}function q_(t){const{breakpoint:e}=t,r=`(min-width: ${SU[e]}px)`,o=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia(r):null;return!(o!=null&&o.matches)}function W_(){const t=ar({breakpoint:"sm"});return(me.instance().config().responsiveFullWidthSidebarEnabled??!1)&&t}function IU(){const[t,e]=m.useState(!1);return m.useEffect(()=>{async function n(){const o=await(me.instance().config().isConversationHistoryHidden??(()=>Promise.resolve(!1)))();e(o)}n().catch(()=>{})},[]),t}function Zv(t){const{className:e,text:n}=t;return d.jsx("p",{className:Be("inline h-min flex-none rounded border px-0.5 uppercase text-3xs",e),children:n})}const xN=nl.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),y0={dedupe:!0},whe=(t,e,n)=>{const{cache:r,compare:o,suspense:i,fallbackData:s,revalidateOnMount:a,revalidateIfStale:l,refreshInterval:u,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:p}=n,[g,v,y,b]=No.get(r),[C,S]=Ts(t),I=m.useRef(!1),E=m.useRef(!1),T=m.useRef(C),w=m.useRef(e),A=m.useRef(n),_=()=>A.current,L=()=>_().isVisible()&&_().isOnline(),[N,K,q,ae]=Pi(r,C),O=m.useRef({}).current,W=De(s)?n.fallback[C]:s,te=(k,B)=>{for(const ge in O){const M=ge;if(M==="data"){if(!o(k[M],B[M])&&(!De(k[M])||!o(be,B[M])))return!1}else if(B[M]!==k[M])return!1}return!0},D=m.useMemo(()=>{const k=!C||!e?!1:De(a)?_().isPaused()||i?!1:De(l)?!0:l:a,B=Z=>{const Ee=go(Z);return delete Ee._k,k?{isValidating:!0,isLoading:!0,...Ee}:Ee},ge=N(),M=ae(),Q=B(ge),fe=ge===M?Q:B(M);let z=Q;return[()=>{const Z=B(N());return te(Z,z)?(z.data=Z.data,z.isLoading=Z.isLoading,z.isValidating=Z.isValidating,z.error=Z.error,z):(z=Z,Z)},()=>fe]},[r,C]),G=Sy.useSyncExternalStore(m.useCallback(k=>q(C,(B,ge)=>{te(ge,B)||k()}),[r,C]),D[0],D[1]),re=!I.current,J=g[C]&&g[C].length>0,ne=G.data,X=De(ne)?W:ne,Ie=G.error,Ce=m.useRef(X),be=p?De(ne)?Ce.current:ne:X,ue=J&&!De(Ie)?!1:re&&!De(a)?a:_().isPaused()?!1:i?De(X)?!1:l:De(X)||l,Me=!!(C&&e&&re&&ue),Ye=De(G.isValidating)?Me:G.isValidating,le=De(G.isLoading)?Me:G.isLoading,we=m.useCallback(async k=>{const B=w.current;if(!C||!B||E.current||_().isPaused())return!1;let ge,M,Q=!0;const fe=k||{},z=!y[C]||!fe.dedupe,Z=()=>Mc?!E.current&&C===T.current&&I.current:C===T.current,Ee={isValidating:!1,isLoading:!1},tt=()=>{K(Ee)},ht=()=>{const Ve=y[C];Ve&&Ve[1]===M&&delete y[C]},mt={isValidating:!0};De(N().data)&&(mt.isLoading=!0);try{if(z&&(K(mt),n.loadingTimeout&&De(N().data)&&setTimeout(()=>{Q&&Z()&&_().onLoadingSlow(C,n)},n.loadingTimeout),y[C]=[B(S),Oc()]),[ge,M]=y[C],ge=await ge,z&&setTimeout(ht,n.dedupingInterval),!y[C]||y[C][1]!==M)return z&&Z()&&_().onDiscarded(C),!1;Ee.error=dn;const Ve=v[C];if(!De(Ve)&&(M<=Ve[0]||M<=Ve[1]||Ve[1]===0))return tt(),z&&Z()&&_().onDiscarded(C),!1;const rt=N().data;Ee.data=o(rt,ge)?rt:ge,z&&Z()&&_().onSuccess(ge,C,n)}catch(Ve){ht();const rt=_(),{shouldRetryOnError:xt}=rt;rt.isPaused()||(Ee.error=Ve,z&&Z()&&(rt.onError(Ve,C,rt),(xt===!0||Rr(xt)&&xt(Ve))&&(!_().revalidateOnFocus||!_().revalidateOnReconnect||L())&&rt.onErrorRetry(Ve,C,rt,qt=>{const Wt=g[C];Wt&&Wt[0]&&Wt[0](Nr.ERROR_REVALIDATE_EVENT,qt)},{retryCount:(fe.retryCount||0)+1,dedupe:!0})))}return Q=!1,tt(),!0},[C,r]),Ke=m.useCallback((...k)=>Ey(r,T.current,...k),[]);if(Do(()=>{w.current=e,A.current=n,De(ne)||(Ce.current=ne)}),Do(()=>{if(!C)return;const k=we.bind(dn,y0);let B=0;const M=eT(C,g,(Q,fe={})=>{if(Q==Nr.FOCUS_EVENT){const z=Date.now();_().revalidateOnFocus&&z>B&&L()&&(B=z+_().focusThrottleInterval,k())}else if(Q==Nr.RECONNECT_EVENT)_().revalidateOnReconnect&&L()&&k();else{if(Q==Nr.MUTATE_EVENT)return we();if(Q==Nr.ERROR_REVALIDATE_EVENT)return we(fe)}});return E.current=!1,T.current=C,I.current=!0,K({_k:S}),ue&&(De(X)||Es?k():QE(k)),()=>{E.current=!0,M()}},[C]),Do(()=>{let k;function B(){const M=Rr(u)?u(N().data):u;M&&k!==-1&&(k=setTimeout(ge,M))}function ge(){!N().error&&(h||_().isVisible())&&(f||_().isOnline())?we(y0).then(B):B()}return B(),()=>{k&&(clearTimeout(k),k=-1)}},[u,h,f,C]),m.useDebugValue(be),i&&De(X)&&C){if(!Mc&&Es)throw new Error("Fallback data is required when using suspense in SSR.");w.current=e,A.current=n,E.current=!1;const k=b[C];if(!De(k)){const B=Ke(k);xN(B)}if(De(Ie)){const B=we(y0);De(be)||(B.status="fulfilled",B.value=!0),xN(B)}else throw Ie}return{mutate:Ke,get data(){return O.data=!0,be},get error(){return O.error=!0,Ie},get isValidating(){return O.isValidating=!0,Ye},get isLoading(){return O.isLoading=!0,le}}},_he=ZE(whe),Ahe=t=>Ts(t?t(0,null):null)[0],b0=Promise.resolve(),khe=t=>(e,n,r)=>{const o=m.useRef(!1),{cache:i,initialSize:s=1,revalidateAll:a=!1,persistSize:l=!1,revalidateFirstPage:u=!0,revalidateOnMount:h=!1,parallel:f=!1}=r,[,,,p]=No.get(JE);let g;try{g=Ahe(e),g&&(g=$O+g)}catch{}const[v,y,b]=Pi(i,g),C=m.useCallback(()=>De(v()._l)?s:v()._l,[i,g,s]);Sy.useSyncExternalStore(m.useCallback(_=>g?b(g,()=>{_()}):()=>{},[i,g]),C,C);const S=m.useCallback(()=>{const _=v()._l;return De(_)?s:_},[g,s]),I=m.useRef(S());Do(()=>{if(!o.current){o.current=!0;return}g&&y({_l:l?I.current:S()})},[g,i]);const E=h&&!o.current,T=t(g,async _=>{const L=v()._i,N=v()._r;y({_r:dn});const K=[],q=S(),[ae]=Pi(i,_),O=ae().data,W=[];let te=null;for(let D=0;D<q;++D){const[G,re]=Ts(e(D,f?null:te));if(!G)break;const[J,ne]=Pi(i,G);let X=J().data;const Ie=a||L||De(X)||u&&!D&&!De(O)||E||O&&!De(O[D])&&!r.compare(O[D],X);if(n&&(typeof N=="function"?N(X,re):Ie)){const Ce=async()=>{if(!(G in p))X=await n(re);else{const ue=p[G];delete p[G],X=await ue}ne({data:X,_k:re}),K[D]=X};f?W.push(Ce):await Ce()}else K[D]=X;f||(te=X)}return f&&await Promise.all(W.map(D=>D())),y({_i:dn}),K},r),w=m.useCallback(function(_,L){const N=typeof L=="boolean"?{revalidate:L}:L||{},K=N.revalidate!==!1;return g?(K&&(De(_)?y({_i:!0,_r:N.revalidate}):y({_i:!1,_r:N.revalidate})),arguments.length?T.mutate(_,{...N,revalidate:K}):T.mutate()):b0},[g,i]),A=m.useCallback(_=>{if(!g)return b0;const[,L]=Pi(i,g);let N;if(Rr(_)?N=_(S()):typeof _=="number"&&(N=_),typeof N!="number")return b0;L({_l:N}),I.current=N;const K=[],[q]=Pi(i,g);let ae=null;for(let O=0;O<N;++O){const[W]=Ts(e(O,ae)),[te]=Pi(i,W),D=W?te().data:dn;if(De(D))return w(q().data);K.push(D),ae=D}return w(K)},[g,i,w,S]);return{size:S(),setSize:A,mutate:w,get data(){return T.data},get error(){return T.error},get isValidating(){return T.isValidating},get isLoading(){return T.isLoading}}},xhe=qO(_he,khe);function Y_(t,e,n){const{data:r,error:o,isLoading:i,size:s,setSize:a,mutate:l}=xhe(e,t,{revalidateFirstPage:!!(n!=null&&n.refreshInterval),...n}),u=m.useCallback(async()=>{await l()},[l]),h=m.useCallback(async()=>{await a(s+1)},[a,s]),f=r==null?void 0:r[s-1],p=s>0&&!!r&&typeof f>"u",g=i||p,v=f?!!e(s+1,f):!1;return{loader:{loading:g,hasNextPage:v,error:o,onLoadMore:h,data:r},refetch:u}}function Rhe(t,e){if(!(e!=null&&e.next)&&t>0)return null;const n={url:"/pages",isFirstPage:t===0};return e!=null&&e.next&&(n.args={cursor:e.next}),n}function Nhe(t={}){const{disabled:e=!1}=t,n=bo("kill-shared-page"),r=m.useCallback(async({url:o,args:i})=>{const s={...i,...n?{}:{"api-version":"2"}};return await $n(o,hQ,{query:s,analytics:{anonymousPath:"/pages"}}).then(l=>l.data)},[n]);return Y_(r,e?()=>null:Rhe)}function Phe(){const t=se("pages"),e=se("pages-anonymous"),n=Sr();return{canCreatePageForSignedOut:e&&t,canCreatePage:(n||e)&&t}}function QNe(){nt({pageName:"chatPage",sectionName:"chatResponse",source:"addToPage"})}function JNe(t){nt({pageName:"addToPage",source:t})}function Mhe(){nt({sectionName:"actionMenu",source:"createNewPage"})}function Ohe(t){nt({pageName:t,source:"openPage"})}function XNe(){nt({pageName:"pages",sectionName:"editBar",source:"askCopilot"})}function ZNe(t){const{action:e,pageId:n,conversationId:r,messageId:o,suggestionId:i}=t;nt({pageName:"pages",sectionName:"suggestions",source:e==="accept"?"applyRevision":"reject",conversationId:r,customData:JSON.stringify({eventInfo_pageId:n,eventInfo_messageId:o,eventInfo_suggestionId:i})})}function ePe(t){const{reaction:e,pageId:n,suggestionId:r,messageId:o,startIndex:i,endIndex:s,oldText:a,replacement:l,conversationId:u}=t;nt({pageName:"pages",sectionName:"suggestions",source:"pagesFeedback",scenario:e,conversationId:u,customData:JSON.stringify({eventInfo_pageId:n,eventInfo_reaction:e,eventInfo_suggestionId:r,eventInfo_messageId:o,eventInfo_startIndex:i,eventInfo_endIndex:s,eventInfo_oldText:a,eventInfo_replacement:l})})}function tPe(t){Dr({feature:"page",...t})}const nPe=["createPage","addToExistingPage","openPageOnChat","openPageOnHistory","copyPage"];function rPe(t,e,n){Sa({feature:"page",scenario:t,duration:Math.round(e),customData:JSON.stringify({eventInfo_pageId:n})})}function oPe(){nt({pageName:"pages",source:"hyperlinkInPages"})}function iPe({sectionName:t,pageId:e}){nt({sectionName:t,source:"deletePage",customData:JSON.stringify({eventInfo_pageId:e})})}function sPe({sectionName:t,pageId:e}){nt({sectionName:t,source:"renamePage",customData:JSON.stringify({eventInfo_pageId:e})})}function aPe(t){U.trackEvent({name:"interaction",data:{eventName:"copilotPagesEdited",eventInfo_customData:JSON.stringify({eventInfo_pageId:t})}})}function cPe(t){const{pageName:e,sectionName:n,pageId:r}=t;nt({pageName:e,sectionName:n,source:"pagesSharing",customData:JSON.stringify({eventInfo_pageId:r})})}function lPe(t){const{sectionName:e,pageId:n}=t;nt({sectionName:e,source:"removePagesSharing",customData:JSON.stringify({eventInfo_pageId:n})})}const uPe=["pagesHistory","direct"];function dPe(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pagesSharing",eventInfo_impressionScenario:t}})}const hPe=["responsePreviewedPage","chatCreateNewPage","chatAddToExistingPage","chatDirectToNewPage","pagesHistory","actionMenuCreateNewPage","makeACopyViewerPage","makeACopyOwnerPage","makeACopyViewOnly","makeACopyPagesHistory"];function fPe(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pages",eventInfo_impressionScenario:t}})}function pPe(t){const{pageName:e,sectionName:n,pageId:r}=t;nt({pageName:e,sectionName:n,source:"makePagesCopy",customData:JSON.stringify({eventInfo_pageId:r})})}function mPe(){nt({pageName:"pages",source:"printPage"})}function Lhe(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"threePages",eventInfo_impressionScenario:t}})}const Dhe=c.union([c.literal("open"),c.literal("close")]),EU=c.object({sidebarVisibility:Dhe.optional()});function jhe(t){Ro(iL,EU,{sidebarVisibility:t})}function TU(){var t;return((t=Co(iL,EU))==null?void 0:t.sidebarVisibility)??"close"}function Uhe(){return!me.instance().config().sidebarNavigation||q_({breakpoint:"md"})?!1:TU()!=="close"}const Fa=P(Uhe());function Fhe(){const t=gi(),e=py(),n=ve(Fa);return m.useCallback(async({pageId:r,closeSidebar:o,sourcePage:i,impressionScenario:s,featureLatencyInfo:a})=>{Ohe(i),o&&n(!1),await t({to:"/pages/$pageId",params:{pageId:r},from:e.state.location.pathname,state:{...a,impressionScenario:s}})},[t,e.state.location.pathname,n])}const Bhe=P(t=>t(_l).isOpen||t(wU)),_l=P({isOpen:!1,scenario:null}),wU=P(t=>{const e=t(Dc);return e===null?!1:e===0||t(C5).includes(e)}),Hhe=P(t=>{const e=t(wU),n=t(Oa("location-prompt")),r=t(Zi).filter(({author:i})=>i==="human").length,o=!!yn(mG);return e||!n||o?!1:r===YH}),zhe=at();function na(t){t&&zhe.set(js,{title:t.title,subtitle:t.message,dismissable:!0,dismissAfter:10*1e3})}const RN="/pages";async function Vhe(t,e){const n=await Ur({path:"/pages",args:{body:{title:t,content:e},analytics:{anonymousPath:RN}}}),r=await n.json(),o=pQ.safeParse(r);if(!n.ok&&o.success)throw new Error(o.data.errorCode);try{return lQ.parse(r)}catch(i){throw i instanceof kg&&jf(i,RN,!1),i}}function $he(){const{canCreatePage:t,canCreatePageForSignedOut:e}=Phe(),{t:n}=xe(),[r,o]=m.useState(!1),i=rl(),s=ve(Zr),a=ve(_l),l=Fhe();return{creatingPage:r,createPage:t?async({content:h,sourcePage:f,impressionScenario:p,featureLatencyInfo:g})=>{o(!0);try{const{id:v}=await Vhe("",h);await l({pageId:v,closeSidebar:!0,sourcePage:f,impressionScenario:p,featureLatencyInfo:g})}catch(v){v instanceof Error&&v.message==="page-count-exceeded"&&e?(Lhe(f),s(i?"prompt-3p-sign-in":"prompt-sign-in"),a({isOpen:!0,scenario:"sidebarActionCreatePage",reason:"pageLimitReached"})):na({title:n("common.somethingWrong"),message:n("pages.errorCreatingMessage")})}finally{o(!1)}}:null}}function Ghe(t){const{callback:e,signInScenario:n,onShowSignIn:r,signInReason:o}=t,i=Sr(),s=ve(_l);return(...a)=>{if(!i){s({isOpen:!0,scenario:n,reason:o}),r&&typeof r=="function"&&r();return}e(...a)}}const Khe=P(!1),_U=P(!1),Xh=P(null),qhe=P(!0),Whe=P(-1),gPe=P(!1);function Qd(t){const{createConversation:e}=P_(),n=ve(Zr),r=ve(Op),o=ve(Lb),i=ve(Xh);return m.useCallback(async a=>{try{n(null),r(null),i(null),t==null||t(),await e(a)}finally{o("center")}},[e,o,n,r,i,t])}function Q_({defaultValue:t,controlledValue:e,onChange:n}){const r=e!==void 0,[o,i]=m.useState(t);return m.useEffect(()=>{r&&i(e)},[e,r]),{state:r?e:o,setState:l=>{r||i(l),n==null||n(l)}}}function Hb(t){const{renderTrigger:e,triggerClick:n,children:r,className:o,options:i,isOpen:s,onIsOpenChange:a}=t,{state:l,setState:u}=Q_({controlledValue:s,defaultValue:!1,onChange:a}),{disableFocusManager:h=!1}=i??{},f=Yd(),{refs:p,x:g,y:v,strategy:y,context:b}=dp({open:l,placement:(i==null?void 0:i.placement)??"bottom-end",onOpenChange:u,middleware:[_d((i==null?void 0:i.offset)??1),hp({fallbackAxisSideDirection:"end"}),Ad()],whileElementsMounted:wd}),C=kE(b),S=xE(b),I=RE(b,{role:(i==null?void 0:i.roleType)??"dialog"}),{getReferenceProps:E,getFloatingProps:T}=NE([C,S,I]),w=A=>{i!=null&&i.stopReferencePropagation&&A.stopPropagation(),n==null||n(A)};return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:p.setReference,...E({onClick:w})},l),l&&d.jsx(my,{children:d.jsx(gy,{context:b,modal:!1,disabled:h,returnFocus:(i==null?void 0:i.returnFocus)??!0,children:d.jsx("div",{ref:p.setFloating,style:{position:y,top:`${v}px`,[f?"insetInlineEnd":"insetInlineStart"]:`${g}px`},...T({onClick:A=>{i!=null&&i.stopFloatingPropagation&&A.stopPropagation(),i!=null&&i.hideOnMenuClick&&u(!1)}}),className:Y("flex rounded-2xl p-1.5 shadow-xl",(i==null?void 0:i.overrideZIndex)??jt.modal,o),children:r})})})]})}function AU(t){const{buttonSize:e}=t,{t:n}=xe(),r=Qd(),{createPage:o}=$he(),i=Sr(),s=se("pages-anonymous"),{refetch:a}=Nhe({disabled:!i&&!s}),l=async()=>{Mhe(),await(o==null?void 0:o({content:"",sourcePage:"createNewPage",impressionScenario:"actionMenuCreateNewPage",featureLatencyInfo:{scenario:"createPage",startTimestamp:Date.now()}})),await a()},u=Ghe({callback:l,signInScenario:"sidebarActionCreatePage",signInReason:"createPage"}),h=async()=>{!i&&s?l():u()};return d.jsx(Hb,{options:{placement:"bottom-end",hideOnMenuClick:!0,roleType:"menu"},className:mi,renderTrigger:({onClick:f,...p})=>d.jsx(Te,{...p,title:n("sidebar.actions.menuTitle"),color:"subtle-dimmed-inverted",variant:"rect",size:e,className:"!min-w-7 !px-0",onClick:g=>{nt({source:"sidebarActionsMenu",customData:JSON.stringify({buttonSize:e})}),f(g)},children:d.jsx(El,{className:"size-3.5 rotate-90"})}),children:d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsx(Te,{color:"subtle-dimmed-inverted",size:"40-base",variant:"rect",alignment:"start",title:n("sidebar.actions.newChat"),onClick:async()=>{await r()},children:n("sidebar.actions.newChat")}),d.jsx(Te,{color:"subtle-dimmed-inverted",size:"40-base",alignment:"start",variant:"rect",title:n("sidebar.actions.newPage"),onClick:()=>{setTimeout(()=>{h()},0)},children:n("sidebar.actions.newPage")})]})})}const kU=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M9.15898 16.8666C9.36292 17.0528 9.67918 17.0384 9.86536 16.8345C10.0515 16.6305 10.0371 16.3143 9.8332 16.1281L3.66535 10.4974H17.4961C17.7722 10.4974 17.9961 10.2735 17.9961 9.99736C17.9961 9.72122 17.7722 9.49736 17.4961 9.49736H3.66824L9.8332 3.86927C10.0371 3.68309 10.0515 3.36684 9.86536 3.16289C9.67918 2.95895 9.36292 2.94456 9.15898 3.13074L2.24263 9.44478C2.10268 9.57254 2.02285 9.74008 2.00314 9.91323C1.99851 9.94058 1.99609 9.96869 1.99609 9.99736C1.99609 10.0242 1.99821 10.0506 2.00229 10.0763C2.02047 10.2522 2.10058 10.4229 2.24263 10.5526L9.15898 16.8666Z",fill:"currentColor"})),vPe=Object.freeze(Object.defineProperty({__proto__:null,default:kU},Symbol.toStringTag,{value:"Module"})),zb=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_21044_3802",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20},m.createElement("path",{d:"M19.7803 1.28033C20.0732 0.987435 20.0732 0.512561 19.7803 0.219669C19.4874 -0.0732238 19.0125 -0.0732228 18.7196 0.219671L8.71967 10.2197L8.25 11.75L9.78033 11.2803L19.7803 1.28033ZM4.25 1C2.45507 1 1 2.45508 1 4.25V15.75C1 17.5449 2.45507 19 4.25 19H15.75C17.5449 19 19 17.5449 19 15.75V7.75C19 7.33579 18.6642 7 18.25 7C17.8358 7 17.5 7.33579 17.5 7.75V15.75C17.5 16.7165 16.7165 17.5 15.75 17.5H4.25C3.2835 17.5 2.5 16.7165 2.5 15.75V4.25C2.5 3.2835 3.2835 2.5 4.25 2.5H12.25C12.6642 2.5 13 2.16421 13 1.75C13 1.33579 12.6642 1 12.25 1H4.25Z",fill:"currentColor"})),m.createElement("g",{mask:"url(#mask0_21044_3802)"},m.createElement("rect",{width:24,height:24,transform:"translate(-2 -2)",fill:"currentColor"}))),yPe=Object.freeze(Object.defineProperty({__proto__:null,default:zb},Symbol.toStringTag,{value:"Module"})),J_=t=>m.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M3.75 8.5C3.75 8.08579 4.08579 7.75 4.5 7.75H5.75C6.16421 7.75 6.5 8.08579 6.5 8.5C6.5 8.91421 6.16421 9.25 5.75 9.25H4.5C4.08579 9.25 3.75 8.91421 3.75 8.5ZM3.75 12C3.75 11.5858 4.08579 11.25 4.5 11.25H5.75C6.16421 11.25 6.5 11.5858 6.5 12C6.5 12.4142 6.16421 12.75 5.75 12.75H4.5C4.08579 12.75 3.75 12.4142 3.75 12ZM3.75 15.5C3.75 15.0858 4.08579 14.75 4.5 14.75H5.75C6.16421 14.75 6.5 15.0858 6.5 15.5C6.5 15.9142 6.16421 16.25 5.75 16.25H4.5C4.08579 16.25 3.75 15.9142 3.75 15.5ZM4.25 3C2.45507 3 1 4.45507 1 6.25V17.75C1 19.5449 2.45508 21 4.25 21H19.75C21.5449 21 23 19.5449 23 17.75V6.25C23 4.45507 21.5449 3 19.75 3H4.25ZM19.75 19.5H9V4.5H19.75C20.7165 4.5 21.5 5.2835 21.5 6.25V17.75C21.5 18.7165 20.7165 19.5 19.75 19.5ZM4.25 4.5H7.5V19.5H4.25C3.2835 19.5 2.5 18.7165 2.5 17.75V6.25C2.5 5.2835 3.2835 4.5 4.25 4.5Z",fill:"currentColor"})),bPe=Object.freeze(Object.defineProperty({__proto__:null,default:J_},Symbol.toStringTag,{value:"Module"}));function xU(){const t=x(lT),e=x(cd);return t&&!!e}function Vb(){const t=$t();return t.startsWith("/podcasts")||t.startsWith("/shares/podcasts")}function Yhe(t){const{open:e,toggle:n}=t,r=Qd(),[o]=Ze(Lr),i=x(fl),{t:s}=xe(),a=se("pages"),l=$t(),u=Vb(),h=o==="chat-only"||e,f=xU(),p=!IU(),g=!e&&(l.startsWith("/daily")||l.endsWith("/talk")||u||l.startsWith("/labs/experiments/3d-generations")||l.startsWith("/shares/3d-generations"));return d.jsx("div",{className:Y("pointer-events-none absolute start-0 top-0 w-full p-1 pe-3.5",jt.sidebar),children:d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"absolute flex min-w-full items-center justify-between gap-1 p-1",children:[d.jsx(Mn,{children:g&&d.jsx(Ne.div,{className:Y("pointer-events-auto absolute inset-0 rounded-2xl border border-stroke-100 shadow-md dark:border-stroke-300",mi),initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:Ho})}),d.jsxs("div",{className:"pointer-events-auto flex shrink-0 items-center gap-1","data-theme":i&&!e?i.theme:void 0,children:[(p||h&&e)&&d.jsxs(d.Fragment,{children:[d.jsx(Te,{title:s(e?"sidebar.close":"sidebar.open"),className:"after:absolute after:inset-0 after:rounded-lg hover:after:bg-black/3 dark:hover:after:bg-white/5",color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:()=>{nt({source:"sidebarToggle",pageName:l,customData:JSON.stringify({isOpen:e})}),n()},testId:"sidebar-toggle-button",children:e?d.jsx(kU,{className:"size-4"}):d.jsx(J_,{className:"size-5"})}),f&&!p&&d.jsx(Zv,{text:s("settings.copilotBeta.beta"),className:"me-2 ms-1 uppercase"})]}),h&&(p||!e)&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center rounded-lg hover:bg-black/3 dark:hover:bg-white/5",children:[d.jsx(Te,{title:s("composer.startNewChat"),color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:async()=>{nt({source:"sidebarNewConversation",destination:"/chat",pageName:l,customData:JSON.stringify({isOpen:e})}),await r()},children:d.jsx(zb,{className:"size-4"})}),a&&d.jsx(AU,{buttonSize:"28-xxs"})]}),f&&d.jsx(Zv,{text:s("settings.copilotBeta.beta"),className:"me-2 ms-1 uppercase"})]})]})]})})})}const NN=65,Qhe=100;function PN({count:t=1}){const e=m.useMemo(()=>Array.from({length:t},()=>`${Math.floor(Math.random()*(Qhe-NN+1))+NN}%`),[t]);return d.jsx("div",{className:"flex flex-col gap-5 px-3 py-1",children:e.map((n,r)=>d.jsx("div",{style:{width:n},className:Y("relative h-5 overflow-hidden rounded-lg bg-background-300 opacity-30 dark:bg-background-250 dark:opacity-40","border border-background-300 dark:border-background-250","after:absolute after:-start-[300%] after:end-0 after:start-0 after:h-full","after:opacity-50 dark:after:opacity-5","after:bg-gradient-to-r after:from-transparent after:via-white after:to-transparent","after:bg-[length:80%_100%] after:bg-no-repeat","after:animate-[shimmer-translate_2s_infinite]")},r))})}const Jhe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/labs-entry-BqXQ5OEs.png",RU=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M19.2501 11.0017C20.2166 11.0017 21.0001 11.7852 21.0001 12.7517V19.2517C21.0001 20.2182 20.2166 21.0017 19.2501 21.0017H14.7501C13.7836 21.0017 13.0001 20.2182 13.0001 19.2517V12.7517C13.0001 11.7852 13.7836 11.0017 14.7501 11.0017H19.2501ZM9.26831 15.0141C10.2348 15.0141 11.0183 15.7976 11.0183 16.7641V19.2517C11.0183 20.2182 10.2348 21.0017 9.26831 21.0017H4.75391C3.78741 21.0017 3.00391 20.2182 3.00391 19.2517V16.7641C3.00391 15.7976 3.78741 15.0141 4.75391 15.0141H9.26831ZM19.2501 12.5017H14.7501C14.612 12.5017 14.5001 12.6136 14.5001 12.7517V19.2517C14.5001 19.3898 14.612 19.5017 14.7501 19.5017H19.2501C19.3882 19.5017 19.5001 19.3898 19.5001 19.2517V12.7517C19.5001 12.6136 19.3882 12.5017 19.2501 12.5017ZM9.26831 16.5141H4.75391C4.61584 16.5141 4.50391 16.626 4.50391 16.7641V19.2517C4.50391 19.3898 4.61584 19.5017 4.75391 19.5017H9.26831C9.40639 19.5017 9.51831 19.3898 9.51831 19.2517V16.7641C9.51831 16.626 9.40639 16.5141 9.26831 16.5141ZM9.25391 3C10.2204 3 11.0039 3.7835 11.0039 4.75V11.25C11.0039 12.1682 10.2968 12.9212 9.39743 12.9942L9.25391 13H4.75391C3.78741 13 3.00391 12.2165 3.00391 11.25V4.75C3.00391 3.7835 3.78741 3 4.75391 3H9.25391ZM9.25391 4.5H4.75391C4.61584 4.5 4.50391 4.61193 4.50391 4.75V11.25C4.50391 11.3881 4.61584 11.5 4.75391 11.5H9.25391L9.31123 11.4934C9.42167 11.4675 9.50391 11.3683 9.50391 11.25V4.75C9.50391 4.61193 9.39198 4.5 9.25391 4.5ZM19.2501 3C20.2166 3 21.0001 3.7835 21.0001 4.75V7.25C21.0001 8.2165 20.2166 9 19.2501 9H14.7501C13.7836 9 13.0001 8.2165 13.0001 7.25V4.75C13.0001 3.7835 13.7836 3 14.7501 3H19.2501ZM14.7501 4.5C14.612 4.5 14.5001 4.61193 14.5001 4.75V7.25C14.5001 7.38807 14.612 7.5 14.7501 7.5H19.2501C19.3882 7.5 19.5001 7.38807 19.5001 7.25V4.75C19.5001 4.61193 19.3882 4.5 19.2501 4.5H14.7501Z",fill:"currentColor"})),CPe=Object.freeze(Object.defineProperty({__proto__:null,default:RU},Symbol.toStringTag,{value:"Module"})),NU=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",...t},m.createElement("path",{fill:"currentColor",d:"M4 3h1c1 0 2 .8 2 1.9V19c0 1-.8 2-1.9 2H4c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H5 4Zm6 0h1c1 0 2 .8 2 1.9V19c0 1-.8 2-1.9 2H10c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H11h-1Zm7 2a2 2 0 0 1 1.9 1.3v.2l3 11.7c.3 1-.3 2.1-1.3 2.4h-.1l-1 .3a2 2 0 0 1-2.4-1.3v-.1L14 7.7a2 2 0 0 1 1.3-2.3h.1l1-.3.5-.1ZM5 4.5H4c-.2 0-.4.2-.5.4V19c0 .2.2.4.4.5H5c.2 0 .4-.2.5-.4V5c0-.2-.2-.4-.4-.5H5Zm6 0h-1c-.2 0-.4.2-.5.4V19c0 .2.2.4.4.5H11c.2 0 .4-.2.5-.4V5c0-.2-.2-.4-.4-.5H11Zm6 2h-.2l-1 .3a.5.5 0 0 0-.3.5l3 11.8c.1.3.3.4.5.4h.1l1-.3c.3 0 .4-.3.4-.5l-3-11.8c-.1-.3-.3-.4-.5-.4Z"})),SPe=Object.freeze(Object.defineProperty({__proto__:null,default:NU},Symbol.toStringTag,{value:"Module"}));function MN(t){return t?{x:t.scrollLeft,y:t.scrollTop}:{x:0,y:0}}function Xhe(t,e={}){const{checkIsScrolling:n=!0,scrollEndDelay:r=150}=e,[o,i]=m.useState(MN(t.current)),[s,a]=m.useState(!1),l=m.useRef(void 0);return m.useEffect(()=>{const u=t.current;let h=null;if(u===null)return()=>{};function f(){h===null&&(h=window.requestAnimationFrame(()=>{i(MN(u)),n&&(a(!0),l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{a(!1)},r)),h=null}))}return u.addEventListener("scroll",f),()=>{u.removeEventListener("scroll",f),l.current&&clearTimeout(l.current)}},[n,t,r]),e.checkIsScrolling?{...o,isScrolling:s}:o}function Zhe(t,e){let n=!1;return(...r)=>{n||(t(...r),n=!0,setTimeout(()=>{n=!1},e))}}function ON(t,e=1e3){const n=m.useRef();return m.useEffect(()=>{n.current=t},[t]),m.useMemo(()=>Zhe((...i)=>{var s;(s=n.current)==null||s.call(n,...i)},e),[e])}function efe({onScrollStart:t,onScrollEnd:e,scrollRefs:n}){const r=m.useRef({}),o=ON(s=>{const{target:a}=s;a instanceof Window?r.current={scrollSource:"window",scrollStartTime:Date.now(),scrollStartX:a.scrollX,scrollStartY:a.scrollY}:a instanceof HTMLElement&&(r.current={scrollSource:a.id,scrollStartTime:Date.now(),scrollStartX:a.scrollLeft,scrollStartY:a.scrollTop}),t==null||t(r.current)}),i=ON(s=>{const{target:a}=s;a instanceof Window?(r.current={...r.current,scrollEndX:a.scrollX,scrollEndY:a.scrollY,scrollDuration:Date.now()-(r.current.scrollStartTime??0)},e==null||e(r.current)):a instanceof HTMLElement?(r.current={...r.current,scrollEndX:a.scrollLeft,scrollEndY:a.scrollTop,scrollDuration:Date.now()-(r.current.scrollStartTime??0)},e==null||e(r.current)):r.current={}});m.useEffect(()=>{var a,l;const s={passive:!0};for(const u of n)(a=u.current)==null||a.addEventListener("scroll",o,s),(l=u.current)==null||l.addEventListener("scrollend",i,s);return()=>{var u,h;for(const f of n)(u=f.current)==null||u.removeEventListener("scroll",o),(h=f.current)==null||h.removeEventListener("scrollend",i)}},[n,o,i])}function PU(t){const{scrollableRef:e,customData:n}=t,r=m.useCallback(o=>{window.requestAnimationFrame(()=>{xee({...o,scrollSource:t.source??o.scrollSource,customData:JSON.stringify(n)})})},[n,t.source]);efe({onScrollEnd:r,scrollRefs:[e]})}function gg(t){const{children:e,color:n="neutral",className:r}=t;return d.jsx("div",{className:Be("flex h-4 items-center rounded px-1.5 text-3xs",n==="neutral"?"bg-black/8 text-foreground-550 dark:bg-white/8 dark:text-foreground-650":"bg-accent-350/30 text-accent-650 dark:bg-accent-450/30",r),children:e})}const LN="sticky bg-sidebar-light dark:bg-sidebar-dark",DN="before:pointer-events-none before:absolute before:h-10 before:w-full before:from-sidebar-light before:to-transparent dark:before:from-sidebar-dark",tfe="bg-labs-light dark:bg-labs-dark",nfe=m.lazy(()=>H(()=>import("./sidebar-pages-C_4ELvRE.js"),__vite__mapDeps([219,1,2,220])).then(t=>({default:t.SidebarPages}))),rfe=m.lazy(()=>H(()=>import("./conversations-B4bT0gpZ.js"),__vite__mapDeps([221,1,2,222,223,220,224])));function ofe(){const{t}=xe(),e=$t(),n=gi(),r=Sr(),o=se("pages"),i=se("pages-sidebar-empty-cta"),s=se("pages-anonymous"),a=(r||i||s)&&o,l=me.instance().config().enableLabs;se("creator-gallery");const u=Fb(),h=u||e==="/daily",f=e.startsWith("/library"),p=se("library"),g=e.startsWith("/labs");e.startsWith("/gallery");const v=x(Hy),y=m.useRef(null),{y:b}=Xhe(y),C=b>0,S=W_(),I=ve(Fa);return PU({scrollableRef:y,source:"sidebar"}),d.jsx("div",{className:Y("h-screen px-1 py-2",S?"w-full":"w-sidebar"),children:d.jsx("div",{className:"t-custom-scrollbar h-full overflow-y-auto overflow-x-hidden",ref:y,children:d.jsxs("div",{className:"flex min-h-full w-full flex-col px-2",children:[d.jsxs("div",{className:Y(LN,DN,"top-0 z-10 flex flex-col gap-px pb-3 pt-[72px]","before:bottom-0 before:top-full before:bg-gradient-to-b before:opacity-90",C&&"after:absolute after:bottom-0 after:mx-1 after:w-[calc(100%-8px)] after:border-b after:border-black/8 dark:after:border-white/10",S&&"whitespace-nowrap"),children:[d.jsx(Te,{className:Y("flex-col px-2.5 py-2",h&&"!bg-black/5 dark:!bg-white/8"),title:t("composer.goToHome"),color:"subtle-dimmed-inverted",onClick:async()=>{u?S&&I(!1):(nt({source:"sidebarDiscoverButton",destination:"/",pageName:e}),await n({to:"/",from:e}))},testId:"sidebar-discover-button",children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:"relative flex size-10 shrink-0 items-center justify-center bg-caramel-350/40 text-caramel-600 squircle-16 dark:bg-slate-650/60 dark:text-slate-250",children:d.jsx(RU,{className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.discover")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.discoverDescription")})]})]})}),p&&d.jsx(Te,{color:"subtle-dimmed-inverted",className:Y("flex-col px-2.5 py-2",f&&"!bg-black/5 dark:!bg-white/8"),title:t("sidebar.library"),onClick:()=>{n({to:"/library",from:e})},children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:"relative flex size-10 shrink-0 items-center justify-center bg-spot-green-300/40 text-spot-green-600 squircle-16 dark:bg-spot-green-600/60 dark:text-slate-250",children:d.jsx(NU,{className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.library")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.libraryDescription")})]})]})}),l&&d.jsx(Te,{className:Y("flex-col px-2.5 py-2",g&&"!bg-black/5 dark:!bg-white/8"),title:t("sidebar.labsDescription"),color:"subtle-dimmed-inverted",onClick:async()=>{nt({source:"sidebarLabsButton",destination:"/labs",pageName:e}),await n({to:"/labs",from:e}),S&&g&&I(!1)},children:d.jsxs("span",{className:"flex w-full items-center gap-3",children:[d.jsx("span",{className:Y("relative flex size-10 shrink-0 items-center justify-center squircle-16",tfe),children:d.jsx("img",{src:Jhe,alt:t("sidebar.labs"),className:"size-6"})}),d.jsxs("span",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"h-6 w-full text-start text-base-strong",children:t("sidebar.labs")}),d.jsx("span",{className:"w-full text-start text-foreground-650 text-xs",children:t("sidebar.labsDescription")})]})]})}),UE]}),d.jsxs("div",{className:"relative flex grow flex-col py-5",children:[a&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(nfe,{})}),d.jsx("h2",{className:"mb-5 flex gap-2 px-3 align-middle text-base-strong",children:t("sidebar.conversations")}),v?d.jsx(m.Suspense,{fallback:d.jsx(PN,{count:16}),children:d.jsx(rfe,{inSidebar:!0})}):d.jsx(PN,{count:16})]}),d.jsx("div",{className:Y(LN,DN,"bottom-0 before:bottom-full before:bg-gradient-to-t")})]})})})}const ife="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/copilot-wordmark-DvWA6bVb.svg",Fp=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 120 120",fill:"none",...t},m.createElement("defs",null,m.createElement("radialGradient",{id:"a",cx:0,cy:0,r:1,gradientTransform:"matrix(-27.40125 -33.47302 31.47539 -25.76598 95.512 51.286)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.096,stopColor:"#00AEFF"}),m.createElement("stop",{offset:.773,stopColor:"#2253CE"}),m.createElement("stop",{offset:1,stopColor:"#0736C4"})),m.createElement("radialGradient",{id:"b",cx:0,cy:0,r:1,gradientTransform:"rotate(51.84 -70.254 70.14)scale(39.9779 38.7796)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#FFB657"}),m.createElement("stop",{offset:.634,stopColor:"#FF5F3D"}),m.createElement("stop",{offset:.923,stopColor:"#C02B3C"})),m.createElement("radialGradient",{id:"e",cx:0,cy:0,r:1,gradientTransform:"matrix(-31.67773 90.58917 -108.5232 -37.949 103.796 30.703)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.066,stopColor:"#8C48FF"}),m.createElement("stop",{offset:.5,stopColor:"#F2598A"}),m.createElement("stop",{offset:.896,stopColor:"#FFB152"})),m.createElement("linearGradient",{id:"c",x1:31.75,x2:37.471,y1:18.75,y2:84.938,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.156,stopColor:"#0D91E1"}),m.createElement("stop",{offset:.487,stopColor:"#52B471"}),m.createElement("stop",{offset:.652,stopColor:"#98BD42"}),m.createElement("stop",{offset:.937,stopColor:"#FFC800"})),m.createElement("linearGradient",{id:"d",x1:36.75,x2:39.874,y1:10,y2:82.213,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#3DCBFF"}),m.createElement("stop",{offset:.247,stopColor:"#0588F7",stopOpacity:0})),m.createElement("linearGradient",{id:"f",x1:106.964,x2:106.923,y1:33.365,y2:53.037,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.058,stopColor:"#F8ADFA"}),m.createElement("stop",{offset:.708,stopColor:"#A86EDD",stopOpacity:0}))),m.createElement("path",{fill:"url(#a)",d:"M85.855 18.313A11.574 11.574 0 0 0 74.75 10h-3.379a11.574 11.574 0 0 0-11.384 9.485L54.2 51.018l1.436-4.913a11.574 11.574 0 0 1 11.11-8.327H86.38l8.235 3.207 7.937-3.207h-2.316a11.574 11.574 0 0 1-11.105-8.313z"}),m.createElement("path",{fill:"url(#b)",d:"M36.326 101.64A11.574 11.574 0 0 0 47.445 110h7.176c6.276 0 11.409-5.002 11.57-11.277l.781-30.405-1.634 5.583a11.574 11.574 0 0 1-11.108 8.321H34.432l-7.058-3.829-7.641 3.83h2.278c5.154 0 9.687 3.408 11.119 8.36z"}),m.createElement("path",{fill:"url(#c)",d:"M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"}),m.createElement("path",{fill:"url(#d)",d:"M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"}),m.createElement("path",{fill:"url(#e)",d:"M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"}),m.createElement("path",{fill:"url(#f)",d:"M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"})),IPe=Object.freeze(Object.defineProperty({__proto__:null,default:Fp},Symbol.toStringTag,{value:"Module"}));function Hn(t){const{url:e,className:n}=t;return d.jsx("div",{className:Be("bg-current forced-color-adjust-none",n),style:{WebkitMaskImage:`url(${e})`,maskImage:`url(${e})`,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}})}function sfe(t){const{open:e,toggle:n}=t,r=Qd(),[o]=Ze(Lr),i=x(fl),{t:s}=xe(),a=se("pages"),l=$t(),u=Vb(),h=o==="chat-only"||e,f=xU(),p=!e&&(l.startsWith("/daily")||l.endsWith("/talk")||l.startsWith("/gallery")||u||l.startsWith("/labs/experiments/3d-generations")||l.startsWith("/shares/3d-generations"));return d.jsx("div",{className:Y("pointer-events-none absolute start-0 top-0 w-full p-2.5 pe-3.5",jt.sidebar),children:d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"absolute flex min-w-full items-center justify-between p-1",children:[d.jsx(Mn,{children:p&&d.jsx(Ne.div,{className:Y("pointer-events-auto absolute inset-0 rounded-2xl border border-stroke-100 shadow-md dark:border-stroke-300",mi),initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:Ho})}),d.jsx(wn,{className:"flex items-center",delay:jo.default,duration:jo.slow,children:e&&d.jsxs(Te,{role:"link",title:s("sidebar.homepageLink"),className:"pointer-events-auto absolute start-0 flex items-center gap-2.5 px-3.5",color:"subtle-dimmed-inverted",testId:"sidebar-copilot-brand-button",onClick:async()=>{nt({source:"sidebarBrandButton",destination:"/chat",pageName:l}),await r()},children:[d.jsx(Fp,{className:"size-6"}),d.jsxs("span",{className:"flex items-center text-md-strong",children:[d.jsx(Hn,{url:ife,className:"h-[18px] w-[58px]"}),f&&d.jsx(Zv,{text:s("settings.copilotBeta.beta"),className:"ms-2 uppercase"})]})]})}),d.jsxs("div",{className:"pointer-events-auto flex shrink-0 items-center gap-1","data-theme":i&&!e?i.theme:void 0,children:[d.jsx(Te,{title:s(e?"sidebar.close":"sidebar.open"),className:"after:absolute after:inset-0 after:rounded-xl hover:after:bg-black/3 dark:hover:after:bg-white/5",color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:()=>{nt({source:"sidebarToggle",pageName:l,customData:JSON.stringify({isOpen:e})}),n()},testId:"sidebar-toggle-button",children:d.jsx(J_,{className:"size-6"})}),h&&d.jsxs("div",{className:"flex rounded-xl hover:bg-black/3 dark:hover:bg-white/5",children:[d.jsx(Te,{title:s("composer.startNewChat"),color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:async()=>{nt({source:"sidebarNewConversation",destination:"/chat",pageName:l,customData:JSON.stringify({isOpen:e})}),await r()},children:d.jsx(zb,{className:"size-5"})}),a&&d.jsx(AU,{buttonSize:"36-sm"})]}),!e&&f&&d.jsx(Zv,{text:s("settings.copilotBeta.beta"),className:"relative m-2 uppercase"})]})]})})})}function afe(){const[t,e]=Ze(Fa),n=ar({breakpoint:"md"}),r=m.useRef(n),o=me.instance().config().useCompactSidebarHeader??!1;D_(()=>{n&&e(!1)}),m.useEffect(()=>{r.current===!1&&n&&e(!1),r.current===!0&&!n&&e(TU()==="open"),r.current=n},[n,e]);const i=()=>{e(s=>!s),n||jhe(t?"close":"open")};return d.jsxs(d.Fragment,{children:[d.jsx(Mn,{children:n&&t&&d.jsx(Ne.div,{className:"fixed inset-0 bg-black/30",onClick:()=>e(!1),initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:Ho})}),d.jsxs(Ne.div,{className:Y("relative w-full bg-sidebar-light dark:bg-sidebar-dark",t&&"h-full"),layout:"position",children:[o?d.jsx(Yhe,{open:t,toggle:i}):d.jsx(sfe,{open:t,toggle:i}),d.jsx(Mn,{children:t&&d.jsx(Ne.div,{className:"overflow-hidden",initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:Ho,children:d.jsx(ofe,{})})})]})]})}function cfe(t){return["/login","/fang","/referrals","/referrals/rules","/memory/narrative"].includes(t)}function vi(){const t=$t();return(me.instance().config().sidebarNavigation??!1)&&!cfe(t)}const lfe=324,jN="bg-sidebar-light dark:bg-sidebar-dark";function ufe(t){const{children:e,sidebar:n}=t,r=document.getElementById("app"),o=Yd(),i=ar({breakpoint:"md"}),s=vi(),l=x(Fa)&&s,[u,h]=m.useState(!1),f=x(Lr),p=x(of),g=x(Fy),v=W_();m.useEffect(()=>{r&&r.style.setProperty("--layout-offset-y",s&&l&&!i?`${Ei}px`:"0px")},[r,s,l,i]);const y=l&&!i,b=f==="side-by-side",C=v?"100%":lfe,S=p||!!g;return d.jsxs("div",{className:Y("flex h-full overflow-hidden",jN),inert:S?"":void 0,children:[n??(s&&d.jsx(Ne.div,{className:Y("h-full will-change-auto",i?"absolute":"relative",i&&jN,i&&jt.sidebar),initial:{width:l?C:0},animate:{width:l?C:0},transition:Ho,onAnimationStart:()=>h(!0),onAnimationComplete:()=>h(!1),children:d.jsx(afe,{})})),d.jsx(Ne.main,{className:Y("relative flex w-full min-w-0 will-change-auto","after:pointer-events-none after:fixed after:inset-2 after:start-[324px] after:rounded-container after:border after:border-transparent after:transition-opacity dark:after:border-white/12 dark:after:border-s-white/8",y&&!u?"after:opacity-100 after:duration-1000":"after:opacity-0 after:duration-0"),initial:{paddingTop:y||b?Ei:0,paddingBottom:!b&&y?Ei:0,paddingLeft:y&&o?Ei:0,paddingRight:y&&!o?Ei:0},animate:{paddingTop:y||b?Ei:0,paddingBottom:!b&&y?Ei:0,paddingLeft:y&&o||!y&&b?Ei:0,paddingRight:y&&!o||!y&&b?Ei:0},transition:i?{duration:0}:Ho,children:e})]})}function X_(t){const{children:e,className:n,clipPathBreakpoint:r="md",backgroundColor:o}=t,i=ar({breakpoint:r}),s=vi(),l=$t().endsWith("/talk");return d.jsxs("div",{className:Be("relative h-full overflow-hidden",n),children:[d.jsx("div",{className:Y("absolute size-full",s&&!i&&"t-main-clip-path"),children:d.jsx(Tl,{customColor:o,isFixed:!0})}),d.jsx("div",{className:Y("relative size-full",!l&&"overflow-hidden",s&&!i&&"rounded-container"),children:e})]})}const MU=P(!0),dfe=P(!0),hfe=P(!1),ffe=P(!1);function OU(t){const{deferred:e=!1}=t??{},n=XM(),[r,o]=Ze(I5),i=ve(Op);m.useEffect(()=>{const l=nG();l&&o(l)},[n.search,o]);const s=m.useCallback(()=>{o(null)},[o]),a=m.useCallback(l=>{l&&i({source:"promptInUrl",prompt:l})},[i]);return m.useEffect(()=>{r&&!e&&a(r)},[e,a,r]),{prompt:r,handler:e?a:void 0,clear:s}}function pfe(){const t=se("prompt-pt-learn-partial"),e=se("prompt-pt-learn-full"),n=se("prompt-pt-learn-fill"),r=se("prompt-pt-advice-partial"),o=se("prompt-pt-advice-full"),i=se("prompt-pt-advice-fill"),s=se("prompt-pt-ideas-partial"),a=se("prompt-pt-ideas-full"),l=se("prompt-pt-ideas-fill"),u=se("prompt-pt-msn-answers"),h=se("prompt-pt-msn-headlines"),f=se("prompt-pt-msn-events"),p=se("prompt-pt-msn-answers-full"),g=se("prompt-pt-msn-headlines-full"),v=se("prompt-pt-msn-events-full"),y=U.getFormCode();let b=null,C=!1,S=!1,I=!1;switch(y){case"NTPCHB":{t||e||n?b="teach":r||o||i?b="advice":(s||a||l)&&(b="ideas"),C=t||r||s,S=e||o||a,I=n||i||l;break}case"MSNCHB":{u||p?b="answers":h||g?b="headlines":(f||v)&&(b="events"),S=p||g||v,I=u||h||f;break}default:b=null}let E=null;C?E="prefix":(S||I)&&(E="complete");let T=null;return C||I?T="partial":S&&(T="full"),{formCode:y,treatment:b,lengthVariant:E,passthroughType:T}}function LU(t){var p;const{inEeaPlusRegion:e,labsFeatureEnabled:n,region:r,isUpsellFeatureEnabled:o,isAuthenticated:i,isTeenUser:s,isProUser:a,skipProUserCheck:l}=t;if(e&&r!=="CA"&&!n)return!1;const u=!r||sz.includes(r),h=((p=me.instance().config().actions)==null?void 0:p.overrideFreemiumActionsUpsellFeatureEnabled)??!1;return a||l||(o||h)&&i&&!s&&!u}function mfe(){const t=Ue(pl),e=ze("labs-actions"),n=ze("labs-actions-skipprocheck"),r=me.instance().config().proSubscription.enabled,o=zf(),i=Ue(Gy),s=Ue(Cr),a=!!Ue($5);return LU({inEeaPlusRegion:a,labsFeatureEnabled:e,region:s,isUpsellFeatureEnabled:r,isAuthenticated:o,isTeenUser:i,isProUser:t,skipProUserCheck:n})}function DU(t){const{actionsAvailableForAccount:e,actionsAvailableForSurface:n}=t;return e&&n}async function gfe(){var r;const t=mfe(),n=await(((r=me.instance().config().actions)==null?void 0:r.enableActions)??(()=>Promise.resolve(!1)))();return DU({actionsAvailableForAccount:t,actionsAvailableForSurface:n})}function vfe(t,e,n){return t&&(n&&e)}function jU(){const t=x(pl),e=se("labs-actions"),n=se("labs-actions-skipprocheck"),r=me.instance().config().proSubscription.enabled,o=Sr(),i=!!x(Gy),s=x(Cr),a=!!x($5);return LU({inEeaPlusRegion:a,labsFeatureEnabled:e,region:s,isUpsellFeatureEnabled:r,isAuthenticated:o,isTeenUser:i,isProUser:t,skipProUserCheck:n})}function UU(){const[t,e]=m.useState(!1),n=x(eg);return m.useEffect(()=>{async function r(){var i;await(((i=me.instance().config().actions)==null?void 0:i.enableActions)??(()=>Promise.resolve(!1)))()&&e(!0)}r().catch(()=>{})},[e,n]),t}function Z_(){const t=jU(),e=UU();return DU({actionsAvailableForAccount:t,actionsAvailableForSurface:e})}function EPe(){var r;const t=jU(),e=UU(),n=((r=me.instance().config().actions)==null?void 0:r.overrideLabsActionsFeatureEnabled)??!1;return vfe(t,e,n)}const FU=["smart-mode-6e0b4c6f","smart-mode-cd0c997b","smart-mode"];function Bp(){return ND(FU,"any")}function yfe(){return dd(FU,"any")}let vg=null;function bfe(){const t=ve(hn),e=Z_(),n=Bp();m.useEffect(()=>{const r=eG();vg===null&&(vg=r);const o=s=>s==="td"?"reasoning":e&&s==="ac"?"computerUse":n&&s==="sm"?"smart":null,i=o(r||vg);i&&t(i)},[t,e,n])}function Cfe(){return vg}function Sfe(t){var n;const e=[];for(const r of t){if(r.type!=="product"&&r.type!=="propertyPromotion"&&r.type!=="tourActivity")return null;if(!r.tags)continue;if(r.tags.length>1)return null;const o=r.tags[0];if(!(!o||!o.value))if(e.length===0)e.push(o);else{if(((n=e[0])==null?void 0:n.category)!==o.category)return null;e.find(i=>i.value===o.value)||e.push(o)}}return e}function TPe(t,e){var n;return t!=null&&t.length?JSON.stringify({tagCategory:(n=t[0])==null?void 0:n.category,tagValue:(e==null?void 0:e.value)??"recommended",tagPosition:e?t.indexOf(e)+1:null,tagCount:t.length}):""}function Ife(t){return t.every(e=>e.type==="product"||e.type==="propertyPromotion"||e.type==="tourActivity")}function wPe(t,e,n){let r=t;return e!=null&&e.length&&n?r=t.filter(o=>{var i;return o.tags&&((i=o.tags[0])==null?void 0:i.value)===n.value}):e!=null&&e.length&&!n&&(r=t.filter(o=>!o.tags)),r}class Efe{constructor(e){j(this,"startTime",0);j(this,"timeToFirstToken",0);j(this,"receivedFirstToken",!1);j(this,"receivedLastToken",!1);j(this,"currentAdditionalData");j(this,"currentMessageId","");j(this,"receivedMessageTime",0);j(this,"startMessageTime",0);j(this,"mostRecentTokenTime",0);this.startTime=e}resetStartTime(e){this.startTime=e,this.timeToFirstToken=0}onBeforeSend(){this.receivedFirstToken=!1,this.receivedLastToken=!1}onSent(e){this.currentAdditionalData=e}onReceived(e){this.receivedMessageTime=performance.now(),U.trackEvent({name:"system",data:{eventName:"copilotChatRequest",eventInfo_additionalData:this.currentAdditionalData,eventInfo_duration:this.receivedMessageTime-this.startTime,eventInfo_conversationId:e.conversationId,eventInfo_messageId:this.currentMessageId,eventInfo_mode:e.chatMode}})}onStartMessage(e){this.startMessageTime=performance.now(),this.currentMessageId=e.messageId,this.receivedMessageTime||(this.receivedMessageTime=this.startTime),U.trackEvent({name:"system",data:{eventName:"copilotChatReqToResp",eventInfo_duration:this.startMessageTime-this.receivedMessageTime,eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:e.conversationId,eventInfo_messageId:e.messageId,eventInfo_mode:e.chatMode}})}onFirstToken(e,n,r){if(!this.receivedFirstToken&&e===this.currentMessageId){const o=performance.now()-this.startTime;this.timeToFirstToken=o,this.receivedFirstToken=!0,U.trackEvent({name:"system",data:{eventName:"copilotChatRespToReceived",eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:r,eventInfo_duration:performance.now()-this.receivedMessageTime,eventInfo_messageId:e,eventInfo_mode:n}}),U.trackEvent({name:"system",data:{eventName:"copilotFirstTokenReceived",eventInfo_conversationId:r,eventInfo_messageId:e,eventInfo_duration:o,eventInfo_mode:n,eventInfo_additionalData:this.currentAdditionalData}})}this.mostRecentTokenTime=performance.now()}onLastToken(e){const{citationCount:n,imageCount:r,messageId:o,inputMethod:i,conversationId:s,chatMode:a,chainOfThoughtCount:l}=e;if(!this.receivedLastToken&&o===this.currentMessageId){const u=this.mostRecentTokenTime-this.startTime;this.receivedLastToken=!0,U.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_numCitations:n,eventInfo_numImagesGenerated:r,eventInfo_numChainOfThoughts:l,eventInfo_inputMethod:i,eventInfo_responseMethod:"text",eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData,eventInfo_landingPage:U.getLandingPage(),eventInfo_firstToLastTokenDuration:u-this.timeToFirstToken}}),U.trackEvent({name:"system",data:{eventName:"copilotLastTokenReceived",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_duration:u,eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData}}),U.trackEvent({name:"system",data:{eventName:"copilotChatE2E",eventInfo_conversationId:s,eventInfo_messageId:o,eventInfo_duration:performance.now()-this.startTime,eventInfo_mode:a,eventInfo_additionalData:this.currentAdditionalData}}),this.currentAdditionalData=void 0}}onAdsRender(e){const n=performance.now()-this.startTime,{ads:r}=e,i=(r==null?void 0:r.find(l=>l.type==="miniShowroom"))??(r&&r.length>0?r[0]:void 0),s=r&&Ife(r)?Sfe(r):[],a=r==null?void 0:r.find(l=>l.type==="mainShowroom");U.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"render",eventInfo_adType:i==null?void 0:i.type,eventInfo_adCount:r==null?void 0:r.length,eventInfo_rguid:e.requestId,eventInfo_messageId:e.messageId,eventInfo_conversationId:e.conversationId,eventInfo_duration:n,eventInfo_additionalData:JSON.stringify({eventType:e.eventType,adTags:s!=null&&s.length?s:void 0,brandId:a==null?void 0:a.brandId})}})}onSubmitMessageBlocked(e,n,r){U.trackEvent({name:"interaction",data:{eventName:"copilotUserInputBlocked",eventInfo_inputMethod:n,eventInfo_mode:e,eventInfo_messageId:this.currentMessageId,eventInfo_conversationId:r,eventInfo_duration:performance.now()-this.startTime,eventInfo_additionalData:this.currentAdditionalData}})}onImageGenerationStart(e){const{messageId:n,conversationId:r,chatMode:o}=e,s=performance.now()-this.startTime;U.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenStarted",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:s}})}onImageReceived(e){const{messageId:n,conversationId:r,chatMode:o}=e,i=performance.now()-this.startTime;U.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:i}})}onPartialImageReceived(e){const{messageId:n,imageGenPhase:r,conversationId:o,chatMode:i}=e,s=performance.now()-this.startTime;U.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"PartialImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:i,eventInfo_duration:s,eventInfo_customData:`${r}`}})}onMemorySignalReceived(e){const{messageId:n,conversationId:r}=e,i=performance.now()-this.startTime;U.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"MemorySignalReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_duration:i}})}onChainOfThoughtReceived(e){const{messageId:n,conversationId:r,chatMode:o}=e,i=performance.now()-this.startTime;U.trackEvent({name:"system",data:{eventName:"copilotCoTFirstTokenReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_mode:o,eventInfo_duration:i}})}}function Tfe(t,e,n){switch(t.type){case"research":return{type:"task",task:{id:t.id,type:t.type,contents:[],partialOutput:[],inlineCitations:[],status:"pending",prompt:t.prompt},partId:e};case"computerUse":return{type:"task",task:{id:t.id,conversationId:t.conversationId,type:t.type,status:"running",updatedAt:n},partId:e};case"podcast":return{type:"task",task:{id:t.id,type:t.type,status:t.status,podcast:t.podcast,updatedAt:t.updatedAt??n},partId:e};default:return null}}function BU({path:t,args:e,onLoad:n,alt:r,...o}){const{data:i,isLoading:s}=Il(t,async a=>{const u=await(await xa(a,e)).blob();return URL.createObjectURL(u)});return m.useEffect(()=>{!s&&n&&n()},[s,n]),s?d.jsx("div",{...o}):d.jsx("img",{...o,src:i,alt:r})}const UN=at();function wfe(t){var n,r;if(t.status!=="completed")return;const e=UN.get(it);Dl.latestLocation.pathname.startsWith("/chats")&&e&&t.conversationId===e||UN.set(js,{iconProvider:()=>{var o,i,s;return d.jsx(BU,{path:`/podcasts/user/${(o=t.podcast)==null?void 0:o.id}/Files/${(s=(i=t.podcast)==null?void 0:i.thumbnail)==null?void 0:s.name}`,className:"rounded-xl object-cover"})},title:ee("podcasts.generationNotification.title"),subtitle:((n=t.podcast)==null?void 0:n.title)??"",action:()=>{var o;qy({from:window.location.pathname,to:`/podcasts/user/${(o=t.podcast)==null?void 0:o.id}`})},trackingArgs:{scenario:"podcastGenerationNotification",customData:JSON.stringify({podcastId:(r=t.podcast)==null?void 0:r.id})},dismissAfter:3e4})}const _fe=P(!1),HU=P(void 0),Afe=P(!1),FN=P(new Set),kfe=P(void 0),Oh=at();function xfe(t,e){const n=Oh.get(it);if(ze("ds-new-progress")){if(t.status!=="completed")return;if(Oh.get(FN).has(t.id))Oh.set(FN,a=>Or(a,l=>{l.delete(t.id)}));else return}else if(!Vg.includes(t.status)||(uD("chat"),!n||n===e))return;const o=t.id,i={title:ee("research.generationNotification.title"),subtitle:ee("research.generationNotification.subTitle"),link:ee("research.generationNotification.subTitleLink"),action:()=>{qy({from:window.location.pathname,to:`/chats/${e}`})},onClick:()=>{Oh.set(kfe,o)},dismissable:!0,trackingArgs:{scenario:"researchCompletionNotification",customData:JSON.stringify({researchId:t.id,sourceConversationId:e})}};Oh.set(js,i)}function Rfe(){const t=x(di),e=x(it);return m.useMemo(()=>{if(e){for(const n of t.values())if(n.conversationId===e)return n}},[e,t])}function Nfe(){const t=at(),e=t.get(di),n=t.get(it);if(n){for(const r of e.values())if(r.conversationId===n)return r}}const Fi=at(),Pfe="MissingUrlFromApi";function Mfe(t,e){const n=Fi.get(di).get(t);return(n==null?void 0:n.type)==="computerUse"&&!n.lastUserCommand&&Ofe(n)&&e.some(o=>o.op==="replace"&&o.path==="/status"&&o.value==="paused")?WI(e,["userTakeControl","pauseByClick"]):!1}function zU(t){return t==="paused"||t==="running"||t==="pending"}function Ofe(t){var e,n;return t.status==="paused"&&(((e=t.statusChange)==null?void 0:e.reason)==="safetyRiskDetected"||((n=t.statusChange)==null?void 0:n.reason)==="askUserInput")}function Lfe(t){var e;return t.status==="paused"&&((e=t.statusChange)==null?void 0:e.reason)==="safetyRiskDetected"}function Dfe(t){var e;return t.status==="paused"&&((e=t.statusChange)==null?void 0:e.reason)==="userTakeControl"&&t.lastUserCommand==="takeTaskControl"}function C0(t,e=!1){return t.map(n=>({type:"chainOfThought",text:n.text,screenshotUrl:e?Pfe:null,reaction:null,partId:Math.random().toString()}))}function WI(t,e){return t.some(n=>{if(n.op==="replace"&&n.path==="/statusChange"){const{value:r}=n;if(typeof r=="object"&&r!==null&&"reason"in r){const{reason:o}=r;if(typeof o=="string"){const i=SL.safeParse(o);return i.success&&e.includes(i.data)}}}return!1})}function jfe(t,e){const n=Fi.get(di).get(t);if((n==null?void 0:n.type)==="computerUse"){const{conversationId:r,status:o,statusChange:i}=n;if(!r)return;if(o==="cancelled"&&Dt(r,h=>{const f=BN(t,"cancelTask");h.push(f)}),WI(e,["giveBackControl"])?Dt(r,h=>{const f=BN(t,"takeTaskControl");h.push(f)}):(i==null?void 0:i.reason)==="giveBackControl"&&HN(t),WI(e,["taskCompleted"])&&Dt(r,h=>{const f={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",content:[{type:"card",partId:Math.random().toString(),card:{type:"computerUseFeedback"}}]};h.push(f)}),i)switch(i.reason){case"askUserInput":case"safetyRiskDetected":{o==="paused"?(i.reason==="askUserInput"&&Sa({feature:"computerUse",scenario:"askUserInput",customData:JSON.stringify({id:n.id,conversationId:n.conversationId})}),r===Fi.get(it)||Fi.set(js,{title:n.title&&n.title!==""?ee("actions.alertTitleTemplate",{conversationName:n.title}):ee("actions.defaultAlertTitle"),subtitle:i.reason==="safetyRiskDetected"?ee("actions.safetyRiskAlertSubTitle"):ee("actions.askUserInputAlertSubTitle"),action:()=>fD({id:r}),dismissAfter:30*1e3,dismissable:!0}),WT(t,f=>{"lastUserCommand"in f&&(f.lastUserCommand=void 0)})):HN(t);break}}const l=e.filter(h=>h.op==="add"&&h.path==="/chainOfThought/-").map(h=>({text:"value"in h?h.value:""}));l.length>0&&Dt(r,h=>{if(h.length===0)return;const f=zN(h);if(f)f.push(...C0(l));else{const p={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",content:C0(l)};h.push(p)}}),e.filter(h=>h.op==="replace"&&h.path==="/computerAction").length>0&&Dt(r,h=>{const f=zN(h);f&&f.push(...C0([{text:n.computerAction??""}],!0))})}}function BN(t,e){return{id:Math.random().toString(),createdAt:new Date().toISOString(),author:"human",content:[{type:"command",command:{type:e,taskId:t}}]}}function HN(t){WT(t,e=>{"statusChange"in e&&(e.statusChange=void 0)})}function zN(t){const e=t.at(-1);if(e&&e.author==="ai"&&e.content.find(n=>n.type==="chainOfThought"))return e.content}function _Pe(t){var n;const e=Nfe();return(e==null?void 0:e.type)==="computerUse"?e.status!=="running"&&!((n=e.replay)!=null&&n.isRunning)?!0:!t:!0}function APe(t){return!!(ze("labs-actions-replay")&&t&&t.type==="computerUse"&&!zU(t.status))}function kPe(t){return{cancelTask:"copilotActionsCancelTask",takeTaskControl:"copilotActionsTakeControl",startTask:void 0,pauseTask:void 0,resumeTask:void 0,releaseTaskControl:void 0}[t]}function VU(t){return oD({tasks:Fi.get(di),conversationId:t,taskType:"computerUse"})}function Ufe(t,e){if(t===e&&(Fi.set(Lr,"side-by-side"),uD("chat")),!ze("actions-auto-open-L2")||!t)return;const r=Fi.get(it);r&&Fi.set(zg,r),Fi.set(it,t),Fi.set(Lr,"side-by-side")}function xPe(t,e,n){U.trackEvent({name:"interaction",data:{eventName:"activityArtifactDrawerOpened",eventInfo_messageId:t,eventInfo_partId:e,eventInfo_messageType:n}})}function Ffe(t){Dr({feature:"activity",errorType:"handleActivityStart",errorMessage:"Could not find message with messageId to start activity",customData:JSON.stringify({messageId:t})})}function Bfe(t,e){Dr({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Could not find activity message with partId in message with messageId",customData:JSON.stringify({messageId:t,partId:e})})}function Hfe(t){Dr({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Error updating activity",exception:JSON.stringify({error:t})})}function zfe(t){return t.filter(e=>e.type!=="miniShowroom").filter(e=>e.type!=="mainShowroom"||e.action).map(e=>{var r;let n="";return e.type==="mainShowroom"?n=((r=e.action)==null?void 0:r.url)??"":e.type==="product"?n=e.offer.link.url:n=e.link.url,{type:e.type,rLink:n}})}function Vfe(t){return zfe(t).some(({rLink:e})=>e==="")}function $fe({entryAd:t,mainAd:e,messageId:n,partId:r,conversationId:o}){var g;const i=ze("adsshowroomagent"),s=Ue(fl);if(!(!!(!s&&t&&e)||!!(!s&&t&&(i||e))||(s==null?void 0:s.conversationId)===o&&!t&&e&&e.brandId===s.brandId))return U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:n,partId:r,conversationId:o,hasEntryAd:!!t,hasMainAd:!!e,mainAdBrandId:e==null?void 0:e.brandId,isShowroomOpened:!!s,showroomBrandId:s==null?void 0:s.brandId}),eventInfo_errorMessage:`Unexpected showroom data received when showroom is ${s?"opened":"closed"}`}}),!1;if(Vfe(((g=e==null?void 0:e.slotAds)==null?void 0:g.map(v=>v.ad))??[]))return!1;const l=(e==null?void 0:e.logo)??(t==null?void 0:t.logo)??(s==null?void 0:s.brandLogo),u=typeof(e==null?void 0:e.backgroundColor)=="number",h=!l||!u,f=t&&!t.brandId;return(i?f:h)?(U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:n,partId:r,conversationId:o,entryAdType:t==null?void 0:t.type,noBrandLogo:!l,noMainShowroomAd:!e,noBackgroundColor:!u}),eventInfo_errorMessage:"Unexpected data found in ads card"}}),!1):!0}function Gfe({card:t,messageId:e,partId:n,conversationState:r,conversationId:o}){const{ads:i}=t;if(r.timing.onAdsRender({requestId:t.requestId,messageId:e,conversationId:o,eventType:"card",ads:i}),i!=null&&i.some(s=>s.type==="mainShowroom"||s.type==="miniShowroom")){const s=i[0],a=(s==null?void 0:s.type)==="miniShowroom",l=a?s:void 0,u=a?i[1]:s;if(!$fe({entryAd:l,partId:n,conversationId:o,messageId:e,mainAd:(u==null?void 0:u.type)==="mainShowroom"?u:void 0}))return}Dt(o,s=>{const a=An(s,e);a&&a.content.push({type:"card",partId:n,card:t})})}function $U(t,e){var r;const n=me.instance().config();return t&&!((r=n.settingsOverrides)!=null&&r.shouldHideMultipleCharacters)&&!e}function Hp(){const t=se("multiplecharacters"),e=Sl();return $U(t,e)}function YI(){const t=ze("multiplecharacters"),e=Ob();return $U(t,e)}const Kfe=Ny.extend({actionName:c.literal("edge_get_page_content"),parameters:c.array(c.object({tabId:c.number(),windowId:c.number(),pageUrl:c.string().nullish(),pageTitle:c.string().nullish(),pageType:c.string().nullish(),lastAccessedTime:c.number().nullish()}))}),Ba=Ny.extend({actionType:c.string(),id:c.string()}),qfe=Ba.extend({actionName:c.literal("browser_navigate"),parameters:c.object({tabId:c.number(),url:c.string()})}),Wfe=Ba.extend({actionName:c.literal("edge_switch_tab"),parameters:c.object({tabId:c.number()})}),Yfe=Ba.extend({actionName:c.literal("edge_close_tabs"),parameters:c.object({tabIds:c.array(c.number())})}),Qfe=Ba.extend({actionName:c.literal("edge_find_browser_tab_groups"),parameters:c.object({queries:c.string().array()})}),Jfe=Ba.extend({actionName:c.literal("edge_group_open_browser_tabs"),parameters:c.object({tabGroups:c.object({title:c.string(),tabIds:c.array(c.number()),color:c.union([c.literal("red"),c.literal("green"),c.literal("blue")]),collapsed:c.boolean()}).array()})}),Xfe=Ba.extend({actionName:c.literal("edge_ungroup_open_browser_tabs"),parameters:c.object({tabGroupIds:c.number().array()})}),Zfe=Ba.extend({actionName:c.literal("edge_media_controls"),parameters:c.object({action:c.union([c.literal("play"),c.literal("pause")])})}),epe=c.union([qfe,Yfe,Qfe,Jfe,Xfe,Zfe,Wfe]),tpe=c.object({type:c.literal("screenshot")}),npe=c.object({type:c.literal("click"),x:c.number(),y:c.number(),button:c.union([c.literal("back"),c.literal("forward"),c.literal("left"),c.literal("right"),c.literal("middle")])}),rpe=c.object({type:c.literal("scroll"),x:c.number(),y:c.number(),scrollX:c.number(),scrollY:c.number()}),ope=c.object({type:c.literal("doubleClick"),x:c.number(),y:c.number()}),ipe=c.object({type:c.literal("moveMouse"),x:c.number(),y:c.number()}),spe=c.object({type:c.literal("keyPress"),keys:c.string().array()}),ape=c.object({type:c.literal("drag"),path:c.object({x:c.number(),y:c.number()}).array()}),cpe=c.object({type:c.literal("type"),text:c.string()}),lpe=c.object({type:c.literal("wait"),seconds:c.number()}),upe=c.discriminatedUnion("type",[tpe,npe,ope,ipe,spe,ape,rpe,cpe,lpe]),dpe=Ba.extend({actionName:c.literal("computer_use"),parameters:c.object({tabId:c.number(),callId:c.string(),action:upe})}),hpe=c.union([...epe.options,dpe]),fpe=c.discriminatedUnion("actionName",[Kfe,mq,...hpe.options]),ppe=at();function mpe(t){ppe.set(bn,e=>Or(e,n=>{for(const{title:r,id:o,updatedAt:i,continuedAt:s}of t){const a=n.get(o);a?(a.title=r,a.id=o,a.updatedAt=i,a.continuedAt=s):n.set(o,{id:o,title:r,updatedAt:i,history:[],streamingState:"idle",continuedAt:s})}}))}const gpe=at();function vpe(t,e,n){bpe(t.map(r=>ype(r,e,n)).filter(r=>r!==void 0))}function ype(t,e,n){switch(t.type){case"research":return{id:t.id,conversationId:e,type:t.type,status:t.status,updatedAt:""};case"computerUse":return{id:t.id,conversationId:t.conversationId??"",type:t.type,status:t.status,updatedAt:t.updatedAt??"",title:t.title??"",lastScreenshot:t.lastScreenshot};case"podcast":return{id:t.id,conversationId:e,status:t.status==="completed"?"completed":"running",type:t.type,podcast:t.podcast,updatedAt:t.updatedAt??n};default:return}}function bpe(t){gpe.set(di,n=>Or(n,r=>{for(const o of t){const i=r.get(o.id);if(i)i.title=o.title,i.conversationId=o.conversationId,i.updatedAt=o.updatedAt,i.status=o.status,i.type=o.type,i.type==="computerUse"&&o.type==="computerUse"&&(i.lastScreenshot=o.lastScreenshot);else{const s={id:o.id,title:o.title,conversationId:o.conversationId,updatedAt:o.updatedAt,status:o.status,type:o.type};s.type==="computerUse"&&o.type==="computerUse"&&(s.chainOfThought=[],s.lastScreenshot=o.lastScreenshot),o.type==="podcast"&&s.type==="podcast"&&(s.podcast=o.podcast),r.set(o.id,s)}}}));const e=t.filter(n=>n.type==="computerUse"&&n.conversationId).map(n=>{const{conversationId:r,title:o,updatedAt:i}=n;return{id:r??"",title:o,updatedAt:i,continuedAt:null,history:[],streamingState:"idle"}});mpe(e)}const GU="cf-turnstile",Cpe=`#${GU}`;function Spe(){const t=x(of),e=x(Os);return bo("kill-cf-turnstile")?null:d.jsx(pi,{isOpen:t,className:"w-3/4 sm:w-[350px]",children:d.jsx("div",{id:GU,className:"flex flex-1 items-center justify-center","data-theme":e})})}const Ipe=new gl(()=>new Promise((t,e)=>{const n=setTimeout(()=>{e(new Error("CF Turnstile script took too long to load"))},15e3),r=document.createElement("script");r.type="text/javascript",r.defer=!0,r.src="https://challenges.cloudflare.com/turnstile/v0/api.js",r.onload=()=>{clearTimeout(n),t()},r.onerror=()=>{clearTimeout(n),e(new Error("Failed to load turnstile script"))},document.body.appendChild(r)}));async function KU(t){if(Wr("kill-cf-turnstile")||Ue(of))return;const n=at();U.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"attempt"}}),PE.flushSync(()=>{n.set(of,!0)});try{await Ipe.get()}catch{n.set(Ff,"cf-turnstile");return}try{window.turnstile.render(Cpe,{sitekey:"0x4AAAAAAAg146IpY3lPNWte",callback:async r=>{t(r),window.turnstile.remove(),n.set(of,!1),U.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"success"}})},"error-callback":r=>{U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRenderErrorCallback",eventInfo_details:"Error rendering CF Turnstile.",eventInfo_errorMessage:r}})}})}catch(r){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRender",eventInfo_details:"Error rendering CF Turnstile",eventInfo_errorMessage:r instanceof Error?r.message:""}}),n.set(Ff,"cf-turnstile")}}function Epe(t){const e=t.match(/^\*\*(.*?)\*\*\n\n$/);if(e){const[,n]=e;return{title:(n==null?void 0:n.trim())??"",text:""}}return{title:"",text:t}}function ey(t,e){return t?Date.now()-parseInt(t,10)<=e:!1}function eA(t,e){return!t||parseInt(t,10)<e}var VM;const wr=(VM=me.instance().config().crossPromotion)==null?void 0:VM.aggressive;var $M,GM,KM,qM,WM;const Al={"thumbs-up":{cardFeature:"cross-promo-card-thumbsup",popupFeature:"cross-promo-popup-thumbsup",cardConfig:($M=wr==null?void 0:wr.card)==null?void 0:$M.thumbsUp,popupConfig:(GM=wr==null?void 0:wr.popup)==null?void 0:GM.thumbsUp},copied:{cardFeature:void 0,popupFeature:"cross-promo-popup-copied",cardConfig:void 0,popupConfig:(KM=wr==null?void 0:wr.popup)==null?void 0:KM.copied},engaging:{cardFeature:void 0,popupFeature:"cross-promo-popup-engaging",cardConfig:void 0,popupConfig:(qM=wr==null?void 0:wr.popup)==null?void 0:qM.engaging},"think-deeper":{cardFeature:void 0,popupFeature:"cross-promo-popup-think-deeper",cardConfig:void 0,popupConfig:(WM=wr==null?void 0:wr.popup)==null?void 0:WM.thinkDeeper}};function Tpe(){return{type:"popup",title:ee("crossSelling.aggressivePromotion.popup.thumbsUpTitle"),subTitle:ee("crossSelling.aggressivePromotion.popup.thumbsUpSubTitle"),images:Al["thumbs-up"].popupConfig}}function wpe(){return{type:"card",title:ee("crossSelling.aggressivePromotion.card.thumbsUpTitle"),subTitle:ee("crossSelling.aggressivePromotion.card.thumbsUpSubTitle"),images:Al["thumbs-up"].cardConfig}}function _pe(){return{type:"popup",title:ee("crossSelling.aggressivePromotion.popup.copiedTitle"),subTitle:ee("crossSelling.aggressivePromotion.popup.copiedSubTitle"),images:Al.copied.popupConfig}}function Ape(){return{type:"popup",title:ee("crossSelling.aggressivePromotion.popup.engagingTitle"),subTitle:ee("crossSelling.aggressivePromotion.popup.engagingSubTitle"),images:Al.engaging.popupConfig}}function kpe(){return{type:"popup",title:ee("crossSelling.aggressivePromotion.popup.thinkDeeperTitle"),subTitle:ee("crossSelling.aggressivePromotion.popup.thinkDeeperSubTitle"),images:Al["think-deeper"].popupConfig}}function qU(t){const n=at().get(LT),r=n===!0?!1:n!==void 0,o=yn(cT),i=!ey(o,2*Pg),s=yn(Fg),a=eA(s,2);r&&Rpe(t)&&i&&a&&Npe(t)}let VN=!1;function xpe(){const e=at().get(hn);!VN&&(e==="reasoning"||e==="research")&&(qU("think-deeper"),VN=!0)}function Rpe(t){return Zh(t)||WU(t)}function Zh(t){const e=Al[t];return ze(e.popupFeature)&&e.popupConfig!==void 0}function WU(t){const e=Al[t];return e.cardFeature!==void 0&&ze(e.cardFeature)&&e.cardConfig!==void 0&&!rL()}function Npe(t){const e=at();t==="thumbs-up"&&Zh(t)?e.set(ms,Tpe()):t==="thumbs-up"&&WU(t)?e.set(ms,wpe()):t==="copied"&&Zh(t)?e.set(ms,_pe()):t==="engaging"&&Zh(t)?e.set(ms,Ape()):t==="think-deeper"&&Zh(t)&&e.set(ms,kpe())}const S0=P({counter:0,isActive:!0});function Ppe(){const t=at(),e=t.get(S0);if(!e.isActive)return;const n=e.counter+1;n===lz?(qU("engaging"),t.set(S0,{counter:n,isActive:!1})):t.set(S0,{counter:n,isActive:e.isActive})}const Mpe="group/ai-message-item space-y-3 break-words",Ope=new Map([["1c","1C:Enterprise"],["abnf","Augmented Backus-Naur Form"],["accesslog","Apache Access Log"],["actionscript","ActionScript"],["ada","Ada"],["ado","Stata"],["adoc","AsciiDoc"],["ahk","AutoHotkey"],["angelscript","AngelScript"],["apache","Apache config"],["apacheconf","Apache config"],["applescript","AppleScript"],["arcade","ArcGIS Arcade"],["arduino","Arduino"],["arm","ARM Assembly"],["armasm","ARM Assembly"],["as","ActionScript"],["asc","AngelScript"],["asciidoc","AsciiDoc"],["aspectj","AspectJ"],["atom","HTML, XML"],["autohotkey","AutoHotkey"],["autoit","AutoIt"],["avrasm","AVR Assembly"],["awk","Awk"],["axapta","X++"],["bash","Bash"],["basic","BASIC"],["bat","Batch file (DOS)"],["bf","Brainfuck"],["bind","DNS Zone"],["bnf","Backus–Naur Form"],["brainfuck","Brainfuck"],["c","C"],["c#","C#"],["c++","C++"],["cal","C/AL"],["capnp","Cap’n Proto"],["capnproto","Cap’n Proto"],["cc","C++"],["ceylon","Ceylon"],["cjs","JavaScript"],["clean","Clean"],["clj","Clojure"],["clojure","Clojure"],["clojure-repl","Clojure REPL"],["cls","Caché Object Script"],["cmake","CMake"],["cmake.in","CMake"],["cmd","Batch file (DOS)"],["coffee","CoffeeScript"],["coffeescript","CoffeeScript"],["console","Shell Session"],["coq","Coq"],["cos","Caché Object Script"],["cpp","C++"],["cr","Crystal"],["craftcms","Twig"],["crm","crmsh"],["crmsh","crmsh"],["crystal","Crystal"],["cs","C#"],["csharp","C#"],["cson","CoffeeScript"],["csp","CSP"],["css","CSS"],["cts","TypeScript"],["cxx","C++"],["d","D"],["dart","Dart"],["dcl","Clean"],["delphi","Delphi"],["dfm","Delphi"],["diff","Diff"],["django","Django"],["dns","DNS Zone"],["do","Stata"],["docker","Dockerfile"],["dockerfile","Dockerfile"],["dos","Batch file (DOS)"],["dpr","Delphi"],["dsconfig","dsconfig"],["dst","Dust"],["dts","Device Tree"],["dust","Dust"],["ebnf","Extended Backus-Naur Form"],["edn","Clojure"],["elixir","Elixir"],["elm","Elm"],["erb","ERB"],["erl","Erlang"],["erlang","Erlang"],["erlang-repl","Erlang REPL"],["ex","Elixir"],["excel","Excel formulae"],["exs","Elixir"],["f#","F#"],["f90","Fortran"],["f95","Fortran"],["feature","Gherkin"],["fix","FIX"],["flix","Flix"],["fortran","Fortran"],["fs","F#"],["fsharp","F#"],["gams","GAMS"],["gauss","GAUSS"],["gcode","G-code (ISO 6983)"],["gemspec","Ruby"],["gherkin","Gherkin"],["glsl","GLSL"],["gml","GML"],["gms","GAMS"],["go","Go"],["golang","Go"],["golo","Golo"],["gql","GraphQL"],["gradle","Gradle"],["graph","Roboconf"],["graphql","GraphQL"],["groovy","Groovy"],["gss","GAUSS"],["gyp","Python"],["h","C"],["h++","C++"],["haml","HAML"],["handlebars","Handlebars"],["haskell","Haskell"],["haxe","Haxe"],["hbs","Handlebars"],["hh","C++"],["hpp","C++"],["hs","Haskell"],["hsp","HSP"],["html","HTML, XML"],["html.handlebars","Handlebars"],["html.hbs","Handlebars"],["htmlbars","Handlebars"],["http","HTTP"],["https","HTTP"],["hx","Haxe"],["hxx","C++"],["hy","Hy"],["hylang","Hy"],["i7","Inform 7"],["iced","CoffeeScript"],["icl","Clean"],["inform7","Inform 7"],["ini","TOML, also INI"],["ino","Arduino"],["instances","Roboconf"],["ipython","Python"],["irb","Ruby"],["irpf90","IRPF90"],["isbl","ISBL"],["java","Java"],["javascript","JavaScript"],["jboss-cli","JBoss CLI"],["jinja","Django"],["jldoctest","Julia REPL"],["js","JavaScript"],["json","JSON"],["jsonc","JSON"],["jsp","Java"],["jsx","JavaScript"],["julia","Julia"],["julia-repl","Julia REPL"],["k","Q"],["kdb","Q"],["kotlin","Kotlin"],["kt","Kotlin"],["kts","Kotlin"],["lasso","Lasso"],["lassoscript","Lasso"],["latex","LaTeX"],["ldif","LDIF"],["leaf","Leaf"],["less","Less"],["lisp","Lisp"],["livecodeserver","LiveCode"],["livescript","LiveScript"],["llvm","LLVM IR"],["ls","Lasso"],["ls","LiveScript"],["lsl","LSL (Linden Scripting Language)"],["lua","Lua"],["m","Mercury"],["mak","Makefile"],["make","Makefile"],["makefile","Makefile"],["markdown","Markdown"],["mathematica","Mathematica"],["matlab","Matlab"],["maxima","Maxima"],["md","Markdown"],["mel","MEL"],["mercury","Mercury"],["mikrotik","MikroTik RouterOS script"],["mips","MIPS Assembly"],["mipsasm","MIPS Assembly"],["mizar","Mizar"],["mjs","JavaScript"],["mk","Makefile"],["mkd","Markdown"],["mkdown","Markdown"],["ml","OCaml"],["ml","SML (Standard ML)"],["mm","Objective-C"],["mma","Mathematica"],["mojolicious","Mojolicious"],["monkey","Monkey"],["moo","Mercury"],["moon","MoonScript"],["moonscript","MoonScript"],["mts","TypeScript"],["n1ql","N1QL"],["nc","G-code (ISO 6983)"],["nestedtext","Nested Text"],["nginx","Nginx config"],["nginxconf","Nginx config"],["nim","Nim"],["nix","Nix"],["nixos","Nix"],["node-repl","Node REPL"],["nsis","NSIS"],["nt","Nested Text"],["obj-c","Objective-C"],["obj-c++","Objective-C"],["objc","Objective-C"],["objective-c++","Objective-C"],["objectivec","Objective-C"],["ocaml","OCaml"],["openscad","OpenSCAD"],["osascript","AppleScript"],["oxygene","Oxygene"],["p21","STEP Part 21"],["parser3","Parser3"],["pas","Delphi"],["pascal","Delphi"],["patch","Diff"],["pb","PureBASIC"],["pbi","PureBASIC"],["pcmk","crmsh"],["pde","Processing"],["perl","Perl"],["pf","Packet Filter config"],["pf.conf","Packet Filter config"],["pgsql","PostgreSQL"],["php","php"],["php-template","PHP template"],["pl","Perl"],["plaintext","Plain text"],["plist","HTML, XML"],["pm","Perl"],["podspec","Ruby"],["pony","Pony"],["postgres","PostgreSQL"],["postgresql","PostgreSQL"],["powershell","PowerShell"],["pp","Puppet"],["processing","Processing"],["profile","Python profiler"],["prolog","Prolog"],["properties",".properties"],["proto","Protocol Buffers"],["protobuf","Protocol Buffers"],["ps","PowerShell"],["ps1","PowerShell"],["puppet","Puppet"],["purebasic","PureBASIC"],["pwsh","PowerShell"],["py","Python"],["pycon","python-repl"],["python","Python"],["python-repl","python-repl"],["q","Q"],["qml","QML"],["qt","QML"],["r","R"],["rb","Ruby"],["re","ReasonML"],["reasonml","ReasonML"],["rib","RenderMan RIB"],["roboconf","Roboconf"],["routeros","MikroTik RouterOS script"],["rs","Rust"],["rsl","RenderMan RSL"],["rss","HTML, XML"],["ruby","Ruby"],["ruleslanguage","Oracle Rules Language"],["rust","Rust"],["sas","SAS"],["scad","OpenSCAD"],["scala","Scala"],["scheme","Scheme"],["sci","Scilab"],["scilab","Scilab"],["scm","Scheme"],["scss","SCSS"],["sh","Bash"],["shell","Shell Session"],["shellsession","Shell Session"],["smali","Smali"],["smalltalk","Smalltalk"],["sml","SML (Standard ML)"],["sqf","SQF"],["sql","SQL"],["st","Smalltalk"],["stan","Stan"],["stanfuncs","Stan"],["stata","Stata"],["step","STEP Part 21"],["step21","STEP Part 21"],["stp","STEP Part 21"],["styl","Stylus"],["stylus","Stylus"],["subunit","SubUnit"],["sv","Verilog"],["svg","HTML, XML"],["svh","Verilog"],["swift","Swift"],["taggerscript","Tagger Script"],["tao","XL"],["tap","Test Anything Protocol"],["tcl","Tcl"],["tex","LaTeX"],["text","Plain text"],["thor","Ruby"],["thrift","Thrift"],["tk","Tcl"],["toml","TOML, also INI"],["tp","TP"],["ts","TypeScript"],["tsx","TypeScript"],["twig","Twig"],["txt","Plain text"],["typescript","TypeScript"],["v","Verilog"],["vala","Vala"],["vb","Visual Basic .NET"],["vbnet","Visual Basic .NET"],["vbs","VBScript"],["vbscript","VBScript"],["vbscript-html","VBScript in HTML"],["verilog","Verilog"],["vhdl","VHDL"],["vim","Vim Script"],["wasm","WebAssembly"],["wildfly-cli","JBoss CLI"],["wl","Mathematica"],["wren","Wren"],["wsf","HTML, XML"],["x++","X++"],["x86asm","Intel x86 Assembly"],["xhtml","HTML, XML"],["xjb","HTML, XML"],["xl","XL"],["xls","Excel formulae"],["xlsx","Excel formulae"],["xml","HTML, XML"],["xpath","XQuery"],["xq","XQuery"],["xqm","XQuery"],["xquery","XQuery"],["xsd","HTML, XML"],["xsl","HTML, XML"],["yaml","YAML"],["yml","YAML"],["zep","Zephir"],["zephir","Zephir"],["zone","DNS Zone"],["zsh","Bash"]]),zp="&#95;{{{CITATION{{{&#95;",ty="{",Lpe=Object.freeze(Object.defineProperty({__proto__:null,AI_MESSAGE_CONTAINER_CLASS:Mpe,ALIAS_TO_SUPPORTED_LANGUAGE:Ope,CITATION_DIVIDER:ty,CITATION_PREFIX:zp},Symbol.toStringTag,{value:"Module"}));function YU(t,e){return`[${zp}${t}${ty}](${e})`}const Dpe=new RegExp(`\\[${zp}.*?\\)`,"g");function jpe(t){return t.replace(Dpe,"")}const Upe=2500,Fpe=255,$b=ky(new Map),RPe=P(null),Bpe=P(JH),Hpe=P(Fpe),zpe=P(Upe);function Vpe(t,e,n){return`${t}_${e}_${n}`}function $pe(t,e){at().set($b,r=>{const o=r.get(t)??[],i=[];for(const s of e.editTargets){const a={id:Vpe(e.id,s.startIndex,s.endIndex),pageSuggestionId:e.id,startIndex:s.startIndex,endIndex:s.endIndex,text:e.text};i.push(a)}r.set(t,[...o,...i])})}function NPe(t,e){at().set($b,r=>{const o=r.get(t);o&&r.set(t,o.filter(i=>i.id!==e))})}function PPe(t){at().set($b,n=>{n.delete(t)})}function Gpe(t,e,n){at().set($b,o=>{const i=o.get(t);if(i){const s=i.filter(a=>a.pageSuggestionId===e);for(const a of s)a.text===void 0&&(a.text=""),a.text+=n}})}function Kpe(t){Ls({scenario:"sideBySideMessages",page:"chat",customData:JSON.stringify({eventInfo_event:"receivedSxsEvent",eventInfo_sideBySideComparisonId:t})})}function qpe(t){const{sideBySideComparisonId:e,reason:n}=t;Ls({scenario:"sideBySideMessages",page:"chat",customData:JSON.stringify({eventInfo_event:"skippedSxsMessages",eventInfo_sideBySideComparisonId:e,eventInfo_skippedReason:n})})}function Wpe(t){const{sideBySideComparisonId:e,sideBySideConfig:n}=t,{position:r,isDefault:o}=n;nt({pageName:"chat",sectionName:"sideBySideMessages",source:"selectedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:e,eventInfo_position:r,eventInfo_isControlMessage:o})})}function QU(t){const{sideBySideComparisonId:e,reason:n}=t;nt({pageName:"chat",sectionName:"sideBySideMessages",source:"defaultedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:e,eventInfo_defaultReason:n})})}function Ype(t){const{card:e,messageId:n,conversationId:r}=t,o={eventName:"copilotImpression",eventInfo_impressionPage:"chat",eventInfo_impressionScenario:"answerCardReceived",eventInfo_answerCardType:e.type,eventInfo_messageId:n,eventInfo_conversationId:r};switch(e.type){case"image":o.eventInfo_answerCardContentLength=e.images.length;break;case"localEntity":o.eventInfo_answerCardContentLength=e.entities.length;break;case"financeChart":o.eventInfo_answerCardScenario=e.instrument.securityType;break}U.trackEvent({name:"system",data:o})}function Qpe(t){const{card:e,messageId:n,conversationId:r}=t,o=performance.now(),i=Ue(v5);if(!i)return;const s={eventName:"copilotAnswerCardReceived",eventInfo_messageId:n,eventInfo_conversationId:r,eventInfo_cardType:e.type,eventInfo_duration:o-i};U.trackEvent({name:"system",data:s})}function Jpe(t){const{message:e,conversationId:n}=t;for(const r of e.content)switch(r.type){case"card":Ype({card:r.card,messageId:e.id,conversationId:n}),Qpe({card:r.card,messageId:e.id,conversationId:n});break}}async function Xpe(t){U.setSettings({userConsentModelTraining:!t.optOutOfTraining,userConsentPersonalization:!t.optOutOfPersonalization,userSettingPhoneConnection:!t.optOutOfPhoneConnection,userSettingGenUI:!t.optInToGenerativeUI}),await Ur({path:"/user/settings",args:{options:{method:"PATCH"},body:{optOutOfTraining:t.optOutOfTraining,optOutOfPersonalization:t.optOutOfPersonalization,optInToVoiceTraining:t.optInToVoiceTraining,optOutOfPhoneConnection:t.optOutOfPhoneConnection,optInToGenerativeUI:t.optInToGenerativeUI,allowBiometricDataUse:t.allowBiometricDataUse,allowOneDriveAccess:t.allowOneDriveAccess,features:t.features}}})}async function Zpe(){var e,n;const t=await $n("/user",n5,{parseOptions:{safe:!0},query:{"api-version":"2"}}).then(r=>r.data);at().set(BT,((e=t.remainingCalls)==null?void 0:e.podcastGeneration)??null),at().set(Vy,((n=t.remainingCalls)==null?void 0:n.research)??null)}const Bt=at();function $N(t){return{chatMode:"chat",timing:new Efe(t),citationCount:0,imageCount:0,chainOfThoughtCount:0,inputMethod:"text"}}let I0=null;async function GN(){return I0||(I0=H(()=>import("./index-DS1hydBz.js"),[]).then(t=>t.applyPatch)),I0}class eme{constructor(e){j(this,"ws");j(this,"conversationMetadata",new Map);j(this,"conversationIdByMessageId",new Map);j(this,"messageIdByTaskId",new Map);j(this,"latestMessagePartIdentifier",null);j(this,"pendingSideBySideMessages",new Map);this.ws=e,this.send=this.send.bind(this),this.regenerate=this.regenerate.bind(this),this.sendChallengeResponse=this.sendChallengeResponse.bind(this),this.resetConversationState=this.resetConversationState.bind(this),this.resetConversationTiming=this.resetConversationTiming.bind(this),this.setConversationIdByMessageId=this.setConversationIdByMessageId.bind(this),this.setMessageIdByTaskId=this.setMessageIdByTaskId.bind(this),this.onSubmitMessageBlocked=this.onSubmitMessageBlocked.bind(this),this.callBeforeSendForConversation=this.callBeforeSendForConversation.bind(this),this.callOnSentForConversation=this.callOnSentForConversation.bind(this),this.setChatModeForConversation=this.setChatModeForConversation.bind(this),this.setInputMethodForConversation=this.setInputMethodForConversation.bind(this),this.setUserMessageForConversation=this.setUserMessageForConversation.bind(this),this.processEvent=this.processEvent.bind(this),this.sendMessagePreview=this.sendMessagePreview.bind(this)}getConversationState(e){return this.conversationMetadata.has(e)||this.conversationMetadata.set(e,$N(performance.now())),this.conversationMetadata.get(e)}get latestMessagePartId(){return this.latestMessagePartIdentifier}resetConversationState(e,n){this.conversationMetadata.set(e,$N(n))}resetConversationTiming(e,n){this.getConversationState(e).timing.resetStartTime(n)}setConversationIdByMessageId(e){const{messageId:n,conversationId:r}=e;this.conversationIdByMessageId.set(n,r)}setMessageIdByTaskId(e){const{taskId:n,messageId:r}=e;this.messageIdByTaskId.set(n,r)}onSubmitMessageBlocked(e){const{timing:n,chatMode:r,inputMethod:o}=this.getConversationState(e);n.onSubmitMessageBlocked(r,o,e)}callBeforeSendForConversation(e){this.getConversationState(e).timing.onBeforeSend()}callOnSentForConversation(e,n){this.getConversationState(e).timing.onSent(n)}setChatModeForConversation(e,n){const r=this.getConversationState(e);r.chatMode=n}setInputMethodForConversation(e,n){const r=this.getConversationState(e);r.inputMethod=n}setUserMessageForConversation(e,n){const r=this.getConversationState(e);r.lastUserMessage=n}send(e){const{content:n,conversationId:r,data:o,mode:i,context:s}=e,a={event:"send",conversationId:r,content:Array.isArray(n)?n:[n],mode:i,context:s,...o};this.ws.send(JSON.stringify(a))}sendChallengeResponse(e){this.ws.send(JSON.stringify({event:"challengeResponse",token:e.token,method:e.method}))}regenerate(e){const{messageId:n,mode:r}=e,o={event:"regenerate",messageId:n,mode:r};this.ws.send(JSON.stringify(o))}sendMessagePreview(e){const{content:n,conversationId:r,data:o,mode:i,context:s}=e,a={event:"messagePreview",conversationId:r,content:Array.isArray(n)?n:[n],mode:i,context:s,...o};this.ws.send(JSON.stringify(a))}processEvent(e){switch("id"in e&&(this.latestMessagePartIdentifier=e.id??null),e.event){case"received":this.handleReceived(e);break;case"connected":this.handleConnected(e);break;case"emojiReaction":this.handleEmojiReaction(e);break;case"startMessage":this.handleStartMessage(e);break;case"appendText":this.handleAppendText(e);break;case"replaceText":this.handleReplaceText(e);break;case"invokeAction":this.handleInvokeAction(e);break;case"chainOfThought":this.handleChainOfThought(e);break;case"citation":this.handleCitation(e);break;case"generatingImage":this.handleGeneratingImage(e);break;case"imageGenerated":this.handleImageGenerated(e);break;case"partialImageGenerated":this.handlePartialImageGenerated(e);break;case"imageGenerationFailed":this.handleImageGenerationFailed(e);break;case"generatingCard":this.handleGeneratingCard(e);break;case"cardGenerationFailed":this.handleCardGenerationFailed(e);break;case"page":this.handlePage(e);break;case"titleUpdate":this.handleTitleUpdate(e);break;case"challenge":this.handleChallenge(e);break;case"card":this.handleCard(e);break;case"document":this.handleDocument(e);break;case"taskStart":this.handleTaskStart(e);break;case"taskUpdate":this.handleTaskUpdate(e);break;case"error":this.handleError(e);break;case"banned":this.handleBanned(e);break;case"suggestedFollowups":this.handleSuggestedFollowups(e);break;case"done":this.handleDone(e);break;case"startSuggestion":this.handleStartSuggestion(e);break;case"appendSuggestion":this.handleAppendSuggestion(e);break;case"activityStart":this.handleActivityStart(e);break;case"activityUpdate":this.handleActivityUpdate(e);break;case"memorySignal":this.handleMemorySignal(e);break;case"sideBySideComparison":this.handleSideBySideComparison(e);break;case"modeSelected":this.handleModeSelected(e);break}}handleMemorySignal(e){if(Wr("kill-memory-edf-basic"))return;const{messageId:n,partId:r,text:o,signalType:i}=e,s=this.conversationIdByMessageId.get(n);if(!s)return;this.getConversationState(s).timing.onMemorySignalReceived({messageId:n,conversationId:s}),Dt(s,l=>{const u=An(l,n);u&&u.content.push({type:"memorySignal",partId:r,text:o,signalType:i})})}handleSideBySideComparison(e){if(!ze("side-by-side-comparison"))return;const{sideBySideComparisonId:n,conversationId:r,options:o,defaultMessageId:i}=e;Kpe(n),ki(r,s=>{s.sideBySideComparisonId=n});for(const{messageId:s,position:a}of o)this.pendingSideBySideMessages.set(s,{position:a,isDefault:s===i})}handleModeSelected(e){const{messageId:n,mode:r}=e,o=this.conversationIdByMessageId.get(n),i=Ue(hn);if(!o)return;ze("smart-mode-cot")&&i==="smart"&&r==="reasoning"&&Dt(o,a=>{const l=An(a,n);l&&l.content.push({type:"chainOfThought",text:ee("chat.reasoningLoading.emptyCoTText"),partId:"-1"})})}clearAllStreamingStates(){const e=Bt.get(bn);for(const n of e.values())ki(n.id,r=>{r.streamingState="idle"})}handleReceived(e){const{messageId:n,conversationId:r}=e;this.conversationIdByMessageId.set(n,r);const o=this.getConversationState(r);o.timing.onReceived({messageId:n,conversationId:r,chatMode:o.chatMode}),hN([`humanMessage_${n}`,`conversation_${r}`]),Bt.set(Dc,i=>i&&!zf()?i-1:i),Dt(r,i=>{const s=i.at(-1);(s==null?void 0:s.author)==="human"&&(s.id=n)}),Ppe()}handleConnected(e){Lf.trackLatestChatConnectedAssignment(e)}handleEmojiReaction(e){const{messageId:n,emoji:r}=e,o=this.conversationIdByMessageId.get(n);o&&Dt(o,i=>{const s=pZ(i,n);s&&(s.emojiReaction=r)})}handleStartMessage(e){const{messageId:n,conversationId:r,createdAt:o}=e;this.conversationIdByMessageId.set(n,r);const i=this.getConversationState(r),{chatMode:s}=i;i.citationCount=0,i.timing.onStartMessage({messageId:n,conversationId:r,chatMode:s}),YI()&&Bt.set(Ic,"responding"),hN([`aiMesssage_${n}`,`conversation_${r}`]);const a=this.pendingSideBySideMessages.get(n),l={id:n,createdAt:o,author:"ai",content:[],mode:s,sideBySideConfig:a};ki(r,u=>{u.streamingState="streaming"}),Dt(r,u=>{u.length===0&&iD(Bt.get(di),r)||u.push(l)})}handleAppendText(e){const{text:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);if(!i)return;const s=this.getConversationState(i);s.timing.onFirstToken(r,s.chatMode,i),Dt(i,a=>{const l=An(a,r);if(l){au(i,l.id);let u=Ga(l.content,o);if(!u)u={type:"text",text:"",partId:o},l.content.push(u);else if(u.type!=="text"){console.error(`appendText event with partId that is not a text item. Item is of type ${u.type}`,e);return}u.text=u.text.concat(n),gZ(l)}})}handleReplaceText(e){const{text:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);if(!i)return;const s=Bt.get(eo),a=s==null?void 0:s.sideBySideComparisonId;a&&(qpe({sideBySideComparisonId:a,reason:"replacedText"}),YT(i)),Dt(i,l=>{const u=An(l,r);if(u){au(i,u.id);let h=Ga(u.content,o);if(!h)h={type:"text",text:"",partId:o},u.content.push(h);else if(h.type!=="text"){console.error("replaceText event with partId that is not a text item",e);return}h.text=n,h.citations=void 0}})}handleCitation(e){const{title:n,url:r,messageId:o,publisher:i,iconUrl:s}=e,a=this.conversationIdByMessageId.get(o);if(!a)return;const l=this.getConversationState(a);xG(r,a,o),Dt(a,u=>{const h=An(u,o);if(h){au(a,h.id);const f=mZ(h.content);if(f){f.citations||(f.citations=[]);const p=f.citations.find(v=>v.url===r);let g;p?g=p.index:(l.citationCount+=1,g=`${l.citationCount}`,f.citations.push({index:g,url:r,iconUrl:s,title:n,publisher:i})),f.text=f.text.concat(YU(g,r))}}})}handleGeneratingImage(e){const{prompt:n,messageId:r,partId:o,progressionText:i}=e,s=this.conversationIdByMessageId.get(r);if(!s)return;const a=this.getConversationState(s);a.timing.onImageGenerationStart({messageId:r,conversationId:s,chatMode:a.chatMode}),Dt(s,l=>{const u=An(l,r);u&&u.content.push({type:"image",prompt:n,partId:o,partialGenerationStep:0,status:"generating",progressionText:i})})}handleImageGenerated(e){const{url:n,partId:r,messageId:o}=e,i=this.conversationIdByMessageId.get(o);if(!i)return;const s=this.getConversationState(i);s.imageCount+=1,s.timing.onImageReceived({messageId:o,conversationId:i,chatMode:s.chatMode}),Dt(i,a=>{const l=An(a,o);if(l){const u=Ga(l.content,r);(u==null?void 0:u.type)==="image"&&(u.isPartiallyLoading=!1,u.url=n,u.partialGenerationStep=void 0,u.status="generated",u.progressionText=void 0)}})}handlePartialImageGenerated(e){const{content:n,messageId:r,partId:o}=e,i=this.conversationIdByMessageId.get(r);if(!i)return;const s=this.getConversationState(i);Dt(i,a=>{const l=An(a,r);if(l){const u=Ga(l.content,o);if((u==null?void 0:u.type)==="image"){u.isPartiallyLoading=!0,u.url=`data:image/png;base64,${n}`;const h=(u.partialGenerationStep??0)+1;u.partialGenerationStep=h,u.status="generating",s.timing.onPartialImageReceived({messageId:r,conversationId:i,chatMode:s.chatMode,imageGenPhase:h})}}})}getImageGenerationErrorMessage(e){switch(e){case"not-signed-in":return;case"throttled":return ee("error.imageGenerationFailedThrottled");case"blocked":return;default:return ee("error.imageGenerationFailed")}}handleImageGenerationFailed(e){const{messageId:n,partId:r,errorCode:o}=e,i=this.conversationIdByMessageId.get(n);if(!i)return;Dt(i,a=>{const l=An(a,n);l&&(l.content=l.content.filter(u=>u.type!=="image"||u.partId!==r))});const s=this.getImageGenerationErrorMessage(o);o==="not-signed-in"&&Bt.set(_l,{isOpen:!0,scenario:null,reason:"imageGeneration"}),s&&Gh(s,i)}handleCardGenerationFailed(e){const n=Bt.get($h);if(n&&this.isGeneratedCards(n)){Bt.set($h,void 0);const r=this.conversationIdByMessageId.get(e.messageId);if(!r)return;n==="quiz"&&Gh(ee("quizCard.generatedQuizFailed"),r)}}handleGeneratingCard(e){const{type:n}=e;this.isGeneratedCards(n)&&Bt.set($h,n)}isGeneratedCards(e){return O5.safeParse(e).success}handleTitleUpdate(e){const{conversationId:n,title:r}=e;Bt.set(bn,o=>Or(o,i=>{const s=i.get(n);s&&(s.title=r)}))}handleCard(e){const{messageId:n,partId:r,card:o}=e,i=this.conversationIdByMessageId.get(n);if(!i)return;const s=this.getConversationState(i);if(o.type==="ads"){Gfe({card:o,messageId:n,partId:r,conversationState:s,conversationId:i});return}Dt(i,a=>{const l=An(a,n);l&&l.content.push({type:"card",partId:r,card:o})})}handleDocument(e){const{messageId:n,partId:r,attachmentId:o,fileName:i,contentType:s}=e,a=this.conversationIdByMessageId.get(n);a&&Dt(a,l=>{const u=An(l,n);u&&u.content.push({type:"document",partId:r,attachmentId:o,fileName:i,contentType:s})})}handleBanned(e){const{expiresAt:n}=e,r=F_(n);r&&B_(r,"chat",n)}handlePage(e){const{messageId:n,page:r,partId:o}=e,i=this.conversationIdByMessageId.get(n);i&&(Dt(i,s=>{const a=An(s,n);a&&a.content.push({type:"page",partId:o,page:r})}),wt.emit("pages:page-created",r))}handleStartSuggestion(e){const{pageId:n,suggestionId:r,editTargets:o}=e;$pe(n,{id:r,text:void 0,editTargets:o})}handleAppendSuggestion(e){const{pageId:n,suggestionId:r,text:o}=e;Gpe(n,r,o)}handleActivityStart(e){if(!$g())return;const{messageId:n,partId:r,activity:o}=e,i=this.conversationIdByMessageId.get(n);i&&Dt(i,s=>{const a=An(s,n);a?(au(i,a.id),a.content.push({activity:o,type:"activity",partId:r})):Ffe(n)})}async handleActivityUpdate(e){if(!$g())return;const{messageId:n,partId:r,update:o}=e,i=this.conversationIdByMessageId.get(n);if(i)try{const s=await GN();Dt(i,a=>{const l=An(a,n);if(!l)return;const u=Ga(l.content,r);if(!u||u.type!=="activity"){Bfe(n,r);return}s(u.activity,o)})}catch(s){Hfe(s)}}processInvokeAction(e){const n=Bt.get(it);if(n)switch(e.actionName){case"phone_send_message":{Dt(n,r=>{const o=cD(r);o&&o.content.push({type:"card",partId:Math.random().toString(),card:{type:"phoneSendMessage",actionId:e.actionId,contactName:e.parameters.contactName,text:e.parameters.text,phoneNumber:e.parameters.phoneNumber}})});break}case"edge_get_page_content":{const r=e.parameters.map(o=>({tabId:o.tabId,windowId:o.windowId,pageUrl:o.pageUrl??""}));Due.run({actionId:e.actionId,tabs:r});break}case"browser_navigate":case"edge_switch_tab":case"edge_close_tabs":case"edge_group_open_browser_tabs":case"edge_ungroup_open_browser_tabs":case"edge_find_browser_tab_groups":case"edge_media_controls":case"computer_use":{jue.run(e);break}}}handleInvokeAction(e){const{success:n,data:r}=fpe.safeParse(e);n?this.processInvokeAction(r):console.error("Invalid action data:",e)}handleTaskStart(e){const{messageId:n,task:r,partId:o}=e,i=this.conversationIdByMessageId.get(n);this.messageIdByTaskId.set(r.id,n);const s=new Date().toISOString();if(i){vpe([r],i,s),Bt.set(Lu,!1),Dt(i,l=>{const u=An(l,n);if(u){const h=Tfe(r,o,s);h&&u.content.push(h)}}),Oue.run({task:r,action:"startTask"});const a=Bt.get(it);r.type==="computerUse"&&i===a&&Ufe(r.conversationId,i),(r.type==="podcast"||r.type==="research")&&Zpe()}}async handleTaskUpdate(e){const{taskId:n,update:r}=e;if(Mfe(n,r))return;let o=!1;const i=this.messageIdByTaskId.get(n),s=i?this.conversationIdByMessageId.get(i):void 0;try{const a=await GN();i&&s&&Dt(s,l=>{const u=ze("ds-new-progress")||ze("multiple-research-tasks-in-conversation")&&wO,h=An(l,i,u);if(h){const f=hZ(h.content),p=f==null?void 0:f.task;p&&p.type==="research"&&(a(p,r),xfe(p,s))}}),WT(n,l=>{var u;if(l.type==="computerUse"&&a(l,r),l.type==="podcast"){const h=((u=l.podcast)==null?void 0:u.id)??"";a(l,r),l.podcast&&(l.podcast.id=h)}}),o=!0}catch(a){console.error("Error applying task update patch:",a)}if(o){const a=Bt.get(di).get(n);switch(a==null?void 0:a.type){case"computerUse":jfe(n,r);break;case"podcast":wfe(a);break}}}handleSuggestedFollowups(e){const{disableMultiturn:n}=me.instance().config();if(!n){const{suggestions:r,messageId:o}=e,i=this.conversationIdByMessageId.get(o);i&&ki(i,s=>{s.suggestedFollowup={messageId:o,suggestions:r}})}}handleError(e){const{errorCode:n}=e;if(n==="over-turn-limit")Bt.set(Dc,0);else if(n==="over-reasoning-quota"){!Bt.get(pl)&&zf()&&me.instance().config().thinkDeeperFreemiumEnabled&&(Bt.set(oX,"chat-over-reasoning-quota"),Bt.set(Zr,"reasoning-mode-pro-subscription")),Bt.set(hn,"chat");for(const[o]of this.conversationMetadata.entries())Gh(ee("chat.overCapacity"),o)}else if(n==="over-task-quota"||n==="over-lifetime-task-quota")Bt.set(iX,n),Bt.set(Zr,"over-task-quota");else if(n==="unknown-error")for(const[r]of this.conversationMetadata.entries())ki(r,o=>{o.streamingState="idle"});else if(n==="page-content-length-exceeded"||n==="page-count-exceeded"){wt.emit("page:message-error",n);for(const[r]of this.conversationMetadata.entries())ki(r,o=>{o.streamingState="idle"})}else for(const[r]of this.conversationMetadata.entries())Gh(ee("error.eventNotRecognized"),r);Bt.set(Lu,!1)}handleChainOfThought(e){const{messageId:n,partId:r,text:o}=e,i=this.conversationIdByMessageId.get(n);i&&Dt(i,s=>{const a=An(s,n);if(a){au(i,a.id);let l=Ga(a.content,r);const u=this.getConversationState(i);if(l)l.type!=="chainOfThought"?console.error(`chainOfThought event with partId that is not a chainOfThought item. Item is of type ${l.type}`,e):l.text=l.text.concat(o);else{l={type:"chainOfThought",text:"",title:"",partId:r},a.content.push(l);const{title:h,text:f}=Epe(o);l.title=h,l.text=f,u.timing.onChainOfThoughtReceived({messageId:n,conversationId:i,chatMode:u.chatMode}),u.chainOfThoughtCount+=1}}})}handleChallenge(e){const n=()=>{const r=Bt.get(it);if(!r)return;const{lastUserMessage:o}=this.getConversationState(r);o&&this.send(o)};if(e.method==="copilot"){const{parameter:r}=e,o=((7*Number(r)+21)%100).toString();this.sendChallengeResponse({method:"copilot",token:o}),n();return}Wr("kill-cf-turnstile")||KU(r=>{this.sendChallengeResponse({token:r,method:"cloudflare"}),n()})}handleDone(e){var u;YI()&&Bt.get(Ic)==="responding"&&Bt.set(Ic,"idle");const{messageId:n}=e,r=this.conversationIdByMessageId.get(n);if(!r)return;const o=this.getConversationState(r);o.timing.onLastToken({messageId:n,conversationId:r,citationCount:o.citationCount,imageCount:o.imageCount,chainOfThoughtCount:o.chainOfThoughtCount,chatMode:o.chatMode,inputMethod:o.inputMethod});const s=((u=Bt.get(bn).get(r))==null?void 0:u.history)??[],a=An(s,n);Dt(r,h=>{if(!a)return;const f=An(h,a.id),p=a.content.find(g=>g.type==="image"&&g.partialGenerationStep!==void 0);if(f&&p){const g=Ga(f.content,p.partId);g&&(g.partialGenerationStep===0?g.type="deleted":g.type==="image"&&(g.isPartiallyLoading=!1,g.partialGenerationStep=void 0,g.status="non-complete"))}});const l=this.pendingSideBySideMessages.get(n);l&&(this.pendingSideBySideMessages.delete(n),Dt(r,h=>{const f=An(h,n);f&&(f.sideBySideConfig={...l,isStreamingComplete:!0})})),this.pendingSideBySideMessages.size===0&&ki(r,h=>{h.streamingState="idle"}),Bt.set($h,void 0),Bt.set(Lu,!1),window.setTimeout(()=>{Bt.set(RT,h=>Or(h,f=>{const p=f.get(r);p!=null&&p.has(n)&&(p.delete(n),p.size===0&&f.delete(r))}))},3e3),Bt.set(E5,!0),a&&Jpe({message:a,conversationId:r}),Fue.run({conversationMessages:s})}}async function tme(){try{const{load:t}=await H(async()=>{const{load:r}=await import("./botd.esm-lgyyZBu9.js");return{load:r}},__vite__mapDeps([225,1,2])),e=await t({monitoring:!1}),{bot:n}=e.detect();return n}catch(t){return U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"BotDetectionError",eventInfo_details:"Failed on bot detection",eventInfo_errorMessage:t instanceof Error?t.message:"Unknown bot detection error"}}),!1}}async function nme(){return new Promise((t,e)=>{KU(async n=>{try{const r=await Ur({path:"/challenges/verify",args:{body:{token:n,method:"cloudflare"}}}),{isValid:o}=await r.json();t(o)}catch(r){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CloudflareChallengeVerificationError",eventInfo_details:"Error verifying Cloudflare challenge",eventInfo_errorMessage:r instanceof Error?r.message:""}})}e()})})}const rme="eval/chat";function ome(){const t=ze("weather-cards"),e=!Wr("kill-image-cards"),n=ze("local-cards"),r=!Wr("kill-sports-cards"),o=!Wr("kill-video-cards"),i=ze("shopping-card"),s=ze("shopping-curated"),a=ze("media-spotlight-card"),l=ze("job-cards"),u=ze("safetycards"),h=ze("quiz-cards"),f=ze("generateads"),p=ze("generateadsint"),g=ze("adsparity"),v=!Wr("kill-finance-cards"),y=ze("adstags"),b=ze("product-ads-dynamic-filter"),C=ze("property-promotion-ads-dynamic-filter"),S=ze("tour-activity-ads-dynamic-filter"),I=ze("adsshowroom")||ze("adsshowroomagent"),E=ze("emoji-reactions"),T=ze("imagegenv3");ze("turn-telemetry");const w=ze("recipe-card"),A=ze("file-cards"),_=ze("side-by-side-comparison"),L=Ob(),{adsEnabled:N,adsShowroomEnabled:K,disableAnswerCards:q,enforceAdsOptOutOfPersonalization:ae,answerCardOverrides:O}=me.instance().config(),W=!!at().get(pl),te=(f||p||g)&&N&&!W&&!L,D=a&&(O==null?void 0:O.shouldEnableMediaSpotlightCard),G=[];q||(t&&G.push("weather"),n&&G.push("local"),e&&G.push("image"),r&&G.push("sports"),o&&G.push("video"),i&&G.push("shopping"),l&&G.push("job"),te&&G.push("ads"),u&&G.push("safetyHelpline"),h&&G.push("quiz"),v&&G.push("finance"),s&&G.push("shoppingCurated"),w&&G.push("recipe"),A&&G.push("file"),D&&G.push("mediaSpotlight"));const re={supportedTypes:["text","product","multimedia","tourActivity","propertyPromotion"]};ae&&(re.optOutOfPersonalization=!0),I&&N&&K&&re.supportedTypes.push("showroom"),(b||y)&&(re.product={tagsSupported:!0}),C&&(re.propertyPromotion={tagsSupported:!0}),S&&(re.tourActivity={tagsSupported:!0});const J=[];E&&J.push("emoji-reactions"),T&&J.push("partial-generated-images");const ne=!q_({breakpoint:"lg"});return _&&ne&&J.push("side-by-side-comparison"),{supportedFeatures:J,supportedCards:G.length>0?G:void 0,ads:te?re:null}}const E0=1e3,ime=3e4,sme=5e3,ame=1e4,cme=3,KN=6e4;class lme{constructor({autoReconnect:e=!1}={}){j(this,"connection");j(this,"autoReconnect");j(this,"reconnectInterval");j(this,"maxReconnectInterval");j(this,"reconnectTimeout");j(this,"sendQueue",[]);j(this,"connecting",!1);j(this,"state",null);j(this,"cachedSendData",null);j(this,"pongTimeout",null);j(this,"windowStartTime",null);j(this,"connectionCount",0);j(this,"cooldownStart",null);j(this,"boundReconnectIfNeeded");j(this,"boundDisconnect");j(this,"boundVisibilityChange");j(this,"getUrl",null);j(this,"onopen");j(this,"onmessage");j(this,"onclose");j(this,"onerror");this.connection=null,this.autoReconnect=e,this.reconnectInterval=E0,this.maxReconnectInterval=e?ime:0,this.reconnectTimeout=null,this.onopen=null,this.onmessage=null,this.onclose=null,this.onerror=null,this.connect=this.connect.bind(this),this.reconnect=this.reconnect.bind(this),this.processSendQueue=this.processSendQueue.bind(this)}async initialize(){this.state=null,await this.connect(),this.autoReconnect&&(this.boundReconnectIfNeeded=this.reconnectIfNeeded.bind(this),this.boundDisconnect=this.disconnect.bind(this),this.boundVisibilityChange=()=>{document.visibilityState==="visible"&&this.reconnectIfNeeded()},window.addEventListener("online",this.boundReconnectIfNeeded),window.addEventListener("offline",this.boundDisconnect),document.addEventListener("visibilitychange",this.boundVisibilityChange))}async connect(){var n;if(((n=this.connection)==null?void 0:n.readyState)===WebSocket.CONNECTING||this.connecting||this.pongTimeout)return;if(!this.getUrl)throw new Error("getUrl function is not set");this.connecting=!0;const e=await this.getUrl();this.connection=new WebSocket(e),this.connecting=!1,this.connection.onopen=r=>{if(this.state=null,!Wr("kill-rapid-reconnect-detect")){const o=performance.now();!this.windowStartTime||o-this.windowStartTime>=ame?(this.windowStartTime=o,this.connectionCount=1):this.connectionCount+=1,this.connectionCount>=cme&&(this.cooldownStart=o,this.windowStartTime=null,this.connectionCount=0,this.sendQueue=[])}this.onopen&&this.onopen(r),this.processSendQueue(),this.reconnectInterval=E0,this.reconnectTimeout&&(window.clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null)},this.connection.onmessage=r=>{if(this.state!=="destroyed")try{const o=JSON.parse(r.data);this.onmessage&&this.onmessage(o),o.event==="pong"&&(this.removePongTimeout(),this.processSendQueue())}catch{}},this.connection.onclose=r=>{this.connection&&this.connection.bufferedAmount>0&&this.cachedSendData&&(this.sendQueue.push(this.cachedSendData),this.cachedSendData=null),this.onclose&&this.onclose(r),this.autoReconnect&&this.state===null&&this.reconnect(),this.removePongTimeout()},this.connection.onerror=r=>{this.onerror&&this.onerror(r),this.connection&&this.connection.close(),this.removePongTimeout()}}reconnect(){if(this.reconnectTimeout&&window.clearTimeout(this.reconnectTimeout),!Wr("kill-rapid-reconnect-detect")&&this.cooldownStart){const e=performance.now()-this.cooldownStart;if(e<KN){const n=KN-e;this.reconnectTimeout=window.setTimeout(this.connect,n);return}this.cooldownStart=null,this.reconnectInterval=E0}this.reconnectTimeout=window.setTimeout(this.connect,this.reconnectInterval),this.reconnectInterval=Math.min(this.reconnectInterval*2,this.maxReconnectInterval)}processSendQueue(){if(this.sendQueue.length>0){const e=this.sendQueue;this.sendQueue=[];for(const n of e)this.send(n)}}reconnectIfNeeded(){if(this.state!=="destroyed"){if(!this.connection||this.connection.readyState!==WebSocket.OPEN){this.reconnect();return}this.pongTimeout===null&&(this.connection.send(JSON.stringify({event:"ping"})),this.pongTimeout=window.setTimeout(()=>{var e;this.pongTimeout=null,(e=this.connection)==null||e.close(),this.reconnect()},sme))}}removePongTimeout(){this.pongTimeout!==null&&(window.clearTimeout(this.pongTimeout),this.pongTimeout=null)}send(e){if(this.state!=="destroyed")if(this.connection&&this.connection.readyState===WebSocket.OPEN&&this.pongTimeout===null)try{this.cachedSendData=e,this.connection.send(e)}catch{this.sendQueue.push(e),this.connect()}else this.sendQueue.push(e),this.connect()}cleanup(){this.boundReconnectIfNeeded&&window.removeEventListener("online",this.boundReconnectIfNeeded),this.boundDisconnect&&window.removeEventListener("offline",this.boundDisconnect),this.boundVisibilityChange&&document.removeEventListener("visibilitychange",this.boundVisibilityChange)}disconnect(){this.connection&&(this.state="disconnected",this.connection.close())}destroy(){this.connection&&(this.state="destroyed",this.cleanup(),this.connection.close(),this.connection=null,this.windowStartTime=null,this.connectionCount=0,this.cooldownStart=null)}}async function ts({useMockConnection:t}={}){const e=async({cursor:n})=>{const r=$j()?rme:"chat";return n?uN(r,{cursor:n}):uN(r)};return yg.get({getUrl:e})}async function ume({getUrl:t}){if(typeof WebSocket>"u")return{destroy:()=>{},send:()=>{},regenerate:()=>{},sendContext:()=>{},sendAudioStart:()=>{},sendAudio:()=>{},sendAudioEnd:()=>{},setCallType:()=>{},stop:()=>{},setOnEvent:()=>()=>{},sendChallengeResponse:()=>{},sendActionResult:()=>{},sendMessagePreview:()=>{},selectSxSMessage:()=>{},resetConversationState:()=>{},resetConversationTiming:()=>{},setConversationIdByMessageId:()=>{},setMessageIdByTaskId:()=>{},setChatModeForConversation:()=>{},setInputMethodForConversation:()=>{},callBeforeSendForConversation:()=>{},callOnSentForConversation:()=>{},setUserMessageForConversation:()=>{},onSubmitMessageBlocked:()=>{}};const e=zf(),n=!!me.instance().config().isBotDetectionEnabled;if(ze("client-side-request-challenge")&&!Wr("kill-client-side-request-challenge")&&n&&!e){const r=await tme(),o=!r||await nme();if(U.trackEvent({name:"system",data:{eventName:"botDetectionTriggered",eventInfo_result:o?"success":"failed",eventInfo_isBot:r}}),!o)return Promise.reject()}return new Promise((r,o)=>{const i=Wr("kill-chat-auto-reconnect"),s=new lme({autoReconnect:!i}),a=new eme(s);s.getUrl=()=>t({cursor:a.latestMessagePartId}),s.onopen=()=>{const u={event:"setOptions",...ome()};s.send(JSON.stringify(u)),s.onmessage=h=>{try{Sx.parse(h)}catch(f){f instanceof kg&&jf(f,"/chat")}a.processEvent(h)},r({destroy:()=>{s.destroy(),a.clearAllStreamingStates()},stop:(h={})=>{const{conversationId:f,taskId:p}=h;s.send(JSON.stringify({event:"stop",conversationId:f})),p&&s.send(JSON.stringify({event:"send",conversationId:f,content:[{type:"command",command:{type:"cancelTask",taskId:p}}],mode:"research"})),f&&ki(f,g=>{g.streamingState="idle"})},send:a.send,regenerate:a.regenerate,sendContext:h=>{s.send(JSON.stringify({event:"sendContext",context:h}))},sendAudioStart:(h,f,p)=>{const g={event:"audioStart",conversationId:h,options:f,clientType:p};s.send(JSON.stringify(g))},sendAudio:h=>{const f={event:"audio",audio:h};s.send(JSON.stringify(f))},sendAudioEnd:()=>{const h={event:"audioEnd"};s.send(JSON.stringify(h))},setCallType:h=>{const f={event:"setCallType",callType:h};s.send(JSON.stringify(f))},sendChallengeResponse:a.sendChallengeResponse,setOnEvent:h=>{s.onmessage=f=>{try{Sx.parse(f),a.processEvent(f)}catch(p){p instanceof kg&&jf(p,"/chat")}h(f)}},sendActionResult:h=>{s.send(JSON.stringify({event:"actionResult",actionId:h.actionId,result:h.result}))},selectSxSMessage:h=>{const{sideBySideComparisonId:f,selectedMessageId:p}=h,g={event:"selectMessage",sideBySideComparisonId:f,selectedMessageId:p};s.send(JSON.stringify(g))},resetConversationState:a.resetConversationState,resetConversationTiming:a.resetConversationTiming,setConversationIdByMessageId:a.setConversationIdByMessageId,setMessageIdByTaskId:a.setMessageIdByTaskId,setChatModeForConversation:a.setChatModeForConversation,setInputMethodForConversation:a.setInputMethodForConversation,callBeforeSendForConversation:a.callBeforeSendForConversation,callOnSentForConversation:a.callOnSentForConversation,setUserMessageForConversation:a.setUserMessageForConversation,onSubmitMessageBlocked:a.onSubmitMessageBlocked,sendMessagePreview:a.sendMessagePreview.bind(a)})},s.onclose=()=>{},s.onerror=l=>{const u=l instanceof ErrorEvent?l.message:"Unknown WebSocket error";U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketError",eventInfo_errorMessage:u,eventInfo_details:JSON.stringify(l)}}),o(new Error(`WebSocket connection error: ${u}`))},s.initialize().catch(l=>{const u=l instanceof Error?l.message:"Unknown WebSocket error";U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketInitializationError",eventInfo_errorMessage:u,eventInfo_details:l instanceof Error?l.stack??"":""}}),o(new Error(`WebSocket initialization error: ${u}`))})})}async function tA(){if(yg.isInstantiated){const t=Ue(eo),e=(t==null?void 0:t.streamingState)==="streaming",n=await yg.get();n.stop(),n.destroy(),n.stop({conversationId:t==null?void 0:t.id}),yg.reset();try{U.trackEvent({name:"system",data:{eventName:"chatClientReset",eventInfo_isMessageStreaming:e}})}catch{}}}const yg=new gl(t=>ume(t));function dme(t,e,n,r={text:"",atTimestamp:0,files:[]}){return n?e.length!==r.files.length?!0:!!!(t&&t.length>=n.minTextLength)||r.atTimestamp&&r.atTimestamp+n.debounceInMilliseconds>=Date.now()?!1:t&&r.text&&(t.includes(r.text)||r.text.includes(t))?Math.abs((t.length-r.text.length)/r.text.length)>=n.textDeltaPercent/100:!0:!1}const ya=P(null),JU=P(t=>{const e=t(ya);return(e==null?void 0:e.type)==="attachments"?e.uploadAttachments:[]},(t,e,n,r)=>{const o=t(ya),i=t(JU),s=typeof n=="function"?n(i):n;s.length===0&&(o==null?void 0:o.type)!=="attachments"||e(ya,{type:"attachments",uploadAttachments:s,source:r})}),Ra=P(t=>{const e=t(ya);return(e==null?void 0:e.type)==="tabs"?e.userAddedTabs:new Map},(t,e,n)=>{const r=t(ya),o=t(Ra),i=typeof n=="function"?n(o):n;i.size===0&&(r==null?void 0:r.type)!=="tabs"||e(ya,{type:"tabs",userAddedTabs:i})}),hme=P(t=>{const e=t(ya);return(e==null?void 0:e.type)==="attachments"&&e.uploadAttachments.length>0}),fme=P(t=>{const e=t(ya);return(e==null?void 0:e.type)==="tabs"&&e.userAddedTabs.size>0}),qN=P(new Map);function pme(){var e;const t=Ue(H5);if(t)return{character:{id:t.id,locationId:(e=t.location)==null?void 0:e.id}}}function XU(){const t=gp(bn),e=ve(jy);return m.useCallback((n,r)=>{t(o=>{const i=o.get(n);if(i){const{history:s}=i;r(s);const a=s.at(-1);if(a){const l=new Date(i.updatedAt),u=new Date(a.createdAt);l<u&&(i.updatedAt=a.createdAt)}s.length>2&&(i.isNew=!1,e(!0))}return o})},[t,e])}const mme=at();function ZU(t,e){at().set(bn,n=>Or(n,r=>{const o=r.get(t);if(o){const{history:i}=o;e(i);const s=i.at(-1);if(s){const a=new Date(o.updatedAt),l=new Date(s.createdAt);a<l&&(o.updatedAt=s.createdAt)}i.length>2&&(o.isNew=!1,mme.set(jy,!0))}}))}const gme=5e3,vme="largest-contentful-paint";function yme(t,e=gme){if(!bme())return QI(t,e);try{return Sme(t,e)}catch{return QI(t,e)}}function bme(){return"PerformanceObserver"in window}function QI(t,e){const n=setTimeout(t,e);return()=>clearTimeout(n)}function Cme(t){typeof window.requestIdleCallback<"u"?window.requestIdleCallback(t):setTimeout(t,0)}function Sme(t,e){let n=!1;const r=new PerformanceObserver(a=>{if(n)return;a.getEntries().length>0&&i()});try{r.observe({type:vme,buffered:!0})}catch{return QI(t,e)}const o=setTimeout(()=>{n||i()},e);function i(){n=!0,r.disconnect(),Cme(t)}function s(){n||(n=!0,r.disconnect(),clearTimeout(o))}return s}function Ime(){const t=se("bing-uet"),e=x(Cr),n=Bb(e);m.useEffect(()=>{const r=ol(),o=!!sT(),i=n?o&&r.advertising:!0;if(!t||!i||!e)return;const s=document.createElement("script");s.src="https://bat.bing.com/bat.js",s.defer=!0,s.onload=()=>{if(!window.UET)return;window.uetq=window.uetq??[];const u={ti:"355045625",enableAutoSpaTracking:!0};window.uetq=new window.UET(u),window.uetq.push("pageLoad")};const l=yme(()=>{document.querySelector('script[src="https://bat.bing.com/bat.js"]')||document.head.appendChild(s)});return()=>{l();try{const u=document.querySelector('script[src="https://bat.bing.com/bat.js"]');u&&document.head.removeChild(u)}catch{}}},[t,e,n])}let WN=!1;function Eme(){WN||(WN=!0,window.uetq=window.uetq??[],window.uetq.push("event","outbound_click",{}))}function e9(){const t=se("smart-mode-6e0b4c6f"),e=se("smart-mode-cd0c997b"),n=n9(e),r=ee(t||e?"composer.chatModes.smart.coachmarkDescriptionGPT5Variant":"composer.chatModes.smart.description");return{title:t?EO:IO,description:ee(n),coachmarkDescription:r}}function t9(){const t=ze("smart-mode-6e0b4c6f"),e=ze("smart-mode-cd0c997b"),n=n9(e);return{title:t?EO:IO,description:ee(n)}}function n9(t){return t?"composer.chatModes.smart.descriptionGPT5Variant":"composer.chatModes.smart.description"}function r9(t){return t?t.startsWith("!"):!1}function op({chatMode:t,forceExcludeModelName:e=!1}){const r=ze("model-in-mode-name")&&!e;let o=ee(`composer.chatModes.${t}.title`);return t==="chat"&&r?o=ee("composer.chatModes.chat.titleWithModel"):t==="reasoning"?o=r?cz:SO:t==="smart"&&(o=t9().title),o}function Tme(t){const e=t9();return t==="smart"?e.description:ee(`composer.chatModes.${t}.description`)}const YN={global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lrn_uni;u1={REGION};u2={LANG_LOCALE};u6=CMC;u50=submit_message;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://secure.adnxs.com/px?id=1869141&t=2","https://servedby.flashtalking.com/spot/1/5155;147512;16638/?spotName=USA_FY25H2_Copilot_Consumer_Chat_Send_button_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=Custom&m.customEventName=COPChatSend&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:e8n8utj&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://secure.adnxs.com/px?id=1869542&t=2&seg=39793132&consent={CONSENT}","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://servedby.flashtalking.com/spot/1/3360;147492;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Chat_Send_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:7s8ltxf&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}"]},bg={onPageLoad:{global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lp_uniq;u1={REGION};u2={LANG_LOCALE};u6=CMC;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869069&t=2","https://servedby.flashtalking.com/spot/1/5155;147507;16638/?spotName=USA_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=PageVisit&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:tzodkxv&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869539&seg=39793125&t=2&consent={CONSENT}","https://servedby.flashtalking.com/spot/1/3360;147490;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:2slc99p&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}"]},onMessageSend:YN,onStartVoiceChat:YN,onSuggestionChipClicked:{global:[],us:[],gb:[],other:[]},onDiscoverCardClicked:{global:[],us:[],gb:[],other:[]},onQueryParamSubmit:{global:[],us:[],gb:[],other:[]}},wme={onPageLoad:{behavior:20,Content:{Id:"CMCChatLoaded",cN:"CMC Chat Loaded"}},onMessageSend:{behavior:63,Content:{Id:"ChatManualMessage",cN:"Chat Manual Message"}},onStartVoiceChat:{behavior:300,Content:{Id:"VoiceMessageClick",cN:"Voice Message Click"}},onSuggestionChipClicked:{behavior:60,Content:{Id:"SuggestionChipClicked",cN:"Suggestion Chip Clicked"}},onDiscoverCardClicked:{behavior:144,Content:{Id:"DiscoverCardClicked",cN:"Discover Card Clicked"}},onQueryParamSubmit:{behavior:141,Content:{Id:"QueryParamMessageSubmit",cN:"Query Param Message Submit"}}};function _me(t,e){return e==="US"?bg[t].us:e==="GB"?bg[t].gb:e&&["AU","CA","DE","FR","JP"].includes(e)?bg[t].other:[]}function Ame(t){if(!ze("ads-pixels"))return;const e=at().get(Cr),n=Rt.language,r=Date.now().toString(),o=bg[t].global,i=_me(t,e),{set:s}=at();s(A5,a=>{for(const l of o.concat(i))a[l]||(a[l]={url:l.replace("{CACHE_BUSTER}",r).replace("{REGION}",e??"").replace("{LANG_LOCALE}",n).replace("{CONSENT}",Rme(e)).replace("{td1}",e??"").replace("{td2}",n).replace("{td3}","CMC").replace("{td4}","").replace("{td5}","").replace("{td6}",Nme(t)),isMounted:!0,timestamp:Date.now()});return{...a}})}function kme(t){ze("custom-1ds")&&(window.OneDsAzureAnalytics.capturePageAction(null,wme[t]),tL())}function ku(t){try{Ame(t),kme(t)}catch{Dr({feature:"sendIdeasTelemetry",customData:JSON.stringify({eventName:t})})}}function xme(t){ku(t==="suggestion"?"onSuggestionChipClicked":t==="discover"?"onDiscoverCardClicked":t==="queryParam"?"onQueryParamSubmit":"onMessageSend")}function Rme(t){return(t&&yy.includes(t))===!0?ol().advertising?"1":"0":""}function Nme(t){switch(t){case"onPageLoad":return"page_load";case"onMessageSend":return"submit_message";case"onStartVoiceChat":return"voice_message";case"onSuggestionChipClicked":return"suggestion_chip";case"onDiscoverCardClicked":return"discover_card";case"onQueryParamSubmit":return"query_param_submit";default:return""}}const Ti=at(),QN={};async function o9(t){const{text:e,filesWithAttachment:n=[],command:r}=t,o=Ue(hn),i=Ue(it),{result:s}=await Bue.run({chatMode:o,message:e??""}),a=n.length===0||n.every(({error:f,attachment:p})=>!!f||!p);return{isSubmittable:!!i&&!(!e&&a&&!r),shouldDropAccordingToMiddleware:!!s}}async function i9(t,e=!1){const{text:n,filesWithAttachment:r=[],inputMethod:o,command:i,context:s,reference:a,galleryImageUrl:l}=t,u=pme(),h=Ue(hn),f=Ue(it),p=Ue(fl),g=Ue(Ra);if(!f)throw new Error("No conversation ID found");let v=0,y=0;const b=[];for(const A of r)A.attachment&&(A.attachment.item.type==="image"?v+=1:A.attachment.item.type==="document"&&(A.attachment.item.partId=`${y}`,y+=1),b.push(A));if(l){const A=Ume(l);b.push(A)}const C=[],S={id:"",createdAt:new Date().toISOString(),author:"human",content:[],inputMethod:o};p&&p.conversationId===f&&(S.brand=p);for(const{attachment:A}of b)A&&(S.content.push(A.item),C.push(A.content));if(g.size>0&&(o!=="askCopilot"?S.content.push({type:"browserTabs",tabs:Array.from(g.values()).map(A=>({id:A.id,title:A.title,url:A.url,windowId:A.windowId,favIconUrl:A.favIconUrl}))}):Ti.set(Ra,new Map)),n){S.content.push({type:"text",text:n});let{textToSend:A}=await Hue.run({textToSend:n,chatMode:h});g.size>0&&!A.startsWith("/")&&(A=`${ee("composer.multiTabs.multitabsprompt",{CountOfAddTabs:g.size})} ${A}`),C.push({type:"text",text:A})}i&&C.push({type:"command",command:i}),a&&C.push({type:"reference",reference:a}),!(i&&c.union([Ly,al]).safeParse(i.type).success)&&!e&&ZU(f,A=>{A.push(S)});const{sendData:E,additionalData:T}=await Rue.run(S);return{sendMessageParams:{content:C,conversationId:f,data:E,mode:h,context:{...u,...s,ads:p?{showroom:{brandId:p.brandId,adId:p.adId??void 0,scenario:"chat"}}:void 0}},newMessage:S,filesToSubmit:b,additionalData:T,imagesUploaded:v,documentsUploaded:y}}async function Pme(t){var S,I,E,T,w;const{text:e,inputMethod:n,scenario:r,customData:o,entryPoint:i}=t,s=Ue(hn),a=Ue(it),l=Ue(fl),u=Ue(Ra),h=Ue(qN),f=ze("multi-file-upload"),{isSubmittable:p,shouldDropAccordingToMiddleware:g}=await o9(t);if(g){s==="computerUse"&&Ti.set(hn,"chat");return}const v=performance.now();if(Ti.set(v5,v),Ti.set(Lb,"bottom"),!p||!a)return;await gfe()&&(s==="computerUse"?(nt({source:"copilotActionsStartTask",customData:JSON.stringify({conversationId:a})}),Ti.set(Lu,!0)):Ti.set(Lu,!1)),QU({sideBySideComparisonId:a,reason:"sentNewMessage"}),YT(a);const y=await i9(t);Ti.set(bn,A=>Or(A,_=>{const L=_.get(a);L&&(L.suggestedFollowup=void 0)}));const b=await ts({useMockConnection:r9(e)});u.size>0&&Ti.set(Ra,new Map),h.size>0&&Ti.set(qN,new Map),b.send(y.sendMessageParams),b.resetConversationState(a,v),b.setChatModeForConversation(a,s),b.setInputMethodForConversation(a,n),b.callBeforeSendForConversation(a),b.callOnSentForConversation(a,y.additionalData),b.setUserMessageForConversation(a,y.sendMessageParams);const C={eventName:"copilotCompose",eventInfo_conversationId:a,eventInfo_inputMethod:n,eventInfo_numImagesUploaded:y.imagesUploaded,eventInfo_numDocumentsUploaded:y.documentsUploaded,eventInfo_mode:s,eventInfo_landingPage:U.getLandingPage(),...y.filesToSubmit.length>0?{eventInfo_uploadFileSize:((I=(S=y.filesToSubmit[0])==null?void 0:S.file)==null?void 0:I.size)??0,eventInfo_uploadFileType:(T=(E=y.filesToSubmit[0])==null?void 0:E.attachment)==null?void 0:T.type}:{}};f&&(C.eventInfo_uploadFilesInfo=JSON.stringify(y.filesToSubmit.map(({file:A,attachment:_,scenario:L})=>({scenario:L,type:(_==null?void 0:_.type)??"",size:(A==null?void 0:A.size)??""})))),y.additionalData&&(C.eventInfo_additionalData=y.additionalData),r&&(C.eventInfo_scenario=r),o&&(C.eventInfo_customData=o),l&&(C.eventInfo_adsContext=JSON.stringify({showroomBrandId:l.brandId,showroomBrandName:(w=l.brandLogo)==null?void 0:w.businessName})),i&&(C.eventInfo_entryPoint=i),U.trackEvent({name:"interaction",data:C}),Eme(),xme(n),xpe(),s==="computerUse"&&Ti.set(hn,"chat")}async function Mme(){const t=Ue(it);t&&(await ts()).onSubmitMessageBlocked(t)}async function Ome(){var r,o;const t=await ts(),e=Ue(it),n=(o=(r=lD(e))==null?void 0:r.part.task)==null?void 0:o.id;e&&(YT(e),QU({sideBySideComparisonId:e,reason:"stoppedMessage"})),t.stop({conversationId:e,taskId:n})}async function Lme(t){const{messageId:e}=t,n=performance.now(),r=Ue(it);if(!r)return;ZU(r,i=>{const s=cD(i);s&&s.id===e&&i.pop()});const o=await ts();o.regenerate(t),o.resetConversationTiming(r,n),o.setChatModeForConversation(r,Ue(hn)),o.callBeforeSendForConversation(r)}async function Dme(t){const{text:e,filesWithAttachment:n=[]}=t,r=Ue(it),o=Ue(S5),{isSubmittable:i}=await o9(t);if(!i||!r)return;if(dme(e??"",n,o,QN[r])){const a=await ts({useMockConnection:r9(e)}),l=await i9(t,!0);a.sendMessagePreview(l.sendMessageParams),QN[r]={text:e??"",atTimestamp:Date.now(),files:n}}}async function jme(t){(await ts()).selectSxSMessage(t)}const gs={submitMessage:Pme,stopMessage:Ome,onSubmitMessageBlocked:Mme,regenerateMessage:Lme,sendMessagePreview:Dme,selectSideBySideMessage:jme};function MPe(t,e){return t.find(n=>n.partId===e)}function Ume(t){return{attachment:{item:{type:"image",url:t},content:{type:"image",url:t},size:0,type:"image/png"}}}function s9(t){const{deferred:e=!1}=t??{},n=!!x(it),r=x(Hy),[o,i]=Ze(OT),s=ve(Op),a=ve(hn);m.useEffect(()=>{const h=Cfe()==="ac"?null:tG();if(h){const f=dG();i({prompt:h,inputMethod:f}),s({source:"queryInUrl",prompt:h})}},[a,s,i]);const l=m.useCallback(()=>{i(null)},[i]),u=m.useCallback(h=>{h&&(s({source:"queryInUrl",prompt:h}),(async()=>{if(n&&r&&h){const p=(o==null?void 0:o.inputMethod)??"queryParam",g=gs.submitMessage({text:h,inputMethod:p});l(),await g}})().catch(console.error))},[s,n,r,l,o]);return m.useEffect(()=>{!e&&o&&u(o.prompt)},[e,u,o]),{prompt:(o==null?void 0:o.prompt)??null,handler:e?u:void 0,clear:l}}function a9(){const t=Fme(),e=Bme();return t.prompt?t:e}function Fme(){const{t}=xe(),{formCode:e,lengthVariant:n,treatment:r,passthroughType:o}=pfe();if(e&&n&&r){const i=t(`promptsByFormCode.${e}.${r}.${n}`,"");return{passthroughType:o,prompt:i,source:i?{type:"formCode",formCode:e}:void 0}}return{passthroughType:null}}function Bme(){const{prompt:t}=OU({deferred:!0}),{prompt:e}=s9({deferred:!0});let n=null,r;return t?(n="partial",r=t):e&&(n="full",r=e),{passthroughType:n,prompt:r,source:r?{type:"query"}:void 0}}function c9(){const t=x(OT),{passthroughType:e}=a9();return!!(t!=null&&t.prompt)&&e==="full"}function Hme(){var u,h;const t=$t(),e=x(Lr),n=x(DT),{isMediaViewerOpen:r}=Us(),{disableMultiturn:o}=me.instance().config(),i=((u=me.instance().config().composer)==null?void 0:u.largeScreen)===!0&&((h=me.instance().config().composer)==null?void 0:h.voiceOnly)===!0,s=["/pro/subscribe","/pro/ewallet/return","/referrals","/referrals/rules","/subscription/manage","/subscription/start"],a=c9(),l=!t.startsWith("/labs")||t==="/labs/portrait/talk";return!s.includes(t)&&!t.startsWith("/topic-selection")&&(!t.startsWith("/fang")||r)&&!t.startsWith("/login")&&!t.startsWith("/pro/redeem")&&!t.startsWith("/gaming")&&(!t.startsWith("/library")||r)&&!t.startsWith("/memory/narrative")&&!t.startsWith("/conversations")&&!t.startsWith("/campaigns")&&!t.startsWith("/pages")&&!t.startsWith("/shares/pages")&&!t.startsWith("/shares/3d-generations")&&!t.startsWith("/gallery")&&l&&e!=="detail-only"&&!n&&!i&&!o&&!a}function zme(){var r,o;const t=$t(),e=Fb();return((r=me.instance().config().composer)==null?void 0:r.largeScreen)===!0&&((o=me.instance().config().composer)==null?void 0:o.voiceOnly)===!0&&!t.startsWith("/login-dcf")&&!e}function Vme(t){const{showSettings:e,showSettingsRelyOnChatDetailLayout:n}=t,r=x(Lr);return m.useMemo(()=>n?e&&r!=="side-by-side"&&r!=="detail-only":e,[n,e,r])}function $me(){const[t,e]=Ze(ffe);return m.useEffect(()=>{async function n(){const o=await(me.instance().config().isCommandHeaderSupported??(()=>Promise.resolve(!1)))();e(o)}n().catch(()=>{})},[e]),t}function Gme(){const[t,e]=Ze(dfe),n=x(MU);return m.useEffect(()=>{async function r(){const i=await(me.instance().config().isPinToggleHeaderCommandSupported??(()=>Promise.resolve(!1)))();e(i&&n)}r().catch(()=>{})},[e,n]),t}function l9(){const t=Object.assign({"../../assets/lottie/chain-of-thought-dark.json":()=>H(()=>import("./chain-of-thought-dark-DAdrbVMG.js"),[]).then(e=>e.default),"../../assets/lottie/chain-of-thought-light.json":()=>H(()=>import("./chain-of-thought-light-Cr0oOWNN.js"),[]).then(e=>e.default),"../../assets/lottie/character-thinking-cloud-animation.json":()=>H(()=>import("./character-thinking-cloud-animation-BPHslFRh.js"),[]).then(e=>e.default),"../../assets/lottie/image-gen-dark.json":()=>H(()=>import("./image-gen-dark-Xe9QwJfO.js"),[]).then(e=>e.default),"../../assets/lottie/image-gen-light.json":()=>H(()=>import("./image-gen-light-CvTKvF-o.js"),[]).then(e=>e.default),"../../assets/lottie/loader-gradient.json":()=>H(()=>import("./loader-gradient-nOUtNO79.js"),[]).then(e=>e.default),"../../assets/lottie/loader-image-generating.json":()=>H(()=>import("./loader-image-generating-CXsAaCuT.js"),[]).then(e=>e.default),"../../assets/lottie/loader-reasoning-dark.json":()=>H(()=>import("./loader-reasoning-dark-BWb0u6bB.js"),[]).then(e=>e.default),"../../assets/lottie/loader-reasoning-light.json":()=>H(()=>import("./loader-reasoning-light-DeS5Bpum.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-dark.json":()=>H(()=>import("./loader-spinner-dark-OIzWyRIV.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-light.json":()=>H(()=>import("./loader-spinner-light-DwSZ3tXn.js"),[]).then(e=>e.default),"../../assets/lottie/loader-spinner-white.json":()=>H(()=>import("./loader-spinner-white-B1ATuHTQ.js"),[]).then(e=>e.default),"../../assets/lottie/pages-welcome-dark.json":()=>H(()=>import("./pages-welcome-dark-r64A2mUI.js"),[]).then(e=>e.default),"../../assets/lottie/pages-welcome-light.json":()=>H(()=>import("./pages-welcome-light-DDUDcHxX.js"),[]).then(e=>e.default),"../../assets/lottie/voicemail-dark.json":()=>H(()=>import("./voicemail-dark-BtARQIb1.js"),[]).then(e=>e.default),"../../assets/lottie/voicemail-light.json":()=>H(()=>import("./voicemail-light-DeMSWjpH.js"),[]).then(e=>e.default)});return{load:e=>{const n=t[e];return n?n():Promise.reject(new Error(`Lottie animation not found: ${e}`))},exists:e=>e in t,getPaths:()=>Object.keys(t)}}const Kme=m.lazy(()=>H(()=>import("./index.es-B1Q_jbUA.js"),__vite__mapDeps([226,2,1]))),qme=l9();function _t(t){const{type:e,className:n,rendererSettings:r,colorTheme:o}=t,i=x(Os),s=o??i,[a,l]=m.useState(null),h=`../../assets/lottie/${m.useMemo(()=>{switch(e){case"gradient":return"loader-gradient.json";case"reasoning":return s==="dark"?"loader-reasoning-dark.json":"loader-reasoning-light.json";case"chainOfThought":return s==="dark"?"chain-of-thought-dark.json":"chain-of-thought-light.json";case"spinnerWhite":return"loader-spinner-white.json";case"imageGen":return s==="dark"?"image-gen-dark.json":"image-gen-light.json";case"spinnerThemed":default:return s==="dark"?"loader-spinner-dark.json":"loader-spinner-light.json"}},[e,s])}`;return m.useEffect(()=>{qme.load(h).then(l).catch(()=>l(null))},[h]),a?d.jsx(m.Suspense,{fallback:d.jsx("div",{}),children:d.jsx(Kme,{animationData:a,loop:!0,className:n,rendererSettings:r})}):d.jsx("div",{})}const nA=Object.freeze(Object.defineProperty({__proto__:null,default:_t},Symbol.toStringTag,{value:"Module"})),Wme=16/9,Yme=48,u9=296,Qme=u9/Wme,Jme=Qme+Yme;function Xme(){return d.jsx("div",{className:"pointer-events-none absolute inset-0 mb-[calc(var(--composer-container-height)+20px)] me-4 ms-2 mt-[72px]",children:d.jsx("div",{className:"absolute bottom-0 end-4",style:{width:`${u9}px`,height:`${Jme}px`},children:d.jsx("div",{className:Y("relative flex h-full flex-col overflow-hidden rounded-4xl","bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]"),style:{boxShadow:"0px 16px 24px -2px rgba(0, 0, 0, 0.12)"},children:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(_t,{className:"size-12"})})})})})}function JI(t){Dr({feature:"fileDownload",errorType:"DownloadFileError",errorMessage:t})}const rA=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M18.2498 20.5009C18.664 20.5008 19 20.8365 19 21.2507C19 21.6649 18.6644 22.0008 18.2502 22.0009L5.25022 22.0047C4.836 22.0048 4.5 21.6691 4.5 21.2549C4.5 20.8407 4.83557 20.5048 5.24978 20.5047L18.2498 20.5009ZM11.6482 2.01271L11.75 2.00586C12.1297 2.00586 12.4435 2.28801 12.4932 2.65409L12.5 2.75586L12.499 16.4409L16.2208 12.7205C16.4871 12.4543 16.9038 12.4301 17.1974 12.648L17.2815 12.7206C17.5477 12.9869 17.5719 13.4036 17.354 13.6972L17.2814 13.7813L12.2837 18.7779C12.0176 19.044 11.6012 19.0683 11.3076 18.8507L11.2235 18.7782L6.22003 13.7816C5.92694 13.4889 5.92661 13.014 6.21931 12.7209C6.48539 12.4545 6.90204 12.43 7.1958 12.6477L7.27997 12.7202L10.999 16.4339L11 2.75586C11 2.37616 11.2822 2.06237 11.6482 2.01271L11.75 2.00586L11.6482 2.01271Z",fill:"currentColor"})),OPe=Object.freeze(Object.defineProperty({__proto__:null,default:rA},Symbol.toStringTag,{value:"Module"})),Zme=10*1024*1024,ege=5*1024*1024,tge=50*1024*1024,nge=3,Gu={"image/png":["png"],"image/jpeg":["jpg","jpeg"],"image/webp":["webp"],"image/svg+xml":["svg"],"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},rge={"image/png":["png"],"image/jpeg":["jpg","jpeg"]},oge={"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},JN=P(null),d9=P(t=>{const e=t(Oa("fileasyncprocessing"));return{maxFilesPerMessage:nge,image:{maxBytes:Zme,mimeTypes:rge},document:{maxBytes:e?tge:ege,mimeTypes:oge}}}),kl=P(t=>t(JN)??t(d9),(t,e,n)=>{e(JN,n)}),Jd=P(t=>{const e=t(kl);return{...e.image.mimeTypes,...e.document.mimeTypes}});function Vp(t){const e=Ue(kl).document.mimeTypes;return t in e}function oA(t,e){const n=Ue(Jd),{supportedMimeTypes:r=n}=e??{};if(!t)return!1;const o=Ns(t);return o===""?!1:o in r}function LPe(){const t=Ue(Jd);return Object.keys(t).map(e=>e in Gu&&Gu[e]?[e,...Gu[e].map(n=>`.${n}`)]:[]).flat()}function h9(t){return Object.values(t).flat().map(e=>`.${e}`)}function ige(){const t=Ue(kl).document.mimeTypes;return h9(t)}function f9(){const t=Ue(kl);return{documentMaxSize:t.document.maxBytes,imageMaxSize:t.image.maxBytes}}function iA(t){var o;const e=(o=t.split(".").pop())==null?void 0:o.toLowerCase(),n=Ue(Jd),r=Object.entries(n).find(([,i])=>i.includes(e??""));return r?r[0]:""}function Ns(t){return t?t.type!==""?t.type:iA(t.name):""}function sge(t,e){const n=Ue(Jd),{supportedMimeTypes:r=n}=e??{};let o,i=null;const s=ze("multi-file-upload"),a=f9();if(!oA(t,{supportedMimeTypes:r}))o={title:ee("composer.errors.unsupportedAttachmentTypeV2.title"),message:ee("composer.errors.unsupportedAttachmentTypeV2.message")},i="fileType";else if(!p9(t)){const l=Ns(t);o=s?{title:ee("composer.errors.multi.attachmentTooLarge.title"),message:ee("composer.errors.multi.attachmentTooLarge.message",{limit:Vp(l)?a.documentMaxSize/1024/1024:a.imageMaxSize/1024/1024})}:{title:ee("composer.errors.attachmentTooLargeV2.title"),message:ee("composer.errors.attachmentTooLargeV2.message")},i="fileSize"}return U.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:i,eventInfo_fileType:Ns(t),eventInfo_fileSize:t.size}}),o}function age(t){return t.type==="text/x-markdown"?new File([t],t.name,{type:"text/markdown"}):t}function p9(t){const e=f9(),n=Ns(t),r=Vp(n)?e.documentMaxSize:e.imageMaxSize;return t.size<=r}function cge(t){var n;const e=(n=t.clipboardData)==null?void 0:n.items;if(e)for(let r=0;r<e.length;r+=1){const o=e[r];if((o==null?void 0:o.kind)==="file"){const i=o.getAsFile();if(!oA(i))continue;const s=Ns(i);if(i!==null)return p9(i)?{file:i,error:void 0}:(U.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:"fileType",eventInfo_fileSize:i.size,eventInfo_fileType:s,eventInfo_errorMessage:"File size too large in paste"}}),{file:void 0,error:{title:ee("composer.errors.attachmentTooLargeV2.title"),message:ee("composer.errors.attachmentTooLargeV2.message")}})}}return{file:void 0,error:void 0}}function m9(t){switch(t){case"unsupported-content-type":return{title:ee("composer.errors.unsupportedAttachmentTypeV2.title"),message:ee("composer.errors.unsupportedAttachmentTypeV2.message")};case"attachment-too-large":return{title:ee("composer.errors.attachmentTooLargeV2.title"),message:ee("composer.errors.attachmentTooLargeV2.message")};case"empty-attachment":return{title:ee("composer.errors.emptyAttachmentV2.title"),message:ee("composer.errors.emptyAttachmentV2.message")};case"content-blocked":return{title:ee("composer.errors.attachmentContentBlockedV2.title"),message:ee("composer.errors.attachmentContentBlockedV2.message")};case"rate-limit-exceeded":return{title:ee("composer.errors.attachmentRateLimitExceededV2.title"),message:ee("composer.errors.attachmentRateLimitExceededV2.message")};default:return{title:ee("composer.errors.attachmentDefault.title"),message:ee("composer.errors.attachmentDefault.message")}}}function g9(t,e){const n=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=n,r.download=e,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),r.remove()}function DPe(t,e,n){const r=new Blob([n],{type:e});g9(r,t)}function lge(t){const e=t.headers.get("Content-Disposition");if(!e)return;const n=e.match(/filename\*=UTF-8''([^;]+)/);if(n&&n[1])return decodeURIComponent(n[1]);const r=e.match(/filename=([^;]+)/);if(r&&r[1])return r[1].replace(/^"(.*)"$/,"$1")}async function v9(t){const{url:e,fileName:n,preferResponseFileName:r,args:o}=t,i=FE(e)?await fetch(e,o==null?void 0:o.options):await xa(e,o);if(!i.ok)throw new Error(`Failed to fetch file: ${n} from ${e} (status: ${i.status})`);const s=await i.blob();let a=n;if(r){const l=lge(i);l&&(a=l)}g9(s,a)}function uge({name:t,size:e,message:n,kind:r}){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:n,eventInfo_details:`Error uploading ${r} attachment`,eventInfo_uploadFileSize:e,eventInfo_uploadFileType:t,eventInfo_numDocumentsUploaded:1}})}const dge=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"none",...t},m.createElement("path",{d:"M10 6.5V2H5.5C4.67157 2 4 2.67157 4 3.5V16.5C4 17.3284 4.67157 18 5.5 18H14.5C15.3284 18 16 17.3284 16 16.5V8H11.5C10.6716 8 10 7.32843 10 6.5ZM6.5 10H13.5C13.7761 10 14 10.2239 14 10.5C14 10.7761 13.7761 11 13.5 11H6.5C6.22386 11 6 10.7761 6 10.5C6 10.2239 6.22386 10 6.5 10ZM6.5 12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H6.5C6.22386 13 6 12.7761 6 12.5C6 12.2239 6.22386 12 6.5 12ZM6.5 14H13.5C13.7761 14 14 14.2239 14 14.5C14 14.7761 13.7761 15 13.5 15H6.5C6.22386 15 6 14.7761 6 14.5C6 14.2239 6.22386 14 6.5 14ZM11 6.5V2.25L15.75 7H11.5C11.2239 7 11 6.77614 11 6.5Z",fill:"currentColor"})),hge=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",...t},m.createElement("path",{d:"M12 2V8C12 9.10457 12.8954 10 14 10H20V20C20 21.1046 19.1046 22 18 22H6C4.89543 22 4 21.1046 4 20V4C4 2.89543 4.89543 2 6 2H12ZM13.5 2.5V8C13.5 8.27614 13.7239 8.5 14 8.5H19.5L13.5 2.5Z",fill:"currentColor"})),fge="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/pdf-DuUY2RJ0.svg",pge=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none",...t},m.createElement("path",{d:"M3 2.5C3 2.22386 3.22386 2 3.5 2H11.5C11.7761 2 12 2.22386 12 2.5V4.5C12 4.77614 11.7761 5 11.5 5C11.2238 5 11 4.77614 11 4.5V3H7.99997L7.99998 13H9C9.27614 13 9.5 13.2239 9.5 13.5C9.5 13.7761 9.27614 14 9 14H6C5.72386 14 5.5 13.7761 5.5 13.5C5.5 13.2239 5.72386 13 6 13H6.99998L6.99997 3H4V4.5C4 4.77614 3.77614 5 3.5 5C3.22386 5 3 4.77614 3 4.5V2.5Z",fill:"currentColor"}));function mge(t){const{fileType:e,className:n}=t;switch(e){case"application/pdf":return d.jsx(Hn,{url:fge,className:n});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return d.jsx(dge,{className:n});case"text/plain":return d.jsx(pge,{className:n});case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return d.jsx(hge,{className:n})}}function gge(t){switch(t){case"application/pdf":return"bg-system-red-350";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return"bg-midnight-300";case"text/plain":return"bg-spot-blue-300";case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return"bg-neutral-300"}}function vge(t){const{t:e}=xe();switch(t){case"application/pdf":return e("fileUpload.fileTypeDisplayPdf");case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return e("fileUpload.fileTypeDisplayDoc");case"text/plain":return e("fileUpload.fileTypeDisplayTxt");case"application/json":return e("fileUpload.fileTypeDisplayJson");case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":return e("fileUpload.fileTypeDisplayXlsx");case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":return e("fileUpload.fileTypeDisplayPptx");case"text/csv":return e("fileUpload.fileTypeDisplayCsv");case"text/markdown":return e("fileUpload.fileTypeDisplayMarkdown");default:return e("fileUpload.fileTypeDisplayDefault")}}const yge=100,ny=P([]);function bge(){const t=x(ny),[e,n]=m.useState(!1),r=e?t:[];return d.jsxs("div",{className:"sr-only",ref:()=>setTimeout(()=>n(!0),yge),children:[d.jsx(XN,{messages:r.filter(o=>o.type==="polite"),type:"polite"}),d.jsx(XN,{messages:r.filter(o=>o.type==="assertive"),type:"assertive"})]})}function XN({messages:t,type:e}){return d.jsx("div",{"aria-live":e,"aria-atomic":"true",children:t.map(n=>d.jsx("div",{"aria-label":n.msg,children:n.msg},n.id))})}function XI(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.floor(Math.random()*16);return(t==="x"?e:Math.floor(Math.random()*4+8)).toString(16)})}const y9=7e3;function Td(t={}){return Cge(t),null}function Cge(t={}){const{msg:e,id:n,type:r="polite",timeout:o=y9}=t,i=ve(ny),s=m.useRef(n??XI());m.useEffect(()=>{e&&i(a=>{if(a.some(u=>u.id===s.current&&u.msg===e&&u.type===r))return a;s.current=n??XI();const l={msg:e,id:s.current,type:r};return window.setTimeout(()=>{i(u=>u.filter(h=>h.id!==l.id))},o),[...a,l]})},[n,e,r,i,o])}function xl(t){const{msg:e,id:n,type:r="polite",timeout:o=y9}=t;if(!e)return;const i=at();i.set(ny,s=>{const a={msg:e,id:n??XI(),type:r};return window.setTimeout(()=>{i.set(ny,l=>l.filter(u=>u.id!==a.id))},o),[...s,a]})}const Sge=m.lazy(()=>H(()=>Promise.resolve().then(()=>nA),void 0));function sA(t){var f;const{onRemove:e,filename:n,fileType:r,isUploading:o,role:i}=t,{t:s}=xe(),a=gge(r),l=vge(r),u=m.useCallback(()=>{e==null||e(),xl({msg:s("fileUpload.fileRemoved")})},[e,s]),h=(f=me.instance().config().composer)==null?void 0:f.smallAttachmentCard;return d.jsxs(Ne.div,{className:Y("relative flex justify-center gap-2 overflow-hidden rounded-xl border border-black/8 bg-acrylic-thin-fallback-light/60 p-3 dark:border-white/8 dark:bg-midnight-800/80 sm:w-56",{"mx-1 mt-2 h-[58px] w-auto flex-row":h,"h-32 w-44 flex-col":!h}),layout:"position",initial:ot,animate:Lt,exit:ot,role:i,children:[d.jsx("div",{className:Y("grid aspect-square size-8 place-items-center self-start rounded-full text-black",a),children:d.jsx(mge,{fileType:r,className:"size-5"})}),d.jsxs("div",{className:Y({"min-w-0 flex-1":h}),children:[d.jsx("p",{className:Y("font-ligatures-none truncate text-xs",{"overflow-hidden whitespace-nowrap":h}),children:n}),d.jsx("p",{className:"text-foreground-600 text-2xs",children:l})]}),e&&!o&&d.jsx("button",{type:"button",title:s("fileUpload.removeFileWithName",{name:n}),"aria-label":s("fileUpload.removeFileWithName",{name:n}),onClick:u,className:"absolute end-0.5 top-0.5 m-1 rounded-full border border-black/20 p-1 text-foreground-850 dark:border-white/20",children:d.jsx(Mr,{className:"size-3"})}),d.jsx(wn,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45",children:o?d.jsxs(d.Fragment,{children:[d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(Sge,{type:"spinnerThemed",className:"size-11"})}),d.jsx(Td,{msg:s("fileUpload.uploadingFile"),type:"polite"})]}):null})]})}function Ige(t){const{contentType:e,name:n,url:r}=t,{t:o}=xe(),i=ve(js),s=x(it),a=m.useCallback(()=>{const l={url:r,fileName:n};nt({source:"fileDownloadButton",scenario:"fileDownload",conversationId:s,customData:JSON.stringify(l)}),v9(l).catch(u=>{const h=u instanceof Error?u.message:"unknown file card error";JI(h),h.includes("status: 404")?i({title:o("common.fileUnavailable"),subtitle:o("common.fileUnavailableDetails"),dismissAfter:3e3}):i({title:o("common.downloadFailed"),subtitle:o("common.downloadFailedDetails",{fileName:n}),dismissAfter:3e3})})},[r,n,o,i,s]);return r?d.jsxs("div",{className:"flex w-fit max-w-full items-center gap-4 md:max-w-96",children:[d.jsx(sA,{filename:n,fileType:e}),d.jsx(Te,{title:o("common.download"),size:"36-sm",variant:"circle",color:"subtle-dimmed-inverted",onClick:a,"aria-label":o("common.download"),className:"shrink-0 border border-stroke-350",children:d.jsx(rA,{className:"size-5"})})]}):(JI("No URL provided"),null)}const b9=1.2;function Ha(t={},e={}){return{start:{...t,opacity:0},end:n=>({...e,opacity:1,transition:{delay:n,ease:"easeInOut",duration:b9}})}}const Ege=Ha();function Tge(t){const{items:e,shouldAnimate:n,BlockRenderer:r,delay:o}=t;return d.jsx(Ne.blockquote,{className:"flex flex-col gap-3 border-s-2 border-foreground-300 ps-3",variants:Ege,initial:n?"start":"end",animate:"end",custom:o,children:d.jsx(r,{blocks:e,shouldAnimate:n})})}function Rl(t){m.useEffect(()=>(window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}),[t])}function C9(t){const e=x(Zi),{openMediaViewer:n}=Us(),r=m.useCallback(()=>{if(!t)return[];const s=e.find(l=>l.id===t);if(!s||s.author!=="ai")return[];const a=[];for(const l of s.content)if(l.type==="card"){if(l.card.type==="image"){const u=l.card;a.push(...u.images)}else if(l.card.type==="video"){const u=l.card;a.push(...u.videos)}}return a},[e,t]),o=m.useCallback(s=>r().some(l=>l.source.url===s),[r]),i=m.useCallback(s=>{const a=r(),l=a.findIndex(h=>h.source.url===s);if(l===-1)return;const u=a.map(h=>"image"in h?{type:"image",url:h.image.url,thumbnailUrl:h.image.thumbnailUrl,altText:h.image.altText,initLoading:!0,source:{title:h.source.title,url:h.source.url,iconUrl:h.source.iconUrl??void 0}}:{type:"video",url:h.video.url,isShort:h.video.isShort,bestMomentIndex:h.bestMomentIndex,moments:h.moments,source:{title:h.video.title,url:h.source.url,iconUrl:h.source.iconUrl??void 0}});n({currentMediaIndex:l,media:u})},[r,n]);return{checkMediaLink:o,openMediaLink:i}}function Na({onOutsideEvent:t,elements:e,shouldAttachListeners:n=!0,includeScroll:r=!0,invokeOnce:o=!0,includeFocus:i=!0}){m.useEffect(()=>{const s=a=>{const l=a.target,u=e.some(f=>{var p;return(p=f.current)==null?void 0:p.contains(l)}),h=l instanceof Element&&l.closest("[data-outside-events-ignore]")!==null;!u&&!h&&t()};return n&&(document.addEventListener("mousedown",s,{once:o}),r&&document.addEventListener("scroll",s,!0),i&&document.addEventListener("focusin",s,!0)),()=>{document.removeEventListener("mousedown",s),r&&document.removeEventListener("scroll",s,!0),i&&document.removeEventListener("focusin",s,!0)}},[n,r,e,o,i,t])}const $p=m.createContext(void 0),wge=Ha();function _ge(t){const{url:e,title:n,index:r,shouldAnimate:o,delay:i,onCitationClick:s}=t,a=m.useContext($p),l=se("citation-media-open"),u=m.useId(),h=m.useId(),{checkMediaLink:f,openMediaLink:p}=C9(a??null),g=OE(),v=x(it),[y,b]=m.useState(!1),[C,S]=m.useState(null),{refs:I,floatingStyles:E}=tO({placement:"top",elements:{reference:C},middleware:[_d(8),hp(),Ad()]});Na({onOutsideEvent:()=>b(!1),elements:[I.floating],includeScroll:!0,invokeOnce:!0}),Rl(_=>{(_.key==="Escape"||_.key==="Control")&&b(L=>(L&&C instanceof HTMLElement&&C.focus(),!1))});const T=()=>{if(l&&f(e)){p(e);return}b(!0)},w=()=>{gn({source:"citationLink",conversationId:v,messageId:a,destination:od(e)}),b(!1),s&&s()},A=rd(e);return d.jsxs(Ne.span,{initial:o?"start":"end",animate:"end",variants:wge,custom:i,className:"mx-0.5 inline-block h-5 w-4 pb-1 align-middle","data-copy":"false",children:[d.jsx("button",{id:h,"aria-expanded":y,"aria-controls":u,"aria-label":ee("chat.citationPopoverButtonLabel",{citationNumber:r}),ref:S,type:"button",className:Y("mx-px flex size-full items-center justify-center rounded-md bg-accent-200 pt-px text-foreground-800 text-3xs hover:bg-accent-250 focus:bg-accent-250 dark:bg-slate-700 hover:dark:bg-background-400 focus:dark:bg-background-400",y&&"pointer-events-none"),onClick:T,children:r}),y&&d.jsx("span",{id:u,role:"dialog","aria-labelledby":h,className:Y("absolute w-screen px-4 max-sm:mb-2 sm:w-[350px] sm:px-0",jt.citations),style:E,ref:I.setFloating,children:d.jsx(Ne.span,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{scale:{duration:.2},opacity:{duration:.15}},className:"origin-top-left",style:LE,children:d.jsx("a",{onClick:w,className:"flex w-full rounded-2xl border border-stroke-100 bg-background-100 p-3 shadow-lg dark:bg-background-250",href:od(e),target:"_blank",rel:g,children:d.jsxs("span",{className:"w-full flex-1 space-y-0.5",children:[d.jsx("span",{className:"line-clamp-1 text-xs-strong",children:n}),d.jsx("span",{className:"line-clamp-1 flex items-center gap-1.5 text-foreground-600 text-2xs",children:A})]})})})})]},"citation")}const Age="https://#timestamp-",kge="https://#settings:privacy";function S9(t){return t?t.startsWith(Age)?"VideoCitation":t.startsWith(kge)?"PrivacySettings":"Unknown":"Unknown"}function xge(t){return S9(t)!=="Unknown"}function Rge(t){if(!/^\d{2}:\d{2}:\d{2}$/.test(t))return t;const[n,r,o]=t.split(":");return n==="00"?(r==null?void 0:r.charAt(0))==="0"?`${r.substring(1)}:${o}`:`${r}:${o}`:(n==null?void 0:n.charAt(0))==="0"?`${n.substring(1)}:${r}:${o}`:t}const Nge=Ha(),ZN="font-bold text-accent-550 dark:text-accent-600 hover:underline text-start align-top";function Pge(t){const{url:e,text:n,shouldAnimate:r,delay:o}=t,i=m.useContext($p),s=x(it),a=S9(e),l=async()=>{switch(a){case"VideoCitation":await Lue.run({url:e});break;case"PrivacySettings":await Uue.run({url:e});break}U.trackEvent({name:"interaction",data:{eventName:"localCitationClick",eventInfo_messageId:i??"",eventInfo_conversationId:s??"",eventInfo_citationType:a}})};m.useEffect(()=>{U.trackEvent({name:"interaction",data:{eventName:"localCitationImpression",eventInfo_messageId:i??"",eventInfo_conversationId:s??"",eventInfo_citationType:a}})},[i,s,a]);const u=Rge(n);return r?d.jsx(Ne.button,{className:ZN,onClick:l,"data-url":e,initial:"start",animate:"end",variants:Nge,custom:o,children:u}):d.jsx("button",{type:"button",className:ZN,onClick:l,"data-url":e,children:u})}const eP=Ha(),tP="font-bold text-accent-550 dark:text-accent-600 hover:underline text-start align-top";function ns(t){const{items:e,shouldAnimate:n,dangerouslyUseHtml:r,shouldTestForUrl:o=!0}=t,i=m.useContext($p),s=se("text-link-media-open"),{checkMediaLink:a,openMediaLink:l}=C9(i??null),u=ve(Xj),h=ve(Zr);return d.jsx(d.Fragment,{children:e.map((f,p)=>{var E;if(f.type==="citation"){const{title:T,url:w,index:A,delay:_}=f;return d.jsx(_ge,{title:T,url:w,index:A,shouldAnimate:n,delay:_},p)}if(f.type==="italic"||f.type==="bold"||f.type==="strikethrough"||f.type==="sup"||f.type==="sub"||f.type==="code"){const T=d.jsx(ns,{items:f.items,shouldAnimate:n,dangerouslyUseHtml:r});return f.type==="italic"?d.jsx("em",{children:T},p):f.type==="bold"?d.jsx("strong",{children:T},p):f.type==="strikethrough"?d.jsx("del",{children:T},p):f.type==="sup"?d.jsx("sup",{children:T},p):f.type==="sub"?d.jsx("sub",{children:T},p):d.jsx(Ne.code,{className:"font-ligatures-none mx-0.5 rounded-[4px] border border-stroke-300 bg-accent-200/60 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-accent-200",initial:n?"start":"end",animate:"end",variants:eP,custom:f.delay,children:T},p)}if(f.type!=="word")return null;const{word:g,url:v,delay:y,format:b}=f,S=Mge({word:g,url:v,testForUrl:!b&&o}),I={initial:"start",animate:"end",variants:eP,custom:y,...r===!0||b==="latexAsHtml"?{dangerouslySetInnerHTML:{__html:((E=window.copilotTrustedTypesPolicy)==null?void 0:E.createHTML(g))??""}}:{children:g}};if(S.url){if(xge(S.url))return d.jsx(Pge,{url:S.url,text:S.word,shouldAnimate:n,delay:y},p);const T=()=>{if(s&&S.url&&a(S.url)){l(S.url);return}u(S.url),h("confirm-link-navigation")};return d.jsxs(m.Fragment,{children:[n?d.jsx(Ne.button,{className:tP,onClick:T,"data-url":S.url,...I}):d.jsx("button",{type:"button",className:tP,onClick:T,"data-url":S.url,...I}),S.suffix&&S.suffix]},p)}return n?d.jsx(Ne.span,{...I},p):r===!0||b==="latexAsHtml"?d.jsx("span",{...I},p):d.jsx(m.Fragment,{children:g},p)})})}function Mge({word:t,url:e,testForUrl:n}){return e?{url:e,word:t}:n?Vz(t):{word:t}}function Xi(t){var e,n;return(n=(e=me.instance().config().styleOverrides)==null?void 0:e.typography)==null?void 0:n[t]}function ip(t){var e,n;return(n=(e=me.instance().config().styleOverrides)==null?void 0:e.padding)==null?void 0:n[t]}function Oge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h1",{className:Y(Xi("h1")??"text-2xl-medium","[&:not(:first-child)]:pt-6"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}function Lge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h2",{className:Y(Xi("h2")??"text-xl-medium","[&:not(:first-child)]:pt-3.5","pb-1"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}function Dge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h3",{className:Y(Xi("h3")??"text-lg-medium","pb-1","[&:not(:first-child)]:pt-3.5"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}function jge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h4",{className:Y(Xi("h4")??"text-md-medium"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}function Uge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h5",{className:Y(Xi("h5")??"text-base-medium"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}function Fge(t){const{shouldAnimate:e,items:n}=t;return d.jsx("h6",{className:Y(Xi("h6")??"text-base"),children:d.jsx(ns,{shouldAnimate:e,items:n})})}const Bge=[Oge,Lge,Dge,jge,Uge,Fge];function Hge(t){const{shouldAnimate:e,items:n,level:r}=t,o=Bge[r-1];return o?d.jsx(o,{shouldAnimate:e,items:n}):null}const zge=Ha(),nP="relative pb-6 w-full after:border-b after:border-stroke-300 after:w-full after:absolute after:mt-3";function Vge(t){const{delay:e,shouldAnimate:n}=t;return n?d.jsx(Ne.div,{className:nP,initial:"start",animate:"end",variants:zge,custom:e}):d.jsx("div",{className:nP})}const $ge=Ha();function Gge(t){const{content:e,shouldAnimate:n,delay:r,dangerouslyUseHtml:o}=t;return d.jsx(Ne.div,{initial:n?"start":"end",animate:"end",custom:r,variants:$ge,children:d.jsx("div",{className:"horizontal-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 text-center",children:d.jsx(ns,{items:e,shouldAnimate:n,dangerouslyUseHtml:o})})})}const rP="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col",Kge=Ha();function qge(t){const{items:e,ordered:n,start:r,shouldAnimate:o,BlockRenderer:i}=t,s=e.map(({items:a,delay:l},u)=>d.jsx(Ne.li,{initial:o?"start":"end",animate:"end",variants:Kge,custom:l,className:"ps-2",children:d.jsx(i,{blocks:a,shouldAnimate:o})},u));return n?d.jsx("ol",{start:r,className:Y(rP,"ms-5 marker:normal-nums marker:text-sm-strong"),children:s}):d.jsx("ul",{className:Y(rP,"ms-4 px-1"),children:s})}const I9={shouldCollapseCode:!1},E9=m.createContext(I9);function jPe(t){const{children:e,config:n={}}=t,r=m.useMemo(()=>({...I9,...n}),[n]);return d.jsx(E9.Provider,{value:r,children:e})}function Wge(){return m.useContext(E9)}function Yge(t){const{items:e,shouldAnimate:n}=t;return d.jsx("p",{children:d.jsx("span",{className:Y("font-ligatures-none","whitespace-pre-wrap",Xi("aiMessageDefault")),children:d.jsx(ns,{items:e,shouldAnimate:n})})})}const Qge=Ha();function Jge(t){const{columns:e,data:n,shouldAnimate:r}=t;return d.jsxs("div",{className:"relative max-w-full",children:[d.jsx("div",{className:"my-6 max-w-full overflow-x-auto rounded-lg bg-white/25 dark:bg-black/25",children:d.jsxs("table",{className:"t-table",style:{borderSpacing:0},children:[d.jsx("thead",{children:d.jsx("tr",{children:e.map((o,i)=>d.jsx(oP,{type:"head",items:o,shouldAnimate:r},i))})}),d.jsx("tbody",{children:n.map((o,i)=>d.jsx("tr",{children:o.map((s,a)=>d.jsx(oP,{type:"data",items:s,shouldAnimate:r},a))},i))})]})}),d.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-lg border border-stroke-300 dark:border-stroke-450"})]})}function oP(t){var i;const{type:e,items:n,shouldAnimate:r}=t,o=e==="head"?Ne.th:Ne.td;return d.jsx(o,{variants:Qge,initial:r?"start":"end",animate:"end",custom:((i=n[0])==null?void 0:i.delay)??0,children:d.jsx(ns,{shouldAnimate:r,items:n})})}const Xge=m.lazy(()=>H(()=>import("./code-BBUUtRD2.js"),__vite__mapDeps([227,1,2,228])));function ry(t){const{blocks:e,shouldAnimate:n}=t,{shouldCollapseCode:r}=Wge();return d.jsx(d.Fragment,{children:e.map((o,i)=>{const s=`${o.type}-${i}`;switch(o.type){case"paragraph":return d.jsx(Yge,{items:o.items,shouldAnimate:n},s);case"list":return d.jsx(qge,{ordered:o.ordered,start:o.start,items:o.items,BlockRenderer:ry,shouldAnimate:n},s);case"heading":return d.jsx(Hge,{items:o.items,level:o.level,shouldAnimate:n},s);case"code":return d.jsx(Xge,{content:o.content,original:o.original,delay:o.delay,shouldAnimate:n,language:o.language,dangerouslyUseHtml:o.dangerouslyUseHtml,shouldCollapse:r},s);case"latex":return d.jsx(Gge,{content:o.content,delay:o.delay,shouldAnimate:n,dangerouslyUseHtml:o.dangerouslyUseHtml},s);case"table":return d.jsx(Jge,{columns:o.columns,data:o.data,shouldAnimate:n},s);case"blockquote":return d.jsx(Tge,{items:o.items,delay:o.delay,shouldAnimate:n,BlockRenderer:ry},s);case"hr":return d.jsx(Vge,{delay:o.delay,shouldAnimate:n},s);default:return null}})})}let xu=null;async function Zge(t){return xu||(xu=(await H(async()=>{const{default:e}=await import("./katex-CfZphoad.js");return{default:e}},[])).default,t==null||t(),xu)}function T9(t,e,n){return xu?xu.renderToString(t,{output:"mathml",displayMode:e,throwOnError:!1}):(Zge(n),t)}var Xa={},Lh={},Za={},iP;function w9(){if(iP)return Za;iP=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.Node=Za.NodeType=void 0;var t;(function(i){i[i.element=1]="element",i[i.text=3]="text"})(t||(Za.NodeType=t={}));let e=class{constructor({nodeType:s,namespace:a,selfCloseTag:l,text:u,nodeName:h,childNodes:f,parentNode:p,attributes:g}){this.namespace=a||null,this.nodeType=s,this.isSelfCloseTag=!!l,this.text=u||null,this.nodeName=s===t.element?h:"#text",this.childNodes=f||[],this.parentNode=p,this.attributes=g||[]}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get innerHTML(){return this.childNodes.reduce((s,a)=>s+(a.nodeType===t.text?a.text:a.outerHTML),"")}get outerHTML(){if(this.nodeType===t.text)return this.textContent;const s=o(this.attributes),a=`<${this.nodeName}${s.length?" ":""}${s}${this.isSelfCloseTag?"/":""}>`;if(this.isSelfCloseTag)return a;const l=this.childNodes.map(h=>h.outerHTML).join(""),u=`</${this.nodeName}>`;return[a,l,u].join("")}get textContent(){return this.nodeType===t.text?this.text:this.childNodes.map(s=>s.textContent).join("").replace(/\x20+/g," ")}getAttribute(s){const a=this.attributes.find(l=>l.name===s);return a?a.value:null}getElementsByTagName(s){return n(this,a=>a.nodeName.toUpperCase()===s.toUpperCase())}getElementsByClassName(s){const a=new RegExp(`^(.*?\\s)?${s}(\\s.*?)?$`);return n(this,l=>!!(l.attributes.length&&a.test(l.getAttribute("class")||"")))}getElementsByName(s){return n(this,a=>!!(a.attributes.length&&a.getAttribute("name")===s))}getElementById(s){return r(this,a=>!!(a.attributes.length&&a.getAttribute("id")===s))}};Za.Node=e,e.ELEMENT_NODE=t.element,e.TEXT_NODE=t.text;function n(i,s){return i.nodeType===t.text?[]:i.childNodes.reduce((a,l)=>l.nodeType!==t.text&&s(l)?[...a,l,...n(l,s)]:[...a,...n(l,s)],[])}function r(i,s){for(let a=0,l=i.childNodes.length;a<l;a++){const u=i.childNodes[a];if(s(u))return u;const h=r(u,s);if(h)return h}return null}function o(i){return i.map(s=>s.name+(s.value?`="${s.value}"`:"")).join(" ")}return Za}var Dh={},sP;function eve(){if(sP)return Dh;sP=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.NodeAttribute=void 0;let t=class{constructor({name:n,value:r}){this.name=n,this.value=r}};return Dh.NodeAttribute=t,Dh}var aP;function cP(){if(aP)return Lh;aP=1,Object.defineProperty(Lh,"__esModule",{value:!0}),Lh.Dom=void 0;const t=w9(),e=eve(),n=/(<\/?(?:[a-z][a-z0-9]*:)?[a-z][a-z0-9-_.]*?[a-z0-9]*\s*(?:\s+[a-z0-9-_:]+(?:=(?:(?:'[\s\S]*?')|(?:"[\s\S]*?")))?)*\s*\/?>)|([^<]|<(?![a-z/]))*/gi,r=/\s[a-z0-9-_:]+\b(\s*=\s*('|")[\s\S]*?\2)?/gi,o=/(\s[a-z0-9-_:]+\b\s*)(?:=(\s*('|")[\s\S]*?\3))?/gi,i=/^<[a-z]/,s=/\/>$/,a=/^<\//,l=/^[^<]/,u=/<\/?((?:([a-z][a-z0-9]*):)?(?:[a-z](?:[a-z0-9-_.]*[a-z0-9])?))/i,h=/^('|")|('|")$/g,f=/^(?:area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/i;let p=class{constructor(w){this.rawHTML=w}find(w,A){const _=g(this.rawHTML,w,A);return A?_[0]||null:_}getElementsByClassName(w){const A=new RegExp(`^(.*?\\s)?${w}(\\s.*?)?$`);return this.find(_=>!!(_.attributes.length&&A.test(_.getAttribute("class")||"")))}getElementsByTagName(w){return this.find(A=>A.nodeName.toUpperCase()===w.toUpperCase())}getElementById(w){return this.find(A=>A.getAttribute("id")===w,!0)}getElementsByName(w){return this.find(A=>A.getAttribute("name")===w)}getElementsByAttribute(w,A){return this.find(_=>_.getAttribute(w)===A)}};Lh.Dom=p;function g(T,w,A=!1){const _=v(T),L=[];for(const N of _)if(N&&w(N)&&(L.push(N),A))return L;return L}function*v(T){const w=b(T);let A=null;for(let _=0,L=w.length;_<L;_++){const N=w[_];A=C(N,A)||A,y(A,N)&&(yield A,A=A.parentNode)}for(;A;)yield A,A=A.parentNode}function y(T,w){if(!w)return!1;const A=a.test(w),[,_]=w.match(u)||[];return A&&T.nodeName===_||T.isSelfCloseTag||T.nodeType===t.NodeType.text}function b(T){return T.match(n)||[]}function C(T,w){const A=l.test(T),_=i.test(T);return A?E(T,w):_?S(T,w):null}function S(T,w){var A;const[,_,L]=T.match(u)||[],N=s.test(T)||f.test(_),K=I(T),q=new t.Node({nodeType:t.NodeType.element,nodeName:_,namespace:L,attributes:K,childNodes:[],parentNode:w,selfCloseTag:N});return(A=w==null?void 0:w.childNodes)===null||A===void 0||A.push(q),q}function I(T){return(T.match(r)||[]).map(w=>{o.lastIndex=0;const A=o.exec(w)||[],[,_="",L=""]=A;return new e.NodeAttribute({name:_.trim(),value:L.trim().replace(h,"")})})}function E(T,w){var A;const _=new t.Node({nodeType:t.NodeType.text,nodeName:"#text",text:T,parentNode:w});return(A=w==null?void 0:w.childNodes)===null||A===void 0||A.push(_),_}return Lh}var lP;function tve(){return lP||(lP=1,function(t){var e=Xa&&Xa.__createBinding||(Object.create?function(i,s,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(i,l,u)}:function(i,s,a,l){l===void 0&&(l=a),i[l]=s[a]}),n=Xa&&Xa.__exportStar||function(i,s){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,i,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFromString=void 0;const r=cP();function o(i){return new r.Dom(i)}t.parseFromString=o,n(cP(),t),n(w9(),t)}(Xa)),Xa}var uP=tve();function aA(t){const e=[];let n="",r=!1;for(const o of t)o===" "||o===`
`?r=!0:r&&(e.push(n),n="",r=!1),n+=o;return n.length>0&&e.push(n),e}function nve(t){const n=uP.parseFromString(`<html>${t}</html>`).getElementsByTagName("html")[0];let r=[];for(const o of n.childNodes)o.nodeType===uP.NodeType.text?o.textContent&&(r=r.concat(aA(o.textContent))):r.push(o.outerHTML);return r}function rve(t){return t===" "||t===`
`||t==="	"}function _9(t,e,n={}){if(t.length<=e)return t;function r(a){const l=a.trim();return n.ellipsis?`${l}...`:l}const o=t.indexOf(`
`,0);if(o>=0&&o<e){const a=t.slice(0,o);return r(a)}let i=e;for(;i>0;){const a=t[i];if(a&&!rve(a))i-=1;else break}let s=t.slice(0,e);return i>0&&(s=t.slice(0,i)),r(s)}let Bi=null;function A9(t){return Bi||(H(()=>import("./core-BiIOkrJH.js"),__vite__mapDeps([229,2])).then(e=>e.default).then(e=>{Bi=e,t==null||t()}),null)}async function ove(t){const[{ALIAS_TO_SUPPORTED_LANGUAGE:e},{loadLanguageModule:n}]=await Promise.all([H(()=>Promise.resolve().then(()=>Lpe),void 0),H(()=>import("./language-loader-DH8IXb6w.js"),__vite__mapDeps([230,1,2]))]),r=e.get(t);if(!r)return!1;const o=await n(r);return o?Bi?(Bi.registerLanguage(t,o),!0):(A9(()=>{Bi==null||Bi.registerLanguage(t,o)}),!1):!1}const ive={jsx:["xml"],tsx:["xml"]};async function sve(t){const e=t.map(async r=>Bi?Bi.getLanguage(r)?!1:ove(r):!1);return(await Promise.allSettled(e)).some(r=>r.status==="fulfilled"&&r.value)}async function ave(t){const e=ive[t]??[];return sve([...e,t])}const vu=.018;function eu({items:t,delay:e,isHtml:n,forceRender:r}){var i;const o=[];for(const s of t){if(s.type==="citation"){const p=e.getValue();e.queueUpdate(vu),o.push({type:"citation",delay:p,...s.props});continue}if(s.type==="latex"){const p=T9(s.props.content,!1,r),g=e.getValue();e.queueUpdate(vu),o.push({type:"word",word:p,delay:g,format:"latexAsHtml"});continue}if(s.props.link){const p=s.props.text,{url:g}=s.props.link,v=e.getValue();e.queueUpdate(vu),o.push({type:"word",word:p,delay:v,url:g});continue}let a=null,l=null;if(s.props.annotations){for(const p of["italic","bold","strikethrough","code","sub","sup"])if(s.props.annotations[p]){const v={type:p,items:[]};(p==="code"||p==="sup"||p==="sub")&&(v.delay=e.getValue(),e.queueUpdate(vu)),l?(l.items.push(v),l=v):(a=v,l=v)}}const u=[],h=(i=s.props.annotations)==null?void 0:i.code;let f;n?f=nve(s.props.text):f=aA(s.props.text);for(let p=0;p<f.length;p+=1)u.push({type:"word",word:f[p],delay:e.getValue(),format:h?"code":void 0}),e.queueUpdate(vu);l&&a?(l.items.push(...u),o.push(a)):o.push(...u)}return o}function oy(t,e,n){const r=[];for(const o of t)switch(o.type){case"paragraph":{r.push({type:"paragraph",items:eu({items:o.props.items,delay:e,forceRender:n})});continue}case"list":{r.push({type:"list",ordered:o.props.ordered,start:o.props.start,items:o.props.items.map(i=>({delay:e.getValue(),items:oy(i,e,n)}))});continue}case"heading":{r.push({type:"heading",level:o.props.level,items:eu({items:o.props.items,delay:e})});continue}case"hr":{r.push({type:"hr",delay:e.getValue()}),e.queueUpdate(vu);continue}case"code":{const{language:i,content:s}=o.props;if(s.type!=="text")continue;let a=s.props.text,l=!1;if(i){const h=A9(n);if(ave(i).then(f=>{f&&n()}),h!=null&&h.getLanguage(i)){const{value:f}=h.highlight(s.props.text,{language:i});f&&(a=f,l=!0)}}const u={...s,props:{...s.props,text:a}};r.push({type:"code",content:eu({items:[u],delay:e,isHtml:l}),original:s.props.text,language:i,delay:e.getValue(),dangerouslyUseHtml:l});continue}case"latex":{const{content:i}=o.props;if(i.type!=="text")continue;i.props.text=T9(i.props.text,!0,n),r.push({type:"latex",content:eu({items:[i],isHtml:!0,delay:e}),delay:e.getValue(),dangerouslyUseHtml:!0});continue}case"table":{r.push({type:"table",columns:o.props.columns.map(i=>eu({items:i,delay:e})),data:o.props.data.map(i=>i.map(s=>eu({items:s,delay:e})))});continue}case"blockquote":{r.push({type:"blockquote",delay:e.getValue(),items:oy(o.props.items,e,n)});continue}default:{console.log(`Unhandled block type: ${o.type}`);continue}}return r}var Bm;function k9(t){return Bm=Bm||document.createElement("textarea"),Bm.innerHTML="&"+t+";",Bm.value}var cve=Object.prototype.hasOwnProperty;function lve(t,e){return t?cve.call(t,e):!1}function x9(t){var e=[].slice.call(arguments,1);return e.forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){t[r]=n[r]})}}),t}var uve=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function sp(t){return t.indexOf("\\")<0?t:t.replace(uve,"$1")}function R9(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function ZI(t){if(t>65535){t-=65536;var e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}var dve=/&([a-z#][a-z0-9]{1,31});/gi,hve=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function fve(t,e){var n=0,r=k9(e);return e!==r?r:e.charCodeAt(0)===35&&hve.test(e)&&(n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10),R9(n))?ZI(n):t}function el(t){return t.indexOf("&")<0?t:t.replace(dve,fve)}var pve=/[&<>"]/,mve=/[&<>"]/g,gve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function vve(t){return gve[t]}function Xr(t){return pve.test(t)?t.replace(mve,vve):t}var qe={};qe.blockquote_open=function(){return`<blockquote>
`};qe.blockquote_close=function(t,e){return"</blockquote>"+Nl(t,e)};qe.code=function(t,e){return t[e].block?"<pre><code>"+Xr(t[e].content)+"</code></pre>"+Nl(t,e):"<code>"+Xr(t[e].content)+"</code>"};qe.fence=function(t,e,n,r,o){var i=t[e],s="",a=n.langPrefix,l="",u,h,f;if(i.params){if(u=i.params.split(/\s+/g),h=u.join(" "),lve(o.rules.fence_custom,u[0]))return o.rules.fence_custom[u[0]](t,e,n,r,o);l=Xr(el(sp(h))),s=' class="'+a+l+'"'}return n.highlight?f=n.highlight.apply(n.highlight,[i.content].concat(u))||Xr(i.content):f=Xr(i.content),"<pre><code"+s+">"+f+"</code></pre>"+Nl(t,e)};qe.fence_custom={};qe.heading_open=function(t,e){return"<h"+t[e].hLevel+">"};qe.heading_close=function(t,e){return"</h"+t[e].hLevel+`>
`};qe.hr=function(t,e,n){return(n.xhtmlOut?"<hr />":"<hr>")+Nl(t,e)};qe.bullet_list_open=function(){return`<ul>
`};qe.bullet_list_close=function(t,e){return"</ul>"+Nl(t,e)};qe.list_item_open=function(){return"<li>"};qe.list_item_close=function(){return`</li>
`};qe.ordered_list_open=function(t,e){var n=t[e],r=n.order>1?' start="'+n.order+'"':"";return"<ol"+r+`>
`};qe.ordered_list_close=function(t,e){return"</ol>"+Nl(t,e)};qe.paragraph_open=function(t,e){return t[e].tight?"":"<p>"};qe.paragraph_close=function(t,e){var n=!(t[e].tight&&e&&t[e-1].type==="inline"&&!t[e-1].content);return(t[e].tight?"":"</p>")+(n?Nl(t,e):"")};qe.link_open=function(t,e,n){var r=t[e].title?' title="'+Xr(el(t[e].title))+'"':"",o=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+Xr(t[e].href)+'"'+r+o+">"};qe.link_close=function(){return"</a>"};qe.image=function(t,e,n){var r=' src="'+Xr(t[e].src)+'"',o=t[e].title?' title="'+Xr(el(t[e].title))+'"':"",i=' alt="'+(t[e].alt?Xr(el(sp(t[e].alt))):"")+'"',s=n.xhtmlOut?" /":"";return"<img"+r+i+o+s+">"};qe.table_open=function(){return`<table>
`};qe.table_close=function(){return`</table>
`};qe.thead_open=function(){return`<thead>
`};qe.thead_close=function(){return`</thead>
`};qe.tbody_open=function(){return`<tbody>
`};qe.tbody_close=function(){return`</tbody>
`};qe.tr_open=function(){return"<tr>"};qe.tr_close=function(){return`</tr>
`};qe.th_open=function(t,e){var n=t[e];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"};qe.th_close=function(){return"</th>"};qe.td_open=function(t,e){var n=t[e];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"};qe.td_close=function(){return"</td>"};qe.strong_open=function(){return"<strong>"};qe.strong_close=function(){return"</strong>"};qe.em_open=function(){return"<em>"};qe.em_close=function(){return"</em>"};qe.del_open=function(){return"<del>"};qe.del_close=function(){return"</del>"};qe.ins_open=function(){return"<ins>"};qe.ins_close=function(){return"</ins>"};qe.mark_open=function(){return"<mark>"};qe.mark_close=function(){return"</mark>"};qe.sub=function(t,e){return"<sub>"+Xr(t[e].content)+"</sub>"};qe.sup=function(t,e){return"<sup>"+Xr(t[e].content)+"</sup>"};qe.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};qe.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};qe.text=function(t,e){return Xr(t[e].content)};qe.htmlblock=function(t,e){return t[e].content};qe.htmltag=function(t,e){return t[e].content};qe.abbr_open=function(t,e){return'<abbr title="'+Xr(el(t[e].title))+'">'};qe.abbr_close=function(){return"</abbr>"};qe.footnote_ref=function(t,e){var n=Number(t[e].id+1).toString(),r="fnref"+n;return t[e].subId>0&&(r+=":"+t[e].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"};qe.footnote_block_open=function(t,e,n){var r=n.xhtmlOut?`<hr class="footnotes-sep" />
`:`<hr class="footnotes-sep">
`;return r+`<section class="footnotes">
<ol class="footnotes-list">
`};qe.footnote_block_close=function(){return`</ol>
</section>
`};qe.footnote_open=function(t,e){var n=Number(t[e].id+1).toString();return'<li id="fn'+n+'"  class="footnote-item">'};qe.footnote_close=function(){return`</li>
`};qe.footnote_anchor=function(t,e){var n=Number(t[e].id+1).toString(),r="fnref"+n;return t[e].subId>0&&(r+=":"+t[e].subId),' <a href="#'+r+'" class="footnote-backref">↩</a>'};qe.dl_open=function(){return`<dl>
`};qe.dt_open=function(){return"<dt>"};qe.dd_open=function(){return"<dd>"};qe.dl_close=function(){return`</dl>
`};qe.dt_close=function(){return`</dt>
`};qe.dd_close=function(){return`</dd>
`};function N9(t,e){return++e>=t.length-2?e:t[e].type==="paragraph_open"&&t[e].tight&&t[e+1].type==="inline"&&t[e+1].content.length===0&&t[e+2].type==="paragraph_close"&&t[e+2].tight?N9(t,e+2):e}var Nl=qe.getBreak=function(e,n){return n=N9(e,n),n<e.length&&e[n].type==="list_item_close"?"":`
`};function cA(){this.rules=x9({},qe),this.getBreak=qe.getBreak}cA.prototype.renderInline=function(t,e,n){for(var r=this.rules,o=t.length,i=0,s="";o--;)s+=r[t[i].type](t,i++,e,n,this);return s};cA.prototype.render=function(t,e,n){for(var r=this.rules,o=t.length,i=-1,s="";++i<o;)t[i].type==="inline"?s+=this.renderInline(t[i].children,e,n):s+=r[t[i].type](t,i,e,n,this);return s};function Io(){this.__rules__=[],this.__cache__=null}Io.prototype.__find__=function(t){for(var e=this.__rules__.length,n=-1;e--;)if(this.__rules__[++n].name===t)return n;return-1};Io.prototype.__compile__=function(){var t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||t.__cache__[n].push(r.fn))})})};Io.prototype.at=function(t,e,n){var r=this.__find__(t),o=n||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=o.alt||[],this.__cache__=null};Io.prototype.before=function(t,e,n,r){var o=this.__find__(t),i=r||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Io.prototype.after=function(t,e,n,r){var o=this.__find__(t),i=r||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Io.prototype.push=function(t,e,n){var r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Io.prototype.enable=function(t,e){t=Array.isArray(t)?t:[t],e&&this.__rules__.forEach(function(n){n.enabled=!1}),t.forEach(function(n){var r=this.__find__(n);if(r<0)throw new Error("Rules manager: invalid rule name "+n);this.__rules__[r].enabled=!0},this),this.__cache__=null};Io.prototype.disable=function(t){t=Array.isArray(t)?t:[t],t.forEach(function(e){var n=this.__find__(e);if(n<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[n].enabled=!1},this),this.__cache__=null};Io.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function yve(t){t.inlineMode?t.tokens.push({type:"inline",content:t.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):t.block.parse(t.src,t.options,t.env,t.tokens)}function Pl(t,e,n,r,o){this.src=t,this.env=r,this.options=n,this.parser=e,this.tokens=o,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}Pl.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""};Pl.prototype.push=function(t){this.pending&&this.pushPending(),this.tokens.push(t),this.pendingLevel=this.level};Pl.prototype.cacheSet=function(t,e){for(var n=this.cache.length;n<=t;n++)this.cache.push(0);this.cache[t]=e};Pl.prototype.cacheGet=function(t){return t<this.cache.length?this.cache[t]:0};function ap(t,e){var n,r,o,i=-1,s=t.posMax,a=t.pos,l=t.isInLabel;if(t.isInLabel)return-1;if(t.labelUnmatchedScopes)return t.labelUnmatchedScopes--,-1;for(t.pos=e+1,t.isInLabel=!0,n=1;t.pos<s;){if(o=t.src.charCodeAt(t.pos),o===91)n++;else if(o===93&&(n--,n===0)){r=!0;break}t.parser.skipToken(t)}return r?(i=t.pos,t.labelUnmatchedScopes=0):t.labelUnmatchedScopes=n-1,t.pos=a,t.isInLabel=l,i}function bve(t,e,n,r){var o,i,s,a,l,u;if(t.charCodeAt(0)!==42||t.charCodeAt(1)!==91||t.indexOf("]:")===-1||(o=new Pl(t,e,n,r,[]),i=ap(o,1),i<0||t.charCodeAt(i+1)!==58))return-1;for(a=o.posMax,s=i+2;s<a&&o.src.charCodeAt(s)!==10;s++);return l=t.slice(2,i),u=t.slice(i+2,s).trim(),u.length===0?-1:(r.abbreviations||(r.abbreviations={}),typeof r.abbreviations[":"+l]>"u"&&(r.abbreviations[":"+l]=u),s)}function Cve(t){var e=t.tokens,n,r,o,i;if(!t.inlineMode){for(n=1,r=e.length-1;n<r;n++)if(e[n-1].type==="paragraph_open"&&e[n].type==="inline"&&e[n+1].type==="paragraph_close"){for(o=e[n].content;o.length&&(i=bve(o,t.inline,t.options,t.env),!(i<0));)o=o.slice(i).trim();e[n].content=o,o.length||(e[n-1].tight=!0,e[n+1].tight=!0)}}}function eE(t){var e=el(t);try{e=decodeURI(e)}catch{}return encodeURI(e)}function P9(t,e){var n,r,o,i=e,s=t.posMax;if(t.src.charCodeAt(e)===60){for(e++;e<s;){if(n=t.src.charCodeAt(e),n===10)return!1;if(n===62)return o=eE(sp(t.src.slice(i+1,e))),t.parser.validateLink(o)?(t.pos=e+1,t.linkContent=o,!0):!1;if(n===92&&e+1<s){e+=2;continue}e++}return!1}for(r=0;e<s&&(n=t.src.charCodeAt(e),!(n===32||n<32||n===127));){if(n===92&&e+1<s){e+=2;continue}if(n===40&&(r++,r>1)||n===41&&(r--,r<0))break;e++}return i===e||(o=sp(t.src.slice(i,e)),!t.parser.validateLink(o))?!1:(t.linkContent=o,t.pos=e,!0)}function M9(t,e){var n,r=e,o=t.posMax,i=t.src.charCodeAt(e);if(i!==34&&i!==39&&i!==40)return!1;for(e++,i===40&&(i=41);e<o;){if(n=t.src.charCodeAt(e),n===i)return t.pos=e+1,t.linkContent=sp(t.src.slice(r+1,e)),!0;if(n===92&&e+1<o){e+=2;continue}e++}return!1}function O9(t){return t.trim().replace(/\s+/g," ").toUpperCase()}function Sve(t,e,n,r){var o,i,s,a,l,u,h,f,p;if(t.charCodeAt(0)!==91||t.indexOf("]:")===-1||(o=new Pl(t,e,n,r,[]),i=ap(o,0),i<0||t.charCodeAt(i+1)!==58))return-1;for(a=o.posMax,s=i+2;s<a&&(l=o.src.charCodeAt(s),!(l!==32&&l!==10));s++);if(!P9(o,s))return-1;for(h=o.linkContent,s=o.pos,u=s,s=s+1;s<a&&(l=o.src.charCodeAt(s),!(l!==32&&l!==10));s++);for(s<a&&u!==s&&M9(o,s)?(f=o.linkContent,s=o.pos):(f="",s=u);s<a&&o.src.charCodeAt(s)===32;)s++;return s<a&&o.src.charCodeAt(s)!==10?-1:(p=O9(t.slice(1,i)),typeof r.references[p]>"u"&&(r.references[p]={title:f,href:h}),s)}function Ive(t){var e=t.tokens,n,r,o,i;if(t.env.references=t.env.references||{},!t.inlineMode){for(n=1,r=e.length-1;n<r;n++)if(e[n].type==="inline"&&e[n-1].type==="paragraph_open"&&e[n+1].type==="paragraph_close"){for(o=e[n].content;o.length&&(i=Sve(o,t.inline,t.options,t.env),!(i<0));)o=o.slice(i).trim();e[n].content=o,o.length||(e[n-1].tight=!0,e[n+1].tight=!0)}}}function Eve(t){var e=t.tokens,n,r,o;for(r=0,o=e.length;r<o;r++)n=e[r],n.type==="inline"&&t.inline.parse(n.content,t.options,t.env,n.children)}function Tve(t){var e,n,r,o,i,s,a,l,u,h=0,f=!1,p={};if(t.env.footnotes&&(t.tokens=t.tokens.filter(function(g){return g.type==="footnote_reference_open"?(f=!0,l=[],u=g.label,!1):g.type==="footnote_reference_close"?(f=!1,p[":"+u]=l,!1):(f&&l.push(g),!f)}),!!t.env.footnotes.list)){for(s=t.env.footnotes.list,t.tokens.push({type:"footnote_block_open",level:h++}),e=0,n=s.length;e<n;e++){for(t.tokens.push({type:"footnote_open",id:e,level:h++}),s[e].tokens?(a=[],a.push({type:"paragraph_open",tight:!1,level:h++}),a.push({type:"inline",content:"",level:h,children:s[e].tokens}),a.push({type:"paragraph_close",tight:!1,level:--h})):s[e].label&&(a=p[":"+s[e].label]),t.tokens=t.tokens.concat(a),t.tokens[t.tokens.length-1].type==="paragraph_close"?i=t.tokens.pop():i=null,o=s[e].count>0?s[e].count:1,r=0;r<o;r++)t.tokens.push({type:"footnote_anchor",id:e,subId:r,level:h});i&&t.tokens.push(i),t.tokens.push({type:"footnote_close",level:--h})}t.tokens.push({type:"footnote_block_close",level:--h})}}var dP=` 
()[]'".,!?-`;function T0(t){return t.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function wve(t){var e,n,r,o,i,s,a,l,u,h,f,p,g=t.tokens;if(t.env.abbreviations){for(t.env.abbrRegExp||(p="(^|["+dP.split("").map(T0).join("")+"])("+Object.keys(t.env.abbreviations).map(function(v){return v.substr(1)}).sort(function(v,y){return y.length-v.length}).map(T0).join("|")+")($|["+dP.split("").map(T0).join("")+"])",t.env.abbrRegExp=new RegExp(p,"g")),h=t.env.abbrRegExp,n=0,r=g.length;n<r;n++)if(g[n].type==="inline"){for(o=g[n].children,e=o.length-1;e>=0;e--)if(i=o[e],i.type==="text"){for(l=0,s=i.content,h.lastIndex=0,u=i.level,a=[];f=h.exec(s);)h.lastIndex>l&&a.push({type:"text",content:s.slice(l,f.index+f[1].length),level:u}),a.push({type:"abbr_open",title:t.env.abbreviations[":"+f[2]],level:u++}),a.push({type:"text",content:f[2],level:u}),a.push({type:"abbr_close",level:--u}),l=h.lastIndex-f[3].length;a.length&&(l<s.length&&a.push({type:"text",content:s.slice(l),level:u}),g[n].children=o=[].concat(o.slice(0,e),a,o.slice(e+1)))}}}}var _ve=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Ave=/\((c|tm|r|p)\)/ig,kve={c:"©",r:"®",p:"§",tm:"™"};function xve(t){return t.indexOf("(")<0?t:t.replace(Ave,function(e,n){return kve[n.toLowerCase()]})}function Rve(t){var e,n,r,o,i;if(t.options.typographer){for(i=t.tokens.length-1;i>=0;i--)if(t.tokens[i].type==="inline")for(o=t.tokens[i].children,e=o.length-1;e>=0;e--)n=o[e],n.type==="text"&&(r=n.content,r=xve(r),_ve.test(r)&&(r=r.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/mg,"$1—$2").replace(/(^|\s)--(\s|$)/mg,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/mg,"$1–$2")),n.content=r)}}var Nve=/['"]/,hP=/['"]/g,Pve=/[-\s()\[\]]/,fP="’";function pP(t,e){return e<0||e>=t.length?!1:!Pve.test(t[e])}function tu(t,e,n){return t.substr(0,e)+n+t.substr(e+1)}function Mve(t){var e,n,r,o,i,s,a,l,u,h,f,p,g,v,y,b,C;if(t.options.typographer){for(C=[],y=t.tokens.length-1;y>=0;y--)if(t.tokens[y].type==="inline"){for(b=t.tokens[y].children,C.length=0,e=0;e<b.length;e++)if(n=b[e],!(n.type!=="text"||Nve.test(n.text))){for(a=b[e].level,g=C.length-1;g>=0&&!(C[g].level<=a);g--);C.length=g+1,r=n.content,i=0,s=r.length;e:for(;i<s&&(hP.lastIndex=i,o=hP.exec(r),!!o);){if(l=!pP(r,o.index-1),i=o.index+1,v=o[0]==="'",u=!pP(r,i),!u&&!l){v&&(n.content=tu(n.content,o.index,fP));continue}if(f=!u,p=!l,p){for(g=C.length-1;g>=0&&(h=C[g],!(C[g].level<a));g--)if(h.single===v&&C[g].level===a){h=C[g],v?(b[h.token].content=tu(b[h.token].content,h.pos,t.options.quotes[2]),n.content=tu(n.content,o.index,t.options.quotes[3])):(b[h.token].content=tu(b[h.token].content,h.pos,t.options.quotes[0]),n.content=tu(n.content,o.index,t.options.quotes[1])),C.length=g;continue e}}f?C.push({token:e,pos:o.index,single:v,level:a}):p&&v&&(n.content=tu(n.content,o.index,fP))}}}}}var w0=[["block",yve],["abbr",Cve],["references",Ive],["inline",Eve],["footnote_tail",Tve],["abbr2",wve],["replacements",Rve],["smartquotes",Mve]];function L9(){this.options={},this.ruler=new Io;for(var t=0;t<w0.length;t++)this.ruler.push(w0[t][0],w0[t][1])}L9.prototype.process=function(t){var e,n,r;for(r=this.ruler.getRules(""),e=0,n=r.length;e<n;e++)r[e](t)};function Ml(t,e,n,r,o){var i,s,a,l,u,h,f;for(this.src=t,this.parser=e,this.options=n,this.env=r,this.tokens=o,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",s=this.src,h=0,f=!1,a=l=h=0,u=s.length;l<u;l++){if(i=s.charCodeAt(l),!f)if(i===32){h++;continue}else f=!0;(i===10||l===u-1)&&(i!==10&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(h),f=!1,h=0,a=l+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}Ml.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Ml.prototype.skipEmptyLines=function(e){for(var n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Ml.prototype.skipSpaces=function(e){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===32;e++);return e};Ml.prototype.skipChars=function(e,n){for(var r=this.src.length;e<r&&this.src.charCodeAt(e)===n;e++);return e};Ml.prototype.skipCharsBack=function(e,n,r){if(e<=r)return e;for(;e>r;)if(n!==this.src.charCodeAt(--e))return e+1;return e};Ml.prototype.getLines=function(e,n,r,o){var i,s,a,l,u,h=e;if(e>=n)return"";if(h+1===n)return s=this.bMarks[h]+Math.min(this.tShift[h],r),a=o?this.eMarks[h]+1:this.eMarks[h],this.src.slice(s,a);for(l=new Array(n-e),i=0;h<n;h++,i++)u=this.tShift[h],u>r&&(u=r),u<0&&(u=0),s=this.bMarks[h]+u,h+1<n||o?a=this.eMarks[h]+1:a=this.eMarks[h],l[i]=this.src.slice(s,a);return l.join("")};function Ove(t,e,n){var r,o;if(t.tShift[e]-t.blkIndent<4)return!1;for(o=r=e+1;r<n;){if(t.isEmpty(r)){r++;continue}if(t.tShift[r]-t.blkIndent>=4){r++,o=r;continue}break}return t.line=r,t.tokens.push({type:"code",content:t.getLines(e,o,4+t.blkIndent,!0),block:!0,lines:[e,t.line],level:t.level}),!0}function Lve(t,e,n,r){var o,i,s,a,l,u=!1,h=t.bMarks[e]+t.tShift[e],f=t.eMarks[e];if(h+3>f||(o=t.src.charCodeAt(h),o!==126&&o!==96)||(l=h,h=t.skipChars(h,o),i=h-l,i<3)||(s=t.src.slice(h,f).trim(),s.indexOf("`")>=0))return!1;if(r)return!0;for(a=e;a++,!(a>=n||(h=l=t.bMarks[a]+t.tShift[a],f=t.eMarks[a],h<f&&t.tShift[a]<t.blkIndent));)if(t.src.charCodeAt(h)===o&&!(t.tShift[a]-t.blkIndent>=4)&&(h=t.skipChars(h,o),!(h-l<i)&&(h=t.skipSpaces(h),!(h<f)))){u=!0;break}return i=t.tShift[e],t.line=a+(u?1:0),t.tokens.push({type:"fence",params:s,content:t.getLines(e+1,a,i,!0),lines:[e,t.line],level:t.level}),!0}function Dve(t,e,n,r){var o,i,s,a,l,u,h,f,p,g,v,y=t.bMarks[e]+t.tShift[e],b=t.eMarks[e];if(y>b||t.src.charCodeAt(y++)!==62||t.level>=t.options.maxNesting)return!1;if(r)return!0;for(t.src.charCodeAt(y)===32&&y++,l=t.blkIndent,t.blkIndent=0,a=[t.bMarks[e]],t.bMarks[e]=y,y=y<b?t.skipSpaces(y):y,i=y>=b,s=[t.tShift[e]],t.tShift[e]=y-t.bMarks[e],f=t.parser.ruler.getRules("blockquote"),o=e+1;o<n&&(y=t.bMarks[o]+t.tShift[o],b=t.eMarks[o],!(y>=b));o++){if(t.src.charCodeAt(y++)===62){t.src.charCodeAt(y)===32&&y++,a.push(t.bMarks[o]),t.bMarks[o]=y,y=y<b?t.skipSpaces(y):y,i=y>=b,s.push(t.tShift[o]),t.tShift[o]=y-t.bMarks[o];continue}if(i)break;for(v=!1,p=0,g=f.length;p<g;p++)if(f[p](t,o,n,!0)){v=!0;break}if(v)break;a.push(t.bMarks[o]),s.push(t.tShift[o]),t.tShift[o]=-1337}for(u=t.parentType,t.parentType="blockquote",t.tokens.push({type:"blockquote_open",lines:h=[e,0],level:t.level++}),t.parser.tokenize(t,e,o),t.tokens.push({type:"blockquote_close",level:--t.level}),t.parentType=u,h[1]=t.line,p=0;p<s.length;p++)t.bMarks[p+e]=a[p],t.tShift[p+e]=s[p];return t.blkIndent=l,!0}function jve(t,e,n,r){var o,i,s,a=t.bMarks[e],l=t.eMarks[e];if(a+=t.tShift[e],a>l||(o=t.src.charCodeAt(a++),o!==42&&o!==45&&o!==95))return!1;for(i=1;a<l;){if(s=t.src.charCodeAt(a++),s!==o&&s!==32)return!1;s===o&&i++}return i<3?!1:(r||(t.line=e+1,t.tokens.push({type:"hr",lines:[e,t.line],level:t.level})),!0)}function mP(t,e){var n,r,o;return r=t.bMarks[e]+t.tShift[e],o=t.eMarks[e],r>=o||(n=t.src.charCodeAt(r++),n!==42&&n!==45&&n!==43)||r<o&&t.src.charCodeAt(r)!==32?-1:r}function gP(t,e){var n,r=t.bMarks[e]+t.tShift[e],o=t.eMarks[e];if(r+1>=o||(n=t.src.charCodeAt(r++),n<48||n>57))return-1;for(;;){if(r>=o)return-1;if(n=t.src.charCodeAt(r++),!(n>=48&&n<=57)){if(n===41||n===46)break;return-1}}return r<o&&t.src.charCodeAt(r)!==32?-1:r}function Uve(t,e){var n,r,o=t.level+2;for(n=e+2,r=t.tokens.length-2;n<r;n++)t.tokens[n].level===o&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].tight=!0,t.tokens[n].tight=!0,n+=2)}function Fve(t,e,n,r){var o,i,s,a,l,u,h,f,p,g,v,y,b,C,S,I,E,T,w=!0,A,_,L,N;if((f=gP(t,e))>=0)b=!0;else if((f=mP(t,e))>=0)b=!1;else return!1;if(t.level>=t.options.maxNesting)return!1;if(y=t.src.charCodeAt(f-1),r)return!0;for(S=t.tokens.length,b?(h=t.bMarks[e]+t.tShift[e],v=Number(t.src.substr(h,f-h-1)),t.tokens.push({type:"ordered_list_open",order:v,lines:E=[e,0],level:t.level++})):t.tokens.push({type:"bullet_list_open",lines:E=[e,0],level:t.level++}),o=e,I=!1,A=t.parser.ruler.getRules("list");o<n&&(C=t.skipSpaces(f),p=t.eMarks[o],C>=p?g=1:g=C-f,g>4&&(g=1),g<1&&(g=1),i=f-t.bMarks[o]+g,t.tokens.push({type:"list_item_open",lines:T=[e,0],level:t.level++}),a=t.blkIndent,l=t.tight,s=t.tShift[e],u=t.parentType,t.tShift[e]=C-t.bMarks[e],t.blkIndent=i,t.tight=!0,t.parentType="list",t.parser.tokenize(t,e,n,!0),(!t.tight||I)&&(w=!1),I=t.line-e>1&&t.isEmpty(t.line-1),t.blkIndent=a,t.tShift[e]=s,t.tight=l,t.parentType=u,t.tokens.push({type:"list_item_close",level:--t.level}),o=e=t.line,T[1]=o,C=t.bMarks[e],!(o>=n||t.isEmpty(o)||t.tShift[o]<t.blkIndent));){for(N=!1,_=0,L=A.length;_<L;_++)if(A[_](t,o,n,!0)){N=!0;break}if(N)break;if(b){if(f=gP(t,o),f<0)break}else if(f=mP(t,o),f<0)break;if(y!==t.src.charCodeAt(f-1))break}return t.tokens.push({type:b?"ordered_list_close":"bullet_list_close",level:--t.level}),E[1]=o,t.line=o,w&&Uve(t,S),!0}function Bve(t,e,n,r){var o,i,s,a,l,u=t.bMarks[e]+t.tShift[e],h=t.eMarks[e];if(u+4>h||t.src.charCodeAt(u)!==91||t.src.charCodeAt(u+1)!==94||t.level>=t.options.maxNesting)return!1;for(a=u+2;a<h;a++){if(t.src.charCodeAt(a)===32)return!1;if(t.src.charCodeAt(a)===93)break}return a===u+2||a+1>=h||t.src.charCodeAt(++a)!==58?!1:(r||(a++,t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.refs||(t.env.footnotes.refs={}),l=t.src.slice(u+2,a-2),t.env.footnotes.refs[":"+l]=-1,t.tokens.push({type:"footnote_reference_open",label:l,level:t.level++}),o=t.bMarks[e],i=t.tShift[e],s=t.parentType,t.tShift[e]=t.skipSpaces(a)-a,t.bMarks[e]=a,t.blkIndent+=4,t.parentType="footnote",t.tShift[e]<t.blkIndent&&(t.tShift[e]+=t.blkIndent,t.bMarks[e]-=t.blkIndent),t.parser.tokenize(t,e,n,!0),t.parentType=s,t.blkIndent-=4,t.tShift[e]=i,t.bMarks[e]=o,t.tokens.push({type:"footnote_reference_close",level:--t.level})),!0)}function Hve(t,e,n,r){var o,i,s,a=t.bMarks[e]+t.tShift[e],l=t.eMarks[e];if(a>=l||(o=t.src.charCodeAt(a),o!==35||a>=l))return!1;for(i=1,o=t.src.charCodeAt(++a);o===35&&a<l&&i<=6;)i++,o=t.src.charCodeAt(++a);return i>6||a<l&&o!==32?!1:(r||(l=t.skipCharsBack(l,32,a),s=t.skipCharsBack(l,35,a),s>a&&t.src.charCodeAt(s-1)===32&&(l=s),t.line=e+1,t.tokens.push({type:"heading_open",hLevel:i,lines:[e,t.line],level:t.level}),a<l&&t.tokens.push({type:"inline",content:t.src.slice(a,l).trim(),level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"heading_close",hLevel:i,level:t.level})),!0)}function zve(t,e,n){var r,o,i,s=e+1;return s>=n||t.tShift[s]<t.blkIndent||t.tShift[s]-t.blkIndent>3||(o=t.bMarks[s]+t.tShift[s],i=t.eMarks[s],o>=i)||(r=t.src.charCodeAt(o),r!==45&&r!==61)||(o=t.skipChars(o,r),o=t.skipSpaces(o),o<i)?!1:(o=t.bMarks[e]+t.tShift[e],t.line=s+1,t.tokens.push({type:"heading_open",hLevel:r===61?1:2,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:t.src.slice(o,t.eMarks[e]).trim(),level:t.level+1,lines:[e,t.line-1],children:[]}),t.tokens.push({type:"heading_close",hLevel:r===61?1:2,level:t.level}),!0)}var D9={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(t){D9[t]=!0});var Vve=/^<([a-zA-Z]{1,15})[\s\/>]/,$ve=/^<\/([a-zA-Z]{1,15})[\s>]/;function Gve(t){var e=t|32;return e>=97&&e<=122}function Kve(t,e,n,r){var o,i,s,a=t.bMarks[e],l=t.eMarks[e],u=t.tShift[e];if(a+=u,!t.options.html||u>3||a+2>=l||t.src.charCodeAt(a)!==60)return!1;if(o=t.src.charCodeAt(a+1),o===33||o===63){if(r)return!0}else if(o===47||Gve(o)){if(o===47){if(i=t.src.slice(a,l).match($ve),!i)return!1}else if(i=t.src.slice(a,l).match(Vve),!i)return!1;if(D9[i[1].toLowerCase()]!==!0)return!1;if(r)return!0}else return!1;for(s=e+1;s<t.lineMax&&!t.isEmpty(s);)s++;return t.line=s,t.tokens.push({type:"htmlblock",level:t.level,lines:[e,t.line],content:t.getLines(e,s,0,!0)}),!0}function _0(t,e){var n=t.bMarks[e]+t.blkIndent,r=t.eMarks[e];return t.src.substr(n,r-n)}function qve(t,e,n,r){var o,i,s,a,l,u,h,f,p,g,v;if(e+2>n||(l=e+1,t.tShift[l]<t.blkIndent)||(s=t.bMarks[l]+t.tShift[l],s>=t.eMarks[l])||(o=t.src.charCodeAt(s),o!==124&&o!==45&&o!==58)||(i=_0(t,e+1),!/^[-:| ]+$/.test(i))||(u=i.split("|"),u<=2))return!1;for(f=[],a=0;a<u.length;a++){if(p=u[a].trim(),!p){if(a===0||a===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(p))return!1;p.charCodeAt(p.length-1)===58?f.push(p.charCodeAt(0)===58?"center":"right"):p.charCodeAt(0)===58?f.push("left"):f.push("")}if(i=_0(t,e).trim(),i.indexOf("|")===-1||(u=i.replace(/^\||\|$/g,"").split("|"),f.length!==u.length))return!1;if(r)return!0;for(t.tokens.push({type:"table_open",lines:g=[e,0],level:t.level++}),t.tokens.push({type:"thead_open",lines:[e,e+1],level:t.level++}),t.tokens.push({type:"tr_open",lines:[e,e+1],level:t.level++}),a=0;a<u.length;a++)t.tokens.push({type:"th_open",align:f[a],lines:[e,e+1],level:t.level++}),t.tokens.push({type:"inline",content:u[a].trim(),lines:[e,e+1],level:t.level,children:[]}),t.tokens.push({type:"th_close",level:--t.level});for(t.tokens.push({type:"tr_close",level:--t.level}),t.tokens.push({type:"thead_close",level:--t.level}),t.tokens.push({type:"tbody_open",lines:v=[e+2,0],level:t.level++}),l=e+2;l<n&&!(t.tShift[l]<t.blkIndent||(i=_0(t,l).trim(),i.indexOf("|")===-1));l++){for(u=i.replace(/^\||\|$/g,"").split("|"),t.tokens.push({type:"tr_open",level:t.level++}),a=0;a<u.length;a++)t.tokens.push({type:"td_open",align:f[a],level:t.level++}),h=u[a].substring(u[a].charCodeAt(0)===124?1:0,u[a].charCodeAt(u[a].length-1)===124?u[a].length-1:u[a].length).trim(),t.tokens.push({type:"inline",content:h,level:t.level,children:[]}),t.tokens.push({type:"td_close",level:--t.level});t.tokens.push({type:"tr_close",level:--t.level})}return t.tokens.push({type:"tbody_close",level:--t.level}),t.tokens.push({type:"table_close",level:--t.level}),g[1]=v[1]=l,t.line=l,!0}function Hm(t,e){var n,r,o=t.bMarks[e]+t.tShift[e],i=t.eMarks[e];return o>=i||(r=t.src.charCodeAt(o++),r!==126&&r!==58)||(n=t.skipSpaces(o),o===n)||n>=i?-1:n}function Wve(t,e){var n,r,o=t.level+2;for(n=e+2,r=t.tokens.length-2;n<r;n++)t.tokens[n].level===o&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].tight=!0,t.tokens[n].tight=!0,n+=2)}function Yve(t,e,n,r){var o,i,s,a,l,u,h,f,p,g,v,y,b,C;if(r)return t.ddIndent<0?!1:Hm(t,e)>=0;if(h=e+1,t.isEmpty(h)&&++h>n||t.tShift[h]<t.blkIndent||(o=Hm(t,h),o<0)||t.level>=t.options.maxNesting)return!1;u=t.tokens.length,t.tokens.push({type:"dl_open",lines:l=[e,0],level:t.level++}),s=e,i=h;e:for(;;){for(C=!0,b=!1,t.tokens.push({type:"dt_open",lines:[s,s],level:t.level++}),t.tokens.push({type:"inline",content:t.getLines(s,s+1,t.blkIndent,!1).trim(),level:t.level+1,lines:[s,s],children:[]}),t.tokens.push({type:"dt_close",level:--t.level});;){if(t.tokens.push({type:"dd_open",lines:a=[h,0],level:t.level++}),y=t.tight,p=t.ddIndent,f=t.blkIndent,v=t.tShift[i],g=t.parentType,t.blkIndent=t.ddIndent=t.tShift[i]+2,t.tShift[i]=o-t.bMarks[i],t.tight=!0,t.parentType="deflist",t.parser.tokenize(t,i,n,!0),(!t.tight||b)&&(C=!1),b=t.line-i>1&&t.isEmpty(t.line-1),t.tShift[i]=v,t.tight=y,t.parentType=g,t.blkIndent=f,t.ddIndent=p,t.tokens.push({type:"dd_close",level:--t.level}),a[1]=h=t.line,h>=n||t.tShift[h]<t.blkIndent)break e;if(o=Hm(t,h),o<0)break;i=h}if(h>=n||(s=h,t.isEmpty(s))||t.tShift[s]<t.blkIndent||(i=s+1,i>=n)||(t.isEmpty(i)&&i++,i>=n)||t.tShift[i]<t.blkIndent||(o=Hm(t,i),o<0))break}return t.tokens.push({type:"dl_close",level:--t.level}),l[1]=h,t.line=h,C&&Wve(t,u),!0}function Qve(t,e){var n,r,o,i,s,a=e+1,l;if(n=t.lineMax,a<n&&!t.isEmpty(a)){for(l=t.parser.ruler.getRules("paragraph");a<n&&!t.isEmpty(a);a++)if(!(t.tShift[a]-t.blkIndent>3)){for(o=!1,i=0,s=l.length;i<s;i++)if(l[i](t,a,n,!0)){o=!0;break}if(o)break}}return r=t.getLines(e,a,t.blkIndent,!1).trim(),t.line=a,r.length&&(t.tokens.push({type:"paragraph_open",tight:!1,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:r,level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"paragraph_close",tight:!1,level:t.level})),!0}var zm=[["code",Ove],["fences",Lve,["paragraph","blockquote","list"]],["blockquote",Dve,["paragraph","blockquote","list"]],["hr",jve,["paragraph","blockquote","list"]],["list",Fve,["paragraph","blockquote"]],["footnote",Bve,["paragraph"]],["heading",Hve,["paragraph","blockquote"]],["lheading",zve],["htmlblock",Kve,["paragraph","blockquote"]],["table",qve,["paragraph"]],["deflist",Yve,["paragraph"]],["paragraph",Qve]];function lA(){this.ruler=new Io;for(var t=0;t<zm.length;t++)this.ruler.push(zm[t][0],zm[t][1],{alt:(zm[t][2]||[]).slice()})}lA.prototype.tokenize=function(t,e,n){for(var r=this.ruler.getRules(""),o=r.length,i=e,s=!1,a,l;i<n&&(t.line=i=t.skipEmptyLines(i),!(i>=n||t.tShift[i]<t.blkIndent));){for(l=0;l<o&&(a=r[l](t,i,n,!1),!a);l++);if(t.tight=!s,t.isEmpty(t.line-1)&&(s=!0),i=t.line,i<n&&t.isEmpty(i)){if(s=!0,i++,i<n&&t.parentType==="list"&&t.isEmpty(i))break;t.line=i}}};var Jve=/[\n\t]/g,Xve=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,Zve=/\u00a0/g;lA.prototype.parse=function(t,e,n,r){var o,i=0,s=0;if(!t)return[];t=t.replace(Zve," "),t=t.replace(Xve,`
`),t.indexOf("	")>=0&&(t=t.replace(Jve,function(a,l){var u;return t.charCodeAt(l)===10?(i=l+1,s=0,a):(u="    ".slice((l-i-s)%4),s=l-i+1,u)})),o=new Ml(t,this,e,n,r),this.tokenize(o,o.line,o.lineMax)};function eye(t){switch(t){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}function tye(t,e){for(var n=t.pos;n<t.posMax&&!eye(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}function nye(t,e){var n,r,o=t.pos;if(t.src.charCodeAt(o)!==10)return!1;if(n=t.pending.length-1,r=t.posMax,!e)if(n>=0&&t.pending.charCodeAt(n)===32)if(n>=1&&t.pending.charCodeAt(n-1)===32){for(var i=n-2;i>=0;i--)if(t.pending.charCodeAt(i)!==32){t.pending=t.pending.substring(0,i+1);break}t.push({type:"hardbreak",level:t.level})}else t.pending=t.pending.slice(0,-1),t.push({type:"softbreak",level:t.level});else t.push({type:"softbreak",level:t.level});for(o++;o<r&&t.src.charCodeAt(o)===32;)o++;return t.pos=o,!0}var uA=[];for(var vP=0;vP<256;vP++)uA.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){uA[t.charCodeAt(0)]=1});function rye(t,e){var n,r=t.pos,o=t.posMax;if(t.src.charCodeAt(r)!==92)return!1;if(r++,r<o){if(n=t.src.charCodeAt(r),n<256&&uA[n]!==0)return e||(t.pending+=t.src[r]),t.pos+=2,!0;if(n===10){for(e||t.push({type:"hardbreak",level:t.level}),r++;r<o&&t.src.charCodeAt(r)===32;)r++;return t.pos=r,!0}}return e||(t.pending+="\\"),t.pos++,!0}function oye(t,e){var n,r,o,i,s,a=t.pos,l=t.src.charCodeAt(a);if(l!==96)return!1;for(n=a,a++,r=t.posMax;a<r&&t.src.charCodeAt(a)===96;)a++;for(o=t.src.slice(n,a),i=s=a;(i=t.src.indexOf("`",s))!==-1;){for(s=i+1;s<r&&t.src.charCodeAt(s)===96;)s++;if(s-i===o.length)return e||t.push({type:"code",content:t.src.slice(a,i).replace(/[ \n]+/g," ").trim(),block:!1,level:t.level}),t.pos=s,!0}return e||(t.pending+=o),t.pos+=o.length,!0}function iye(t,e){var n,r,o,i=t.posMax,s=t.pos,a,l;if(t.src.charCodeAt(s)!==126||e||s+4>=i||t.src.charCodeAt(s+1)!==126||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,l=t.src.charCodeAt(s+2),a===126)||l===126||l===32||l===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===126;)r++;if(r>s+3)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===126&&t.src.charCodeAt(t.pos+1)===126&&(a=t.src.charCodeAt(t.pos-1),l=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,l!==126&&a!==126&&(a!==32&&a!==10?o--:l!==32&&l!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"del_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"del_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function sye(t,e){var n,r,o,i=t.posMax,s=t.pos,a,l;if(t.src.charCodeAt(s)!==43||e||s+4>=i||t.src.charCodeAt(s+1)!==43||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,l=t.src.charCodeAt(s+2),a===43)||l===43||l===32||l===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===43;)r++;if(r!==s+2)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===43&&t.src.charCodeAt(t.pos+1)===43&&(a=t.src.charCodeAt(t.pos-1),l=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,l!==43&&a!==43&&(a!==32&&a!==10?o--:l!==32&&l!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"ins_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"ins_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function aye(t,e){var n,r,o,i=t.posMax,s=t.pos,a,l;if(t.src.charCodeAt(s)!==61||e||s+4>=i||t.src.charCodeAt(s+1)!==61||t.level>=t.options.maxNesting||(a=s>0?t.src.charCodeAt(s-1):-1,l=t.src.charCodeAt(s+2),a===61)||l===61||l===32||l===10)return!1;for(r=s+2;r<i&&t.src.charCodeAt(r)===61;)r++;if(r!==s+2)return t.pos+=r-s,e||(t.pending+=t.src.slice(s,r)),!0;for(t.pos=s+2,o=1;t.pos+1<i;){if(t.src.charCodeAt(t.pos)===61&&t.src.charCodeAt(t.pos+1)===61&&(a=t.src.charCodeAt(t.pos-1),l=t.pos+2<i?t.src.charCodeAt(t.pos+2):-1,l!==61&&a!==61&&(a!==32&&a!==10?o--:l!==32&&l!==10&&o++,o<=0))){n=!0;break}t.parser.skipToken(t)}return n?(t.posMax=t.pos,t.pos=s+2,e||(t.push({type:"mark_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"mark_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=i,!0):(t.pos=s,!1)}function yP(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122}function bP(t,e){var n=e,r,o,i,s=!0,a=!0,l=t.posMax,u=t.src.charCodeAt(e);for(r=e>0?t.src.charCodeAt(e-1):-1;n<l&&t.src.charCodeAt(n)===u;)n++;return n>=l&&(s=!1),i=n-e,i>=4?s=a=!1:(o=n<l?t.src.charCodeAt(n):-1,(o===32||o===10)&&(s=!1),(r===32||r===10)&&(a=!1),u===95&&(yP(r)&&(s=!1),yP(o)&&(a=!1))),{can_open:s,can_close:a,delims:i}}function cye(t,e){var n,r,o,i,s,a,l,u=t.posMax,h=t.pos,f=t.src.charCodeAt(h);if(f!==95&&f!==42||e)return!1;if(l=bP(t,h),n=l.delims,!l.can_open)return t.pos+=n,e||(t.pending+=t.src.slice(h,t.pos)),!0;if(t.level>=t.options.maxNesting)return!1;for(t.pos=h+n,a=[n];t.pos<u;){if(t.src.charCodeAt(t.pos)===f){if(l=bP(t,t.pos),r=l.delims,l.can_close){for(i=a.pop(),s=r;i!==s;){if(s<i){a.push(i-s);break}if(s-=i,a.length===0)break;t.pos+=i,i=a.pop()}if(a.length===0){n=i,o=!0;break}t.pos+=r;continue}l.can_open&&a.push(r),t.pos+=r;continue}t.parser.skipToken(t)}return o?(t.posMax=t.pos,t.pos=h+n,e||((n===2||n===3)&&t.push({type:"strong_open",level:t.level++}),(n===1||n===3)&&t.push({type:"em_open",level:t.level++}),t.parser.tokenize(t),(n===1||n===3)&&t.push({type:"em_close",level:--t.level}),(n===2||n===3)&&t.push({type:"strong_close",level:--t.level})),t.pos=t.posMax+n,t.posMax=u,!0):(t.pos=h,!1)}var lye=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function uye(t,e){var n,r,o=t.posMax,i=t.pos;if(t.src.charCodeAt(i)!==126||e||i+2>=o||t.level>=t.options.maxNesting)return!1;for(t.pos=i+1;t.pos<o;){if(t.src.charCodeAt(t.pos)===126){n=!0;break}t.parser.skipToken(t)}return!n||i+1===t.pos||(r=t.src.slice(i+1,t.pos),r.match(/(^|[^\\])(\\\\)*\s/))?(t.pos=i,!1):(t.posMax=t.pos,t.pos=i+1,e||t.push({type:"sub",level:t.level,content:r.replace(lye,"$1")}),t.pos=t.posMax+1,t.posMax=o,!0)}var dye=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function hye(t,e){var n,r,o=t.posMax,i=t.pos;if(t.src.charCodeAt(i)!==94||e||i+2>=o||t.level>=t.options.maxNesting)return!1;for(t.pos=i+1;t.pos<o;){if(t.src.charCodeAt(t.pos)===94){n=!0;break}t.parser.skipToken(t)}return!n||i+1===t.pos||(r=t.src.slice(i+1,t.pos),r.match(/(^|[^\\])(\\\\)*\s/))?(t.pos=i,!1):(t.posMax=t.pos,t.pos=i+1,e||t.push({type:"sup",level:t.level,content:r.replace(dye,"$1")}),t.pos=t.posMax+1,t.posMax=o,!0)}function fye(t,e){var n,r,o,i,s,a,l,u,h=!1,f=t.pos,p=t.posMax,g=t.pos,v=t.src.charCodeAt(g);if(v===33&&(h=!0,v=t.src.charCodeAt(++g)),v!==91||t.level>=t.options.maxNesting||(n=g+1,r=ap(t,g),r<0))return!1;if(a=r+1,a<p&&t.src.charCodeAt(a)===40){for(a++;a<p&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a>=p)return!1;for(g=a,P9(t,a)?(i=t.linkContent,a=t.pos):i="",g=a;a<p&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a<p&&g!==a&&M9(t,a))for(s=t.linkContent,a=t.pos;a<p&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);else s="";if(a>=p||t.src.charCodeAt(a)!==41)return t.pos=f,!1;a++}else{if(t.linkLevel>0)return!1;for(;a<p&&(u=t.src.charCodeAt(a),!(u!==32&&u!==10));a++);if(a<p&&t.src.charCodeAt(a)===91&&(g=a+1,a=ap(t,a),a>=0?o=t.src.slice(g,a++):a=g-1),o||(typeof o>"u"&&(a=r+1),o=t.src.slice(n,r)),l=t.env.references[O9(o)],!l)return t.pos=f,!1;i=l.href,s=l.title}return e||(t.pos=n,t.posMax=r,h?t.push({type:"image",src:i,title:s,alt:t.src.substr(n,r-n),level:t.level}):(t.push({type:"link_open",href:i,title:s,level:t.level++}),t.linkLevel++,t.parser.tokenize(t),t.linkLevel--,t.push({type:"link_close",level:--t.level}))),t.pos=a,t.posMax=p,!0}function pye(t,e){var n,r,o,i,s=t.posMax,a=t.pos;return a+2>=s||t.src.charCodeAt(a)!==94||t.src.charCodeAt(a+1)!==91||t.level>=t.options.maxNesting||(n=a+2,r=ap(t,a+1),r<0)?!1:(e||(t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.list||(t.env.footnotes.list=[]),o=t.env.footnotes.list.length,t.pos=n,t.posMax=r,t.push({type:"footnote_ref",id:o,level:t.level}),t.linkLevel++,i=t.tokens.length,t.parser.tokenize(t),t.env.footnotes.list[o]={tokens:t.tokens.splice(i)},t.linkLevel--),t.pos=r+1,t.posMax=s,!0)}function mye(t,e){var n,r,o,i,s=t.posMax,a=t.pos;if(a+3>s||!t.env.footnotes||!t.env.footnotes.refs||t.src.charCodeAt(a)!==91||t.src.charCodeAt(a+1)!==94||t.level>=t.options.maxNesting)return!1;for(r=a+2;r<s;r++){if(t.src.charCodeAt(r)===32||t.src.charCodeAt(r)===10)return!1;if(t.src.charCodeAt(r)===93)break}return r===a+2||r>=s||(r++,n=t.src.slice(a+2,r-1),typeof t.env.footnotes.refs[":"+n]>"u")?!1:(e||(t.env.footnotes.list||(t.env.footnotes.list=[]),t.env.footnotes.refs[":"+n]<0?(o=t.env.footnotes.list.length,t.env.footnotes.list[o]={label:n,count:0},t.env.footnotes.refs[":"+n]=o):o=t.env.footnotes.refs[":"+n],i=t.env.footnotes.list[o].count,t.env.footnotes.list[o].count++,t.push({type:"footnote_ref",id:o,subId:i,level:t.level})),t.pos=r,t.posMax=s,!0)}var gye=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],vye=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,yye=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function bye(t,e){var n,r,o,i,s,a=t.pos;return t.src.charCodeAt(a)!==60||(n=t.src.slice(a),n.indexOf(">")<0)?!1:(r=n.match(yye),r?gye.indexOf(r[1].toLowerCase())<0||(i=r[0].slice(1,-1),s=eE(i),!t.parser.validateLink(i))?!1:(e||(t.push({type:"link_open",href:s,level:t.level}),t.push({type:"text",content:i,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=r[0].length,!0):(o=n.match(vye),o?(i=o[0].slice(1,-1),s=eE("mailto:"+i),t.parser.validateLink(s)?(e||(t.push({type:"link_open",href:s,level:t.level}),t.push({type:"text",content:i,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=o[0].length,!0):!1):!1))}function Gb(t,e){return t=t.source,e=e||"",function n(r,o){return r?(o=o.source||o,t=t.replace(r,o),n):new RegExp(t,e)}}var Cye=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,Sye=/[^"'=<>`\x00-\x20]+/,Iye=/'[^']*'/,Eye=/"[^"]*"/,Tye=Gb(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",Sye)("single_quoted",Iye)("double_quoted",Eye)(),wye=Gb(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",Cye)("attr_value",Tye)(),_ye=Gb(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",wye)(),Aye=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,kye=/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,xye=/<[?].*?[?]>/,Rye=/<![A-Z]+\s+[^>]*>/,Nye=/<!\[CDATA\[[\s\S]*?\]\]>/,Pye=Gb(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",_ye)("close_tag",Aye)("comment",kye)("processing",xye)("declaration",Rye)("cdata",Nye)();function Mye(t){var e=t|32;return e>=97&&e<=122}function Oye(t,e){var n,r,o,i=t.pos;return!t.options.html||(o=t.posMax,t.src.charCodeAt(i)!==60||i+2>=o)||(n=t.src.charCodeAt(i+1),n!==33&&n!==63&&n!==47&&!Mye(n))||(r=t.src.slice(i).match(Pye),!r)?!1:(e||t.push({type:"htmltag",content:t.src.slice(i,i+r[0].length),level:t.level}),t.pos+=r[0].length,!0)}var Lye=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,Dye=/^&([a-z][a-z0-9]{1,31});/i;function jye(t,e){var n,r,o,i=t.pos,s=t.posMax;if(t.src.charCodeAt(i)!==38)return!1;if(i+1<s){if(n=t.src.charCodeAt(i+1),n===35){if(o=t.src.slice(i).match(Lye),o)return e||(r=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),t.pending+=R9(r)?ZI(r):ZI(65533)),t.pos+=o[0].length,!0}else if(o=t.src.slice(i).match(Dye),o){var a=k9(o[1]);if(o[1]!==a)return e||(t.pending+=a),t.pos+=o[0].length,!0}}return e||(t.pending+="&"),t.pos++,!0}var A0=[["text",tye],["newline",nye],["escape",rye],["backticks",oye],["del",iye],["ins",sye],["mark",aye],["emphasis",cye],["sub",uye],["sup",hye],["links",fye],["footnote_inline",pye],["footnote_ref",mye],["autolink",bye],["htmltag",Oye],["entity",jye]];function Kb(){this.ruler=new Io;for(var t=0;t<A0.length;t++)this.ruler.push(A0[t][0],A0[t][1]);this.validateLink=Uye}Kb.prototype.skipToken=function(t){var e=this.ruler.getRules(""),n=e.length,r=t.pos,o,i;if((i=t.cacheGet(r))>0){t.pos=i;return}for(o=0;o<n;o++)if(e[o](t,!0)){t.cacheSet(r,t.pos);return}t.pos++,t.cacheSet(r,t.pos)};Kb.prototype.tokenize=function(t){for(var e=this.ruler.getRules(""),n=e.length,r=t.posMax,o,i;t.pos<r;){for(i=0;i<n&&(o=e[i](t,!1),!o);i++);if(o){if(t.pos>=r)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};Kb.prototype.parse=function(t,e,n,r){var o=new Pl(t,this,e,n,r);this.tokenize(o)};function Uye(t){var e=["vbscript","javascript","file","data"],n=t.trim().toLowerCase();return n=el(n),!(n.indexOf(":")!==-1&&e.indexOf(n.split(":")[0])!==-1)}var Fye={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},Bye={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},Hye={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}},zye={default:Fye,full:Bye,commonmark:Hye};function j9(t,e,n){this.src=e,this.env=n,this.options=t.options,this.tokens=[],this.inlineMode=!1,this.inline=t.inline,this.block=t.block,this.renderer=t.renderer,this.typographer=t.typographer}function za(t,e){typeof t!="string"&&(e=t,t="default"),e&&e.linkify!=null&&console.warn(`linkify option is removed. Use linkify plugin instead:

import Remarkable from 'remarkable';
import linkify from 'remarkable/linkify';
new Remarkable().use(linkify)
`),this.inline=new Kb,this.block=new lA,this.core=new L9,this.renderer=new cA,this.ruler=new Io,this.options={},this.configure(zye[t]),this.set(e||{})}za.prototype.set=function(t){x9(this.options,t)};za.prototype.configure=function(t){var e=this;if(!t)throw new Error("Wrong `remarkable` preset, check name/content");t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enable(t.components[n].rules,!0)})};za.prototype.use=function(t,e){return t(this,e),this};za.prototype.parse=function(t,e){var n=new j9(this,t,e);return this.core.process(n),n.tokens};za.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};za.prototype.parseInline=function(t,e){var n=new j9(this,t,e);return n.inlineMode=!0,this.core.process(n),n.tokens};za.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};function Vye(t){const e="\\(",n="\\)";function r(a,l){const u=a.pos,h=a.posMax;let f=u;if(a.src.charAt(f)!==e[0]||a.src.charAt(f+1)!==e[1])return!1;f+=e.length;const p=a.src.slice(u,f);if(p.length>2)return!1;const g=f;let v=0;for(;f<h;){const y=a.src.charAt(f),b=y===n[0]&&a.src.charAt(f+1)===n[1];if(y==="{"&&(f===0||a.src.charAt(f-1)!=="\\"))v+=1;else if(y==="}"&&(f===0||a.src.charAt(f-1)!=="\\")){if(v-=1,v<0)return!1}else if(b&&v===0){const C=f,S=f+n.length;if(S-C===p.length){if(!l){const I=a.src.slice(g,C).replace(/[ \n]+/g," ").trim();a.push({type:"latex",content:I,block:!1,level:a.level})}return a.pos=S,!0}}f+=1}return l||(a.pending+=p),a.pos+=p.length,!0}const o={start:"$$",end:"$$"},i={start:"\\[",end:"\\]"};function s(a,l,u,h){const f=a.tShift[l],p=a.bMarks[l]+f;let g=a.src.slice(p,a.eMarks[l]),v=null;if(g.startsWith(o.start)?v=o:g.startsWith(i.start)&&(v=i),!v)return!1;let y=l,b=!1;for(;y<=u;){const S=a.tShift[y],I=a.bMarks[y]+S;if(g=a.src.slice(I,a.eMarks[y]),g.endsWith(v.end)&&(y>l||g!==v.end)){b=!0;break}y+=1}if(!b)return!1;if(h)return!0;const C=a.src.slice(p+v.start.length,a.eMarks[y]-v.end.length);return a.tokens.push({type:"latex_block",content:C.trim(),lines:[l,y],level:a.level}),a.line=y+1,!0}t.inline.ruler.push("latex",r,{}),t.block.ruler.after("fences","latex_block",s,{})}function $ye(t){return t.replaceAll(/(\n\n\$\$.*?\$\$) *(\n\n)/g,"$1$2")}function Gye(t){return[Kye,Wr("kill-post-process-latex-double-dollar")?null:$ye].filter(n=>n!==null).reduce((n,r)=>r(n),t)}const k0="\\[",CP="\\]";function Kye(t){return t.includes(k0)?t.replaceAll(k0,`

${k0}`).replaceAll(CP,`${CP}

`):t}const Gp=new za({breaks:!0});Gp.use(Vye);Gp.inline.ruler.enable(["text","newline","emphasis","links","backticks","sup","sub","latex","del"],!0);Gp.block.ruler.enable(["list","paragraph","heading","hr","fences","table","blockquote","latex_block"],!0);Gp.core.ruler.enable(["block","inline","references"],!0);function qye(t){const[e="",...n]=t.replace(zp,"").split(ty);return{index:e,title:n.join(ty)}}function U9(t,e={}){const n=[];let r=null,o=!1,i=!1,s=!1;for(const a of t)switch(a.type){case"text":case"sup":case"sub":if("content"in a&&a.content){const l={},u=a.content.startsWith(zp)?{type:"citation",props:{index:"",title:"",url:"",iconUrl:null,publisher:null}}:{type:"text",props:{text:a.content}};if(u.type==="text"&&(r&&(u.props.link=r),o&&(l.bold=!0),i&&(l.italic=!0),s&&(l.strikethrough=!0),a.type==="text"&&(u.props.text=u.props.text.replaceAll("\\$","$")),a.type==="sup"&&(l.sup=!0),a.type==="sub"&&(l.sub=!0),Object.keys(l).length>0&&(u.props.annotations=l)),u.type==="citation"&&r){const{citations:h}=e,{index:f,title:p}=qye(a.content),g=h==null?void 0:h.find(v=>v.index===f);u.props={index:f,title:(g==null?void 0:g.title)??p,url:r.url,iconUrl:null,publisher:null}}n.push(u)}break;case"softbreak":case"hardbreak":n.push({type:"text",props:{text:`
`}});break;case"code":"content"in a&&n.push({type:"text",props:{text:a.content,annotations:{code:!0}}});break;case"latex":"content"in a&&n.push({type:"latex",props:{content:a.content}});break;case"strong_open":o=!0;break;case"strong_close":o=!1;break;case"em_open":i=!0;break;case"em_close":i=!1;break;case"del_open":s=!0;break;case"del_close":s=!1;break;case"link_open":r="href"in a?{url:da(a.href)}:null;break;case"link_close":r=null;break}return n}function Vm(t,e){return t!==void 0&&t.type==="inline"&&"children"in t?U9(Array.isArray(t.children)?t.children:[],e):null}function Wye(t,e){let n=0;function r(){var s;let i=t[n];if(!i)return null;if(i.type==="hr")return n+=1,i=t[n],{type:"hr"};if(i.type==="latex_block")return n+=1,"content"in i?{type:"latex",props:{content:{type:"text",props:{text:i.content}}}}:null;if(i.type==="paragraph_open"){n+=1,i=t[n],n+=1;const a=Vm(i,e);return a?{type:"paragraph",props:{items:a}}:null}if(i.type==="blockquote_open"){const a={type:"blockquote",props:{items:[]}};for(n+=1,i=t[n];(i==null?void 0:i.type)!=="blockquote_close";){const l=r();l&&"type"in l&&a.props.items.push(l),i=t[n]}return n+=1,a}if(i.type==="ordered_list_open"||i.type==="bullet_list_open"){const a={type:"list",props:{items:[],ordered:i.type==="ordered_list_open"}};"order"in i&&(a.props.start=i.order);const l=i.type==="ordered_list_open"?"ordered_list_close":"bullet_list_close";for(n+=1,i=t[n];(i==null?void 0:i.type)!==l;){const u=r(),h=[];if(u&&Array.isArray(u)){for(const f of u)(f.type==="paragraph"||f.type==="list"||f.type==="code"||f.type==="heading")&&h.push(f);a.props.items.push(h)}i=t[n]}return n+=1,a}if(i.type==="list_item_open"){const a=[];for(n+=1,i=t[n];(i==null?void 0:i.type)!=="list_item_close";){const l=r();if(l)for(const u of[l].flat())(u.type==="paragraph"||u.type==="list"||u.type==="code"||u.type==="heading")&&a.push(u);i=t[n]}return n+=1,a}if(i.type==="heading_open"){const a="hLevel"in i?i.hLevel:1;n+=1,i=t[n],n+=1;const l=Vm(i,e);return l?{type:"heading",props:{level:a,items:l}}:null}if(i.type==="fence"&&"content"in i){const a={type:"code",props:{content:{type:"text",props:{text:jpe(i.content)}},language:"params"in i?i.params:void 0}};return n+=1,a}if(i.type==="table_open"){const a=[],l=[];for(;(i==null?void 0:i.type)!=="table_close";){if((i==null?void 0:i.type)==="th_open"){n+=1,i=t[n];const u=Vm(i,e);u&&a.push(u)}if((i==null?void 0:i.type)==="tr_open"&&!i.lines&&l.push([]),(i==null?void 0:i.type)==="td_open"){n+=1,i=t[n];const u=Vm(i,e);u&&((s=l[l.length-1])==null||s.push(u))}n+=1,i=t[n]}return{type:"table",props:{columns:a,data:l}}}return i.type==="inline"&&"children"in i?(n+=1,U9(i.children??[])):(n+=1,null)}const o=[];for(;n<t.length;){const i=r();i&&!Array.isArray(i)&&o.push(i)}return o}function F9(t,e={}){const n=Gp.parse(Gye(t),{});return Wye(n,e)}const Yye={getValue:()=>0,queueUpdate:()=>{}};function Qye(){}function Jye(t){const{text:e}=t,n=F9(e),r=oy(n,Yye,Qye);return d.jsx(ry,{blocks:r,shouldAnimate:!1})}function Xye(t){const{artifact:e}=t;switch(e.type){case"code":{const{language:n,content:r}=e,o=`\`\`\`${n}
${r}
\`\`\``;return d.jsx(Jye,{text:o})}case"file":{const{contentType:n,name:r,url:o}=e;return d.jsx(Ige,{name:r,contentType:n,url:o})}default:return null}}function Zye(t){const{activities:e}=t;return d.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto",children:e.map((n,r)=>d.jsxs("div",{className:"flex flex-col gap-4 pt-3",children:[d.jsx("h3",{children:n.title}),n.artifacts.map((o,i)=>d.jsx(Xye,{artifact:o},i))]},r))})}const ebe=P(void 0);function tbe(){const[t,e]=Ze(ebe),n=!!t,r=()=>{e(void 0)};return!t||t.length===0?null:d.jsx(pi,{className:"w-full max-w-[606px] p-4 pb-6",isOpen:n,variant:"drawer",onClose:r,children:d.jsx(Zye,{activities:t})})}function B9(t){const{onClose:e,children:n,className:r}=t,o=m.useRef(null);return Na({onOutsideEvent:()=>{e()},elements:[o],invokeOnce:!1,includeScroll:!1,includeFocus:!1}),PE.createPortal(d.jsx(wn,{mode:"sync",className:Be("relative",jt.modal),children:d.jsx("div",{className:"fixed inset-0 flex items-end justify-center bg-black/20",children:d.jsxs("div",{className:"flex max-h-[90%] w-full shrink-0 flex-col rounded-t-4xl border border-white/100 bg-stone-150 backdrop-blur-xl dark:border-white/5 dark:bg-midnight-800",children:[d.jsx("div",{className:"relative flex w-full items-center justify-center py-3",children:d.jsx("div",{className:"h-[6px] w-12 rounded-full bg-black/25 dark:bg-white/25"})}),d.jsx("div",{className:Be("no-scrollbar w-full overflow-y-auto px-4 pb-4",r),ref:o,children:n})]})})}),document.body)}function Ol(t){const e=m.useRef(null),{isOpen:n,dialogName:r,headerText:o,fullBleed:i,children:s,onClose:a,className:l,bottomSheetClassName:u,closeButtonTestId:h,backdropOpacity:f="default",bottomSheetOnSmall:p}=t,g=m.useRef(null),{t:v}=xe(),y=ar({breakpoint:"sm"}),b=m.useId(),C=p&&y,S=f==="none"?"backdrop:bg-transparent":"backdrop:bg-stone-850/30 dark:backdrop:bg-midnight-850/70",I=n&&!C&&a!==void 0;Na({onOutsideEvent:I?a:()=>{},elements:I?[g]:[],includeScroll:!1,includeFocus:!1});const{modalAttributes:E}=ZM({trapFocus:!0,legacyTrapFocus:!0,alwaysFocusable:!0});if(m.useEffect(()=>{var T,w;n?(T=e.current)==null||T.showModal():(w=e.current)==null||w.close()},[n]),m.useEffect(()=>{const T=e.current;if(!T)return()=>{};const w=()=>{a==null||a()};return T.addEventListener("cancel",w),()=>{T.removeEventListener("cancel",w)}},[a]),C&&n){const T=!i&&o;return d.jsxs(B9,{onClose:a,className:u,children:[T&&d.jsx("h2",{id:b,className:"py-6 text-center text-foreground-850 text-xl",children:o}),s]})}return d.jsx(Ne.dialog,{className:Be("fixed inset-0 m-auto rounded-4xl border border-white/10 bg-background-150 text-foreground-800 shadow-xl dark:bg-background-250",S),animate:n?"animate":"initial",initial:"initial",exit:"exit",variants:{initial:ot,animate:Lt},transition:{duration:jo.default,ease:"easeInOut"},ref:e,role:"dialog","aria-modal":"true","aria-labelledby":o?b:void 0,"aria-label":o?void 0:r,...n?E:{},children:n&&d.jsxs("div",{"data-modal-overlay":"true",className:Be("flex min-h-[150px] flex-col gap-3",!i&&"p-6",l),ref:g,children:[!i&&d.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o&&d.jsx("h2",{id:b,className:"text-foreground-800 text-md-strong",children:o}),a&&d.jsx(Te,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:v("common.closeText"),"aria-label":v("common.closeText"),onClick:a,testId:h,children:d.jsx(Mr,{className:"size-5"})})]}),s]})})}const nbe="XF86Back",HPe="XF86BTVoice",rbe=461;function obe(t){return t.key===nbe||t.keyCode===rbe}function ibe(t){const{className:e,children:n}=t;return d.jsx("span",{className:Y("inline-block h-4 min-w-4 rounded-md bg-accent-200 px-1 pt-px text-center leading-4 text-foreground-800 text-3xs dark:bg-accent-200",e),children:n})}const sbe={default:"border-black/10 dark:border-white/10",accent:"border-stroke-300"};function dA(t){const{horizontalMargin:e=!0,verticalMargin:n=!0,color:r="default",className:o}=t;return d.jsx("div",{className:Y("border-t-[1px]",e&&"mx-2",n&&"my-2",sbe[r],o)})}const abe=m.lazy(()=>H(()=>import("./index-YnDusNz7.js").then(t=>t.i),__vite__mapDeps([231,2,232,1]))),cbe="focus-within:bg-neutral-50/5 before:pointer-events-none before:absolute before:inset-0 before:rounded-3xl before:border before:border-transparent focus-within:before:border-[1px] focus-within:before:border-[rgba(255,255,255,0.1)]";function lbe(){var h,f;const t=x(rX),[e,n]=Ze(w5),r=m.useContext($p),o=x(it),i=OE(),s=((h=me.instance().config().composer)==null?void 0:h.largeScreen)===!0&&((f=me.instance().config().composer)==null?void 0:f.voiceOnly)===!0,a=()=>{n(null),nt({source:"citationOverflowModal",scenario:"close"})},{focusable:l}=kd({isFocusBoundary:!0});Rl(p=>{obe(p)&&(p.stopPropagation(),a())});const u=m.useMemo(()=>new Map((e??[]).map((p,g)=>[g,m.createRef()])),[e]);return d.jsx(Ol,{isOpen:t,onClose:s?void 0:a,headerText:`${e==null?void 0:e.length} ${ee("chat.references")}`,className:Y(s?"max-h-[40vh]":"max-h-[80vh]",s?"w-[480px]":"w-[440px]","mx-4 px-2"),children:d.jsx(BE.Provider,{value:l.focusKey??"",children:d.jsx("div",{className:Y("flex flex-col gap-2 overflow-y-auto",s?"no-scrollbar":"t-custom-scrollbar"),children:e==null?void 0:e.map((p,g)=>d.jsx(H9,{ref:u.get(g),index:g,citation:p,currentConversationId:o,messageId:r,isLargeScreenVoiceComposer:s,citationsModalData:e,rel:i},g))})})})}const H9=m.forwardRef(({index:t,citation:e,currentConversationId:n,messageId:r,citationsModalData:o,isLargeScreenVoiceComposer:i=!1,rel:s},a)=>{const{title:l,url:u,publisher:h}=e,{refCallback:f,focusable:p}=kd({autoRestoreFocus:!0,forceFocus:!0,scrollIntoViewOnFocus:!0},a);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:Y(i&&cbe,"group relative flex flex-row items-center gap-2 rounded-3xl p-2"),children:[d.jsxs("a",{rel:s,ref:f,className:"flex flex-1 flex-col items-start gap-2 py-1","data-spatial-navigation-autofocus":!0,href:u,"data-spatial-focus-key":p.focusKey,target:"_blank",onClick:g=>{if(i){g.preventDefault();return}nt({source:"citationModalLink",customData:JSON.stringify({destination:od(u),conversationId:n,messageId:r})})},children:[d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(ibe,{children:e.index}),d.jsx("div",{className:"text-foreground-550 text-xs",children:h??rd(u)})]}),d.jsx("div",{children:l}),d.jsx("div",{className:"text-foreground-550 text-xs",children:rd(u)})]}),i&&d.jsx(m.Suspense,{fallback:d.jsx("span",{}),children:d.jsx("div",{className:"flex size-28 items-center justify-center rounded-2xl bg-white opacity-0 group-focus-within:opacity-100",children:d.jsx(abe,{value:u,size:86})})})]}),t<o.length-1&&d.jsx(dA,{horizontalMargin:!1,verticalMargin:!1,className:"my-4"})]})});H9.displayName="CitationItem";const ube=m.lazy(()=>H(()=>Promise.resolve().then(()=>nA),void 0));async function dbe(t){await Ur({path:t,args:{options:{method:"DELETE"}}})}function hbe(){const{t}=xe(),e=ve(_5),{trigger:n,isMutating:r}=tT("/conversations/history",dbe),o=async()=>{await n(),e(null)},i=()=>{e(null)};return d.jsxs(Ol,{isOpen:!0,onClose:i,headerText:t("settings.clearHistory.header"),className:"min-h-[328px] w-full max-w-[400px]",children:[d.jsx("p",{className:"text-start",children:t("settings.clearHistory.description")}),d.jsx(Te,{title:t("settings.clearHistory.confirm"),color:"default",size:"56-xl",variant:"rect",className:"mt-3 w-full text-system-red-550 dark:text-system-red-350",onClick:o,disabled:r,children:r?d.jsx(ube,{type:"spinnerThemed",className:"size-6"}):t("settings.clearHistory.confirm")}),d.jsx(Te,{title:t("common.cancel"),color:"strong",size:"56-xl",variant:"rect",className:"mt-3 w-full",onClick:i,children:t("common.cancel")})]})}const z9=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M17.7545 14.0002C18.9966 14.0002 20.0034 15.007 20.0034 16.2491V16.8245C20.0034 17.7188 19.6838 18.5836 19.1023 19.263C17.5329 21.0965 15.1457 22.0013 12.0004 22.0013C8.8545 22.0013 6.46849 21.0962 4.90219 19.2619C4.32242 18.583 4.00391 17.7195 4.00391 16.8267V16.2491C4.00391 15.007 5.01076 14.0002 6.25278 14.0002H17.7545ZM17.7545 15.5002H6.25278C5.83919 15.5002 5.50391 15.8355 5.50391 16.2491V16.8267C5.50391 17.3624 5.69502 17.8805 6.04287 18.2878C7.29618 19.7555 9.26206 20.5013 12.0004 20.5013C14.7387 20.5013 16.7063 19.7555 17.9627 18.2876C18.3117 17.8799 18.5034 17.361 18.5034 16.8245V16.2491C18.5034 15.8355 18.1681 15.5002 17.7545 15.5002ZM12.0004 2.00488C14.7618 2.00488 17.0004 4.24346 17.0004 7.00488C17.0004 9.76631 14.7618 12.0049 12.0004 12.0049C9.23894 12.0049 7.00036 9.76631 7.00036 7.00488C7.00036 4.24346 9.23894 2.00488 12.0004 2.00488ZM12.0004 3.50488C10.0674 3.50488 8.50036 5.07189 8.50036 7.00488C8.50036 8.93788 10.0674 10.5049 12.0004 10.5049C13.9334 10.5049 15.5004 8.93788 15.5004 7.00488C15.5004 5.07189 13.9334 3.50488 12.0004 3.50488Z"})),zPe=Object.freeze(Object.defineProperty({__proto__:null,default:z9},Symbol.toStringTag,{value:"Module"})),x0="relative size-full rounded-full aspect-square",SP="flex items-center justify-center uppercase",R0="after:absolute after:-inset-px after:rounded-full after:border-[0.5px] after:border-black/10 dark:after:border-white/20";function fbe(t){const{firstName:e,imgSrc:n,nameSizeClass:r,altText:o}=t;return n?d.jsx("img",{className:Y("overflow-hidden object-cover",x0,R0),src:n,alt:o??ee("common.profileImage")}):e?d.jsx("div",{className:Y(x0,SP,R0,r??"text-md"),children:d.jsx("div",{children:e[0]})}):d.jsx("div",{className:Y(x0,SP,R0),children:d.jsx(z9,{className:"size-6 fill-foreground-800","alt-text":o??ee("common.profileImage")})})}const IP=5e3;function pbe(){const t=se("aad-student"),e=x(HX),{t:n}=xe(),[r,o]=m.useState(!1),i=t&&e&&!r,s=x(RD),a=x(ml),l=t&&e===void 0&&s&&a,u=l&&!r;m.useEffect(()=>{if(l&&!r){const C=setTimeout(()=>{o(!0),Ree(new Error(`Student status check timed out after ${IP}ms`))},IP);return()=>clearTimeout(C)}},[l,r]);const h=n(i?"entraRedirect.guestTitle":"entraRedirect.workTitle"),f=n(i?"entraRedirect.guestDescription":"entraRedirect.workDescription");return{isStudentEnabled:i,isLoadingEnabled:u,workTitle:h,workDescription:f,titleGapClass:i?"mb-6 sm:mb-10":"mb-8 sm:mb-14",eventInfoScenario:i?"Student":"Enterprise",getPageTitle:()=>n(i?"aadStudent.title":"entraRedirect.pageTitle"),getPageSubTitle:C=>i?n("aadStudent.subtitle",{email:C}):void 0,getWorkButtonText:C=>i?n("aadStudent.continueAsGuestButtonText"):n("entraRedirect.goToWorkButton",{redirectUrl:C})}}function mbe(){var re;const t=x(RD),e=x(ml),n=x(br),[r,o]=m.useState(void 0),i=se("aad-login-removal"),s=rl(),a=gi(),{isStudentEnabled:l,isLoadingEnabled:u,workTitle:h,workDescription:f,titleGapClass:p,eventInfoScenario:g,getPageTitle:v,getPageSubTitle:y,getWorkButtonText:b}=pbe(),C=!l&&(n==null?void 0:n.email);m.useEffect(()=>{t&&cr(jg,JSON.stringify(t))},[t]);let S=!1;try{S=JSON.parse(yn(jg)??"false")}catch(J){console.error("Failed to parse authentication status:",J),S=!1}const I=t?e:!S&&!!((re=window.cwcRedirect)!=null&&re.cwcRedirectUrl),[E,T]=m.useState(I),[w,A]=m.useState(),{t:_}=xe(),{login:L,logout:N}=Wd();m.useEffect(()=>{async function J(){const ne=await lN();o(ne),C&&i&&Gue()}J()},[C,i]);const K=(J,ne,X)=>da(`${J}?fromCode=cmcv2&redirectId=${ne}${X?`&login_hint=${X}`:""}`),q=async()=>{let J=crypto.randomUUID().replace(/-/g,"").toUpperCase(),ne=xC,X="AadUnknown";e&&r?ne=K(xC,J,r.username):window.cwcRedirect&&(ne=window.cwcRedirect.cwcRedirectUrl,J=window.cwcRedirect.redirectId,X=window.cwcRedirect.chatEligibility),me.instance().config().entraRedirectModalBehaviour==="new-tab"?wl(da(ne)):Lp(da(ne)),U.trackEvent({name:"interaction",data:{eventName:"copilotEnterpriseRedirect",...w,eventInfo_traceId:J,eventInfo_redirectUrl:ne,eventInfo_chatEligibility:X}})},ae=async()=>{U.trackEvent({name:"interaction",data:{eventName:"copilotStudentRedirectSignOut",...w}}),await N()},O=async()=>{U.trackEvent({name:"interaction",data:{eventName:"copilotEnterpriseRedirectSwitchAccount",eventInfo_scenario:g,...w}}),T(!1),s?(await N(!1),await a({from:"/",to:"/login"})):await L({provider:"microsoft"})},W=async()=>{U.trackEvent({name:"interaction",data:{eventName:t?"copilotEnterpriseRedirectSignOut":"copilotEnterpriseRedirectContinueSignedOut",...w}}),t?await N():T(!1)};if(m.useEffect(()=>{T(I),I&&(async()=>{var X;let ne={};if(e){const Ie=await lN();ne={userAadId:(X=Ie==null?void 0:Ie.idTokenClaims)==null?void 0:X.oid,userAadTenantId:Ie==null?void 0:Ie.tenantId}}else window.cwcRedirect&&(ne={userAadId:window.cwcRedirect.userId,userAadTenantId:window.cwcRedirect.tenantId});U.trackEvent({name:"system",data:{eventName:"copilotEnterpriseRedirectImpression",eventInfo_redirectReason:e?"AAD":"CWC",eventInfo_scenario:g,...ne}}),A(ne)})().catch(console.error)},[e,I,g]),!E)return null;const te=!S&&window.cwcRedirect?new URL(window.cwcRedirect.cwcRedirectUrl).hostname:xC,D=y(n==null?void 0:n.email),G=()=>l?null:i?d.jsx("div",{className:"mt-8 sm:mt-12",children:d.jsx(co,{i18nKey:"entraRedirect.playAroundFirst",components:{entraContinue:d.jsx("button",{type:"button",className:"underline",onClick:W,children:_("entraRedirect.playAroundFirst")})}})}):d.jsx("div",{className:"mt-8 sm:mt-12",children:d.jsx(co,{i18nKey:t?"entraRedirect.signOut":"entraRedirect.continueSignedOut",components:{[t?"entraSignOut":"entraContinue"]:d.jsx("button",{type:"button",className:"underline",onClick:W,children:_(t?"entraRedirect.signOut":"entraRedirect.continueSignedOut")})}})});return d.jsxs(wn,{id:String(E),duration:0,mode:"sync",className:Y("fixed inset-0",jt.modal),children:[d.jsx(Tl,{forceGradient:!0}),d.jsx("main",{className:"relative m-auto flex size-full max-w-chat flex-col items-center justify-center overflow-y-auto p-4 pb-8 pt-20 sm:py-4",children:u?d.jsx(_t,{className:"size-8"}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-9",children:d.jsx(Fp,{className:"size-12"})}),d.jsx("h1",{className:Y("mb-8 w-full whitespace-pre-wrap break-words px-4 text-center text-3xl sm:mb-14",p),children:v()}),l&&D&&d.jsx("p",{className:"mb-10 w-full whitespace-pre-wrap break-words px-4 text-center text-base sm:mb-16",children:D}),d.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 md:gap-16",children:[d.jsx(EP,{title:h,description:f,onClick:l?ae:q,children:d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{children:b(te)}),C&&d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("div",{className:"relative size-5",children:d.jsx(fbe,{firstName:n.firstName??n.givenName??void 0,imgSrc:n.imgSrc,nameSizeClass:"text-xs"})}),d.jsx("p",{className:"text-xs",children:n.email})]})]})}),d.jsx(EP,{title:_("entraRedirect.personalTitle"),description:_("entraRedirect.personalDescription"),onClick:O,children:d.jsx("p",{className:"text-xs",children:_("entraRedirect.switchToPersonalButton")})})]}),G()]})})]})}function EP({title:t,onClick:e,description:n,children:r}){return d.jsxs("div",{className:"flex flex-col justify-between rounded-4xl bg-white/70 p-4 dark:bg-midnight-700/70 md:p-6 md:pb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"mb-2.5 text-lg",children:t}),d.jsx("p",{className:"mb-6 text-sm",children:n})]}),d.jsx(Te,{color:"default",variant:"rect",title:t,onClick:e,children:r})]})}function qb(t,e=!0,n=!1){m.useEffect(()=>{var r;e&&((r=t.current)==null||r.focus({preventScroll:n}))},[t,e,n])}const gbe=m.lazy(()=>H(()=>import("./index-YnDusNz7.js").then(t=>t.i),__vite__mapDeps([231,2,232,1])));function vbe(t){const{onClose:e,interceptedLink:n}=t,{t:r}=xe(),o=m.useRef(null);return qb(o),Rl(i=>{(i.key==="Escape"||i.key==="Control")&&e()}),d.jsxs("div",{className:"flex w-[400px] max-w-[80vw] flex-col items-center p-4 text-center",children:[d.jsx("div",{className:"bg-white p-2",children:d.jsx(m.Suspense,{fallback:d.jsx("span",{}),children:d.jsx(gbe,{value:n,size:96,"aria-label":r("composer.interceptedLink.qrcode_alt_text")})})}),d.jsx("h1",{className:"py-3 text-lg",children:r("composer.interceptedLink.title")}),d.jsx("p",{className:"w-full pb-7",children:d.jsx(co,{i18nKey:"composer.interceptedLink.description",components:{span:d.jsx("span",{className:"break-words underline"})},values:{link:n}})}),d.jsx(Te,{ref:o,onClick:e,title:"close",variant:"pill",size:"48-lg",className:"w-full",children:r("common.closeText")})]})}function Wb(){return x(Cr)==="US"&&me.instance().config().proSubscription.enabled}function ybe(t){const{t:e}=xe(),{config:n,onClose:r}=t,o=x(Q5),i=x(Sn),s=Wb(),a=n.source==="apple"?fX:pX,l=e("subscriptionManage.redirectMobileStoreTitle",{store:a}),u=e("subscriptionManage.redirectMobileStoreContent",{store:a});return m.useEffect(()=>{U.trackEvent({name:"interaction",data:{eventName:"payflowBlockDialogShown",eventInfo_upsellEntryStyle:n.entryStyle,eventInfo_payflowEntryPoint:n.payflowEntryPoint,eventInfo_upsellReason:n.upsellReason,eventInfo_loginProvider:(i==null?void 0:i.accountType)??"None",eventInfo_payflowType:s?"ProSubPaywall":"UniPux",eventInfo_curatedSubscription:(o==null?void 0:o.tier)??"None",eventInfo_disabledReason:"3pPurchase"}})},[n,o==null?void 0:o.tier,s,i==null?void 0:i.accountType]),d.jsx("div",{className:Be("fixed inset-0 h-screen w-screen",jt.modal),"data-outside-events-ignore":!0,onClick:r,children:d.jsx(pi,{isOpen:!0,className:"h-auto max-w-md !gap-0 rounded-[60px] !p-0",disableCloseOutside:!0,children:d.jsxs("div",{className:"flex w-full flex-col p-8",children:[d.jsx("h1",{className:"mt-4 w-full items-center text-center text-xl",children:l}),d.jsx("p",{className:"mt-6 w-full",children:u}),d.jsx(Te,{className:"mt-6 w-full rounded-4xl",color:"strong",title:e("subscriptionManage.upgradeButton"),onClick:r,children:e("subscriptionManage.redirectMobileStoreDismiss")})]})})})}function bbe(){const{t}=xe(),e=x(eo),n=x(HU),r=x(Vy),[o,i]=Ze(Afe),[s,a]=m.useState(!1),l=m.useCallback(()=>{i(!1)},[i]),u=m.useCallback(async()=>{!n||!e||(a(!0),Vg.includes(n.status)||(await ts()).stop({conversationId:e.id,taskId:n.id}))},[e,n]);m.useEffect(()=>{n!=null&&n.status&&Vg.includes(n.status)&&(i(!1),a(!1))},[n==null?void 0:n.status,i]);const h=r!==null?t("research.cancel.limitAnnouncement",{limit:r+1}):"";return d.jsxs(pi,{isOpen:o,headerText:t("research.cancel.title"),className:"max-w-96 gap-4",children:[`${t("research.cancel.description")}${` ${h}`}`,d.jsx(Te,{title:t("research.cancel.cancelButton"),onClick:u,className:"mt-auto text-system-red-550 dark:text-system-red-350",color:"default",size:"56-xl",disabled:s,children:s?d.jsx(_t,{className:"size-8"}):t("research.cancel.cancelButton")}),d.jsx(Te,{title:t("common.keep"),color:"strong",size:"56-xl",onClick:l,children:t("common.keep")})]})}const V9=70;function Cbe(t){var e;return(e=t.contents)!=null&&e.length?t.finalResponse?"done":t.partialOutput&&t.partialOutput.length>0?"writing":"browsing":"planning"}const hA=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M4.5 10a5.5 5.5 0 1 1 11 0 5.5 5.5 0 0 1-11 0ZM10 3a7 7 0 1 0 4.391 12.452l5.329 5.328a.75.75 0 1 0 1.06-1.06l-5.328-5.329A7 7 0 0 0 10 3Z"})),VPe=Object.freeze(Object.defineProperty({__proto__:null,default:hA},Symbol.toStringTag,{value:"Module"}));function Sbe(t){const{text:e,isInDrawer:n=!1,isPreview:r}=t,{t:o}=xe(),i=r?_9(e,V9,{ellipsis:!0}):e;return n?d.jsxs("div",{children:[d.jsx("strong",{className:"me-2",children:o("research.searched")}),d.jsx("span",{className:"text-foreground-800",children:i})]}):d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-foreground-700",children:o("research.searched")}),d.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-black/[0.06] px-2 py-1 text-foreground-450",children:[d.jsx(hA,{className:"size-4"}),d.jsx("span",{className:"text-foreground-800 text-xs",children:e})]})]})}function Ibe(t){let{url:e}=t;e=od(e);const{title:n,decoration:r,source:o,iconUrl:i,mode:s,onClick:a}=t,l=m.useContext($p),u=x(it),h=()=>{a&&a(t),gn({source:o,conversationId:u,messageId:l,destination:e})};return d.jsxs(Te,{onClick:h,color:"default",variant:"pill",size:"28-xxs",title:n,href:e,children:[r,i&&d.jsx("img",{src:i,alt:n,className:"size-4 rounded-md border-[0.5px] border-neutral-300 bg-white/90 dark:border-neutral-600"}),d.jsx("span",{className:"me-0.5",children:s==="research"?rd(e):n})]})}function Ebe(t){const{url:e,isInDrawer:n=!1,isPreview:r=!1}=t,{t:o}=xe();return d.jsxs("div",{className:"flex items-center gap-2",children:[n?d.jsx("strong",{children:o("research.read")}):d.jsx("span",{className:"text-foreground-700",children:o("research.read")}),r?d.jsx("span",{className:"text-foreground-800",children:rd(e)}):d.jsx(Ibe,{title:rd(e),url:e,source:"researchCitationLink"})]})}function TP(t){let e=0;for(const n of t)e+=n;return e}function Tbe(t,e,n){let r=0,o=null,i=[],s=0;return{getValue:()=>{if(!n)return 0;if(!o){o=Math.floor(performance.now());const l=t[t.length-1];if(!l)s=0;else{const u=l+TP(i)*1e3;u>o?(s=(u-o)/1e3,i=[]):(s=0,i=[])}}const a=t[r];return a?(r+=1,i=[],Math.max((a-o)/1e3,0)):(s=Number((s+TP(i)).toFixed(3)),i=[],e(r,o,s),r+=1,s)},queueUpdate:a=>{i.push(a)}}}function wbe(t){const e=m.useRef([]);return m.useCallback(()=>Tbe(e.current,(n,r,o)=>{e.current[n]=r+o*1e3},t),[t])}function _be(t){const{text:e,shouldAnimate:n,isPreview:r}=t,o=wbe(!1),[i,s]=m.useState(0),a=m.useMemo(()=>{const l=o(),u=r?_9(e,V9,{ellipsis:!0}):e,h=F9(u);return oy(h,l,()=>{s(i+1)})},[o,i,r,e]);return d.jsx("div",{className:"flex items-center gap-2 text-foreground-700",children:d.jsx(ry,{blocks:a,shouldAnimate:n})})}function Abe(t){const{item:e,shouldAnimate:n=!1,isPreview:r=!1,isInDrawer:o=!1}=t;switch(e.type){case"citation":return d.jsx(Ebe,{url:e.url,isInDrawer:o,isPreview:r});case"chainOfThought":return d.jsx(_be,{text:e.text,shouldAnimate:n,isPreview:r});case"query":return d.jsx(Sbe,{text:e.text,isInDrawer:o,isPreview:r});default:return null}}function kbe(t){const{progress:e}=t,{t:n}=xe(),r=(()=>{switch(e){case"planning":return n("research.steps.browse.future");case"writing":return n("research.steps.write.present");case"done":return n("research.stepsDrawer.reportReady");default:return""}})();return d.jsx("div",{children:d.jsx("strong",{children:r})})}function $m(t){const{progress:e,contentItem:n,shouldAnimate:r,isPreview:o=!1}=t;return e!=="browsing"?d.jsx(kbe,{progress:e}):n?d.jsx(Abe,{item:n,shouldAnimate:r,isPreview:o,isInDrawer:!0}):null}const $9=t=>m.createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M12.0001 1.07191C13.2068 1.7686 14.2105 2.76833 14.912 3.97215C15.6135 5.17597 15.9885 6.54213 15.9997 7.93538C16.011 9.32864 15.6582 10.7007 14.9762 11.9157C14.2942 13.1307 13.3068 14.1465 12.1115 14.8626C10.9163 15.5787 9.55481 15.9702 8.16178 15.9984C6.76875 16.0266 5.39251 15.6904 4.16929 15.0233C2.94608 14.3562 1.91832 13.3811 1.18775 12.1947C0.457175 11.0083 0.049128 9.65168 0.00400014 8.25911L0 7.99991L0.00400014 7.74071C0.0488032 6.35911 0.450844 5.01268 1.17093 3.83271C1.89101 2.65273 2.90456 1.67948 4.11276 1.00782C5.32097 0.336164 6.6826 -0.0109686 8.0649 0.000264197C9.44721 0.011497 10.803 0.380712 12.0001 1.07191ZM10.9657 5.83431C10.828 5.69657 10.6447 5.61383 10.4503 5.6016C10.2559 5.58938 10.0636 5.64851 9.90972 5.76791L9.83452 5.83431L7.20009 8.46791L6.16568 7.43431L6.09048 7.36791C5.93654 7.2486 5.74437 7.18953 5.54999 7.2018C5.35562 7.21406 5.17239 7.29681 5.03467 7.43452C4.89695 7.57224 4.81421 7.75546 4.80194 7.94984C4.78968 8.14421 4.84874 8.33638 4.96806 8.49031L5.03446 8.56551L6.63448 10.1655L6.70968 10.2319C6.84998 10.3408 7.02251 10.3998 7.20009 10.3998C7.37767 10.3998 7.55019 10.3408 7.69049 10.2319L7.7657 10.1655L10.9657 6.96551L11.0321 6.89031C11.1515 6.73639 11.2107 6.54419 11.1984 6.34977C11.1862 6.15535 11.1035 5.97207 10.9657 5.83431Z",fill:"currentColor"})),$Pe=Object.freeze(Object.defineProperty({__proto__:null,default:$9},Symbol.toStringTag,{value:"Module"}));function Gm(t){const{isFinal:e=!1,isLast:n=!1,shouldAnimate:r=!1,children:o}=t;let i=null;return e?i=d.jsx($9,{className:"relative bottom-1 size-4 text-background-900"}):n?i=d.jsx(_t,{className:"relative bottom-1 size-4"}):i=d.jsx("div",{className:"size-2 rounded-full bg-foreground-800"}),d.jsxs(Ne.div,{className:"relative grid grid-cols-[auto,1fr] items-start gap-4",initial:r?"start":"end",animate:"end",variants:{start:ot,end:s=>({...Lt,transition:{delay:s,ease:"easeInOut",duration:1.2}})},children:[d.jsxs("div",{className:"relative mt-2 flex h-full w-2 flex-col items-center",children:[i,!e&&!n&&d.jsx("div",{className:"absolute bottom-0 top-4 w-0.5 bg-neutral-300"})]}),o]})}function xbe(t){var a,l;const{task:e,onGoToReport:n}=t,{t:r}=xe(),o=m.useRef(null);m.useEffect(()=>{o.current&&o.current.scrollTo({top:o.current.scrollHeight,behavior:"smooth"})},[e]);const i=Cbe(e),s=((a=e.contents)==null?void 0:a.length)??0;return d.jsxs("div",{className:"flex h-full flex-col overflow-y-auto",children:[d.jsxs("div",{ref:o,className:"vertical-scrollbar t-bottom-fade relative h-bottom-fade space-y-4 overflow-y-auto scroll-smooth p-2 pb-12 pt-bottom-fade [scrollbar-gutter:stable_both-edges;]",children:[d.jsx(Gm,{isLast:i==="planning",shouldAnimate:i==="planning",children:d.jsx($m,{progress:"planning"})}),(l=e.contents)==null?void 0:l.map((u,h)=>{const f=i==="browsing"&&h===s-1;return d.jsx(Gm,{isLast:f,shouldAnimate:i!=="done"&&f,children:d.jsx($m,{progress:"browsing",contentItem:u})},h)}),(i==="writing"||i==="done")&&d.jsx(Gm,{isLast:i==="writing",shouldAnimate:i==="writing",children:d.jsx($m,{progress:"writing"})}),i==="done"&&d.jsx(Gm,{isFinal:!0,shouldAnimate:!0,children:d.jsx($m,{progress:"done"})})]}),i==="done"&&d.jsx(Te,{title:r("research.stepsDrawer.goToReport"),onClick:n,color:"strong",variant:"pill",size:"40-base",className:"mx-4 mt-8",children:r("research.stepsDrawer.goToReport")})]})}function Rbe(){const{t}=xe(),e=x(HU),[n,r]=Ze(_fe),o=()=>{r(!1)},i=()=>{o()};return d.jsx(pi,{isOpen:n,onClose:o,headerText:t("research.stepsDrawer.title"),className:"max-w-full p-4",headerClassName:"pb-12",headerTextClassName:"relative top-12 start-4",variant:"drawer",children:e&&d.jsx(xbe,{task:e,onGoToReport:i})})}function Nbe(){var t=new Map;function e(n){var r=n.root,o=n.rootMargin,i=n.threshold,s=t.get(r);s||(s=new Map,t.set(r,s));var a=JSON.stringify({rootMargin:o,threshold:i}),l=s.get(a);if(!l){var u=new Map,h=new IntersectionObserver(function(f){f.forEach(function(p){var g=u.get(p.target);g==null||g(p)})},{root:r,rootMargin:o,threshold:i});l={observer:h,entryCallbacks:u},s.set(a,l)}return{observe:function(p,g){var v,y;(v=l)==null||v.entryCallbacks.set(p,g),(y=l)==null||y.observer.observe(p)},unobserve:function(p){var g,v;(g=l)==null||g.entryCallbacks.delete(p),(v=l)==null||v.observer.unobserve(p)}}}return{getObserver:e}}var Pbe="0px",Mbe=[0],Obe=Nbe();function Lbe(t){var e,n,r=(e=t==null?void 0:t.rootMargin)!=null?e:Pbe,o=(n=t==null?void 0:t.threshold)!=null?n:Mbe,i=m.useRef(null),s=m.useRef(null),a=m.useRef(null),l=m.useState(),u=l[0],h=l[1],f=m.useCallback(function(){var y=i.current;if(!y){h(void 0);return}var b=Obe.getObserver({root:s.current,rootMargin:r,threshold:o});b.observe(y,function(C){h(C)}),a.current=b},[r,o]),p=m.useCallback(function(){var y=a.current,b=i.current;b&&(y==null||y.unobserve(b)),a.current=null},[]),g=m.useCallback(function(y){p(),i.current=y,f()},[f,p]),v=m.useCallback(function(y){p(),s.current=y,f()},[f,p]);return[g,{entry:u,rootRef:v}]}function tE(){return tE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tE.apply(this,arguments)}function Dbe(t){var e,n=Lbe(t),r=n[0],o=n[1],i=!!((e=o.entry)!=null&&e.isIntersecting),s=m.useState(i),a=s[0],l=s[1];return i&&!a&&l(!0),[r,tE({},o,{isVisible:i,wasEverVisible:a})]}var jbe=100;function Ube(t){var e=t.loading,n=t.hasNextPage,r=t.onLoadMore,o=t.rootMargin,i=t.disabled,s=t.delayInMs,a=s===void 0?jbe:s,l=Dbe({rootMargin:o}),u=l[0],h=l[1],f=h.rootRef,p=h.isVisible,g=!i&&!e&&p&&n;return m.useEffect(function(){if(g){var v=setTimeout(function(){r()},a);return function(){clearTimeout(v)}}},[r,g,a]),[u,{rootRef:f}]}function Fbe(){return se("share-to-social-media")}const wP={translateY:"100%"},Bbe={translateY:0};function Hbe(t){const{children:e,id:n,onClose:r,className:o}=t,i=m.useRef(null);return Rl(s=>{const{current:a}=i;!a||!a.contains(document.activeElement)||s.key==="Escape"&&r()}),d.jsxs(d.Fragment,{children:[d.jsx(Ne.div,{initial:ot,animate:Lt,exit:ot,transition:qI,className:"fixed inset-0 bg-black/50"}),d.jsx(Ne.div,{id:n,initial:wP,animate:Bbe,exit:wP,transition:qI,className:Y("absolute bottom-0 max-h-expanded-section w-full overflow-y-hidden rounded-4xl",jt.modal,o),ref:i,children:d.jsx("div",{className:"flex h-full flex-col items-start gap-4 overflow-y-auto bg-background-100 p-6",children:e})})]})}function zbe(t){var a;const{children:e,id:n,onClose:r,className:o}=t,i=vi(),s=(a=me.instance().config().uiOverrides)==null?void 0:a.disableConversationsModalWrapper;return i||s?d.jsx("div",{className:"flex max-w-96 flex-col items-start gap-4 p-2",children:e}):d.jsx(Hbe,{id:n,onClose:r,className:o,children:e})}function Vbe(){const[t,e]=m.useState(!1),n=gp(bn),r=Qd(),o=m.useCallback(async i=>{if(!i)return;const s=VU(i);gn({source:"deleteConversation",conversationId:i,scenario:s?"actions":void 0}),e(!0),s?await xa(`/tasks/${s}`,{options:{method:"DELETE"},analytics:{anonymousPath:"/tasks/*"}}):await xa(`/conversations/${i}`,{options:{method:"DELETE"},analytics:{anonymousPath:"/conversations/*"}}),Ue(it)===i&&await r({shouldNavigateToChat:!1}),e(!1),n(a=>{a.delete(i)})},[n,r]);return{loading:t,deleteConversation:o}}const fA=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"currentColor",d:"M 20.292969 5.2929688 L 9 16.585938 L 4.7070312 12.292969 L 3.2929688 13.707031 L 9 19.414062 L 21.707031 6.7070312 L 20.292969 5.2929688 z"})),GPe=Object.freeze(Object.defineProperty({__proto__:null,default:fA},Symbol.toStringTag,{value:"Module"}));function G9(t){const{disabled:e,checked:n,label:r,className:o,labelClassName:i,setChecked:s,"aria-label":a}=t,l=m.useId();return d.jsxs("label",{"aria-label":a,className:Y("relative flex cursor-pointer items-center",o),htmlFor:l,children:[d.jsx("input",{checked:n,type:"checkbox",id:l,className:"peer sr-only",onChange:u=>s(u.target.checked),disabled:e}),d.jsx("span",{className:Y("flex aspect-square size-5 items-center justify-center rounded-full border transition-colors duration-200 peer-focus:ring-1 peer-focus:ring-black peer-focus:ring-offset-2 peer-disabled:pointer-events-none peer-disabled:opacity-40 dark:peer-focus:ring-white","contrast-more:peer-focus:outline contrast-more:peer-focus:outline-2 contrast-more:peer-focus:outline-offset-2",n&&"bg-black contrast-more:bg-white dark:bg-white"),children:d.jsx(fA,{className:Y("size-3 text-white transition-opacity duration-200 contrast-more:text-current dark:text-black contrast-more:dark:text-current",n?"opacity-100":"opacity-0")})}),d.jsx("span",{className:Y("mt-px ps-4 peer-disabled:pointer-events-none peer-disabled:opacity-40",i),children:r})]})}function $be(t){var v;const{conversationId:e,onClose:n}=t,r=m.useId(),{t:o}=xe(),[i,s]=m.useState(!1),{loading:a,deleteConversation:l}=Vbe(),u=()=>{i&&cr(pG,"true"),n()},h=async()=>{await l(e),u(),wt.emit("composer:focus-input")},f=vi(),g=!((v=me.instance().config().uiOverrides)==null?void 0:v.disableDeleteConfirmationCheckbox)&&!f;return d.jsxs(zbe,{id:r,onClose:n,className:"h-96",children:[d.jsx("h2",{className:"text-lg",children:o("composer.deleteConversation.header")}),d.jsx("p",{children:o("composer.deleteConversation.description")}),g&&d.jsx(G9,{disabled:a,checked:i,label:o("composer.deleteConversation.dontRemindMeCheck"),setChecked:s,className:"flex-1"}),d.jsx(Te,{title:o("common.delete"),color:"default",size:"56-xl",variant:"rect",className:"mt-auto w-full text-system-red-550 dark:text-system-red-350",disabled:a,onClick:h,children:a?d.jsx(_t,{className:"size-8"}):o("common.delete")}),d.jsx(Te,{title:o("common.keep"),color:"strong",size:"56-xl",variant:"rect",className:"w-full",disabled:a,onClick:u,children:o("common.keep")})]})}const Gbe=P(void 0);async function _P(t){try{return await navigator.clipboard.writeText(t),!0}catch(e){return U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CopyError",eventInfo_details:"Error copying shared conversation url.",eventInfo_errorMessage:e instanceof Error?e.message:""}}),!1}}function Kbe({url:t,disableAutoCopy:e=!1,buttonColor:n="strong",onCopyClick:r}){const{t:o}=xe(),i=o("share.copied"),s=o("share.copy"),[a,l]=m.useState(""),u=m.useRef(null),h=m.useRef(null),f=m.useCallback(()=>{u.current=window.setTimeout(()=>{l(s)},CO)},[s]),p=m.useCallback(()=>{u.current&&clearTimeout(u.current)},[]);m.useEffect(()=>e?(l(s),p):(_P(t).then(v=>{var y;l(v?i:s),(y=h.current)==null||y.focus(),v&&f()}),p),[f,p,t,i,s,e]);const g=async()=>{await _P(t),l(i),p(),f(),r&&r()};return d.jsx(Te,{ref:h,title:a,color:n,size:"56-xl",className:"w-full",onClick:g,"aria-live":"polite","aria-label":a,children:a})}function qbe(t){const{t:e}=xe(),{value:n,onCopy:r,onError:o,children:i,title:s=e("share.copy"),disabled:a,copyOnRender:l=!1,...u}=t,[h,f]=m.useState(!1),p=m.useCallback(async()=>{try{await navigator.clipboard.writeText(n),f(!0),r&&r(),setTimeout(()=>f(!1),CO)}catch(g){o&&o(g),U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CopyError",eventInfo_details:"Error on copying value to clipboard.",eventInfo_errorMessage:g instanceof Error?g.message:""}})}},[n,r,o]);return m.useEffect(()=>{l&&p()},[l,p]),d.jsx(Te,{onClick:p,title:s,disabled:a,...u,children:i??e(h?"share.copied":"share.copy")})}function Wbe(t){const{onClose:e,shareUrl:n,imagePath:r,title:o}=t,[i,s]=m.useState(!0),{t:a}=xe(),l=()=>{e(!1)};return d.jsxs(Ol,{isOpen:!0,onClose:l,headerText:a("podcasts.share"),className:"w-full max-w-[640px]",children:[d.jsxs("div",{className:"mt-3 flex flex-col gap-6",children:[d.jsxs("div",{className:"mx-2 flex flex-col items-center gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(BU,{alt:"",path:r,onLoad:()=>s(!1),className:"rounded-2xl"}),d.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-podcast-share-modal-light dark:bg-gradient-podcast-share-modal-dark"}),!i&&d.jsx("h1",{className:"absolute bottom-8 mx-8 inline text-foreground-800 text-xl",role:"presentation",children:o})]}),i&&d.jsx("div",{className:"flex h-[328px] items-center justify-center",children:d.jsx(_t,{type:"spinnerThemed",className:"size-6"})})]}),d.jsx("div",{className:"py-4",children:d.jsx(Kbe,{url:n,disableAutoCopy:!0})})]}),d.jsx("div",{className:"m-auto mb-3 max-w-[484px] text-center text-foreground-600 text-2xs",children:a("podcasts.sharePodcastsDisclaimer")})]})}const Ybe=m.lazy(()=>H(()=>import("./sender-share-conversation-modal-BlAwiJv9.js"),__vite__mapDeps([233,1,2,234,235,236])).then(t=>({default:t.ShareConversationModal})));function Qbe(){const[t,e]=Ze(Gbe),{t:n}=xe(),r=Fbe(),o=m.useMemo(()=>t?document.activeElement:null,[t]),i=()=>{var s;o instanceof HTMLElement&&setTimeout(()=>{o.focus()},0),e(void 0),(t==null?void 0:t.action)==="share"&&((s=t.onClose)==null||s.call(t))};switch(t==null?void 0:t.action){case"delete":return d.jsx(pi,{isOpen:!0,className:"w-3/4 max-w-fit",children:d.jsx($be,{onClose:i,conversationId:t.conversationId})});case"share":{let s;return r?s=n("common.share"):t.messageId?s=n("share.shareModalHeaderOneTurn"):s=n("share.shareModalHeader"),d.jsx(pi,{trapFocus:!0,isOpen:!!t.conversationId,disableCloseOutside:!0,onClose:i,headerText:s,headerTextClassName:Be("text-lg",r&&"text-xl"),className:Be("relative max-h-full w-3/4 max-w-[640px] gap-3 overflow-y-auto",r&&"gap-4 p-8"),children:d.jsx(m.Suspense,{fallback:d.jsx(Te,{color:"strong",size:"56-xl",className:"w-full",title:n("common.loading"),disabled:!0,children:d.jsx(_t,{className:"size-8"})}),children:d.jsx(Ybe,{conversationId:t.conversationId,scenario:t.scenario,messageId:t.messageId})})})}case"share-podcast":return d.jsx(Wbe,{onClose:i,shareUrl:t.shareUrl,imagePath:t.imagePath,title:t.title});default:return null}}const Jbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/turn-limit-dark-CEuF11Ih.jpg",Xbe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/turn-limit-light-BSlP2HSn.jpg";function K9(t){const{dismiss:e,source:n,beforeContinue:r}=t,{t:o}=xe(),{login:i}=Wd(),s=o("logIn.proUpsellHeader"),a=o("logIn.proUpsellDescription"),l=o("common.notNow"),u=o("signInPrompt.continueWithMicrosoft"),h=x(Os),f=$t();m.useEffect(()=>{Ls({page:f,scenario:`UpsellProForAuth0AccountFrom${n}`})},[f,n]);const p=()=>{nt({source:`UpsellProForAuth0AccountFrom${n}`,scenario:"ProUpsellForAuth0AccountLinkWithMSA",destination:"MicrosoftLoginPage"}),r==null||r(),sessionStorage.setItem(t1,`${new Date().getTime().toString()}-link`),i({provider:"microsoft"})},g=()=>{nt({source:`UpsellProForAuth0AccountFrom${n}`,scenario:"dismissProUpsellForAuth0Account",destination:f}),e()};return d.jsxs("div",{className:"flex flex-col items-center p-4 text-center",children:[d.jsx("img",{src:h==="dark"?Jbe:Xbe,alt:o("images.birds"),className:"h-44 w-full rounded-xl object-cover"}),d.jsx("h1",{className:"pb-3 pt-6 text-lg",children:s}),d.jsx("p",{className:"max-w-[95%] break-words pb-7",children:a}),d.jsxs(Te,{onClick:p,title:u,variant:"pill",size:"48-lg",className:"w-full",color:"strong",testId:"prompt-sign-in-msft-composer-action",children:[d.jsx(Cy,{className:"size-6"}),u]}),d.jsx(Te,{onClick:g,title:l,variant:"pill",size:"48-lg",color:"overlay-bright",className:"mt-3 w-full",testId:"not-now-button-composer-action",children:l})]})}const Zbe=Object.freeze(Object.defineProperty({__proto__:null,default:K9},Symbol.toStringTag,{value:"Module"}));function eCe(){const t=se("ceo-thinkdeeper"),e=se("ceo-smart-mode"),n=se("ceo"),r=se("webretrieval"),o=se("webcontent"),i=se("browserautomationorchestratortool");return t||e||n||r||o||i}function tCe(){const t=se("memory-management-v2"),e=Sr(),n=x(zy);return t&&e&&!n}function q9(){const[t,e]=Ze(hl);return m.useEffect(()=>{e(n=>n||rG())},[e]),t}function nCe(){const t=q9(),e=eCe(),n=x(ei),r=x(_5),[o,i]=Ze(Fy),[s,a]=Ze(lX),l=me.instance().config().entraRedirectModalBehaviour!=="skip",u=se("ds-new-progress"),[h,f]=Ze(N5);return tCe(),d.jsxs(d.Fragment,{children:[n&&d.jsx(mU,{accountActionRequired:n}),t&&o&&d.jsx(pi,{isOpen:!0,trapFocus:!0,children:d.jsx(vbe,{interceptedLink:o,onClose:()=>{i(void 0)}})}),d.jsx(Qbe,{}),r&&d.jsx(hbe,{}),s&&d.jsx(pi,{isOpen:!0,className:"min-h-[328px] max-w-[528px]",children:d.jsx(K9,{dismiss:()=>a(null),source:"ProSubPage"})}),l&&d.jsx(mbe,{}),d.jsx(Spe,{}),d.jsx(lbe,{}),e&&d.jsx(tbe,{}),u&&d.jsxs(d.Fragment,{children:[d.jsx(Rbe,{}),d.jsx(bbe,{})]}),h!==null&&d.jsx(ybe,{config:h,onClose:()=>f(null)}),UE]})}const W9=t=>m.createElement("svg",{width:96,height:93,viewBox:"0 0 96 93",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_140_39981",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:96,height:93},m.createElement("mask",{id:"path-1-outside-1_140_39981",maskUnits:"userSpaceOnUse",x:0,y:0,width:96,height:93,fill:"black"},m.createElement("rect",{fill:"white",width:96,height:93}),m.createElement("path",{d:"M4 46.5C4 23.0279 23.0279 4 46.5 4H49.5C72.9721 4 92 23.0279 92 46.5V46.5C92 69.9721 72.9721 89 49.5 89H46.5C23.0279 89 4 69.9721 4 46.5V46.5Z"})),m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",fill:"url(#paint0_linear_140_39981)",fillOpacity:.8,mask:"url(#path-1-outside-1_140_39981)"}),m.createElement("g",{clipPath:"url(#paint1_angular_140_39981_clip_path)","data-figma-skip-parse":"true",mask:"url(#path-1-outside-1_140_39981)"},m.createElement("g",{transform:"matrix(0 -0.0425 0.0556447 0 48 46.5)"},m.createElement("foreignObject",{x:-1094.12,y:-1094.12,width:2188.24,height:2188.24},m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{background:"conic-gradient(from 90deg,rgba(214, 147, 237, 1) 0deg,rgba(250, 176, 198, 1) 60.2401deg,rgba(244, 185, 234, 1) 85.1532deg,rgba(141, 152, 255, 1) 126.663deg,rgba(170, 110, 238, 1) 209.329deg,rgba(255, 103, 119, 1) 250.911deg,rgba(255, 186, 113, 1) 291.415deg,rgba(198, 134, 255, 1) 332.659deg,rgba(214, 147, 237, 1) 360deg)",height:"100%",width:"100%",opacity:1}})))),m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",mask:"url(#path-1-outside-1_140_39981)"})),m.createElement("g",{mask:"url(#mask0_140_39981)"},m.createElement("g",{clipPath:"url(#paint2_angular_140_39981_clip_path)","data-figma-skip-parse":"true"},m.createElement("g",{transform:"matrix(0 -0.071 0.0897903 0 48 47.0001)"},m.createElement("foreignObject",{x:-1014.09,y:-1014.09,width:2028.17,height:2028.17},m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{background:"conic-gradient(from 90deg,rgba(0, 0, 0, 1) 0deg,rgba(255, 255, 255, 1) 52.2deg,rgba(197, 197, 197, 1) 122.4deg,rgba(0, 0, 0, 1) 147.6deg,rgba(255, 255, 255, 1) 171deg,rgba(174, 174, 174, 1) 235.8deg,rgba(0, 0, 0, 1) 250.911deg,rgba(217, 238, 247, 1) 266.4deg,rgba(255, 255, 255, 1) 332.659deg,rgba(0, 0, 0, 1) 360deg)",height:"100%",width:"100%",opacity:1}})))),m.createElement("rect",{x:-23,y:-24,width:142,height:142})),m.createElement("defs",null,m.createElement("clipPath",{id:"paint1_angular_140_39981_clip_path"},m.createElement("path",{d:"M46.5 4V8H49.5V4V0H46.5V4ZM49.5 89V85H46.5V89V93H49.5V89ZM46.5 89V85C25.237 85 8 67.763 8 46.5H4H0C0 72.1812 20.8188 93 46.5 93V89ZM92 46.5H88C88 67.763 70.763 85 49.5 85V89V93C75.1812 93 96 72.1812 96 46.5H92ZM49.5 4V8C70.763 8 88 25.237 88 46.5H92H96C96 20.8188 75.1812 0 49.5 0V4ZM46.5 4V0C20.8188 0 0 20.8188 0 46.5H4H8C8 25.237 25.237 8 46.5 8V4Z",mask:"url(#path-1-outside-1_140_39981)"})),m.createElement("clipPath",{id:"paint2_angular_140_39981_clip_path"},m.createElement("rect",{x:-23,y:-24,width:142,height:142})),m.createElement("linearGradient",{id:"paint0_linear_140_39981",x1:4,y1:89,x2:101.93,y2:75.3765,gradientUnits:"userSpaceOnUse"},m.createElement("stop",{stopColor:"#FFAB4E"}),m.createElement("stop",{offset:1,stopColor:"#FF7791"})))),KPe=Object.freeze(Object.defineProperty({__proto__:null,default:W9},Symbol.toStringTag,{value:"Module"})),Y9=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M20.2899 16.4358C20.6074 15.5282 20.78 14.5526 20.78 13.5366V9.5241C20.78 9.10859 20.4432 8.77175 20.0277 8.77175C19.6122 8.77175 19.2753 9.10859 19.2753 9.5241V13.5366C19.2753 14.1176 19.2072 14.6827 19.0785 15.2244L20.2899 16.4358Z",fill:"currentColor"}),m.createElement("path",{d:"M15.263 11.1575V6.51431C15.263 4.71377 13.8034 3.25414 12.0028 3.25414C10.7464 3.25414 9.65599 3.96485 9.11167 5.00618L8.01336 3.90787C8.86428 2.60809 10.3333 1.74944 12.0028 1.74944C14.6344 1.74944 16.7677 3.88274 16.7677 6.51431V12.6622L15.263 11.1575Z",fill:"currentColor"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0026 20.8093C7.986 20.8093 4.7299 17.5532 4.7299 13.5366L4.7299 9.5241C4.7299 9.10859 4.39306 8.77175 3.97755 8.77175C3.56204 8.77175 3.2252 9.10859 3.2252 9.5241L3.2252 13.5366C3.2252 18.3843 7.15498 22.314 12.0026 22.314C14.6664 22.314 17.053 21.1274 18.6628 19.2539L21.0006 21.5917C21.2944 21.8855 21.7707 21.8855 22.0645 21.5917C22.3584 21.2979 22.3584 20.8215 22.0645 20.5277L3.00504 1.46823C2.71123 1.17442 2.23487 1.17442 1.94106 1.46823C1.64725 1.76204 1.64725 2.2384 1.94106 2.53221L7.23793 7.82908V13.5362C7.23793 16.1678 9.37124 18.3011 12.0028 18.3011C13.5589 18.3011 14.9407 17.5552 15.8103 16.4015L17.5951 18.1862C16.261 19.7891 14.251 20.8093 12.0026 20.8093ZM8.74263 13.5362C8.74263 15.3368 10.2023 16.7964 12.0028 16.7964C13.1441 16.7964 14.1484 16.21 14.7308 15.322L8.74263 9.33378L8.74263 13.5362Z",fill:"currentColor"})),qPe=Object.freeze(Object.defineProperty({__proto__:null,default:Y9},Symbol.toStringTag,{value:"Module"})),pA=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7673 6.54284C16.7673 3.91128 14.634 1.77799 12.0024 1.77799C9.37089 1.77799 7.2376 3.91129 7.2376 6.54284L7.2376 13.5647C7.2376 16.1963 9.37089 18.3296 12.0024 18.3296C14.634 18.3296 16.7673 16.1963 16.7673 13.5647L16.7673 6.54284ZM12.0024 3.28268C13.803 3.28268 15.2626 4.7423 15.2626 6.54284L15.2626 13.5647C15.2626 15.3652 13.803 16.8249 12.0024 16.8249C10.2019 16.8249 8.74229 15.3652 8.74229 13.5647L8.74229 6.54284C8.74229 4.7423 10.2019 3.28268 12.0024 3.28268Z",fill:"currentColor"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.0274 8.79987C19.6119 8.79987 19.2751 9.1367 19.2751 9.55221V13.5647C19.2751 17.5813 16.019 20.8374 12.0024 20.8374C7.98587 20.8374 4.72979 17.5813 4.72979 13.5647L4.72979 9.55221C4.72979 9.1367 4.39295 8.79987 3.97744 8.79987C3.56193 8.79987 3.2251 9.1367 3.2251 9.55221L3.2251 13.5647C3.2251 18.4123 7.15485 22.3421 12.0024 22.3421C16.85 22.3421 20.7798 18.4123 20.7798 13.5647V9.55221C20.7798 9.1367 20.443 8.79987 20.0274 8.79987Z",fill:"currentColor"})),WPe=Object.freeze(Object.defineProperty({__proto__:null,default:pA},Symbol.toStringTag,{value:"Module"})),Q9=t=>m.createElement("svg",{width:63,height:73,viewBox:"0 0 63 73",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{filter:"url(#filter0_d_3118_29179)"},m.createElement("path",{d:"M39.7952 28.3892L42.2422 41.8194C43.061 46.313 43.4704 48.5598 42.1865 49.4826C40.9025 50.4053 38.9035 49.3009 34.9054 47.0922L22.9563 40.491C16.2962 36.8117 12.9661 34.972 13.4372 33.1039C13.9083 31.2359 17.7474 31.1951 25.4255 31.1136C27.1365 31.0955 27.992 31.0864 28.6339 30.625C29.2759 30.1637 29.5572 29.3557 30.12 27.7398C32.6452 20.4884 33.9078 16.8627 35.8285 17.0117C37.7493 17.1608 38.4313 20.9036 39.7952 28.3892Z",fill:"white",fillOpacity:.8,shapeRendering:"crispEdges"}),m.createElement("path",{d:"M39.7952 28.3892L42.2422 41.8194C43.061 46.313 43.4704 48.5598 42.1865 49.4826C40.9025 50.4053 38.9035 49.3009 34.9054 47.0922L22.9563 40.491C16.2962 36.8117 12.9661 34.972 13.4372 33.1039C13.9083 31.2359 17.7474 31.1951 25.4255 31.1136C27.1365 31.0955 27.992 31.0864 28.6339 30.625C29.2759 30.1637 29.5572 29.3557 30.12 27.7398C32.6452 20.4884 33.9078 16.8627 35.8285 17.0117C37.7493 17.1608 38.4313 20.9036 39.7952 28.3892Z",stroke:"white",strokeWidth:1.5,shapeRendering:"crispEdges"})),m.createElement("path",{d:"M43.06 50.7014C44.3479 49.7757 44.5485 48.2871 44.5004 46.9375L44.469 46.4069C44.397 45.4896 44.2259 44.4068 44.0083 43.1722L43.7279 41.6191L43.7271 41.6113L43.7263 41.6119L41.2578 28.06L40.7794 25.455C40.3207 22.9993 39.9105 20.9984 39.4527 19.5092L39.3346 19.1407C39.0928 18.4125 38.8119 17.7441 38.4599 17.1874L38.2786 16.9184C37.7807 16.2335 37.0781 15.6722 36.1346 15.5382L35.9428 15.5173C35.0273 15.4462 34.264 15.7987 33.6613 16.3187L33.4134 16.551C32.8862 17.0835 32.4355 17.7951 32.024 18.597L31.8493 18.9462C31.1633 20.3587 30.4435 22.2885 29.6039 24.6656L28.7214 27.1892L28.7014 27.2468C28.4821 27.8767 28.3253 28.323 28.1864 28.662L28.0522 28.9689C27.8919 29.3038 27.7981 29.3776 27.7565 29.4075C27.7254 29.4298 27.6614 29.4719 27.4758 29.5106L27.2465 29.5479C27.0436 29.5728 26.806 29.587 26.5081 29.5964L25.4073 29.6142L25.3455 29.6153C22.0505 29.6503 19.3668 29.6775 17.3562 29.8624L16.5355 29.9519C15.6246 30.0688 14.7765 30.2424 14.0635 30.5367L13.7674 30.6702C13.0061 31.0434 12.328 31.6403 12.0348 32.5515L11.9812 32.738C11.7577 33.624 11.971 34.4332 12.3786 35.1149L12.5645 35.3986C13.059 36.0947 13.7998 36.7301 14.6458 37.3375L15.3198 37.8019C16.9879 38.9103 19.3175 40.1961 22.1748 41.7746L34.238 48.4394L35.6206 49.2003C36.9417 49.9202 38.0776 50.5066 39.0333 50.8666L39.516 51.0344C40.6626 51.3952 41.933 51.5114 43.06 50.7014Z",stroke:"black",strokeWidth:1.5}),m.createElement("defs",null,m.createElement("filter",{id:"filter0_d_3118_29179",x:2.64307,y:6.25732,width:51.1152,height:66.3022,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},m.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),m.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),m.createElement("feMorphology",{radius:2,operator:"erode",in:"SourceAlpha",result:"effect1_dropShadow_3118_29179"}),m.createElement("feOffset",{dy:16}),m.createElement("feGaussianBlur",{stdDeviation:4}),m.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),m.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),m.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3118_29179"}),m.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3118_29179",result:"shape"})))),YPe=Object.freeze(Object.defineProperty({__proto__:null,default:Q9},Symbol.toStringTag,{value:"Module"}));function rCe(t){const{renderFocusedElement:e,children:n,className:r,options:o={},isOpen:i}=t,{offset:s=1,placement:a="bottom-end",adjustArrowPosition:l=S=>S}=o,u=m.useRef(null),{state:h,setState:f}=Q_({controlledValue:i,defaultValue:!1}),{y:p=0}=l({x:0,y:0})??{},{refs:g,context:v,floatingStyles:y,middlewareData:b}=dp({open:h,placement:a,onOpenChange:f,middleware:[_d(s),Ad(),nO({element:u,padding:{right:-38,bottom:p}})],whileElementsMounted:wd}),C=l(b.arrow);return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:g.setReference},h),h&&d.jsx(my,{children:d.jsx(gy,{context:v,modal:!1,children:d.jsxs("div",{ref:g.setFloating,style:y,className:Be("flex outline-none",jt.coachmark),children:[d.jsx("div",{className:Be("start-0 flex rounded-ee-md rounded-es-3xl rounded-se-3xl rounded-ss-3xl border border-background-200 border-white shadow-sm",r),children:n}),d.jsx("div",{ref:u,style:{position:"absolute",left:C==null?void 0:C.x,top:(C==null?void 0:C.y)??p},className:"pointer-events-none",children:d.jsx(Q9,{className:"my-5 size-14"})})]})})})]})}const Km="absolute inset-0 rounded-full",AP="relative size-6 transition-colors",kP=2,oCe=50,iCe=20,J9=.6,sCe=3,aCe=.55,cCe=1,lCe={opacity:0,scale:J9},uCe={opacity:1,scale:1,transition:{...hU,delay:pU}};function dCe(t){const{t:e}=xe(),{isMuted:n,inputVolume:r,isOutputPlaying:o,enableSpinAnimation:i=!0,className:s,coachUserUnmute:a=!1,onClick:l}=t,u=!o&&!n,[h,f]=m.useState(!1),p=ar({breakpoint:"sm"});m.useEffect(()=>{let S;return a&&(S=setTimeout(()=>f(!0),600)),()=>clearTimeout(S)},[a]);const g=rO(r,dU),v=nd(g,[kP,oCe],[J9,sCe]),y=nd(g,[kP,iCe],[aCe,cCe]),{focusable:b,refCallback:C}=kd({autoRestoreFocus:!0,forceFocus:!0});return d.jsx(rCe,{className:"max-w-72 border-white bg-black/90 p-2 dark:bg-white",isOpen:h,options:{placement:"top-end",offset:p?{mainAxis:27,crossAxis:10}:{mainAxis:15,crossAxis:-55},adjustArrowPosition:S=>p?{x:S!=null&&S.x?S.x-20:void 0,y:12}:S},renderFocusedElement:S=>d.jsxs(d.Fragment,{children:[h?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute start-1/2 -my-4 size-fit -translate-x-1/2",children:d.jsx(wn,{duration:.6,exitDelay:4.5,exitDuration:.5,children:d.jsx(Ne.div,{animate:{rotate:360},transition:{duration:2.5,repeat:1,ease:"linear"},children:d.jsx(W9,{className:"size-20"})})})}),d.jsx("div",{className:"absolute start-1/2 -my-4 size-fit -translate-x-1/2",children:d.jsx(Ne.div,{className:"size-[80px] rounded-full border-4 border-solid border-black/80 shadow-sm dark:border-white",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:4.5,ease:"linear"}})})]}):null,d.jsx(Ne.button,{...S,title:e(n?"composer.unmuteMicrophone":"composer.muteMicrophone"),className:Y("size-12 rounded-full",kf,by,s),layout:!a,initial:"initial",animate:"enter",variants:{initial:lCe,enter:uCe},onClick:l,ref:I=>{S.ref(I),C(I)},"data-spatial-focus-key":b.focusKey,children:d.jsxs(Ne.span,{className:Y("flex items-center justify-center overflow-hidden border",n?"border-transparent bg-black/8 dark:bg-white/5":"border-white bg-white/50 hover:bg-white/80 dark:border-white/12 dark:bg-black/40",u&&"text-spot-blue-450 dark:text-midnight-300",Km),layout:!a,children:[d.jsx(Mn,{children:u&&d.jsx(Ne.div,{className:Y("flex items-center justify-center overflow-hidden rounded-full blur-[6px]",Km),layout:!0,initial:ot,animate:Lt,exit:ot,style:{scale:v},children:d.jsx(Ne.div,{className:Y(Km),layout:!0,style:{opacity:y},children:d.jsx(Ne.div,{className:Y(i&&"animate-spin-slow","bg-gradient-audio-input-light dark:bg-gradient-audio-input-dark",Km)})})})}),n?d.jsx(Y9,{className:AP,"aria-hidden":!0}):d.jsx(pA,{className:AP,"aria-hidden":!0})]})})]}),children:d.jsx("div",{className:"flex p-0 px-3 text-white text-sm dark:text-foreground-300",children:e("voice.v2.waitingInteractionUnmuteSubheader")})})}function cp(t,e={},n){const{initialize:r=!1}=e,o=m.useRef(null);return m.useEffect(()=>{const i=n??o.current,s=new ResizeObserver(([a])=>{a&&t(a.contentRect)});return i&&(s.observe(i),r&&t(i.getBoundingClientRect())),()=>s.disconnect()},[t,r,n]),o}class X9{constructor(){j(this,"audioContext");j(this,"audioAnalyser")}get isInitialized(){return this.audioContext!==void 0&&this.audioContext.state!=="closed"}async initialize({sampleRate:e}){this.audioContext&&await this.cleanup();try{this.audioContext=new AudioContext({sampleRate:e}),this.audioAnalyser=this.audioContext.createAnalyser()}catch(n){const r=n instanceof Error?n.message:String(n);throw new Error(`Failed to initialize audio context: ${r}`)}}async cleanup(){this.audioContext&&this.audioContext.state!=="closed"&&await this.audioContext.close(),this.audioContext=void 0,this.audioAnalyser=void 0}}const Z9=24e3,iy=24e3,hCe=1;function fCe(t){const e=atob(t),n=e.length,r=new Uint8Array(n);for(let o=0;o<n;o+=1)r[o]=e.charCodeAt(o);return r.buffer}function pCe(t){let e="";const n=new Uint8Array(t),r=n.byteLength;for(let o=0;o<r;o+=1){const i=n[o];typeof i=="number"&&(e+=String.fromCharCode(i))}return btoa(e)}function e8(t){const e=fCe(t),n=new Int16Array(e),r=new Float32Array(n.length);for(let o=0;o<n.length;o+=1)r[o]=n[o]/32768;return r}function mCe(t){const e=t<0?t*32768:t*32767;return Math.max(-32768,Math.min(32767,e))}function gCe(t){let e=0;for(const n of t){const r=n-128;e+=r*r}return Math.sqrt(e/t.length)}function t8(t){return t/pp}function QPe(t){return`${t8(t)}x`}function xP(t,e){wt.emit(`voice:audio-${e}-volume-changed`,t)}class n8{constructor(e){j(this,"mode");j(this,"volumeUpdateRaf",-1);j(this,"audioAnalyser");j(this,"volume",ZB(0));this.mode=e}startTracking(e){this.audioAnalyser&&this.stopTracking(),this.audioAnalyser=e,this.trackVolume()}trackVolume(){if(!this.audioAnalyser){this.stopTracking();return}const e=new Uint8Array(this.audioAnalyser.frequencyBinCount);this.audioAnalyser.getByteTimeDomainData(e);const n=gCe(e);Math.abs(n-this.volume.get())>hCe&&(this.volume.set(n),xP(n,this.mode)),this.volumeUpdateRaf=requestAnimationFrame(()=>{this.trackVolume()})}stopTracking(){this.volumeUpdateRaf!==-1&&(cancelAnimationFrame(this.volumeUpdateRaf),this.volumeUpdateRaf=-1),this.audioAnalyser=void 0,this.volume.set(0),xP(0,this.mode)}}const vCe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/call_ending-BxIIadI4.mp3",yCe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/call_opening-CKuCznU5.mp3";class bCe{constructor(e={}){j(this,"options");j(this,"antiAliasFilter");this.options={windowSize:e.windowSize??1024,overlap:e.overlap??.7,tolerance:e.tolerance??200,useAntiAlias:e.useAntiAlias??!0,correlationWindowMultiplier:e.correlationWindowMultiplier??1.5,useSampleRateAwareScaling:e.useSampleRateAwareScaling??!1,useFirstFrameCompensation:e.useFirstFrameCompensation??!0},this.options.useAntiAlias&&this.initAntiAliasFilter()}initAntiAliasFilter(){this.antiAliasFilter=new Float32Array([.03,.09,.2,.36,.2,.09,.03])}getSampleRateScaling(e){if(!this.options.useSampleRateAwareScaling||!e)return 1;const r=e/24e3;return Math.max(.5,Math.min(2,r))}process(e,n=1,r){const o=this.getSampleRateScaling(r),{tolerance:i}=this.options;let{windowSize:s}=this.options;const{overlap:a}=this.options,{useAntiAlias:l}=this.options;if(this.options.useSampleRateAwareScaling&&o!==1&&(s=Math.round(s*o),s=Math.max(256,Math.min(4096,s))),Math.abs(n-1)<.001)return e;const u=l?this.applyAntiAliasFilter(e):e,h=Math.round(s*(1-a)),f=Math.round(h*n),p=Math.ceil(u.length/n),g=new Float32Array(p),v=this.createImprovedWindow(s),y=Math.min(s,u.length,p);this.overlapAddFrameEnhanced(u,0,g,0,v,y);let b=0,C=0;for(;b<p-s&&!(C>=u.length-s-i);){const S=this.findBestMatchEnhanced(u,C,g,b,s,i);this.overlapAddFrameEnhanced(u,S,g,b,v,s),b+=h,C+=f}return g}applyAntiAliasFilter(e){if(!this.antiAliasFilter||this.antiAliasFilter.length===0)return e;const n=new Float32Array(e.length),r=this.antiAliasFilter.length,o=Math.floor(r/2);for(let i=0;i<e.length;i+=1){let s=0;for(let a=0;a<r;a+=1){const l=i-o+a;l>=0&&l<e.length&&(s+=(e[l]??0)*(this.antiAliasFilter[a]??0))}n[i]=s}return n}createImprovedWindow(e){const n=new Float32Array(e);for(let r=0;r<e;r+=1){const o=2*Math.PI*r/(e-1),i=.5*(1-Math.cos(o)),s=.04*Math.cos(2*o);n[r]=i-s}return n}setOptions(e){this.options={...this.options,...e}}overlapAddFrameEnhanced(e,n,r,o,i,s){const a=Math.min(o+s,r.length),l=Math.min(s,e.length-n,a-o),u=o===0,h=this.options.useFirstFrameCompensation??!0;let f=1;if(u&&h){const{windowSize:p,overlap:g}=this.options;p>=1700&&g>=.8?f=1.5:p>=1400&&g>=.75?f=1.15:p>=1200&&g>=.7?f=1.25:f=1.2}for(let p=0;p<l;p+=1){const g=e[n+p]??0,v=i[p]??0,y=o+p;let b=1;o>0&&p<s*.1&&(b=p/(s*.1));let C=1;if(u&&h){const S=Math.max(.1,1-p/s*.9);C=1+(f-1)*S}typeof r[y]=="number"&&(r[y]+=g*v*b*C)}}findOptimalStartPosition(e,n,r,o){const i=Math.min(o,r/4),s=Math.max(0,n-i),a=Math.min(e.length-r,n+i);let l=n,u=-1/0;for(let h=s;h<=a;h+=1){let f=0,p=0,g=0,v=0;const y=Math.min(r,512);for(let A=0;A<y;A+=1)if(h+A<e.length){const _=e[h+A]??0;f+=_*_,p+=Math.abs(_),A>0&&v*_<0&&(g+=1),v=_}const b=Math.sqrt(f/y),C=p/y,S=C>0?b/C:0,I=b*.6,E=S*.3,T=g>0?Math.min(1,10/g)*.1:0,w=I+E+T;w>u&&(u=w,l=h)}return l}findBestMatchEnhanced(e,n,r,o,i,s){if(o===0)return this.findOptimalStartPosition(e,n,i,s);const a=Math.max(0,n-s),l=Math.min(e.length-i,n+s),u=Math.floor(i*(this.options.correlationWindowMultiplier??1.5)),h=Math.min(u,i),f=new Float32Array(h),p=Math.max(0,o-h);let g=0,v=0,y=0;for(let S=0;S<h;S+=1){const I=p+S;if(I<r.length){f[S]=r[I]??0;const E=f[S]??0;g+=E*E,S>0&&y*E<0&&(v+=1),y=E}}let b=n,C=-1/0;for(let S=a;S<=l;S+=1){let I=0,E=0,T=0,w=0;for(let q=0;q<h;q+=1)if(S+q<e.length&&p+q<r.length){const ae=e[S+q]??0;I+=(f[q]??0)*ae,E+=ae*ae,q>0&&w*ae<0&&(T+=1),w=ae}const A=g>0&&E>0?I/Math.sqrt(g*E):0,_=Math.abs(T-v),L=Math.max(T,v),N=L>0?1-_/L:1,K=A*.8+N*.2;K>C&&(C=K,b=S)}return b}}const CCe={windowSize:2048,overlap:.5,tolerance:128,useAntiAlias:!0,correlationWindowMultiplier:1.6,useFirstFrameCompensation:!0},SCe={windowSize:1792,overlap:.5,tolerance:300,useAntiAlias:!0,correlationWindowMultiplier:1.8,useFirstFrameCompensation:!0},ICe={windowSize:1280,overlap:.65,tolerance:280,useAntiAlias:!0,correlationWindowMultiplier:1.6,useFirstFrameCompensation:!0},ECe={windowSize:1536,overlap:.75,tolerance:300,useAntiAlias:!0,correlationWindowMultiplier:1.6,useFirstFrameCompensation:!0};function TCe(t){switch(t){case 1.5:return ECe;case 1.25:return ICe;case 1.1:return SCe;case .8:return CCe;case 1:default:return}}const RP=new bCe;function wCe(t,e,n){const r=TCe(e);return r?(RP.setOptions(r),RP.process(t,e,n)):t}function r8(t,e,n=1){const r=typeof t=="string"?e8(t):t;let o=r;n!==1&&(o=wCe(r,n,iy));const i=e.createBuffer(1,o.length,iy);i.getChannelData(0).set(o);const s=e.createBufferSource();return s.buffer=i,s}async function _Ce(t,e,n,r,o){const i=r&&await r(),s=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0,autoGainControl:!0,sampleRate:Z9,...i}}),a=s.getAudioTracks()[0];a&&(a.onended=h=>{o==null||o(h)});const l=e.createMediaStreamSource(s),u=e.createScriptProcessor(8192,1,1);return l.connect(n),n.connect(u),u.connect(e.destination),u.onaudioprocess=h=>{const f=h.inputBuffer.getChannelData(0),p=new Int16Array(f.length);for(let v=0;v<f.length;v+=1){const y=f[v];typeof y=="number"&&(p[v]=mCe(y))}const g=pCe(p.buffer);t(g)},s}async function NP(t,e){const n=await Promise.race([ZT(e),new Promise(r=>{try{const o=new Audio(t);o.addEventListener("ended",()=>r(o),{once:!0}),o.play()}catch{}})]);n==null||n.remove()}const ACe=iy*2;class kCe{constructor(){j(this,"audioBuffer",[]);j(this,"totalBufferSize",0);j(this,"lastProcessOptions",null)}addAudioData(e){if(!e)return!1;const n=e8(e),r=n.length;return r===0?!1:(this.audioBuffer.push({audioData:n,bufferSize:r}),this.totalBufferSize+=r,this.totalBufferSize>=ACe)}getLastProcessOptions(){return this.lastProcessOptions}setLastProcessOptions(e){this.lastProcessOptions=e}mergeAudioChunks(){const e=new Float32Array(this.totalBufferSize);let n=0;for(const r of this.audioBuffer){const{audioData:o}=r;e.set(o,n),n+=o.length}return e}getAudioData(){if(this.audioBuffer.length===0)return null;if(this.audioBuffer.length===1){const e=this.audioBuffer[0];return e?e.audioData:null}return this.mergeAudioChunks()}clearBuffer(){this.audioBuffer=[],this.totalBufferSize=0}}function xCe(t,e,n){e.setLastProcessOptions(t),e.addAudioData(t.data)&&o8(e,n)}function RCe(t,e){o8(t,e)}function o8(t,e){const n=t.getAudioData(),r=t.getLastProcessOptions();!n||!r||(e(r8(n,r.audioContext,r.playbackRate)),t.clearBuffer())}const JPe={lmks_rest:"lmksRest",frames:"frames",expr:"expr",neck_pose:"neckPose",jaw_pose:"jawPose",eyes_pose:"eyesPose",eyes_open_ratio:"eyesOpenRatio",rotation:"rotation",translation:"translation",lmks:"lmks"};class NCe{constructor(e,n){j(this,"lmksRest");j(this,"frames");this.lmksRest=e,this.frames=n}}class PCe{constructor(e,n){j(this,"exp");j(this,"pose");this.exp=e,this.pose=n}isValid(){return this.exp.dtype!==""&&this.exp.data.length>0||this.pose.dtype!==""&&this.pose.data.length>0}}const{EPSILON:nE}=Number,MCe=["Viseme_Neutral","Viseme_AI","Viseme_E","Viseme_U","Viseme_CDG","Viseme_WQ","Viseme_O","Viseme_L","Viseme_ShCh","Viseme_FV","Viseme_MBP"],OCe=[0,1,1,6,2,3,4,5,6,1,6,1,2,5,7,4,8,7,9,4,4,10],ua={enablePose:!1,enableNeck:!1,enableEye:!1,enableEyebrow:!1};function XPe(t){ua.enablePose=t,ua.enableNeck=t,ua.enableEye=t,ua.enableEyebrow=t}function LCe(t,e=null){const{Quaternion:n,Vector3:r}=Uo.getCore(),o=.3,i=.5,s=30/360*Math.PI,a=1,l=.01,u=["eye_BlinkUp","eye_Squint","eye_RSquare"],h=[.5,.2,.2],f=.5,p=.3,g=n.RotationAxis(r.Right(),Math.PI/4),v=g.conjugate(),y=new r(a,a,a),b=new r(-1,-1,-1),C={pose:{translation:new r(0,0,0),rotation:n.Identity()},expression:{eyes_open_ratio:0,eye_BlinkUp:0,eye_Squint:0,eye_RSquare:0,eyebrow_value:0,eyebrow_height:0,eyebrow_bend:0,viseme:new Array(11).fill(0),viseme22_idx:0,viseme11_idx:0},offset:t.offset??null};if(ua.enablePose){let I=PP(t.rotation);if(ua.enableNeck){const A=PP(t.neckPose);I.multiplyInPlace(A)}I=g.multiplyToRef(I,I).multiplyToRef(v,I);let[E,T]=jCe(I);T>s&&(T=s),C.pose.rotation=n.RotationAxis(E,T);const w=r.FromArray(t.translation);r.ClampToRef(w,b,y,w),C.pose.translation=w}const S=t.eyesOpenRatio[0]??0;if(C.expression.eyes_open_ratio=S,ua.enableEye&&e!==null){let I=0,E=0,T=0;if(e.expression.eye_BlinkUp>0)S<.9&&(I=1,E=0,T=0);else if(e.expression.eye_Squint>0)S<.9&&(I=0,E=f,T=0);else if(e.expression.eye_RSquare>0)S>1.1&&(I=0,E=0,T=p);else{const w=e.expression.eyes_open_ratio;S<.75&&w<.8?(I=1,E=0,T=0):S<.8&&w<.85?(I=0,E=f,T=0):S>1.1&&(I=0,E=0,T=p)}C.expression.eye_BlinkUp=I,C.expression.eye_Squint=E,C.expression.eye_RSquare=T}if(ua.enableEyebrow){const I=t.viseme.slice(1,4);C.expression.eyebrow_value=t.viseme[2]??0,C.expression.eyebrow_height=zx(((I[1]??0)-0)*2)*l,C.expression.eyebrow_bend=zx((0-(I[1]??0))*3)}{const I=Math.round(t.viseme[0]??0),E=OCe[I]??0;C.expression.viseme[E]=1,e!==null&&e.expression.viseme22_idx!==I&&(C.expression.viseme[E]=.9),C.expression.viseme22_idx=I,C.expression.viseme11_idx=E}if(e!==null){for(const[_,L]of u.entries()){const N=h[_]??0;C.expression[L]=MP(e.expression[L],C.expression[L],0,N)}const I=C.expression.viseme,E=e.expression.viseme;if((I[10]??0)<1e-6)for(let _=0;_<MCe.length;_+=1)I[_]=MP(E[_]??0,I[_]??0,0,o);const w=C.pose.translation,A=e.pose.translation;C.pose.translation=new r(w.x*i+A.x*(1-i),w.y*i+A.y*(1-i),w.z*i+A.z*(1-i))}return C}function DCe(t){const{TmpVectors:e,Vector3:n}=Uo.getCore(),r=e.Vector3[0];r.fromArray(t);const o=r.length();return o<nE?[n.Up(),0]:[r.scale(1/o),o]}function PP(t){const{Quaternion:e}=Uo.getCore(),[n,r]=DCe(t);return e.RotationAxis(n,r)}function jCe(t){const{Vector3:e}=Uo.getCore(),n=t.lengthSquared();Math.abs(n-1)>nE&&t.normalize();const r=Math.acos(t.w),o=r*2,i=Math.sin(r),s=Math.abs(i)<5e-4?1:i,a=new e(t.x/s,t.y/s,t.z/s);return a.lengthSquared()<nE&&(a.y=1),[a,o]}function MP(t,e,n,r){return Math.abs(e-t)<n?t:t<e?Math.min(t+r,e):Math.max(t-r,e)}function UCe(t,e,n){const{Vector3:r,Quaternion:o}=Uo.getCore(),{Lerp:i}=Uo.getMath();return{pose:{translation:r.Lerp(t.pose.translation,e.pose.translation,n),rotation:o.Slerp(t.pose.rotation,e.pose.rotation,n)},expression:{eyes_open_ratio:0,eye_BlinkUp:i(t.expression.eye_BlinkUp,e.expression.eye_BlinkUp,n),eye_Squint:i(t.expression.eye_Squint,e.expression.eye_Squint,n),eye_RSquare:i(t.expression.eye_RSquare,e.expression.eye_RSquare,n),eyebrow_value:0,eyebrow_height:i(t.expression.eyebrow_height,e.expression.eyebrow_height,n),eyebrow_bend:i(t.expression.eyebrow_bend,e.expression.eyebrow_bend,n),viseme:new Array(11).fill(0).map((a,l)=>i(t.expression.viseme[l]??0,e.expression.viseme[l]??0,n)),viseme22_idx:0,viseme11_idx:0}}}const FCe=3.141592653589793,OP="System.Single, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089";function BCe(t){const e=[],n=[],r=(a,l)=>{if(l>=a.length)throw new Error("index out of range");return a[l]===void 0?0:a[l]};for(const{frame:a,offset:l}of t){if(a.length<97)return console.log("Invalid frame length"),null;const u=new Array(28).fill(0);u[12]=r(a,78),u[16]=r(a,43),u[17]=r(a,43),u[21]=r(a,72),u[23]=.5*r(a,52)+.5*r(a,53),u[24]=.75*r(a,76),u[26]=.75*r(a,76),e.push({exp:u,offset:l});const h=[[-1*r(a,88)+FCe,-1*r(a,89),r(a,90)],[0,r(a,92),-1*r(a,91)],[0,r(a,95),-1*r(a,94)]];n.push(h)}const o={dtype:OP,shape:[e.length,16],data:e,isColumnMajor:!1},i={dtype:OP,shape:[n.length,3,3],data:n,isColumnMajor:!1};return new PCe(o,i)}class HCe{constructor(e){j(this,"activeModel",null);j(this,"a2eAnimationData",null);j(this,"vasaAnimationData",null);j(this,"vasaExpFrames",[]);j(this,"frameOffsetTimeAvailable",!1);j(this,"currentFrameIndex",0);this.getPlayTime=e}get fps(){return this.activeModel==="spda2e"?NG:this.activeModel==="vasa"?PG:25}get frameCount(){return this.activeModel==="spda2e"&&this.a2eAnimationData?this.a2eAnimationData.exp.data.length:this.activeModel==="vasa"&&this.vasaAnimationData?this.vasaAnimationData.frames.length:0}get playbackTime(){return this.getPlayTime()}reset(){this.activeModel=null,this.a2eAnimationData=null,this.vasaAnimationData=null,this.vasaExpFrames=[],this.frameOffsetTimeAvailable=!1,this.currentFrameIndex=0}setFrameData({frame:e,offsetInMilliseconds:n}){e&&(this.activeModel=e.model,e.model==="spda2e"&&this.setA2EFrame(e.poseDiffusion,n),e.model==="vasa"&&this.setVasaFrameData(e,n))}setA2EFrame(e,n){if(!(e!=null&&e.length))return;const r=BCe([{frame:e,offset:n}]);if(r){if(!this.a2eAnimationData){this.a2eAnimationData=r;return}this.a2eAnimationData.exp.data.push(...r.exp.data),this.a2eAnimationData.pose.data.push(...r.pose.data),this.frameOffsetTimeAvailable=this.a2eAnimationData.exp.data.every(({offset:o})=>!Number.isNaN(o))}}setVasaFrameData(e,n){if(!e)return;const r={...e,offset:n};if(!this.vasaAnimationData){this.vasaAnimationData=new NCe([],[r]);return}this.vasaExpFrames.push(LCe(r,this.vasaExpFrames.at(-1))),this.vasaAnimationData.frames.push(r),this.frameOffsetTimeAvailable=this.vasaAnimationData.frames.every(({offset:o})=>!Number.isNaN(o))}getCurrentFrameIndex(e){if(this.frameOffsetTimeAvailable){let n=this.currentFrameIndex;for(;n<e.length;n+=1){this.currentFrameIndex=n;const r=e[n];if((r==null?void 0:r.offset)!==void 0&&r.offset!==null&&r.offset/1e3>=this.playbackTime)break}return n}return Math.round(this.playbackTime/(1/this.fps))}getCurrentA2EFrame(){if(!this.a2eAnimationData)return null;const e=this.a2eAnimationData.exp.data;return this.currentFrameIndex=this.getCurrentFrameIndex(e),e[this.currentFrameIndex]??null}getCurrentVasaFrame(){if(!this.vasaAnimationData)return null;const{frames:e,lmksRest:n}=this.vasaAnimationData;this.currentFrameIndex=this.getCurrentFrameIndex(e);const r=e[this.currentFrameIndex];return r?{frame:r,lmksRest:n}:null}getCurrentVasaExpFrame(){if(!this.vasaAnimationData)return null;this.currentFrameIndex=this.getCurrentFrameIndex(this.vasaExpFrames);const e=this.vasaExpFrames[this.currentFrameIndex-1],n=this.vasaExpFrames[this.currentFrameIndex];if(e&&n&&this.playbackTime<(n.offset??1/0)/1e3){const r=this.playbackTime-(e.offset??0)/1e3;return UCe(e,n,r)}return n??null}}class zCe extends EventTarget{constructor(){super(...arguments);j(this,"audioContextManager",new X9);j(this,"volumeTracker",new n8("input"));j(this,"audioStream",null);j(this,"isMuted",!1)}get volume(){return this.volumeTracker.volume}get audioContext(){return this.audioContextManager.audioContext}get isInputMuted(){return this.isMuted}set isInputMuted(n){this.toggleMute(n)}async startAudioCapture(n){this.audioContextManager.isInitialized&&this.stopAudioCapture();try{await this.audioContextManager.initialize({sampleRate:Z9})}catch(a){throw this.dispatchEvent(new CustomEvent("error",{detail:a})),a}const r=()=>{this.stopAudioCapture(),this.dispatchEvent(new CustomEvent("audioTrackEnded"))},o=a=>{this.dispatchEvent(new CustomEvent("audioData",{detail:a}))},{audioContext:i,audioAnalyser:s}=this.audioContextManager;i&&s&&(this.audioStream=await _Ce(o,i,s,n,r),this.isInputMuted&&this.toggleMute(!0),this.volumeTracker.startTracking(s))}stopAudioCapture(){if(this.audioStream){for(const n of this.audioStream.getTracks())n.stop();this.audioStream=null}this.volumeTracker.stopTracking(),this.audioContextManager.cleanup()}toggleMute(n=!this.isMuted){if(this.audioStream)for(const r of this.audioStream.getTracks())r.enabled=!n;this.isMuted!==n&&(this.isMuted=n,this.dispatchEvent(new CustomEvent("muteStateChanged",{detail:n})))}}class VCe extends EventTarget{constructor(){super(...arguments);j(this,"audioContextManager",new X9);j(this,"volumeTracker",new n8("output"));j(this,"outputGainNode",null);j(this,"outputSourceNodes",new Set);j(this,"audioDuration",0);j(this,"nextBufferTime",0);j(this,"audioOffset",0);j(this,"currentPlaybackRate",1);j(this,"bufferManager",new kCe);j(this,"startJinglePromise");j(this,"animationSyncPromise");j(this,"audioStarted",!1);j(this,"audioChunksLoadDone",!1)}get audioContext(){return this.audioContextManager.audioContext}get audioPlaying(){var n;return((n=this.audioContext)==null?void 0:n.state)==="running"}get audioEnded(){return this.audioChunksLoadDone&&this.outputSourceNodes.size===0}get playbackTime(){if(!this.audioContext||this.audioContext.state==="closed")return 1/0;const{currentTime:n,outputLatency:r}=this.audioContext;return(n-r-this.audioOffset)*this.currentPlaybackRate}get volume(){return this.volumeTracker.volume}async initialize(n=pp){var r;this.audioContextManager.isInitialized&&this.stopAudioPlayback(),this.currentPlaybackRate=t8(n);try{await this.audioContextManager.initialize({sampleRate:iy}),(r=this.audioContext)==null||r.suspend()}catch(o){throw this.dispatchEvent(new CustomEvent("error",{detail:o})),o}this.audioDuration=0,this.nextBufferTime=0,this.audioOffset=0,this.audioStarted=!1,this.audioChunksLoadDone=!1,this.animationSyncPromise=void 0,this.setUpOutputVolumeTracking()}setUpOutputVolumeTracking(){const{audioContext:n,audioAnalyser:r}=this.audioContextManager;!n||!r||(this.outputGainNode=n.createGain(),this.outputGainNode.connect(r),r.connect(n.destination),this.volumeTracker.startTracking(r))}appendAudioData(n){if(!this.audioContext||!this.outputGainNode)return;const r={data:n,audioContext:this.audioContext,playbackRate:this.currentPlaybackRate};if(this.currentPlaybackRate!==1)xCe(r,this.bufferManager,this.appendAudioSource.bind(this));else{const o=r8(n,this.audioContext);this.appendAudioSource(o)}}appendAudioSource(n){var i;if(!this.audioContext||!this.outputGainNode||!n.buffer)return;this.outputSourceNodes.add(n),n.connect(this.outputGainNode),n.addEventListener("ended",()=>{var s;this.outputSourceNodes.delete(n),this.outputSourceNodes.size===0&&(this.audioChunksLoadDone?this.stopAudioPlayback():(s=this.audioContext)==null||s.suspend())}),this.nextBufferTime<this.audioContext.currentTime&&(this.audioOffset+=this.audioContext.currentTime-this.nextBufferTime,this.nextBufferTime=this.audioContext.currentTime),n.start(this.nextBufferTime);const r=n.buffer.length/n.buffer.sampleRate;this.nextBufferTime+=r,this.audioDuration+=r;const{Animation:o}=cn;!this.audioStarted&&!this.animationSyncPromise&&(this.animationSyncPromise=(i=o.getAnimationSyncPromise())==null?void 0:i.finally(()=>{this.animationSyncPromise=void 0})),this.startPlayback()}async startPlayback(){if(this.startJinglePromise??this.animationSyncPromise){const n=cn.currentTurnIndex,r=Promise.all([this.startJinglePromise,this.animationSyncPromise]);try{await r}catch(o){o instanceof Error&&(`${o.message}`,void 0)}if(n!==cn.currentTurnIndex)return}this.audioContext&&this.audioContext.state!=="closed"&&(this.audioContext.resume(),this.audioStarted||(this.audioStarted=!0,this.dispatchEvent(new CustomEvent("audioStart"))))}setAudioDone(){this.audioChunksLoadDone=!0,RCe(this.bufferManager,this.appendAudioSource.bind(this))}stopAudioPlayback(){for(const n of this.outputSourceNodes)n.stop();this.bufferManager.clearBuffer(),this.outputSourceNodes.clear(),this.setAudioDone(),this.volumeTracker.stopTracking(),this.audioContextManager.cleanup(),this.audioStarted&&(this.audioStarted=!1,this.dispatchEvent(new CustomEvent("audioEnd")))}async playCallStartJingle(){this.startJinglePromise||(this.startJinglePromise=NP(yCe,3e3).finally(()=>{this.startJinglePromise=void 0})),await this.startJinglePromise}async playCallEndJingle(){await NP(vCe,3e3)}}class $Ce extends EventTarget{constructor(){super(...arguments);j(this,"isAnimationEnabled",!1);j(this,"frameManager",new HCe(()=>cn.AudioOut.playbackTime));j(this,"animationSyncDeferred");j(this,"appearanceReady",!1)}get currentA2EFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentA2EFrame():null}get currentVasaFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentVasaFrame():null}get currentVasaExpFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentVasaExpFrame():null}get animationEnded(){return cn.AudioOut.audioEnded}get shouldAnimationPlay(){return this.isAnimationEnabled&&!this.animationEnded&&cn.AudioOut.audioStarted}initialize(n=!1){this.stopAnimation(),this.isAnimationEnabled=n}stopAnimation(){this.frameManager.reset(),this.isAnimationEnabled=!1,this.animationSyncDeferred&&this.animationSyncDeferred.reject()}getAnimationSyncPromise(){var n;return this.isAnimationEnabled&&!this.animationSyncDeferred&&(this.initializeAnimationSync(),this.checkAnimationSyncPromise()),(n=this.animationSyncDeferred)==null?void 0:n.promise}initializeAnimationSync(){let n,r;const o=new Promise((a,l)=>{n=a,r=l}),i=ZT(MG),s=Promise.race([o,i]).finally(()=>{this.animationSyncDeferred=void 0});this.animationSyncDeferred={promise:s,resolve:n,reject:r}}checkAnimationSyncPromise(){var n;this.appearanceReady&&this.frameManager.frameCount>OG&&((n=this.animationSyncDeferred)==null||n.resolve())}setAnimationDone(){var n;this.appearanceReady&&((n=this.animationSyncDeferred)==null||n.resolve())}setAppearanceReady(){this.appearanceReady=!0,this.checkAnimationSyncPromise()}setFrameData(n){this.isAnimationEnabled&&(this.frameManager.setFrameData(n),this.checkAnimationSyncPromise())}}const hc=class hc{constructor(){j(this,"AudioIn",new zCe);j(this,"AudioOut",new VCe);j(this,"Animation",new $Ce);j(this,"currentTurnIndex",0)}static getInstance(){return hc.instance||(hc.instance=new hc),hc.instance}};j(hc,"instance",null);let rE=hc;const cn=rE.getInstance(),LP=48,DP=50;function jP(t){const{isNested:e}=t,[n,r]=m.useState(1),[o,i]=m.useState(1),s=m.useRef(void 0),a=m.useRef(void 0),l=cp(g=>{s.current=g.width,a.current=g.height,r((s.current+LP)/s.current),i((a.current+LP)/a.current)},{initialize:!0}),{volume:u}=cn.AudioOut,h=rO(u,dU),f=nd(h,[0,DP],[1,n]),p=nd(h,[0,DP],[1,o]);return d.jsx(Ne.div,{className:"absolute inset-0",ref:l,initial:ot,animate:{...Lt,transition:{delay:pU}},exit:ot,children:d.jsx(Ne.div,{className:Y("absolute inset-0 flex items-center justify-center overflow-hidden rounded-6xl",e?"-scale-x-100 rounded-5xl blur-lg":"bg-stone-100/30 bg-blend-luminosity backdrop-blur-xl after:absolute after:inset-px after:rounded-6xl after:border after:border-transparent dark:bg-midnight-800/30"),layout:!0,style:{scaleX:f,scaleY:p},children:d.jsx(Ne.div,{className:Y("absolute -inset-16 aspect-square bg-gradient-audio-output-light bg-blend-saturation saturate-150 dark:bg-gradient-audio-output-dark dark:saturate-100",e?"animate-spin-slower opacity-20 dark:opacity-30":"animate-spin-slow opacity-40 dark:opacity-50")})})})}function GCe(t){const{dynamicHeight:e}=t;return d.jsx(Ne.div,{className:Y("t-bottom-fade absolute bottom-0 mx-4 box-content w-bottom-fade rounded-lg pt-bottom-fade",e?"h-bottom-fade":"h-composer"),initial:ot,animate:Lt,exit:ot,transition:H_,children:d.jsx(Tl,{isBottomFade:!0})})}function KCe(t,e){const{children:n,className:r,margins:o,data:i,size:s="regular",onButtonRef:a}=t,l=i.isDisabled?"":i.title,u=s==="small";return d.jsx(Ne.div,{className:Be("relative shrink-0",o??"my-1",u?"h-9":"h-10",i.isVisible&&!u&&"size-10",i.isVisible&&u&&"size-9",!i.isVisible&&"overflow-hidden"),layout:!0,initial:!1,ref:e,children:d.jsx(Ne.button,{type:"button",className:Be("absolute flex items-center justify-center rounded-xl fill-foreground-750",u?"size-9 p-1":"size-10 p-2",Pc["subtle-dimmed"],"disabled:active:bg-transparent disabled:active:bg-none",r),layout:"position",disabled:!i.isVisible||i.isDisabled,"aria-hidden":!i.isVisible,"aria-label":l,title:l,onClick:i.onClick,"data-testid":i.testId,"aria-expanded":typeof i.ariaExpanded=="boolean"?i.ariaExpanded:void 0,ref:a,children:n})})}const Zo=m.forwardRef(KCe);function qCe(){return x(MT).map(e=>e.id)}function i8(t){if(t.length===0)throw new Error("Array must have at least one element");return Math.floor(Math.random()*t.length)}function ZPe(t,e){if(t.length===1)throw new Error("Array must have at least two elements");let n;do n=i8(t);while(n===e);return n}function WCe(t){if(t.length!==0)return t[i8(t)]}function YCe(t){const e=[...t];for(let n=t.length-1;n>0;n-=1){const r=Math.floor(Math.random()*(n+1)),o=e[n];o&&e[r]&&(e[n]=e[r],e[r]=o)}return e}function eMe(t,e){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((o,i)=>o===r[i])}const QCe=m.lazy(()=>H(()=>import("./character-EZQ4m8o-.js"),__vite__mapDeps([237,1,2,238])).then(t=>({default:t.Character})));function JCe(){const[t,e]=Ze(Ip),{createConversation:n}=P_(),[r,o]=m.useState(!1),i=ve(b5),s=ve(Ic),a=qCe(),l=m.useRef(null),u=x(Zi);m.useEffect(()=>{if(l.current===null){const y=WCe(a);y&&(l.current=y)}},[a]);const{t:h}=xe();m.useEffect(()=>{r&&l.current&&U.trackEvent({name:"system",data:{eventName:"characterPromotionShown",eventInfo_characterId:l.current}})},[r]),m.useEffect(()=>{const y=localStorage.getItem(gG);o(!y&&u.length>=10&&u.length<14)},[t,u.length]);function f(y){switch(y){case"mica":return"mica-head";case"aqua":return"aqua-head";case"erin":return"erin-head";default:return"mica-head"}}async function p(){l.current&&(s("clicking"),U.trackEvent({name:"interaction",data:{eventName:"characterPromotionClicked",eventInfo_characterId:l.current}}),i(!0),Aee({settingName:"characterId",oldValue:"",newValue:l.current}),U.setSettings({userSettingCharacterId:l.current}),await Promise.all([Ur({path:"/user/settings",args:{options:{method:"PATCH"},body:{preferredCharacter:l.current}}})]))}const g=m.useCallback(async()=>{o(!1)},[]),v=m.useCallback(async()=>{l.current&&(o(!1),i(!0),e(l.current),await n())},[i,e,n]);return r?d.jsx("div",{className:"pointer-events-auto absolute -top-40 end-4 size-56 pb-2",onClick:p,onKeyDown:async y=>{y.key==="Enter"&&await p()},role:"button",tabIndex:0,"aria-label":h("characterAnimation.characterOptInAriaLabelText"),children:d.jsx(QCe,{className:"outline-none",characterId:f(l.current),onCharacterDismissed:g,onCharacterClicked:v})}):null}const s8="0px 0px 0px 1px rgb(255, 255, 255) inset",a8="0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset",XCe="0px 10px 24px 0px rgba(0, 0, 0, 0.18)",ZCe="0px 42px 30px 0px rgba(0, 0, 0, 0.06)",eSe="0px 16px 48px -2px rgba(244, 190, 146, 0.18)",tSe="0px 16px 48px -2px rgba(0, 0, 0, 0.25)",nSe="0px 16px 24px -2px rgba(0, 0, 0, 0.1)",rSe="0px 16px 24px -2px rgba(0, 0, 0, 0.25)",oSe=28,iSe=32,sSe=24,aSe=26,cSe="relative flex grow flex-col overflow-hidden before:absolute before:inset-0 before:rounded-3xl before:border-2 before:border-stroke-350",tMe="bg-white/90 dark:bg-midnight-900/80",lSe="w-auto rounded-3xl contrast-more:border-2",uSe="bg-gradient-to-b from-white/90 to-white/0 dark:from-black/30 dark:to-midnight-800/10",dSe="bg-white/90 dark:bg-midnight-850/60";function mA(t){const{title:e,onClick:n,appearDelay:r=ZH,appearDuration:o=jo.audio.unavailable,className:i}=t;return d.jsx(Ne.div,{layout:"position",initial:"initial",animate:"animate",className:"relative flex h-12 shrink-0 items-center",variants:{initial:{...ot,scale:.9},animate:{...Lt,scale:1,transition:{...hU,delay:r,duration:o}}},children:d.jsx("button",{type:"button",onClick:n,title:e,className:Y("min-w-44",kf,Pc.strong,VE["40-base"],$E["40-base"],by,"rounded-2xl before:rounded-2xl",i),children:e})})}function qm(t){const{children:e,className:n}=t;return d.jsx(Ne.div,{className:n,initial:ot,animate:Lt,exit:ot,transition:{delay:fU},children:e})}const hSe={initial:ot,animate:Lt};function fSe(t){const{titleKey:e,textKey:n,buttonTextKey:r,button:o,cancelButton:i,onClick:s,closeDialogCallback:a}=t,{t:l}=xe(),u=l(e),h=l(o.textKey);return d.jsxs(d.Fragment,{children:[d.jsx(Ne.div,{layout:!0,variants:hSe,initial:"initial",animate:"animate",role:"dialog","aria-label":u,tabIndex:-1,children:d.jsxs("div",{className:"m-3 text-center text-foreground-800",children:[d.jsx("p",{className:"py-3",children:u}),d.jsx("p",{className:"text-xs",children:l(n)}),r&&d.jsx("div",{className:"mx-auto flex w-full max-w-xs justify-around px-5 py-3 text-accent-600",children:d.jsx("button",{onClick:s,type:"button",className:"text-xs",children:l(r)})})]})}),d.jsxs(Ne.div,{className:"relative mx-0.5 my-1 flex w-full items-center justify-center gap-2 px-2 align-middle",onClick:a,children:[i&&d.jsx(Te,{variant:"rect",title:l(i.textKey),className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:i.onClick,children:l(i.textKey)}),d.jsx(Te,{variant:"rect",title:h,className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:o.onClick,children:h})]})]})}function gA(){const t=se("composer-creation-button");return!bo("kill-composer-creation-button")&&t}function UP({config:t}){const{t:e}=xe(),n=gA(),r=Sl();if(t)switch(t.mode){case"stop":return d.jsx(Te,{testId:"stop-button",color:"accent",variant:"circle",size:n?"36-sm":"40-base",className:n?"":"my-1","aria-label":e("composer.stopButton"),title:e("composer.stopButton"),onClick:()=>t.onClick(),children:d.jsx("div",{className:"size-3.5 rounded bg-accent-550 contrast-more:border-2 dark:bg-accent-150"})});case"submit":return d.jsx(Te,{testId:"submit-button",color:"strong",variant:"square",size:n?"36-sm":"40-base",className:Be(n?"rounded-2xl":"my-1 rounded-submitButton"),"aria-label":e("userInput.submitButtonText"),title:e("userInput.submitButtonText"),onClick:()=>t.onClick(),disabled:t.disabled,children:d.jsx(jp,{className:"size-6"})});case"microphone":return r?void 0:d.jsx(Zo,{data:{title:e("composer.startAudioCall"),testId:"audio-call-button",onClick:()=>t.onClick(),isVisible:!0},className:Pc["subtle-dimmed-inverted"],size:n?"small":"regular",margins:n?"my-0":"my-1",children:d.jsx(pA,{className:"size-6","aria-hidden":!0})});default:return}}function pSe(t){var i;const{item:e,onClick:n}=t,r=x(it),o=m.useRef(void 0);return m.useEffect(()=>{r&&o.current!==r&&e.onImpression&&(o.current=r,e.onImpression(r))},[r,e]),d.jsxs(Te,{title:e.title,"aria-label":e.title,variant:"rect",color:"subtle-dimmed-inverted",onClick:n,size:"40-base",alignment:"start",className:"min-w-[230px] px-3 py-2",testId:e.testId,children:[d.jsx("div",{className:"size-6 min-w-6",children:e.icon}),d.jsxs("div",{className:"grow text-left",children:[d.jsxs("div",{className:"line-clamp-1 inline-flex gap-1.5 text-xs",children:[e.title,(i=e.tags)==null?void 0:i.map(s=>d.jsx("div",{className:"flex items-center",children:d.jsx(gg,{color:s.color,children:d.jsx("span",{className:"leading-4",children:s.label})},s.label)},s.label))]}),d.jsx("p",{className:"line-clamp-1 leading-4 text-foreground-600 text-2xs dark:text-foreground-700",children:e.description})]})]},e.key)}const mSe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/dismiss-BcarQlxK.svg";function gSe(t){const{renderTrigger:e,renderSurface:n,containerClassNames:r,color:o="default",onOutsideEvent:i,placement:s="bottom",floatingOffset:a=10}=t,[l,u]=m.useState(!1),h=m.useRef(null),f=m.useRef(null),{refs:p,floatingStyles:g,context:v}=dp({placement:s,strategy:"fixed",middleware:[_d(a),hp(),Ad()],whileElementsMounted:wd,open:l,onOpenChange:u}),y=m.useCallback(C=>{C.stopPropagation(),C.preventDefault(),u(S=>!S)},[]),b=m.useCallback(()=>{u(!1),i==null||i()},[i]);return Na({onOutsideEvent:b,elements:[p.floating,h],includeScroll:!0,invokeOnce:!0}),Rl(C=>{C.key==="Escape"&&l&&b()}),d.jsxs("div",{ref:p.setReference,className:Y("relative",r==null?void 0:r.trigger),children:[e({openPopover:y,isOpen:l,ref:h}),PE.createPortal(d.jsx(Mn,{children:l&&d.jsx(gy,{context:v,modal:!0,returnFocus:!0,initialFocus:f,children:d.jsx(Ne.div,{ref:p.setFloating,className:Be("rounded-2xl p-3 shadow-lg",o==="thin"?aa:mi,r==null?void 0:r.surface,jt.modal),style:{...g,...LE},role:"dialog",tabIndex:-1,initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:{...ot,transition:{duration:jo.default}}},transition:{duration:jo.default,ease:"easeInOut"},children:d.jsx("div",{className:Y("pointer-events-auto relative max-h-expanded-section overflow-visible",jt.modal),children:n({closePopover:b,isOpen:l,focusRef:f})})})})}),document.getElementById("popoverPortal")??document.body)]})}const vA=m.forwardRef((t,e)=>{const{items:n,defaultSelectedItemIndex:r,onSelect:o,onReset:i,onMenuClick:s,disabled:a,showDefaultItemInDropdown:l=!1}=t,u=x(it),h=m.useRef(void 0),f=m.useMemo(()=>!r||r<0||r>=n.length?0:r,[r,n]),[p,g]=m.useState(f);m.useImperativeHandle(e,()=>({setSelectedItemIndex:C=>g(C)}),[]);const{selectedItem:v,dropdownItems:y,selectedNonDefault:b}=m.useMemo(()=>({selectedItem:n[p]??void 0,dropdownItems:l?n:n.filter((C,S)=>S!==p),selectedNonDefault:p!==f}),[n,p,f,l]);return m.useEffect(()=>{u&&h.current!==u&&v&&v.onImpression&&(h.current=u,v.onImpression(u))},[u,v]),d.jsx(gSe,{color:"default",renderTrigger:({openPopover:C})=>v&&d.jsxs(Te,{title:v.key,"aria-label":v.title,variant:"rect",size:"36-sm",disabled:a,color:b?"composer-selected":"subtle-dimmed",className:Be("h-9 select-none gap-x-1 rounded-2xl border border-black/8 dark:border-white/8",v.isIconEnabledInButton?"pe-3 ps-2":"px-3"),onClick:S=>{var I;s==null||s(),(I=v.beforeClick)==null||I.call(v,u??""),b?(g(f),i==null||i()):C(S)},testId:v.testId,children:[b?d.jsx(Hn,{url:mSe,className:"size-4"}):v.isIconEnabledInButton&&v.icon,d.jsx("span",{className:"text-xs",children:v.buttonTitle??v.title}),!b&&v.isChevronEnabledInButton&&d.jsx(El,{className:"size-4 rotate-90"})]}),renderSurface:({closePopover:C})=>d.jsx("div",{className:"flex flex-col",children:y.map(S=>d.jsx(pSe,{item:S,onClick:I=>{var T;(T=S.beforeClick)==null||T.call(S,u??"");const E=n.findIndex(w=>w.key===S.key);g(E),o(E),C(I)}},S.key))}),containerClassNames:{surface:"p-1 border-white/25 dark:border-slate-600/25 shadow-tinted-xl"},placement:"bottom-start",floatingOffset:4})});vA.displayName="ComposerDropdownButton";const vSe=c.record(c.string());function Yb(t){const[e,n]=Ze(dX),r=!!e[t],o=m.useCallback(()=>{const i={...e,[t]:new Date().toISOString()};Ro(SG,vSe,i),n(i)},[e,t,n]);return{alreadyShown:r,dismissCoachmark:o}}const Qb="smartmode",nMe="pagesEditThisResponse";function ySe(t){const{renderReferenceElement:e,children:n,className:r,placement:o,offset:i,isOpen:s=!0,portalId:a,withArrow:l=!1,arrowClassName:u="dark:fill-black fill-white",animation:h="none",onOutsideEvent:f,onInsideEvent:p}=t,g=m.useRef(null),{refs:v,x:y,y:b,strategy:C,context:S,placement:I}=dp({open:s,placement:o??"right",middleware:[_d(i??1),hp({fallbackAxisSideDirection:"end"}),Ad(),nO({element:g})],whileElementsMounted:wd});Na({onOutsideEvent:()=>{f==null||f()},invokeOnce:!0,elements:[v.floating]});const E=kE(S),T=xE(S),w=RE(S),A=Yd(),{getReferenceProps:_,getFloatingProps:L}=NE([E,T,w]),N=x(Os),K=bSe(h,I);return d.jsxs(d.Fragment,{children:[e==null?void 0:e({ref:v.setReference,..._()},s),s&&d.jsx(my,{id:a,children:d.jsxs(Ne.div,{ref:v.setFloating,style:{position:C,top:`${b}px`,[A?"insetInlineEnd":"insetInlineStart"]:`${y}px`,boxShadow:N==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset":void 0},...K,...L({}),className:Y("flex rounded-2xl p-4 shadow-xl",jt.coachmark,NV,l&&"!overflow-visible",r),onClick:p,children:[n,l?d.jsx(eH,{ref:g,context:S,tipRadius:3,strokeWidth:2,className:u}):null]})})]})}function bSe(t,e){switch(t){case"bounce":return CSe(e);case"none":return{};default:return{}}}function CSe(t){const n=t.startsWith("top")||t.startsWith("bottom"),r=t.startsWith("top")||t.startsWith("left")?-1:1;return n?{animate:{y:`${r*10}px`,transition:bN}}:{animate:{x:`${r*10}px`,transition:bN}}}function c8({triggerComponent:t,offset:e=10,onInsideEvent:n}){const{t:r}=xe(),o=Yd(),{alreadyShown:i,dismissCoachmark:s}=Yb(Qb),a=e9(),l=u=>{u.stopPropagation(),s()};return d.jsx(ySe,{className:"max-w-48 cursor-pointer bg-black dark:bg-midnight-150",arrowClassName:"dark:fill-midnight-150 fill-black",isOpen:!i,placement:o?"left":"right",offset:e,withArrow:!0,renderReferenceElement:u=>d.jsx(Ne.div,{ref:u.ref,className:"relative",children:t}),portalId:"composer-container",onInsideEvent:()=>{n==null||n(),s()},children:d.jsxs("div",{className:"flex max-w-[160px] flex-col gap-0.5 bg-black text-white dark:bg-midnight-150 dark:text-black",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:"text-2xs-strong",children:r("composer.chatModes.smart.coachmarkTitle")}),d.jsx("button",{onClick:l,type:"button",children:d.jsx(Mr,{className:"size-4"})})]}),d.jsx("div",{className:"text-2xs",children:a.coachmarkDescription})]})})}const l8="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/quick-pVrRG7df.svg",u8="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/smart-Ccvst-g_.svg",SSe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/think-DxNkOoJG.svg";function d8(){const t=x(pl),e=ze("kill-composer-reasoning-button");return!t&&e}function ISe(t,e){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerCreateButton",eventInfo_impressionScenario:t??"off",eventInfo_conversationId:e}})}function ESe(t,e){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerThinkButton",eventInfo_impressionScenario:t?"thinkDeeperOn":"thinkDeeperOff",eventInfo_conversationId:e}})}function TSe(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerScreenshotButton",eventInfo_conversationId:t}})}function wSe(t,e){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerCreateButton",eventInfo_clickScenario:_Se(t),eventInfo_conversationId:e}})}function _Se(t){if(!t)return"showDrawer";switch(t){case"actions":return"exitActions";case"image":return"exitImage";case"podcast":return"exitPodcast";case"researchReport":return"exitResearchReport";case"quiz":return"exitQuiz";default:return"showDrawer"}}function ASe(t,e){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerThinkButton",eventInfo_clickScenario:t?"disableThinkDeeper":"enableThinkDeeper",eventInfo_conversationId:e}})}function kSe(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerScreenshotButton",eventInfo_conversationId:t}})}function xSe(t){const{disabled:e=!1}=t,n=RSe(),r=Bp(),[o,i]=Ze(hn),[s,a]=m.useState(!1),{dismissCoachmark:l}=Yb(Qb),u=m.useRef(null),h=m.useCallback(p=>{const g=n[p];((g==null?void 0:g.key)==="chat"||(g==null?void 0:g.key)==="smart"||(g==null?void 0:g.key)==="reasoning")&&(a(!0),i(g.key),g.key==="smart"&&l())},[n,i,l]);m.useEffect(()=>{var p;if(s)a(!1);else{const g=n.findIndex(v=>v.key===o);(p=u.current)==null||p.setSelectedItemIndex(g)}},[n,o,s,a]);const f=d.jsx(vA,{ref:u,items:n,onSelect:h,defaultSelectedItemIndex:0,showDefaultItemInDropdown:!0,onReset:()=>{i("chat")},disabled:e,onMenuClick:()=>nt({source:"composerChatModeDropdownButton",pageName:"chatPage",customData:JSON.stringify({currentMode:o})})});return r?d.jsx(c8,{triggerComponent:f,offset:10}):f}function FP(t){return e=>ESe(t,e)}function BP(t){return e=>ASe(t,e)}function RSe(){const{t}=xe("translation"),e=Bp(),n=e9(),r=ze("model-in-mode-name"),o={key:"chat",title:t(r?"composer.chatModes.chat.titleWithModel":"composer.chatModes.chat.title"),buttonTitle:t(r?"composer.chatModes.chat.buttonTitleWithModel":"composer.chatModes.chat.buttonTitle"),icon:d.jsx(Hn,{url:l8,className:"size-5"}),description:t("composer.chatModes.chat.description"),testId:"composer-chat-mode-quick-button",onImpression:FP(!1),beforeClick:BP(!1),tags:[{label:t("composer.chatModes.chat.latency"),color:"neutral"}],isChevronEnabledInButton:!0,isIconEnabledInButton:!1},i={key:"reasoning",title:SO,icon:d.jsx(Hn,{url:SSe,className:"size-6"}),description:t("composer.chatModes.reasoning.description"),testId:"composer-chat-mode-reasoning-button",onImpression:FP(!0),beforeClick:BP(!0),tags:[{label:t("composer.chatModes.reasoning.latency"),color:"neutral"}]},s=[o];if(d8()||s.push(i),e){const a={key:"smart",title:n.title,icon:d.jsx(Hn,{url:u8,className:"size-6"}),description:n.description,testId:"composer-chat-mode-smart-button",tags:[{label:t("common.new"),color:"accent"}]};s.push(a)}return s}const NSe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/research-DamIycj6.svg",PSe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/study-C9DjLnwK.svg",MSe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/think-deeper-C6Ziv8bd.svg",h8="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/checklist-BDS7QRqm.svg",OSe=["chat","reasoning","research"],rMe=["copy","regenerate"];function f8(){const t=se("deep-research"),e=se("deep-research-nano"),n=Sr(),r=x(pl);return t&&(r||!1||!r&&n&&e)&&!me.instance().config().disableDeepResearch}const LSe=["chat"];function DSe(){const[t,e]=Ze(hn),n=Z_(),{t:r}=xe(),{dismissCoachmark:o}=Yb(Qb),i=p=>{nt({source:"composerChatModeMenu",customData:JSON.stringify({currentMode:t,newMode:p})}),e(p),xl({msg:r("actions.screenReaderSwitchPrefix",{chatMode:op({chatMode:p})})}),p==="smart"&&o()},s=f8(),a=Bp(),l=se("study-mode"),u=Sl(),h=d8();let f=LSe.concat(h?[]:["reasoning"],a?["smart"]:[],l?["study"]:[],s?["research"]:[],n?["computerUse"]:[]);return u&&(f=f.filter(p=>OSe.includes(p))),d.jsx("div",{className:"pointer-events-auto relative flex flex-col gap-1 rounded-2xl text-xs contrast-more:border-2","data-testid":"composer-mode-menu",role:"radiogroup",children:f.map((p,g)=>d.jsx(USe,{chatMode:p,isSelected:t===p,onSelect:i,focusOnMount:g===0},p))})}const jSe={chat:d.jsx(Hn,{url:l8,className:"size-5"}),reasoning:d.jsx(Hn,{url:MSe,className:"size-5"}),research:d.jsx(Hn,{url:NSe,className:"size-5"}),computerUse:d.jsx(Hn,{url:h8,className:"size-5"}),smart:d.jsx(Hn,{url:u8,className:"size-5"}),study:d.jsx(Hn,{url:PSe,className:"size-5"})};function USe(t){const{chatMode:e,isSelected:n,focusOnMount:r,onSelect:o}=t,{t:i}=xe(),s=m.useRef(null);qb(s,r);const a=e==="smart"||e==="study",l=e!=="smart"&&e!=="study";return d.jsxs("button",{type:"button",ref:s,title:op({chatMode:e}),onClick:()=>o(e),className:Y("flex items-center justify-between gap-4 rounded-xl px-4 py-2",Pc["subtle-dimmed"]),"data-testid":`${e}-mode-option`,role:"radio","aria-checked":n,children:[d.jsxs("div",{className:"flex items-center gap-4",children:[jSe[e],d.jsxs("div",{className:"pe-4 text-left",children:[d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsxs("div",{children:[" ",op({chatMode:e})," "]}),a&&d.jsx(gg,{color:"accent",children:d.jsx("span",{children:i("common.new")})}),e==="computerUse"&&d.jsx(gg,{color:"accent",children:d.jsx("span",{children:i("settings.labs.title")})}),l&&d.jsx(gg,{children:d.jsx("span",{children:i(`composer.chatModes.${e}.latency`)})})]}),d.jsx("div",{className:"text-foreground-600 text-2xs dark:text-foreground-700",children:Tme(e)})]})]}),d.jsx(FSe,{isSelected:n})]})}function FSe(t){const{isSelected:e}=t;return d.jsx("div",{className:Y("flex size-5 items-center justify-center rounded-full border-2",e?"border-foreground-800":"border-foreground-450"),children:e&&d.jsx("div",{className:"size-2.5 rounded-full bg-foreground-800 contrast-more:border-2"})})}function BSe(t){const{isChatModeMenuOpen:e,onRef:n,onClick:r,disableChatModeSwitcher:o}=t,{t:i}=xe(),s=x(hn),a=l=>{nt({source:"composerChatModeSwitcher",customData:JSON.stringify({currentMode:s,isOpen:e})}),r(l)};return d.jsx(Ne.div,{layout:"position",initial:!1,children:d.jsxs(Te,{testId:"chat-mode-switcher",title:i(e?"composer.chatModes.closeModeMenu":"composer.chatModes.openModeMenu"),onClick:a,color:"subtle-dimmed",ref:n,className:"my-1 border border-black/8",disabled:!o,"aria-haspopup":"menu","aria-expanded":e,children:[d.jsx("span",{className:"text-xs",children:op({chatMode:s,forceExcludeModelName:!0})}),d.jsx(El,{className:Y("size-4",e?"-rotate-90":"rotate-90")})]})})}function HSe(){const t=m.useRef(null);return{captureFocus:()=>{document.activeElement instanceof HTMLElement&&(t.current=document.activeElement)},restoreFocus:()=>{t.current&&t.current.focus()}}}function zSe({disableChatModeSwitcher:t}){const[e,n]=Ze(Db),r=Bp(),{captureFocus:o,restoreFocus:i}=HSe(),s=m.useCallback(a=>{n(l=>a?(o(),"chatMode"):l==="chatMode"?(setTimeout(()=>{i()},0),null):l)},[n,o,i]);return d.jsx(Hb,{isOpen:e==="chatMode",onIsOpenChange:s,renderTrigger:(a,l)=>{const u=d.jsx(BSe,{isChatModeMenuOpen:l,onRef:a.ref,onClick:a.onClick,disableChatModeSwitcher:t});return r?d.jsx(c8,{triggerComponent:u,offset:10,onInsideEvent:()=>{s(!0)}}):u},options:{placement:"top-start",offset:{mainAxis:10,crossAxis:-12},hideOnMenuClick:!0},className:Be(mi,"p-2"),children:d.jsx(DSe,{})})}function VSe({state:t}){const{t:e}=xe(),n=$t(),r=gi(),o=ve(Zr),i=ve(Dd),s=ve(By),a=gA();return d.jsx(Zo,{data:{title:e("composer.goToHome"),testId:"home-button",onClick:async()=>{o(null),i(!1),s(void 0),gn({source:"homeButton"}),await r({to:"/",from:n})},isVisible:t!=="hidden",isDisabled:t==="disabled"},size:a?"small":"regular",children:d.jsx(Fp,{className:"size-6","aria-hidden":!0})})}const p8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 24",fill:"currentColor",...t},m.createElement("path",{d:"M12.5 2C18.0228 2 22.5 6.47715 22.5 12C22.5 17.5228 18.0228 22 12.5 22C6.97715 22 2.5 17.5228 2.5 12C2.5 6.47715 6.97715 2 12.5 2ZM12.5 3.5C7.80558 3.5 4 7.30558 4 12C4 16.6944 7.80558 20.5 12.5 20.5C17.1944 20.5 21 16.6944 21 12C21 7.30558 17.1944 3.5 12.5 3.5ZM12.5 7C12.9142 7 13.25 7.33579 13.25 7.75V11.25H16.75C17.1642 11.25 17.5 11.5858 17.5 12C17.5 12.4142 17.1642 12.75 16.75 12.75H13.25V16.25C13.25 16.6642 12.9142 17 12.5 17C12.0858 17 11.75 16.6642 11.75 16.25V12.75H8.25C7.83579 12.75 7.5 12.4142 7.5 12C7.5 11.5858 7.83579 11.25 8.25 11.25H11.75V7.75C11.75 7.33579 12.0858 7 12.5 7Z"})),oMe=Object.freeze(Object.defineProperty({__proto__:null,default:p8},Symbol.toStringTag,{value:"Module"})),yA=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm.58 16.401-5.805-5.686a.75.75 0 0 0-.966-.071l-.084.07-5.807 5.687c.182.064.378.099.582.099h11.5c.203 0 .399-.035.58-.099l-5.805-5.686L18.33 19.4ZM17.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v11.5c0 .208.036.408.103.594l5.823-5.701a2.25 2.25 0 0 1 3.02-.116l.128.116 5.822 5.702c.067-.186.104-.386.104-.595V6.25a1.75 1.75 0 0 0-1.75-1.75Zm-2.498 2a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z"})),iMe=Object.freeze(Object.defineProperty({__proto__:null,default:yA},Symbol.toStringTag,{value:"Module"})),m8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 24",fill:"currentColor",...t},m.createElement("path",{d:"M12.5 2C18.0228 2 22.5 6.47715 22.5 12C22.5 17.5228 18.0228 22 12.5 22C6.97715 22 2.5 17.5228 2.5 12C2.5 6.47715 6.97715 2 12.5 2ZM15.7197 8.96967L11.25 13.4393L9.28033 11.4697C8.98744 11.1768 8.51256 11.1768 8.21967 11.4697C7.92678 11.7626 7.92678 12.2374 8.21967 12.5303L10.7197 15.0303C11.0126 15.3232 11.4874 15.3232 11.7803 15.0303L16.7803 10.0303C17.0732 9.73744 17.0732 9.26256 16.7803 8.96967C16.4874 8.67678 16.0126 8.67678 15.7197 8.96967Z"})),sMe=Object.freeze(Object.defineProperty({__proto__:null,default:m8},Symbol.toStringTag,{value:"Module"}));function g8(t){return m.useCallback(e=>{if(e.key==="Enter"&&!e.shiftKey||e.key===" "){e.preventDefault();try{const n=t(e);n instanceof Promise&&n.catch(console.error)}catch(n){console.error("Error in useEnterOrSpaceKeyDown:",n)}}},[t])}function $Se(t){const e=t.children[0];return e instanceof HTMLElement?e:null}function GSe(t,e=!0){m.useEffect(()=>{if(e&&t.current){const n=$Se(t.current);n&&n.focus()}},[t,e])}const Ll=t=>d.jsx(qSe,{...t});Ll.Motion=m.forwardRef(KSe);function KSe(t,e){const{children:n,axis:r="vertical",circular:o=!0,tabbable:i,autoFocus:s=!1,...a}=t,l=oO({axis:r,circular:o,tabbable:i}),u=m.useRef(null);return m.useImperativeHandle(e,()=>u.current,[]),qb(u,s),se("a11y-keyboard-navigation")?d.jsx(Ne.div,{ref:u,...l,...a,children:n}):d.jsx(Ne.div,{ref:u,...a,children:n})}function qSe(t){const{children:e,axis:n="vertical",circular:r,tabbable:o,autoFocus:i=!1,...s}=t,a=oO({axis:n,circular:r,tabbable:o}),l=m.useRef(null);return GSe(l,i),se("a11y-keyboard-navigation")?d.jsx("div",{ref:l,...a,...s,children:e}):d.jsx("div",{ref:l,...s,children:e})}const HP="ms-auto me-[2px] size-6 flex-none";function WSe(t,e){const{tab:n,onClick:r,showHighlight:o,showActionIcon:i=!0,onFocus:s,className:a,fallbackIcon:l,titleExtra:u,testId:h}=t,[f,p]=m.useState(!1),{t:g}=xe(),v=m.useCallback(()=>{r==null||r({...n,addedToTabSelection:!n.addedToTabSelection})},[r,n]),y=g8(v),b=f||!n.favIconUrl,C=l??yA;return d.jsxs(Ll.Motion,{className:Be(" box-border flex w-full cursor-pointer flex-row items-center rounded-lg p-1.5 active:bg-black/3 safe-hover:bg-black/5 dark:active:bg-white/5 dark:safe-hover:bg-black/30",o&&"bg-black/5 dark:bg-white/8","forced-colors:focus:outline forced-colors:focus:outline-2 forced-colors:focus:outline-black dark:forced-colors:focus:outline-white","contrast-more:focus:outline contrast-more:focus:outline-2 contrast-more:focus:outline-black dark:contrast-more:focus:outline-white",a),onClick:v,tabIndex:0,onKeyDown:y,ref:e,onFocus:s,tabbable:!0,"aria-label":n.title,"data-testid":h,children:[d.jsx("div",{className:"relative flex size-4 flex-none flex-row items-center rounded-lg bg-black/5",children:b?d.jsx(C,{className:"size-full"}):d.jsx("img",{src:n.favIconUrl,alt:g("composer.multiTabs.tabFavIconAltText"),className:"size-full rounded-[1px] object-cover",onError:()=>{p(!0)}})}),d.jsxs("span",{className:"font-ligatures-none me-7 ms-2 max-h-full truncate text-foreground-850 text-xs",children:[u??n.title,d.jsx("span",{})]}),i&&(n.addedToTabSelection?d.jsx(m8,{className:HP}):d.jsx(p8,{className:HP}))]})}const YSe=m.forwardRef(WSe),sy={ADD:"add"};function QSe(t){return t.sourceType==="opened"}function JSe(t){return QSe(t)?(t.id??0).toString():t.url??""}function v8(t){return t.sourceType===void 0||t.sourceType===null}const y8=t=>m.createElement("svg",{viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6.5 2C4.01472 2 2 4.01472 2 6.5V11.5002C1.39278 11.0441 1 10.3179 1 9.5V6.5C1 3.46243 3.46243 1 6.5 1H9.5C10.3179 1 11.0441 1.39278 11.5002 2H6.5ZM4.06095 6.3954C4.34069 5.02835 5.55025 4 7 4H13.5002C13.0441 3.39278 12.3179 3 11.5 3H7C4.79086 3 3 4.79086 3 7V11.5C3 12.3179 3.39278 13.0441 4 13.5002V7C4 6.79289 4.02099 6.59069 4.06095 6.3954ZM5 7.5C5 6.11929 6.11929 5 7.5 5H12.5C13.8807 5 15 6.11929 15 7.5V12.5C15 13.8807 13.8807 15 12.5 15H7.5C6.11929 15 5 13.8807 5 12.5V7.5ZM7.5 6C6.67157 6 6 6.67157 6 7.5V12.5C6 13.3284 6.67157 14 7.5 14H12.5C13.3284 14 14 13.3284 14 12.5V7.5C14 6.67157 13.3284 6 12.5 6H7.5Z"})),aMe=Object.freeze(Object.defineProperty({__proto__:null,default:y8},Symbol.toStringTag,{value:"Module"}));function XSe(t){const{highlightedIndex:e,activeMenuItemRef:n,onMenuItemClick:r,onFocus:o,tabs:i,emptyStateText:s}=t,a=x(jb),l=()=>i.length===0?d.jsx("span",{className:"-ms-0.5 h-8 leading-8 text-foreground-850 text-xs",role:"status",children:s}):i.map((u,h)=>d.jsx(m.Fragment,{children:d.jsx(YSe,{tab:u,onClick:r,showHighlight:h===e,ref:h===e?n:null,onFocus:()=>o(h),showActionIcon:!a,className:Be(!a&&"py-2"),fallbackIcon:v8(u)?y8:void 0,testId:`multi-tabs-menu-item-${h}`})},JSe(u)));return d.jsxs("div",{className:Be("relative flex w-full overflow-hidden",a?"mb-0 mt-3":"my-3"),children:[d.jsx("div",{className:Be("t-custom-scrollbar flex w-full flex-col gap-y-1 overflow-y-auto overflow-x-hidden px-0.5 py-0.5"),"data-testid":"multi-tabs-menu-items-container",children:l()}),i.length>=4&&a&&d.jsx("div",{className:Be("pointer-events-none absolute inset-x-0 bottom-0 h-8 rounded-b-lg px-4","bg-gradient-composer-tabs-menu-mask-light dark:bg-gradient-composer-tabs-menu-mask-dark")})]})}function ZSe(t){const{mode:e,disabled:n,onClick:r}=t,{t:o}=xe(),i=o("composer.multiTabs.browserTabMenuShareButton"),s=o("composer.multiTabs.browserTabMenuShareButtonForUpdate"),a=e===sy.ADD?i:s;return d.jsx(Te,{title:a,className:"mx-auto mt-auto w-full flex-none",disabled:n,testId:"multi-tabs-share-button",onClick:r,color:"strong",size:"48-lg","aria-label":a,children:a})}function b8(){const t=x(sde),e=se("edge-multi-tabs-history");return t&&e}function e0e(t){const{mode:e,onClose:n}=t,r=x(jb),{t:o}=xe(),i=b8(),s=o("common.closeText"),a=m.useMemo(()=>i?e===sy.ADD?o("composer.multiTabs.browserTabMenuTitleWithHistory"):o("composer.multiTabs.browserTabMenuTitleForUpdateWithHistory"):e===sy.ADD?o("composer.multiTabs.browserTabMenuTitle"):o("composer.multiTabs.browserTabMenuTitleForUpdate"),[i,e,o]);return d.jsxs("div",{className:"flex w-full items-center justify-between pt-2",children:[d.jsx("span",{className:"text-foreground-900 text-xs",children:a}),!r&&d.jsx(Te,{color:"subtle-dimmed",title:s,size:"32-xs",onClick:n,"aria-label":s,children:d.jsx(Mr,{className:"size-5 cursor-pointer"})})]})}const zP="";function t0e(t){const{onChange:e,defaultValue:n}=t,{t:r}=xe(),[o,i]=m.useState(n??zP),s=m.useRef(null),a=b8(),l=()=>{var g;(g=s.current)==null||g.focus(),i(zP)},u=g8(l),h=m.useCallback(g=>{i(g.target.value)},[]);m.useEffect(()=>{e==null||e(o)},[e,o]),m.useEffect(()=>{s.current&&requestAnimationFrame(()=>{var g;(g=s.current)==null||g.focus()})},[s]);const f=r(a?"composer.multiTabs.browserTabMenuSearchPlaceholderWithHistory":"composer.multiTabs.browserTabMenuSearchPlaceholder"),p=r("composer.multiTabs.browserTabMenuSearchClear");return d.jsxs("div",{className:"mt-3 flex h-8 w-full flex-row items-center rounded-3xl bg-white/60 dark:bg-black/60",children:[d.jsx(hA,{className:"mx-2 size-4"}),d.jsx("input",{type:"text",id:"browser-tab-search",autoComplete:"off",spellCheck:!1,autoCorrect:"off",className:"w-full flex-1 rounded-lg bg-transparent py-2 text-sm focus:outline-none",placeholder:f,"aria-label":f,onChange:h,value:o,maxLength:100,ref:s}),o&&d.jsx("div",{role:"button",tabIndex:0,className:"me-1 ms-auto h-6 cursor-pointer rounded-xl border border-midnight-250 bg-midnight-200 px-3 py-1 text-foreground-800 text-2xs dark:border-white/50 dark:bg-white/5",onKeyDown:u,onClick:l,"aria-label":p,children:p})]})}const n0e={id:-1,title:"",addedToTabSelection:!1,isInSearchResult:!0,sourceType:null,active:!1,highlighted:!1,pinned:!1,selected:!1,incognito:!1,autoDiscardable:!0,discarded:!1,index:-1,windowId:-1,groupId:-1};function r0e(t={}){return{...n0e,...t}}const Cg=20,o0e=r0e({sourceType:null});function i0e(t,e){const{t:n}=xe(),r=m.useMemo(()=>t.filter(l=>l.isInSearchResult),[t]),o=m.useMemo(()=>{const a=Math.min(r.length,Cg);return e&&a>1&&a<Cg?{...o0e,title:n("composer.multiTabs.allTabs",{count:a}),isInSearchResult:!0}:null},[r.length,n,e]),i=m.useCallback(()=>t.map(a=>({...a,addedToTabSelection:r.slice(0,Cg).some(l=>l.id===a.id)})),[r,t]),s=m.useMemo(()=>o?[o,...r]:r,[r,o]);return{appearedTabs:r,getUpdatedTabsBySpecialTab:i,specialTab:o,appearedTabsWithSpecialTab:s}}function C8(t,e){let n=null;return(...r)=>{n!==null&&window.clearTimeout(n),n=window.setTimeout(()=>t(...r),e)}}const s0e=300,cMe=2e3;function a0e(t,e=1e3){const n=m.useRef();return n.current=t,m.useMemo(()=>C8((...i)=>{var s;(s=n.current)==null||s.call(n,...i)},e),[e])}function c0e(t){const e=m.useRef(0),n=m.useCallback(async()=>{const r=window.innerHeight;r!==e.current&&(e.current=r,await t(r))},[t]);cp(n,{initialize:!0},document.documentElement)}const l0e=.2,u0e=.2,d0e=594,h0e=46,f0e=360,p0e=240;function m0e(t,e){const n=new Set(t.map(o=>o.id)),r=new Set(e.map(o=>o.id));if(n.size!==r.size)return!0;for(const o of n)if(!r.has(o))return!0;return!1}function g0e(){wt.emit("edge:try-grow-content-height",d0e)}function v0e(t){const e=new Map;for(const n of t)n.id&&n.addedToTabSelection&&e.set(n.id.toString(),n);return e}function y0e(t){const{styles:e,onRef:n,onSave:r,onClose:o=()=>{},outsideClickElements:i=[],originElement:s,mode:a=sy.ADD}=t,[l,u]=Ze(Ra),h=m.useRef(new Map(l)),f=m.useRef(null),[p,g]=m.useState([]),[v,y]=m.useState(0),b=m.useRef(null),{t:C}=xe(),S=m.useDeferredValue([...p]),I=x(jb),{appearedTabsWithSpecialTab:E,getUpdatedTabsBySpecialTab:T}=i0e(S,I),[w,A]=m.useState(!1),_=h.current,[L,N]=m.useState(0),[K,q]=m.useState(!1),ae=m.useCallback(()=>{if(f.current&&s&&s.current){const ue=s.current.getBoundingClientRect();N(ue.top-h0e)}},[N,s]);c0e(()=>{g0e(),ae()}),m.useEffect(()=>{q(!1);async function ue(){const{tabs:Me}=await zue.run({});if(Me&&Me.length>0){const Ye=[];for(const le of Me)le.id&&Ye.push({...le,addedToTabSelection:_.has(le.id.toString()),isInSearchResult:!0,sourceType:"opened"});g(Ye)}}ue().catch(console.error).finally(()=>{q(!0)})},[_]),m.useLayoutEffect(()=>{f.current&&K&&ae()},[ae,K]);const O=m.useMemo(()=>p.filter(ue=>ue.addedToTabSelection),[p]),W=m.useMemo(()=>O.length>Cg,[O]),te=m.useCallback(ue=>{n==null||n(ue),f.current=ue},[n]),D=m.useCallback(ue=>{const Me=v0e(ue);u(Me);const Ye=Array.from(Me.values()),le=m0e(Ye,[..._.values()]);r==null||r(Ye,le)},[_,r,u]),G=m.useCallback(()=>{W||D(p)},[W,D,p]),re=m.useCallback(ue=>{g(Me=>Me.map(le=>le.id===ue.id?ue:le))},[]),J=a0e(m.useCallback(ue=>{g(Me=>Me.map(Ye=>({...Ye,isInSearchResult:Ye.title?Ye.title.toLowerCase().includes(ue.toLowerCase().trim()):!0})))},[]),s0e),ne=m.useCallback(ue=>{y(Me=>ue==="up"?Me>0?Me-1:E.length-1:Me<E.length-1?Me+1:0)},[y,E]);m.useEffect(()=>{b.current&&v>=0&&b.current.scrollIntoView({block:"nearest"})},[v,b]);const X=m.useCallback(ue=>{let Me=[];v8(ue)?Me=T():Me=p.map(Ye=>Ye.id===ue.id?{...ue,addedToTabSelection:!0}:Ye),g(Me),D(Me)},[T,D,p]),Ie=m.useCallback(ue=>{var Me;if(["ArrowUp","ArrowDown"].includes(ue.code))ue.preventDefault(),ne(ue.code==="ArrowUp"?"up":"down");else if(ue.code==="Enter"){ue.preventDefault();const Ye=E[v];Ye&&X({...Ye,addedToTabSelection:!0})}else ue.code==="Tab"&&((Me=f.current)==null||Me.focus())},[ne,v,E,X]);m.useEffect(()=>(wt.on("multi-tabs:search",J),wt.on("multi-tabs:key-down",Ie),()=>{wt.off("multi-tabs:search",J),wt.off("multi-tabs:key-down",Ie)}),[Ie,J]),Na({onOutsideEvent:o,elements:[f,...i],invokeOnce:!1,shouldAttachListeners:w}),m.useEffect(()=>{A(!0)},[]);const Ce=m.useMemo(()=>I?p0e:f0e,[I]),be=m.useMemo(()=>({maxHeight:`${L>Ce?Ce:L}px`,...e}),[L,Ce,e]);return d.jsxs(Ll.Motion,{className:Be(jt.modal,"pointer-events-auto relative z-40 box-border flex max-h-[400px] w-full flex-col rounded-b-6xl rounded-t-4xl border border-white p-4 shadow-lg backdrop-blur-2xl backdrop-saturate-150 contrast-more:border-2 dark:border-white/10","bg-gradient-composer-tabs-menu-light dark:bg-gradient-composer-tabs-menu-dark","bg-blend-normal","forced-colors:bg-stroke-150 dark:forced-colors:bg-midnight-850","contrast-more:bg-stroke-150 dark:contrast-more:bg-midnight-850",I?"px-4 pb-1.5 pt-4":"p-4"),style:be,tabbable:!0,tabIndex:0,ref:te,"data-testid":"composer-multi-tabs-menu",initial:"start",animate:"end",variants:{start:ot,end:{...Lt,transition:{duration:l0e,delay:u0e}}},children:[d.jsx(e0e,{mode:a,onClose:o}),!I&&d.jsx(t0e,{onChange:J}),d.jsx(XSe,{highlightedIndex:v,onFocus:y,activeMenuItemRef:b,onMenuItemClick:I?X:re,tabs:E,emptyStateText:p.length===0?C("composer.multiTabs.noTabsOpen"):C("composer.multiTabs.noTabsFound")}),!I&&d.jsx(ZSe,{mode:a,disabled:W,onClick:G})]})}const S8=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{id:"Shape",d:"M2 6.25C2 4.45507 3.45507 3 5.25 3H18.75C20.5449 3 22 4.45507 22 6.25V12H20.5V6.25C20.5 5.2835 19.7165 4.5 18.75 4.5H5.25C4.2835 4.5 3.5 5.2835 3.5 6.25V15.75C3.5 16.7165 4.2835 17.5 5.25 17.5H11V19H5.25C3.45507 19 2 17.5449 2 15.75V6.25ZM14 13C12.8954 13 12 13.8954 12 15V20C12 21.1046 12.8954 22 14 22H21C22.1046 22 23 21.1046 23 20V15C23 13.8954 22.1046 13 21 13H14Z",fill:"currentColor"})),lMe=Object.freeze(Object.defineProperty({__proto__:null,default:S8},Symbol.toStringTag,{value:"Module"}));function b0e(t){const{onClick:e}=t,{t:n}=xe();return d.jsx(Zo,{data:{title:n("videoCard.pictureInPicture.miniPlayer"),testId:"trigger-picture-in-picture",isVisible:!0,onClick:e},children:d.jsx(S8,{className:"size-6","aria-hidden":!0})})}function C0e(t){const{title:e,onClick:n,appearDelay:r,appearDuration:o,voiceAvailabilityStatus:i,payflowSkuType:s}=t,a=Wb(),l=x(Sn);return m.useEffect(()=>{l!=null&&l.accountType&&U.trackEvent({name:"interaction",data:{eventName:"payflowEntryImpression",eventInfo_loginProvider:l.accountType,eventInfo_actionButton:"GetCopilotPro",eventInfo_payflowEntryPoint:"VoiceLimit",eventInfo_payflowType:a?"ProSubPaywall":"UniPux",eventInfo_payflowSkuType:s,eventInfo_upsellReason:i,eventInfo_upsellEntryStyle:"Button"}})},[i,s,a,l==null?void 0:l.accountType]),d.jsx(mA,{className:"mx-2",title:e,onClick:n,appearDelay:r,appearDuration:o})}const S0e="https://content.lifecycle.office.net/dime/v1/dime.js";function I0e(){return new Promise((t,e)=>{const n=document.createElement("script");n.src=S0e,n.type="text/javascript",n.async=!0,n.onload=()=>{t()},n.onerror=()=>{e(new Error("Failed to load Dime script"))},document.head.appendChild(n)})}const VP=new gl(I0e);async function E0e({language:t,market:e,sessionId:n}){var r;try{const[o]=await Promise.all([Vue(),VP.get()]);return new window.Dime({language:t,market:e,sessionId:n,partnerId:"cmc",authHint:o==null?void 0:o.username,userInfo:{puid:(r=o==null?void 0:o.idTokenClaims)==null?void 0:r.puid}})}catch(o){return VP.reset(),console.log("Failed to load Dime script",o),null}}const N0=new gl(t=>E0e(t));var Wu,up;class T0e{constructor(){on(this,Wu,li("pfcid")??crypto.randomUUID());on(this,up);j(this,"ensureDime",async({language:e,market:n})=>(e!==he(this,up)&&N0.reset(),Ft(this,up,e),N0.get({language:e,market:n,sessionId:he(this,Wu)})));j(this,"overrideSessionId",e=>{N0.reset(),Ft(this,Wu,e)})}get sessionId(){return he(this,Wu)}}Wu=new WeakMap,up=new WeakMap;const P0=new T0e;function M0(t){return t instanceof Error?{errorCode:t.toString(),errorDetails:t.message}:{errorCode:"unknown",errorDetails:String(t)}}function Xd(t,e,n){const r={eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId};let o;switch(t){case"payflowEnter":o={eventName:"payflowEnter",...r,eventInfo_upsellEntryStyle:(n==null?void 0:n.eventInfo_upsellEntryStyle)||"Banner"};break;case"payflowLoginClick":o={eventName:"payflowLoginClick",...r};break;case"dimeCheckoutRendering":o={eventName:"dimeCheckoutRendering",...r};break;case"dimeCheckoutSuccess":o={eventName:"dimeCheckoutSuccess",...r};break;case"dimeCheckoutClosed":o={eventName:"dimeCheckoutClosed",...r};break;case"dimeCheckoutError":o={eventName:"dimeCheckoutError",eventInfo_errorCode:(n==null?void 0:n.eventInfo_errorCode)??"",eventInfo_errorDetails:(n==null?void 0:n.eventInfo_errorDetails)??"",...r};break;default:o={eventName:"unknown",...r};break}U.trackEvent({name:"interaction",data:o})}function w0e(t){Xd("payflowEnter",t,{eventInfo_upsellEntryStyle:"Banner"})}function uMe(t){Xd("payflowLoginClick",t)}function _0e(t){Xd("dimeCheckoutRendering",t)}function A0e(t){Xd("dimeCheckoutSuccess",t)}function k0e(t){Xd("dimeCheckoutClosed",t)}function dMe(t){U.trackEvent({name:"interaction",data:{eventName:"manageSubPageActionClick",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription,eventInfo_actionTarget:t.actionTarget}})}function hMe(t){U.trackEvent({name:"interaction",data:{eventName:"manageSubFREShown",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription}})}function fMe(t){U.trackEvent({name:"interaction",data:{eventName:"manageSubPageLoaded",eventInfo_loginProvider:t.loginProvider,eventInfo_curatedSubscription:t.curatedSubscription,eventInfo_willShowFre:t.willShowFre,eventInfo_willShowProDeprecation:t.willShowProDeprecation,eventInfo_upgradeButtonShown:t.upgradeButtonShown,eventInfo_upgradeButtonTarget:t.upgradeButtonTarget,eventInfo_manageButtonShown:t.manageButtonShown,eventInfo_manageButtonTarget:t.manageButtonTarget,eventInfo_cancelButtonShown:t.cancelButtonShown,eventInfo_cancelButtonTarget:t.cancelButtonTarget,eventInfo_proAutoRenewOn:t.proAutoRenewOn}})}function O0(t){Xd("dimeCheckoutError",t,{eventInfo_errorCode:t.errorCode,eventInfo_errorDetails:t.errorDetails})}const I8="https://go.microsoft.com/fwlink/?linkid=2281226&client=cmc&ocid=cmme6wdx8nv",x0e="sapphire://payment",$P="cmme6wdx8nv",oE="cmmquw3utd3",R0e="cmmjacjzqcs";function E8(t){const{urlParams:e}=me.instance().config().proSubscription;if(!e)return I8;const{client:n}=e,{linkid:r,ocid:o,language:i,market:s}=t,a=new URL("https://go.microsoft.com/fwlink/");return a.searchParams.append("linkid",r),a.searchParams.append("client",n),a.searchParams.append("ocid",o),s&&a.searchParams.append("market",s),i&&a.searchParams.append("language",i),a.toString()}function T8(t,e){var o,i;const{urlParams:n}=me.instance().config().proSubscription;if(!n)return $P;const{ocids:r}=n;return(e?(o=r[t])==null?void 0:o.freeTrial:(i=r[t])==null?void 0:i.buy)??$P}function GP(t,e,n,r){var u;const{urlParams:o}=me.instance().config().proSubscription;if(!o)return I8;const{ocids:i}=o,s=T8(t,e),a=r??((u=i[t])==null?void 0:u.market);return E8({linkid:e?"2243582":"2281226",ocid:s,language:n,market:a})}function N0e(t,e,n){return E8({linkid:"2281226",ocid:t??R0e,language:e,market:n})}function P0e(t){const{ocid:e}=t,n=new URL("https://aka.ms/AA84f4p");return n.searchParams.append("ocid",e),n.toString()}function M0e(t){var r;const{m365UrlParams:e}=me.instance().config().proSubscription;if(!e)return oE;const{ocids:n}=e;return((r=n[t])==null?void 0:r.buy)??oE}const O0e="https://account.microsoft.com/services/copilot/details",L0e="https://account.microsoft.com/services/microsoft365/details",pMe="https://account.microsoft.com/";function mMe({entryPoint:t,isPro:e}){const{manageRefId:n}=me.instance().config().proSubscription,r=`copilot.${n}.${t}`,o=new URL(e?O0e:L0e);return o.searchParams.append("ref",r),o.hash="billing",o.toString()}function KP(t){me.instance().config().subscribeInNewWindow?wl(t):Lp(t)}function ay(t){const{payflowEntryPoint:e,skuType:n,upsellReason:r,beforeNavigate:o,entryStyle:i,preferPremium:s=!1,enableDimePreload:a=!1}=t,l=$t(),u=gi(),h=se("pro-sub-dime"),f=se("cmc-m365-sku"),p=h||f,g=Wb(),v=me.instance().config().proSubscription.enabled,y=x($y),b=x(Cr),{i18n:{resolvedLanguage:C}}=xe(),S=x(Sn),I=ve(Zr),E=x(Os),T=x(Y5),w=x(Q5),{shouldRedirectMobile:A,redirectMobileSource:_}=bX(w??null),L=ve(N5),N=m.useMemo(()=>f?vX(T,s):"gopremium",[f,s,T]);m.useEffect(()=>{p&&a&&N&&(async()=>{if((await $I.get()).supportsPwBBroker()){const J=await P0.ensureDime({language:C??"en-US",market:b});return J==null?void 0:J.preload({experiences:[N]})}return Promise.resolve()})()},[C,b,N,p,a]);const K=m.useMemo(()=>f?M0e(e):h?T8(e,y):oE,[f,e,h,y]),q=m.useCallback(()=>{switch(e){case"VoiceLimit":return nL()?x0e:v?GP(e,y,"",b):"";default:return GP(e,y,"",b)}},[v,y,e,b]),ae=m.useCallback(async()=>{const G=crypto.randomUUID();if(U.trackEvent({name:"interaction",data:{eventName:"payflowEnter",eventInfo_payflowCorrelationId:G,eventInfo_loginProvider:(S==null?void 0:S.accountType)??"unknown",eventInfo_payflowEntryPoint:e,eventInfo_payflowType:g?"ProSubPaywall":"UniPux",eventInfo_payflowSkuType:n,eventInfo_upsellReason:r,eventInfo_upsellEntryStyle:i}}),g)o&&typeof o=="function"&&o(),await u({to:`/pro/subscribe?payflow-correlationId=${G}&entry-point=${e}`,from:l});else{const re=q();KP(re)}},[i,g,l,e,n,r,S==null?void 0:S.accountType,o,q,u]),O=m.useCallback(()=>{const G=f?P0e({ocid:K}):N0e(K,"",b);KP(G)},[f,K,b]),W=m.useMemo(()=>({payflowEntryPoint:e,upsellReason:r??"unknown",loginProvider:(S==null?void 0:S.accountType)??"unknown",curatedSubscription:(w==null?void 0:w.tier)??"unknown",campaignId:K,dimeMarket:b??"unknown",correlationId:P0.sessionId}),[e,r,S==null?void 0:S.accountType,w==null?void 0:w.tier,K,b]),te=m.useCallback(async G=>{const re={...W,payflowInstanceId:G};w0e({...re});const J=await P0.ensureDime({language:CX(C??"en-US"),market:b});if(!N)throw new Error("No dime experience available");if(J)try{_0e({...re}),(await J.launch({experience:N,theme:E??"light",campaignId:K},()=>{A0e({...re})})).status==="Success"?Dp():k0e({...re})}catch(ne){O0({...re,...M0(ne)}),O()}else O0({...re,...M0(new Error("Dime not a valid instance"))}),O()},[C,b,E,N,K,W,O]);return{handleSubscription:m.useCallback(async()=>{if(f&&A&&_!==null){L({source:_,entryStyle:i,upsellReason:r,payflowEntryPoint:e});return}if((!g||p)&&(S==null?void 0:S.provider)==="auth0"){I("upsell-microsoft-account-for-pro-subscription");return}const G=await $I.get();if(p&&G.supportsPwBBroker()){const re=crypto.randomUUID();try{await te(re)}catch(J){O0({...W,...M0(J),payflowInstanceId:re}),O()}}else ae()},[f,A,_,g,p,S==null?void 0:S.provider,L,i,r,e,I,te,W,O,ae])}}function w8(t){const{provider:e="microsoft",scenario:n,from:r}=t,o=rl(),i=gi(),{login:s}=Wd();return m.useCallback(async()=>{if(n&&gn({source:"signin",scenario:n}),o){await i({from:r,to:"/login"});return}await s({provider:e})},[r,i,o,s,e,n])}function D0e(){const{t}=xe(),e=x(rf),n=Sr(),r=x(Gy),o=me.instance().config().proSubscription.enabled,i=x($y),s=o&&i&&!r,a=rl(),l=x(Sn),u=ve(Zr),h=w8({scenario:"voice",from:"/"}),{handleSubscription:f}=ay({payflowEntryPoint:"VoiceLimit",skuType:s?"FreeTrial":"1Mo-Paid",upsellReason:e,entryStyle:"Button"});if(m.useEffect(()=>{r&&(l!=null&&l.accountType)&&U.trackEvent({name:"interaction",data:{eventName:"payflowHiddenEntryImpressionForTeenUser",eventInfo_loginProvider:l.accountType,eventInfo_actionButton:"GetCopilotPro",eventInfo_payflowEntryPoint:"VoiceLimit",eventInfo_payflowType:"UniPux",eventInfo_payflowSkuType:s?"FreeTrial":"1Mo-Paid",eventInfo_upsellReason:e}})},[e,r,n,s,l==null?void 0:l.accountType]),!r)return n?d.jsx(C0e,{voiceAvailabilityStatus:e,payflowSkuType:s?"FreeTrial":"1Mo-Paid",title:t(s?"voice.freeTrialToPro":"voice.v2.subscribeToPro"),onClick:async()=>{if(a&&(l==null?void 0:l.provider)==="auth0"){u("upsell-microsoft-account-for-pro-subscription");return}gn({source:"subscribeCopilotPro",scenario:"voice"}),await f()}}):d.jsx(mA,{className:"mx-2",title:t("voice.signUpOrLogin"),onClick:h})}const j0e="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/settings-B9ohU3kQ.svg",_8=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6.74707 3.99954H10.2113C10.6255 3.99954 10.9613 4.33533 10.9613 4.74954C10.9613 5.12924 10.6791 5.44303 10.313 5.49269L10.2113 5.49954H6.74707C5.55621 5.49954 4.58143 6.4247 4.50226 7.59549L4.49707 7.74954V17.2495C4.49707 18.4404 5.42223 19.4152 6.59302 19.4944L6.74707 19.4995H16.2478C17.4387 19.4995 18.4134 18.5744 18.4926 17.4036L18.4978 17.2495V16.7518C18.4978 16.3375 18.8336 16.0018 19.2478 16.0018C19.6275 16.0018 19.9413 16.2839 19.991 16.65L19.9978 16.7518V17.2495C19.9978 19.2538 18.4254 20.8908 16.447 20.9943L16.2478 20.9995H6.74707C4.74281 20.9995 3.1058 19.4272 3.00227 17.4487L2.99707 17.2495V7.74954C2.99707 5.74528 4.56943 4.10827 6.54791 4.00474L6.74707 3.99954H10.2113H6.74707ZM14.5011 6.5194V3.74954C14.5011 3.12557 15.2078 2.78949 15.688 3.13934L15.7702 3.20828L21.7648 8.95828C22.0446 9.22663 22.0701 9.65765 21.8412 9.95561L21.7649 10.0407L15.7703 15.7926C15.32 16.2246 14.5881 15.9472 14.5082 15.3584L14.5011 15.2514V12.5261L14.1576 12.5562C11.7579 12.8065 9.45784 13.8874 7.24302 15.8169C6.72391 16.2691 5.92078 15.8415 6.00616 15.1584C6.67094 9.83884 9.45282 6.90684 14.2017 6.53904L14.5011 6.5194V3.74954V6.5194ZM16.0011 5.50818V7.24954C16.0011 7.66375 15.6653 7.99954 15.2511 7.99954C11.3777 7.99954 8.97704 9.67567 7.9398 13.1567L7.86074 13.4353L8.21293 13.1985C10.4494 11.7367 12.7988 10.9995 15.2511 10.9995C15.6308 10.9995 15.9446 11.2817 15.9942 11.6478L16.0011 11.7495V13.4924L20.1623 9.49963L16.0011 5.50818Z",fill:"currentColor"})),gMe=Object.freeze(Object.defineProperty({__proto__:null,default:_8},Symbol.toStringTag,{value:"Module"}));function bA(){const t=x(ide),e=se("edge-multi-tabs-reverse");return t&&!e}const U0e=at();function F0e(){const t=bA(),[e,n]=m.useState("add"),[r,o]=m.useState(!1),[i,s]=m.useState(!1),[a,l]=m.useState(!1),[u,h]=Ze(jb),f=ve(Ra),{refs:p,floatingStyles:g}=tO({placement:"top-start",strategy:"absolute",whileElementsMounted:wd,middleware:[_d(()=>({mainAxis:6,crossAxis:0})),Ad({padding:12}),eO({apply({rects:I,elements:E}){Object.assign(E.floating.style,{width:`${I.reference.width}px`})}})]}),v=m.useCallback(async I=>{const{isTrigger:E,keyword:T}=I;h(E),E&&(wt.emit("multi-tabs:search",T),n("add")),s(E)},[h,s]),y=m.useCallback(()=>{u&&(h(!1),wt.emit("mention:cancel","ignore")),s(!1)},[u,h]),b=m.useCallback(()=>{u&&(wt.emit("mention:cancel","remove"),h(!1)),s(!1),l(!0),o(!0),wt.emit("edge:maybe-fetch-page-context","onSaveMultiTabs")},[u,h]),C=m.useCallback(I=>t&&i&&u?(wt.emit("multi-tabs:key-down",I),!0):!1,[u,t,i]),S=()=>u&&i&&t;return m.useEffect(()=>{const I=U0e.sub(it,()=>{s(!1),l(!1),h(!1),f(new Map)});return()=>{I()}},[f,h]),m.useEffect(()=>{const I=()=>{o(!1)};return wt.on("edge:multi-tabs-context-fetched-complete",I),()=>{wt.off("edge:multi-tabs-context-fetched-complete",I)}},[]),{isMultiTabsMenuExpanded:i,floatingStyles:g,edgeTabMenuRefs:p,setIsMultiTabsMenuExpanded:s,isShowMultiTabsPreviewCard:a,setIsShowMultiTabsPreviewCard:l,handleMentionEvent:v,isMentionTriggered:u,handleMultiTabsMenuSaveBtnEvent:b,handleMultiTabsMenuCloseBtnEvent:y,handleUserInputEnterEvent:S,handleUserInputKeydownEvent:C,multiTabsMenuMode:e,setMultiTabsMenuMode:n,isFetchingTabsPageContext:r}}const B0e=at();function A8(t){B0e.set(Ic,t)}function H0e(){const t=Hp(),e=x(B5),[n,r]=Ze(Ip);m.useEffect(()=>{t&&!n&&r(e)},[t,e,n,r])}function z0e(){const{contentPageType:t}=Us(),e=x(Up),n=m.useCallback(()=>{nt({pageName:t,source:"streamlinedComposer",scenario:"clickComposer",customData:JSON.stringify({isChatSidePaneOpened:e})})},[t,e]),r=m.useCallback(()=>{nt({pageName:t,source:"newsComposerInput",scenario:"newsClickNavigateToChat",customData:JSON.stringify({isChatSidePaneOpened:e})})},[t,e]);return{trackConsumptionPageComposerClick:n,trackConsumptionPageComposerSubmit:r}}const k8=P(0),x8=P(),R8=P(),vMe=P({}),yMe=P({lastPosition:0,wasPlaying:!1}),Zd="daily";function bMe(){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"personalizeButton",eventInfo_clickScenario:"",eventInfo_pageName:Zd}})}function CMe(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Select",eventInfo_clickScenario:t,eventInfo_pageName:Zd}})}function SMe(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_UnSelect",eventInfo_clickScenario:t,eventInfo_pageName:Zd}})}function IMe(t){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Save",eventInfo_clickScenario:t.join(","),eventInfo_pageName:Zd}})}function EMe(){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Later",eventInfo_clickScenario:"",eventInfo_pageName:Zd}})}const iE={Podcast:"podcastPlayer",DailyBriefing:"dailyBriefingPlayer"},If={Daily:Zd,Podcast:"podcast"},Qs={Skip:"skip",Rewind:"rewind",Play:"play",Pause:"pause",Next:"next",Previous:"previous",Playback:"playback",Mute:"mute",Unmute:"unmute",Expand:"expand",Collapse:"collapse"};function ec(t,e,n){nt({source:t,pageName:t===iE.Podcast?If.Podcast:If.Daily,scenario:e,customData:n})}function N8(t){const{url:e,podcastId:n,schema:r,includeTranscripts:o=!1}=t;return $n(e,r,{query:{podcastId:n,includeTranscripts:String(o)}}).then(i=>i.data)}function V0e(t,e,n,r,o){return r&&n?{url:`/sharing/podcasts/${n}`,schema:Hg}:t?e?{url:`/podcasts/${e}/${t}`,schema:Hg}:{url:"/daily-briefing",podcastId:t,includeTranscripts:o,schema:t5}:null}function $0e(){const{podcastId:t,podcastType:e,shareId:n}=AE({strict:!1}),r=x(x8),o=t??r,i=Vb(),s=!!t||i,a=se("db-transcript"),l=ve(R8),{data:u,isLoading:h,error:f}=Il(V0e(o,e,n,s,a),N8);m.useEffect(()=>{if(u&&s){const v=Hg.parse(u);l(v.podcastId)}},[u,s,l]);const p=()=>s?e?`${If.Podcast}.${e}`:If.Podcast:If.Daily;if(u&&s){const v=Hg.parse(u),{isAvailable:y,podcastId:b,chapters:C,playback:{positionInSeconds:S,chapterId:I}}=v,E=n?`/sharing/podcasts/${n}/Files`:`/podcasts/${e}/${b}/Files`,T=C.map(({id:_,title:L,image:N,audio:K})=>({id:_,title:L,image:{landscape:{...N.landscape,url:`${E}/${N.landscape.name}`},portrait:{...N.portrait,url:`${E}/${N.portrait.name}`}},audio:K})),w={isAvailable:y,podcastId:b,chapters:T.map(_=>({..._,audio:{default:{url:`${E}/${_.audio.name}`,duration:_.audio.duration,transcript:null}},transitionMusic:null,sources:[]})),playback:{position:S,chapterId:I}},A={...v,chapters:T};return{data:w,podcastData:A,isPodcast:s,isLoading:h,error:f,pageImpressionKey:p()}}return{data:!s&&u?t5.parse(u):void 0,isPodcast:s,isLoading:h,error:f,pageImpressionKey:p()}}function TMe(){const{data:t}=Il({url:"/daily-briefing/topics",schema:e5},N8);return{data:t}}async function wMe(t,e){await Ur({path:"/daily-briefing/topics/unfollow",args:{body:{ids:e}}}),await Ur({path:"/daily-briefing/topics/follow",args:{body:{ids:t}}})}const G0e=1;function K0e(){const t=gi(),e=ve(Zr),n=ve(x8),[r,o]=Ze(k8),{firstStoryId:i}=tH({strict:!1}),s=se("db-autoplay"),a=m.useCallback(async()=>{await t({from:"/daily",to:"/"}),n(void 0),e(null)},[n,e,t]),l=m.useCallback(async f=>{if(s&&i){const p=f.split(",");if(p.length>=2){p[G0e]=i;const g=p.join(",");n(g)}else n(f)}else n(f);o(0),e("daily-briefing-player"),await t({from:"/",to:"/daily",search:{firstStoryId:i}})},[n,s,i,o,e,t]),u=m.useCallback(async()=>{o(r),await t({from:"/daily",to:"/topic-selection"}),e(null)},[e,o,r,t]),h=m.useCallback(async()=>{o(r),e("daily-briefing-player"),await t({from:"/topic-selection",to:"/daily"})},[r,o,e,t]);return{navigateToDailyBriefing:l,navigateToTopicSelection:u,exitDailyBriefing:a,returnToDailyBriefing:h,currentChapterIndex:r}}function q0e({media:t,thresholds:e,key:n}){const r=m.useRef(0),o=m.useRef([]),i=m.useRef(new Set);return m.useEffect(()=>{o.current=(e==null?void 0:e.sort((s,a)=>s.seconds-a.seconds))??[]},[e]),m.useEffect(()=>{r.current=0,i.current=new Set;let s=null;if(!t)return()=>{};function a(){s=performance.now()}function l(p){if(s!==null){const g=(performance.now()-s)/1e3;r.current+=g,s=p?performance.now():null,f()}}function u(){l(!1)}function h(){l(!0)}const f=()=>{for(let p=0;p<o.current.length;p+=1){const g=o.current[p];g&&r.current>=g.seconds&&!i.current.has(p)&&(i.current.add(p),g.callback())}};return t.addEventListener("playing",a),t.addEventListener("pause",u),t.addEventListener("ended",u),t.addEventListener("timeupdate",h),()=>{t.removeEventListener("playing",a),t.removeEventListener("pause",u),t.removeEventListener("ended",u),t.removeEventListener("timeupdate",h)}},[t,n]),{totalTimePlayedRef:r}}function Ef(t){if(!t)return NaN;const e=t.split(":");if(e.length!==2)return NaN;const[n,r]=e,o=Number(n),i=Number(r);return o<0||i<0||i>=60?NaN:o*60+i}function W0e(t,e,n,r){var o,i;return t===n.length-1&&e===r.length-1?1/0:e===r.length-1?Ef((o=n[t+1])==null?void 0:o.startTime):Ef((i=r[e+1])==null?void 0:i.startTime)}function Y0e(t){let e=-1;return t.map((r,o,i)=>{var s;return{...r,startTime:Ef(r.startTime),endTime:o<i.length-1?Ef((s=i[o+1])==null?void 0:s.startTime):1/0,words:r.words.map((a,l,u)=>(e+=1,{...a,startTime:Ef(a.startTime),endTime:W0e(o,l,i,u),index:e}))}})}function P8(t,e,n){return{DailyBriefing:`${e}|${n}`,Podcast:e}[t]}function qP(t,e,n){const r=P8(t,e,n);r&&Ur({path:`/media/${t}/${r}/playback/completed`,args:{}}).catch(o=>{lL(o)})}function Q0e(t,e,n,r){const o=P8(t,n,r);o&&Ur({path:`/media/${t}/${o}/playback`,args:{options:{method:"PATCH"},body:{positionInSeconds:e}}}).catch(i=>{lL(i)})}function L0(t,e){const n=Object.keys(e);if(n.length!==0)return typeof t<"u"&&n.includes(t)?e[t]:Object.values(e)[0]}const J0e=5,X0e=5e3;function M8(){var Q,fe;const{exitDailyBriefing:t}=K0e(),{data:e,isPodcast:n,pageImpressionKey:r}=$0e(),o=n?iE.Podcast:iE.DailyBriefing,i=x(R8),s=x(Cp),a=m.useMemo(()=>e?n?e.chapters.map(z=>{var Ee;return[((Ee=z.audio.default)==null?void 0:Ee.duration)??0]}):e.chapters.map(z=>{var Ee;const Z=[((Ee=L0(s,z.audio))==null?void 0:Ee.duration)??0];return z.transitionMusic&&Z.push(z.transitionMusic.duration),Z}):[],[e,n,s]),[l,u]=Ze(k8),h=m.useRef(null),[f,p]=m.useState(!1),g=l<a.length-1,v=l>0,y=m.useRef(performance.now()),b=m.useRef(performance.now()),C=m.useMemo(()=>{var z;return(z=e==null?void 0:e.chapters[l])!=null&&z.id?e.chapters[l].id:i&&i.split(",")[l]},[e==null?void 0:e.chapters,l,i]),S=m.useMemo(()=>e?n?e.chapters.map(z=>{var Z;return[((Z=z.audio.default)==null?void 0:Z.url)??""]}):e.chapters.map(z=>{var Ee;const Z=[((Ee=L0(s,z.audio))==null?void 0:Ee.url)??""];return z.transitionMusic&&Z.push(z.transitionMusic.url),Z}):[],[e,s,n]),[I,E]=m.useState(0),[T,w]=m.useState([]),[A,_]=m.useState(null),L=JSON.stringify({podcastId:i,eventInfo_chapterId:(Q=e==null?void 0:e.chapters[l])==null?void 0:Q.id,eventInfo_chapterPlayDuration:performance.now()-y.current}),[N,K]=Ze(qhe),q=m.useCallback(()=>{K(z=>{const Z=!z,Ee=Z?Qs.Mute:Qs.Unmute;return ec(o,Ee,L),Z})},[L,o,K]);q0e({media:A,key:C,thresholds:[{seconds:J0e,callback:()=>{if(C&&!T.includes(C)){try{Ur({path:`/daily-briefing/${C}/viewed`,args:{analytics:{anonymousPath:"/daily-briefing/*/viewed"}}})}catch{}w([...T,C])}}}]}),m.useEffect(()=>{if(!A||!f)return;const z=setInterval(()=>{const Z=A.currentTime;Q0e("DailyBriefing",Z,i,C)},X0e);return()=>{clearInterval(z)}},[A,f,C,i]);function ae(){var z;p(!0),(z=h.current)==null||z.playAnimation(),A==null||A.play(),ec(o,Qs.Play,L)}function O(){var z;p(!1),(z=h.current)==null||z.pauseAnimation(),A==null||A.pause(),ec(o,Qs.Pause,L)}function W(z){if(A){const Z=Math.min(A.currentTime+z,A.duration);A.currentTime=Z,ec(o,Qs.Skip,JSON.stringify({seconds:z}))}}function te(z){if(A){const Z=Math.max(A.currentTime-z,0);A.currentTime=Z,ec(o,Qs.Rewind,JSON.stringify({seconds:z}))}}function D(){var z,Z,Ee;qP("DailyBriefing",i,C),e!=null&&e.chapters&&U.trackEvent({name:"system",data:{eventName:"chapterPlayDuration",eventInfo_podcastId:i,eventInfo_chapterIndex:l,eventInfo_isCompleted:l===e.chapters.length-1,eventInfo_publisherName:(Z=(z=e.chapters[l])==null?void 0:z.sources)==null?void 0:Z.map(tt=>tt.publisherName).join(","),eventInfo_impressionElement:r,eventInfo_customData:JSON.stringify({eventInfo_chapterId:(Ee=e.chapters[l])==null?void 0:Ee.id,eventInfo_chapterPlayDuration:performance.now()-y.current})}})}function G(){qP("Podcast",i),U.trackEvent({name:"system",data:{eventName:"podcastPlayDuration",eventInfo_isCompleted:!0,eventInfo_podcastId:i,eventInfo_podcastPlayDuration:performance.now()-b.current,eventInfo_impressionElement:r}})}function re(){A&&(A.currentTime=0)}function J(z){D(),y.current=performance.now(),re(),B(-1),E(0),u(z)}function ne(){g&&(J(l+1),ec(o,Qs.Next,L))}function X(){v&&(J(l-1),ec(o,Qs.Previous,L))}function Ie(z){A&&(A.playbackRate=z/100)}function Ce(z){const Ee=(RC.indexOf(z)+1)%RC.length;return RC[Ee]??pp}function be(){p(!0);const z=S[l]??[];I<z.length-1?E(Z=>Z+1):z.length-1===I&&g?ne():(Me(),t())}function ue(){y.current=performance.now(),b.current=performance.now()}function Me(){n?G():D()}const Ye=se("db-transcript"),le=se("db-transcript-word"),we=m.useMemo(()=>{if(!Ye)return[];const z=e==null?void 0:e.chapters[l];if(!z)return[];const Z=L0(s,z.audio);return Y0e((Z==null?void 0:Z.transcript)??[])},[Ye,s,e==null?void 0:e.chapters,l]),Ke=m.useMemo(()=>we.flatMap(z=>z.words),[we]),k=m.useMemo(()=>a[l]??[],[a,l]),B=ve(Whe),ge=m.useCallback(z=>{if(le){const Ee=Ke.find(tt=>z>=tt.startTime&&z<tt.endTime);return(Ee==null?void 0:Ee.index)??-1}return we.findIndex(Ee=>z>=Ee.startTime&&z<Ee.endTime)},[we,Ke,le]),M=m.useCallback(z=>{const Z=z.currentTarget;let{currentTime:Ee}=Z;for(let ht=0;ht<I;ht+=1){const mt=k[ht];mt&&(Ee+=mt)}if(Ee===0)return;const tt=ge(Ee);B(tt)},[k,I,ge,B]);return m.useEffect(()=>{if(!(!Ye||!A))return A.addEventListener("timeupdate",M),()=>{A.removeEventListener("timeupdate",M)}},[A,M,Ye]),{isPlaying:f,currentChapterId:C,currentChapterIndex:l,chapterDurations:a,currentChapterPartIndex:I,audioElement:A,setAudioElement:_,audioChaptersProgressBarRef:h,currentChapterAudioSrc:((fe=S[l])==null?void 0:fe[I])??"",isPlayerMuted:N,currentChapterTranscript:we,play:e?ae:void 0,pause:e?O:void 0,skipForward:e?z=>W(z):()=>{},skipBack:e?z=>te(z):()=>{},goToNextChapter:g?ne:void 0,goToPreviousChapter:v?X:void 0,getNextPlaybackSpeed:e?z=>Ce(z):void 0,applyPlaybackRate:e?z=>Ie(z):()=>{},onChapterEnded:be,resetAllTimers:ue,trackPlayerEndEvents:Me,togglePlayerMuted:q}}function Z0e(){const{currentChapterId:t}=M8();return m.useMemo(()=>{if(t)return{type:"dailyBriefing",chapterId:t}},[t])}function e1e(t){const[e,n]=m.useState(0);return m.useEffect(()=>{if(!t)return()=>{};const r=a=>{a.preventDefault(),n(l=>l+1)},o=a=>{a.preventDefault(),n(l=>Math.max(0,l-1))},i=a=>{a.preventDefault(),n(0)},s=()=>{document.hidden&&n(0)};return window.addEventListener("dragenter",r,!0),window.addEventListener("dragleave",o,!0),window.addEventListener("drop",i,!0),document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("dragenter",r,!0),window.removeEventListener("dragleave",o,!0),window.removeEventListener("drop",i,!0),document.removeEventListener("visibilitychange",s)}},[t]),e>0}async function t1e(t,e){try{const n=await t.arrayBuffer(),r=new Uint8Array(n),o=await $n("/attachments",GQ,{options:{method:"POST",headers:{"Content-Type":Ns(t)},body:new Blob([r]),signal:e}}).then(i=>i.data);if("errorCode"in o)throw new Error(o.errorCode);return o.url}catch(n){throw console.error("Error uploading image",n),n}}async function n1e(t,e){try{const n=new FormData;t.type!==""?n.append("file",t):n.append("file",new File([t],t.name,{type:Ns(t)}),t.name);const r=await $n("/attachments",o5,{options:{method:"POST",body:n,signal:e}}).then(o=>o.data);if("errorCode"in r)throw new Error(r.errorCode);return r.id}catch(n){throw console.error("Error uploading document",n),n}}async function r1e(t,e){try{const n=await $n("/attachments/onedrive",o5,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id}),signal:e}}).then(r=>r.data);if("errorCode"in n)throw new Error(n.errorCode);return n.id}catch(n){throw console.error("Error uploading OneDrive file",n),n}}async function o1e(t,e){switch(t.kind){case"local-file":return n1e(t.file,e);case"onedrive":return r1e(t.item,e);default:{const n=t;throw new Error(`Unhandled upload kind: ${n}`)}}}async function i1e(t){const{uploadTasks:e,signal:n,onSuccess:r,onError:o,onFinish:i,scenario:s}=t,a=e.map(async l=>{const u=l.upload;try{if(l.type==="document"){const f={content:{type:"document",attachmentId:await o1e(l.upload,n)},item:{type:"document",partId:l.partId,fileName:l.metadata.name,contentType:l.metadata.contentType},size:l.metadata.size,type:l.metadata.contentType},p={id:l.id,file:l.upload.file,scenario:s,processing:!1,attachment:f};r(p)}else{const h=await t1e(u.file,n),f={content:{type:"image",url:h},item:{type:"image",url:h},size:l.metadata.size,type:l.metadata.contentType},p={id:l.id,file:u.file,scenario:s,processing:!1,attachment:f};r(p)}}catch(h){o&&o(h,l)}finally{i()}return null});return Promise.all(a)}function _Me(t,e){const n=e.split(".").pop()??"";return`/attachments/${t}.${n}`}function WP(t){switch(t.kind){case"local-file":{const{file:e}=t;return{name:e.name,contentType:Ns(e),size:e.size}}case"onedrive":{const{item:e}=t;return{name:e.name,contentType:iA(e.name),size:e.size}}default:{const e=t;throw new Error(`Unhandled upload kind: ${e}`)}}}function s1e(t){const[e,n]=Ze(JU),{t:r}=xe(),o=m.useRef(new Set),i=m.useRef(0),s=ve(_l),a=m.useCallback(()=>{for(const g of o.current)g.abort();o.current.clear()},[]);m.useEffect(()=>()=>{a()},[a]);const l=m.useCallback((g,v)=>{s({isOpen:!0,scenario:v??null,reason:g})},[s]),u=m.useCallback(()=>{l("fileUpload")},[l]),h=m.useCallback(()=>{n([],t),i.current=0,a()},[a,n,t]),f=m.useCallback(async g=>{const{uploads:v,scenario:y,onError:b,replaceExisting:C=!1,shouldUploadImageAsDocument:S}=g;C&&h();const I=[],E=[];for(const w of v){const A=WP(w),_=Vp(A.contentType),L=`file-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;if(_||S){const N=String(i.current);i.current+=1,I.push({id:L,upload:w,partId:N,metadata:A,type:"document"}),E.push({id:L,file:w.file,scenario:y,processing:!0})}else I.push({id:L,upload:w,metadata:A,type:"image"}),E.push({id:L,file:w.file,scenario:y,processing:!0})}n(w=>[...w,...E],t);const T=new AbortController;o.current.add(T),await i1e({signal:T.signal,uploadTasks:I,onSuccess:w=>{var A;if(n(_=>_.map(L=>L.id===w.id?w:L),t),(A=w.attachment)!=null&&A.item){const{type:_}=w.attachment.item;xl({msg:r(_==="image"?"fileUpload.uploadedImage":"fileUpload.uploadedFile")})}},onError:(w,A)=>{if(w instanceof Error&&w.message==="not-signed-in")throw h(),u(),w;const _={id:A.id,file:A.upload.file,scenario:y,processing:!1,error:w};n(L=>L.map(N=>N.id===A.id?_:N),t),b&&b(w,A.upload)},onFinish:()=>{o.current.delete(T)}})},[h,u,n,t,r]),p=m.useCallback(g=>{n(v=>{const y=[...v];return y.splice(g,1),y},t)},[n,t]);return{uploadedAttachments:e,isUploadingAttachments:e.some(g=>g.processing===!0),clearAttachments:h,uploadAttachments:f,getUploadMetadata:WP,removeAttachmentByIndex:p}}function a1e(t,e,n,r){const{t:o}=xe(),{clearAttachments:i,uploadAttachments:s,getUploadMetadata:a,isUploadingAttachments:l,uploadedAttachments:u,removeAttachmentByIndex:h}=s1e(),f=x(kl),{maxFilesPerMessage:p}=f,g=x(Jd),v=m.useCallback(async S=>{const{uploads:I,scenario:E,replaceExisting:T=!0,supportedMimeTypes:w=g}=S,A=u.filter(({error:_})=>!_).length;if(!T&&A+I.length>p){e({title:o("composer.errors.multi.tooManyFiles.title",{maxFiles:p}),message:o("composer.errors.multi.tooManyFiles.message")});return}for(const _ of I){const L=sge(_.file,{supportedMimeTypes:w});if(L){e(L),n();return}}t();try{await s({uploads:I,scenario:E,replaceExisting:T,onError:(_,L)=>{if(_ instanceof Error){e(m9(_.message));const{name:N,size:K}=a(L);uge({name:N,size:K,message:_.message,kind:L.kind})}else e({title:o("composer.errors.default.title"),message:o("composer.errors.default.message")})}})}catch(_){_ instanceof Error&&_.message==="not-signed-in"?r():e({title:o("composer.errors.default.title"),message:o("composer.errors.default.message")})}},[u,t,e,o,n,s,a,r,p,g]),y=m.useCallback(async S=>{const{rawFiles:I,scenario:E,replaceExisting:T=!0,supportedMimeTypes:w=g}=S;if(I.length===0)return;const A=[];for(const _ of I)A.push({file:age(_),kind:"local-file"});await v({uploads:A,scenario:E,replaceExisting:T,supportedMimeTypes:w})},[v,g]),b=m.useCallback(()=>{i(),n()},[i,n]),C=m.useCallback(S=>{u.length===1?b():h(S)},[h,u,b]);return{processUploadedFiles:v,processUploadedLocalFiles:y,isUploadingAttachments:l,uploadedAttachments:u,resetFileUpload:b,removeAttachment:C}}function Jb(){var r;const t=x(Lr)==="side-by-side",e=ar({breakpoint:"sm"}),n=!!((r=me.instance().config().actions)!=null&&r.alwaysLayoutChatDetailsOverChat);return t&&(e||n)}function O8(t){return t.map(e=>{if(e.author==="human"||!e.content.find(a=>a.type==="citation"))return e;const r=e.content.find(a=>a.type==="text");if(!r)return e;const o=e.content.filter(a=>a.type==="citation").sort((a,l)=>a.position-l.position),{text:i,citationMetadata:s}=c1e(r.text,o);return r.text=i,r.citations=s,e})}function c1e(t,e){if(!e)return{text:t,citationMetadata:[]};let n=t;const r=[];let o=0;const i=new Map;for(const a of e){const l=a.url;if(!i.has(l)){o+=1;const u=`${o}`;i.set(l,u),r.push({index:u,title:a.title,url:a.url,iconUrl:a.iconUrl??null,publisher:a.publisher??null})}}const s=e.map((a,l)=>({citation:a,originalIndex:l})).sort((a,l)=>{const u=l.citation.position-a.citation.position;return u!==0?u:l.originalIndex-a.originalIndex}).map(a=>a.citation);for(const a of s){const l=a.url,u=i.get(l);u!==void 0&&(n=gz(n,YU(u,a.url),a.position))}return{text:n,citationMetadata:r}}function l1e(){const t=cU(),{conversationId:e}=AE({strict:!1}),{data:n,error:r,isLoading:o}=nH({queryKey:["sharePage",e],queryFn:()=>u1e(`/conversations/shares/${e}`),staleTime:1/0,enabled:t&&!!e});return{data:n,error:r,isLoading:o}}async function u1e(t){const{data:e,response:n}=await $n(t,jJ,{parseOptions:{safe:!0},analytics:{anonymousPath:"/conversations/shares/*"}});if(n.status>=400&&n.status<500)throw new d1e(n.status.toString());return{...e,messages:O8(e.messages.reverse())}}class d1e extends Error{}function h1e(){const t=cU(),{isMediaViewerOpen:e}=Us(),n=x(Zr),r=se("share-continue-v2"),{error:o}=l1e();return t?o?!1:r||e||!!n:!0}function CA(){return K_("(hover: hover) and (pointer: fine)")}const f1e={h550:"550",h600:"600",h760:"760"};function cy(t){const{breakpoint:e}=t,n=f1e[e];return!K_(`(min-height: ${n}px)`)}function Kp(){const t=Ue(Zi),e=Ue(eo);return t.length===0&&!!(e!=null&&e.isNew)}function p1e(){try{return Dl.latestLocation.pathname}catch{return typeof window<"u"&&window.location.pathname?window.location.pathname:"/"}}function eh(){const t=p1e(),e=t.endsWith("/talk"),n=t.startsWith("/chats")&&!e,r=t.endsWith("/landing");return n||r}function Xb(){return!Ue(NT)}function m1e(){var s;const t=Xb(),e=Ue(VT),n=Ue(Lb),r=Kp(),o=eh(),i=!!((s=me.instance().config().landingPage)!=null&&s.enableCentralComposer);return t&&!e&&n==="center"&&o&&r&&i}function g1e(){var o;const t=Xb(),e=Kp(),n=eh(),r=!!((o=me.instance().config().landingPage)!=null&&o.enableStarterPrompts);return t&&n&&e&&r}function L8(){var i;const t=Xb(),e=Kp(),n=eh(),r=Ue(WX),o=!!((i=me.instance().config().landingPage)!=null&&i.enableWidgets);return t&&r&&n&&e&&o}function v1e(){const t=Xb(),e=Kp(),n=eh(),r=L8(),o=ze("appr-home");return t&&n&&e&&o&&!r}function D8(){var s;const t=ze("autosuggest"),e=ze("edge-autosuggest"),n=Kp(),r=eh(),o=t||e,i=!!((s=me.instance().config().landingPage)!=null&&s.enableAutoSuggest);return o&&i&&r&&n}function th(){const t=v1e();return{isCompatibleLandingRoute:eh(),isAutoSuggestEnabled:D8(),isCentralComposerEnabled:m1e(),isStarterPromptsEnabled:g1e(),isWidgetSectionEnabled:L8(),isAppearanceOnHomeEnabled:t,isGreetingCentered:t||ze("categorized-conversation-starter-widget")}}function y1e(){var r;const t=$t(),e=se("cmc-landing"),n=!!((r=me.instance().config().landingPage)!=null&&r.enableLandingRoute);return e&&n&&t.endsWith("/landing")}const b1e=P(),C1e=/\/(?:.*\/)?(ar|vi|gm)-([a-zA-Z0-9]{6,10})/,S1e="gemSnapshotKey";function I1e(){const t=x(b1e),{contentPageType:e}=Us();return m.useMemo(()=>{if(!(!t||!e))try{const n=t.pathname.match(C1e),r=(n==null?void 0:n[2])??null;if(!r)return;switch(e){case"newsGem":{const o=t.searchParams.get(S1e);return o?{type:"newsGem",gemId:r,snapshotKey:o}:void 0}case"newsArticle":return{type:"news",articleId:r};default:return}}catch{return}},[t,e])}function E1e(){const t=gi(),e=py();return m.useCallback(async()=>{await t({to:"/agents",params:{},from:e.state.location.pathname})},[t,e.state.location.pathname])}function T1e(){const t=bo("kill-domain-referrer");return m.useCallback(e=>wl(e,{preventReferrer:t}),[t])}function w1e(){var h,f,p;const t=se("cross-promo-popup"),e=(p=(f=(h=me.instance().config().crossPromotion)==null?void 0:h.aggressive)==null?void 0:f.popup)==null?void 0:p.secondDay,n=yn(m1),r=!ey(n,Pg),o=yn(cT),i=!ey(o,2*Pg),s=yn(Fg),a=eA(s,2),l=x(LT);return m.useMemo(()=>!!(r&&t&&i&&a&&e&&(l===!0?!1:l!==void 0)),[e,t,i,a,r,l])}function Ru(t){const{name:e,status:n,eventName:r,source:o,isMobile:i}=t;U.trackEvent({name:e,data:{eventName:r,eventInfo_source:o,eventInfo_isMobilePlatform:i,eventInfo_status:n}})}function j8(){const[t,e]=Ze(ms),n=se("cross-promo-popup"),r=se("top-banner-cross-promo-desktop");let o="setting";(n||(t==null?void 0:t.type)==="popup")&&(o="popup"),r&&(o="topBanner"),(t==null?void 0:t.type)==="card"&&(o="bottomRightCard");const i=ve(Zr);return m.useCallback(()=>{const s=Date.now().toString();cr(cT,s);const a=yn(Fg);cr(Fg,(parseInt(a??"0",10)+1).toString()),Ru({name:"interaction",status:"Dismissed",eventName:"crossPromotionStripCard",source:o}),i(null),e(null)},[o,i,e])}function U8(t){m.useEffect(()=>{const e=()=>{t()};return Rt.on("languageChanged",e),()=>{Rt.off("languageChanged",e)}},[t])}function F8(t){const{onStartComplete:e}=t;m.useEffect(()=>{const n=()=>{e(),wt.off("app:start-complete",n)};return wt.on("app:start-complete",n),()=>{wt.off("app:start-complete",n)}},[e])}const AMe={Pageseditor:"pageseditor-supported-features"},B8=c.discriminatedUnion("eventName",[c.object({eventName:c.literal("auth0.accountAdded")}),c.object({eventName:c.literal("auth0.accountRemoved")})]),_1e=["imagegeneration","f1","school"],SA=1e3*60*60,A1e={revalidateOnFocus:!1,refreshInterval:SA};async function k1e(t,e,n){return $n(t,KJ,{query:{"api-version":"2",supportedWidgets:e.join(","),...n?{intent:n}:{}},options:{method:"GET",headers:{"Content-Type":"application/json"}},analytics:{anonymousPath:t}}).then(r=>r.data)}function x1e(t){return t?["conversation-starter"]:["conversation-starter","feature-discovery","kickstarter","image-generation","conversation-starter-prompted-greeting","categorized-conversation-starter"]}function R1e(t){var e;if(t.length>0){if(((e=t[0])==null?void 0:e.type)==="textAndGreeting")return t;const n=t[0];if(n)return[n]}}function N1e(t){const e=t.toLowerCase();return _1e.includes(e)}function P1e(){var f;const t=ve(J5),[e,n]=m.useState(!1),r=m.useMemo(()=>{const p=cG();if(p&&N1e(p))return p},[]),o=ve(Ky),i=bo("kill-landing-widgets"),s=!!((f=me.instance().config().landingPage)!=null&&f.shouldFetchWidgetsData);F8({onStartComplete:()=>{n(!0)}});const{data:a,isLoading:l,error:u,mutate:h}=Il(e&&s?"/activation/widgets":null,p=>k1e(p,x1e(i),r),A1e);o(l),U8(h),m.useEffect(()=>{if(a!=null&&a.widgets){const p=R1e(a.widgets);t(p)}},[a,t]),m.useEffect(()=>{u&&(U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"widgets",eventInfo_errorMessage:`${u}`,eventInfo_details:"Widget API error"}}),o(!1),t(void 0))},[u,t,o])}function M1e(){const t=x(zT),e=Ep(),{isCompatibleLandingRoute:n}=th(),r=t&&e&&n;return m.useMemo(()=>{if(r)return{type:"greeting",greetingMessage:t}},[t,r])}function O1e(){const t=Ue(Cr);return z_(Rt.resolvedLanguage,t)}function kMe(){const{i18n:t}=xe(),e=x(Cr);return z_(t.resolvedLanguage,e)}const L1e=25,D1e=70,j1e=4,tl=at(),sE=P(null),H8=P("");let D0=null;function U1e(t){tl.set(H8,t)}function YP(){return tl.get(H8)}function Nu(t){tl.set(M_,t)}function z8(){const t=tl.get(sE);t&&(t.abort(),tl.set(sE,null))}function F1e(){z8();const t=new AbortController;return tl.set(sE,t),t}function B1e(t,e,n){const r=new URL("https://www.bing.com/AS/Suggestions/V2?pt=page.chat"),[o,i]=n.split("-");return r.searchParams.set("lang",(o==null?void 0:o.toLowerCase())??"en"),r.searchParams.set("cc",(i==null?void 0:i.toLowerCase())??"us"),r.searchParams.set("qry",t.toLowerCase()),r.searchParams.set("cvid",e),ze("encacsc")&&r.searchParams.set("ascopilot1","1"),ze("enblsuggrndmzn")&&r.searchParams.set("ascopilot2","1"),ze("encpsrchdata")&&r.searchParams.set("ascopilot3","1"),r.toString()}async function H1e(t){const{query:e,conversationId:n,market:r,abortController:o}=t,i=B1e(e,n,r);return fetch(i,{signal:o.signal}).then(s=>s.json())}function z1e(t,e){const n=t.toLowerCase().split(/\s+/),r=e.st.toLowerCase().split(/\s+/);let o=0;for(let l=0;l<Math.min(n.length,r.length)&&n[l]===r[l];l+=1)o+=1;const i=e.st.split(/\s+/),s=i.slice(0,o).join(" "),a=i.slice(o).join(" ");return{original:e.st,sliced:a,prefill:s+(s?" ":"")}}async function V1e(t){var n;const e=Ue(it);if(e)try{const r=F1e(),o=O1e(),i=performance.now(),s=await H1e({query:t,conversationId:e,market:o,abortController:r});if(t===YP()){if(!s.s.length){Nu(null),Dr({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:e})});return}const a=s.s.map(l=>z1e(s.qc.q,l));if(!a.length){Nu(null),Dr({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:e})});return}Nu({prefill:((n=a[0])==null?void 0:n.prefill)??t,conversationId:e,type:"BCT",suggestions:a.slice(0,j1e)}),Sa({feature:"fetchChatAutoComplete",duration:performance.now()-i})}}catch(r){r instanceof DOMException&&r.name==="AbortError"||U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"autosuggest",eventInfo_errorMessage:`${r}`,eventInfo_details:"Autosuggest API error"}}),t===YP()&&Nu(null)}}function $1e(t){D0&&clearTimeout(D0),D0=setTimeout(()=>{V1e(t)},L1e)}function V8(t){var o;let e=(o=me.instance().config().landingPage)==null?void 0:o.regexForAutoSuggest;ze("one-char-autosuggest")&&(e=/\S+/);const n=ze("autosuggest")||ze("edge-autosuggest"),r=Ue(it);if(!n||!e||!e.test(t)||t.length>=D1e){Nu(null);return}U1e(t),!t||!r?Nu(null):$1e(t)}function ef(){z8(),tl.set(M_,null)}function aE(){return aE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},aE.apply(null,arguments)}function G1e(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var K1e=m.useLayoutEffect,q1e=function(e){var n=m.useRef(e);return K1e(function(){n.current=e}),n},QP=function(e,n){if(typeof e=="function"){e(n);return}e.current=n},W1e=function(e,n){var r=m.useRef();return m.useCallback(function(o){e.current=o,r.current&&QP(r.current,null),r.current=n,n&&QP(n,o)},[n])},JP={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},Y1e=function(e){Object.keys(JP).forEach(function(n){e.style.setProperty(n,JP[n],"important")})},XP=Y1e,_r=null,ZP=function(e,n){var r=e.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?r+n.borderSize:r-n.paddingSize};function Q1e(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),_r||(_r=document.createElement("textarea"),_r.setAttribute("tabindex","-1"),_r.setAttribute("aria-hidden","true"),XP(_r)),_r.parentNode===null&&document.body.appendChild(_r);var o=t.paddingSize,i=t.borderSize,s=t.sizingStyle,a=s.boxSizing;Object.keys(s).forEach(function(p){var g=p;_r.style[g]=s[g]}),XP(_r),_r.value=e;var l=ZP(_r,t);_r.value=e,l=ZP(_r,t),_r.value="x";var u=_r.scrollHeight-o,h=u*n;a==="border-box"&&(h=h+o+i),l=Math.max(h,l);var f=u*r;return a==="border-box"&&(f=f+o+i),l=Math.min(f,l),[l,u]}var eM=function(){},J1e=function(e,n){return e.reduce(function(r,o){return r[o]=n[o],r},{})},X1e=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],Z1e=!!document.documentElement.currentStyle,eIe=function(e){var n=window.getComputedStyle(e);if(n===null)return null;var r=J1e(X1e,n),o=r.boxSizing;if(o==="")return null;Z1e&&o==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var i=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),s=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:i,borderSize:s}},tIe=eIe;function $8(t,e,n){var r=q1e(n);m.useLayoutEffect(function(){var o=function(s){return r.current(s)};if(t)return t.addEventListener(e,o),function(){return t.removeEventListener(e,o)}},[])}var nIe=function(e){$8(window,"resize",e)},rIe=function(e){$8(document.fonts,"loadingdone",e)},oIe=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],iIe=function(e,n){var r=e.cacheMeasurements,o=e.maxRows,i=e.minRows,s=e.onChange,a=s===void 0?eM:s,l=e.onHeightChange,u=l===void 0?eM:l,h=G1e(e,oIe),f=h.value!==void 0,p=m.useRef(null),g=W1e(p,n),v=m.useRef(0),y=m.useRef(),b=function(){var I=p.current,E=r&&y.current?y.current:tIe(I);if(E){y.current=E;var T=Q1e(E,I.value||I.placeholder||"x",i,o),w=T[0],A=T[1];v.current!==w&&(v.current=w,I.style.setProperty("height",w+"px","important"),u(w,{rowHeight:A}))}},C=function(I){f||b(),a(I)};return m.useLayoutEffect(b),nIe(b),rIe(b),m.createElement("textarea",aE({},h,{onChange:C,ref:g}))},sIe=m.forwardRef(iIe);function aIe(t,e){const n=m.useRef(null);m.useEffect(()=>{const r=t==null?void 0:t.current;if(!r)return;const o=s=>{const a=r.selectionStart,l=r.selectionEnd;if(a!==l&&s.key!=="Backspace"&&s.key!=="Delete")n.current={type:"replace",char:s.key,index:a};else if(s.key==="Backspace"&&a>0){const h=r.value[a-1];h!==void 0&&(n.current={char:h,index:a-1,type:"delete"})}else if(s.key==="Delete"&&a<r.value.length){const h=r.value[a];h!==void 0&&(n.current={char:h,index:a,type:"delete"})}else n.current=null},i=()=>{e&&e(n.current),n.current=null};return r.addEventListener("keydown",o),r.addEventListener("input",i),()=>{r.removeEventListener("keydown",o),r.removeEventListener("input",i)}},[t,e])}const cE="@",cIe=new RegExp(`${cE}([^${cE}]*)`,"g");function lIe(t,e){return[...t.slice(0,e).matchAll(cIe)].map(r=>({keyword:r[1],start:r.index,end:r.index+r[0].length}))}function uIe(t,e){const n=lIe(t,e);if(n.length===0)return;const r=n[n.length-1];return(r==null?void 0:r.end)===e?r:void 0}function dIe(t){const{className:e,textAreaRef:n,onMentionChange:r,textAreaValue:o,onCancelMention:i}=t,[s,a]=m.useState(void 0),{t:l}=xe(),u=m.useRef(!1),h=m.useRef(r),f=m.useRef(null),p=m.useRef(new Set),g=m.useCallback(S=>{S&&S.char===cE&&S.type!=="insert"&&p.current.delete(S.index)},[]),v=m.useCallback(()=>{a(void 0),f.current=null},[a]);aIe(n,g),m.useEffect(()=>{h.current=r},[r]);const y=m.useCallback(()=>{const S=n==null?void 0:n.current;if(!S)return;const I=S.selectionStart,E=S.selectionEnd;if(I===E){const T=uIe(o,I);T?p.current.has(T.start)?v():(f.current=T,a(w=>w!==T.keyword?T.keyword:w)):v()}},[v,n,o]),b=m.useCallback((S="remove")=>{var A,_;const I=f.current;if(!I)return;if(S==="ignore"){p.current.add(I.start),(A=h.current)==null||A.call(h,{isTrigger:!1}),a(void 0);return}const E=o.slice(0,I.start),T=o.slice(I.end),w=E+T;f.current=null,(_=h.current)==null||_.call(h,{isTrigger:!1}),i==null||i(w)},[i,o]);m.useEffect(()=>{o===""?(v(),p.current.clear()):y()},[y,o,a,v]),m.useEffect(()=>{var S,I;if(!u.current){u.current=!0;return}s!==void 0?(S=h.current)==null||S.call(h,{isTrigger:!0,keyword:s}):(I=h.current)==null||I.call(h,{isTrigger:!1})},[s,h]),m.useEffect(()=>(wt.on("mention:cancel",b),()=>{wt.off("mention:cancel",b)}),[b]);const C=s==="";return d.jsxs("div",{className:Y("pointer-events-none absolute z-0 overflow-auto",e),"aria-hidden":"true",children:[d.jsx("span",{className:"invisible select-none whitespace-pre-wrap break-words",children:o}),C&&d.jsx("span",{className:"text-foreground-550 dark:text-foreground-600",children:l("userInput.mentionPlaceholderText")})]})}function hIe(t,e){const n=m.useCallback(async r=>{r.key==="Enter"&&!r.shiftKey&&!e&&await t(r)},[t,e]);Rl(n)}function fIe(t,e,n){const r=m.useRef(!1),o=m.useCallback(()=>{r.current=!0},[]),i=m.useCallback(()=>{setTimeout(()=>{r.current=!1},100)},[]);return hIe(async s=>{var a;(a=t.current)!=null&&a.contains(document.activeElement)&&!r.current&&(s.preventDefault(),await e())},n),{handleCompositionStart:o,handleCompositionEnd:i}}const pIe="pointer-events-none cursor-not-allowed select-none shadow-none",mIe="opacity-40",gIe=.25,IA="userInput",EA=m.forwardRef((t,e)=>{var Ie;const{t:n}=xe(),{inputValue:r,errorMessage:o,className:i,characterLimit:s,characterLimitErrorMessage:a,disabled:l,placeholder:u=n("userInput.placeholderText"),autoFocus:h=!0,testId:f,setInput:p,setError:g,onBlur:v,onChange:y,onFocus:b,onClick:C,onEnter:S,onKeyDown:I,onMentionIfEnabled:E,rightButtons:T,isMultiLines:w,"aria-autocomplete":A,"aria-controls":_,disabledClassName:L,inputContainerClassName:N}=t,K=$t(),{isCentralComposerEnabled:q}=th(),ae=m.useRef(null),O=m.useRef(null),W=CA()||me.instance().config().enterKeyButtonEnabled,te=n("userInput.characterLimitText",{maxCharacters:s.toString()});m.useEffect(()=>{var Ce;W&&((Ce=O.current)==null||Ce.focus())},[K,W]);const D=m.useCallback(Ce=>{const{value:be}=Ce.target;p(be),y&&y(be),be.length>s?g(a??te):g(null)},[p,y,s,g,a,te]);m.useImperativeHandle(e,()=>({updateInputValue:Ce=>{const be=Ce(r);p(be)},focus:()=>{var Ce;(Ce=O.current)==null||Ce.focus()},blur:()=>{var Ce;(Ce=O.current)==null||Ce.blur()},contains:Ce=>{var be;return((be=O.current)==null?void 0:be.contains(Ce))??!1},updateSelectionRange:(Ce,be)=>{var ue;(ue=O.current)==null||ue.setSelectionRange(Ce,be)},getTextAreaRef(){return O}}),[r,p]),Rl(Ce=>{var be,ue;Ce.key==="Escape"&&((be=ae.current)!=null&&be.contains(document.activeElement))&&((ue=O.current)==null||ue.blur()),I==null||I(Ce)});const G=m.useCallback(Ce=>{(Ce.clipboardData.getData("text/plain")||"").length>0&&Ce.stopPropagation()},[]),{handleCompositionStart:re,handleCompositionEnd:J}=fIe(ae,S,!W),ne=(Ie=me.instance().config().composer)==null?void 0:Ie.reducedUserInputHeight,X=l?L??mIe:"";return d.jsxs(Ne.div,{className:Be("flex grow items-end",l&&pIe,X,i),onClick:()=>{var Ce;C==null||C(),(Ce=O.current)==null||Ce.focus()},ref:ae,onBlur:Ce=>v==null?void 0:v(Ce),layout:"preserve-aspect",children:[d.jsx(Ne.div,{className:"relative grow overflow-hidden",layout:!0,children:d.jsx(Ne.div,{className:"relative flex size-full cursor-text overflow-hidden text-black dark:text-white",layout:!0,children:d.jsxs(Ne.div,{className:"flex grow flex-col gap-4 py-user-input",layout:!0,transition:{duration:0},children:[d.jsx("div",{className:Be("overflow-y-auto px-4",{"max-h-[15dvh]":ne,"max-h-user-input-shallow":q&&!ne,"max-h-user-input":!q&&!ne},me.instance().config().showScrollbarOnHover?"scrollbar-container":"",N),children:d.jsxs("div",{className:"relative",children:[d.jsx("label",{className:Be(["invisible block h-0 w-0 overflow-hidden",{"whitespace-nowrap":!w}]),htmlFor:"userInput",children:u}),d.jsx(sIe,{className:Be("font-ligatures-none inline-block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600",Xi("composer")??"text-base",ip("composerVertical")),disabled:l,placeholder:u,ref:O,id:IA,role:"textbox","aria-autocomplete":A,"aria-controls":_,spellCheck:!1,value:r,enterKeyHint:"enter",onChange:D,onFocus:()=>b==null?void 0:b(r),onCompositionStart:re,onCompositionEnd:J,onPaste:G,autoFocus:h,"data-testid":f}),E&&d.jsx(dIe,{className:Be("font-ligatures-none inline-block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600",Xi("composer")??"text-base",ip("composerVertical"),"inset-0"),textAreaRef:O,textAreaValue:r,onMentionChange:E,onCancelMention:Ce=>{p(Ce),g(null)}})]})}),o&&d.jsx("div",{className:"flex min-h-6 select-none items-center px-4 text-foreground-600 text-xs",children:o})]})})}),d.jsx(Ne.div,{className:Be("relative bottom-0 my-1.5 flex h-9 items-center",T!=null&&T.length?"mx-1.5 w-auto gap-1":"w-0"),children:T==null?void 0:T.map((Ce,be)=>d.jsx(Mn,{children:d.jsx(Ne.div,{initial:ot,animate:{...Lt,transition:{delay:gIe}},transition:{duration:jo.default},children:Ce})},be))})]})});EA.displayName="UserInput";const nh=at(),vIe=500,Zb=P(""),G8=P("starter-prompts"),K8=P(!0);function lE(t){nh.set(Zb,t)}function uE(){nh.set(Zb,"")}function Sg(t){nh.set(G8,t)}function rc(t){nh.set(K8,t)}function q8(t){nh.set(Dd,t)}function TA(){return x(Zb)}function yIe(){return x(G8)}function bIe(){return x(K8)}const CIe=C8((t,e)=>{kee(Ue(it),t,JSON.stringify(e))},vIe);function SIe(t,e){CIe(t,e)}function W8(t){const{text:e,attachments:n,inputMethod:r}=t,o=Ue(Zb),i=YI(),s=q_({breakpoint:"sm"}),a=Ue(hn),l=Ue(Zr),u=!Wr("kill-chat-message-preview"),h=a==="computerUse",p=D8()&&!l&&!h;if(e||Sg("starter-prompts"),rc(o.length<=0||e.length===0),q8(!1),nh.set(By,void 0),SIe(r??"user"),i&&A8("typing"),s&&sZ(),p&&V8(e),yfe()&&a==="smart"&&u)try{gs.sendMessagePreview({text:e,inputMethod:"text",filesWithAttachment:n??[]})}catch{}}function Wm(t){const{prompt:e,prefillSource:n}=t,r=document.querySelector(`#${IA}`);r&&(ef(),lE(e),W8({text:e,inputMethod:n}),setTimeout(()=>{r.focus(),r.setSelectionRange(e.length,e.length)},0))}const IIe=(t,e)=>{var n,r,o,i;if(t==="light"){const s=(r=(n=me.instance().config().composer)==null?void 0:n.shadowBoxStyleOverride)==null?void 0:r.outerLargeBoxShadowLight;if(s)return s;if(e)return eSe}else if(t==="dark"){const s=(i=(o=me.instance().config().composer)==null?void 0:o.shadowBoxStyleOverride)==null?void 0:i.outerLargeBoxShadowDark;if(s)return s;if(e)return tSe}return XCe},EIe=(t,e)=>{var n,r,o,i;if(t==="light"){const s=(r=(n=me.instance().config().composer)==null?void 0:n.shadowBoxStyleOverride)==null?void 0:r.outerSmallBoxShadowLight;if(s)return s;if(e)return nSe}else if(t==="dark"){const s=(i=(o=me.instance().config().composer)==null?void 0:o.shadowBoxStyleOverride)==null?void 0:i.outerSmallBoxShadowDark;if(s)return s;if(e)return rSe}return ZCe},TIe=t=>t==="dark"?a8:s8,Y8=t=>m.createElement("svg",{viewBox:"0 0 28 28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M27.9994 14.0514C27.9994 6.29111 21.7315 0 13.9997 0C6.26795 0 0 6.29111 0 14.0514C0 20.641 4.52023 26.1705 10.6179 27.6892V18.3455H7.73121V14.0514H10.6179V12.2011C10.6179 7.41859 12.7745 5.20184 17.4526 5.20184C18.3396 5.20184 19.8701 5.37664 20.4962 5.55088V9.44312C20.1658 9.40828 19.5918 9.39085 18.8789 9.39085C16.5835 9.39085 15.6965 10.2637 15.6965 12.5328V14.0514H20.2694L19.4837 18.3455H15.6965V28C22.6286 27.1597 28 21.2356 28 14.0514H27.9994Z"})),xMe=Object.freeze(Object.defineProperty({__proto__:null,default:Y8},Symbol.toStringTag,{value:"Module"})),Q8=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{id:"Linkedin"},m.createElement("path",{id:"Shape",d:"M23.6999 2.75909C23.6999 1.39872 22.5971 0.295929 21.2368 0.295929H2.76308C1.40272 0.295929 0.299927 1.39872 0.299927 2.75909V21.2328C0.299927 22.5931 1.40272 23.6959 2.76308 23.6959H21.2368C22.5971 23.6959 23.6999 22.5931 23.6999 21.2328V2.75909ZM3.63848 9.12156H7.24935V20.6943H3.63848V9.12156ZM16.4313 8.83425C19.8921 8.83425 20.6797 10.9844 20.753 13.861L20.7589 14.3469V20.6942H17.1519L17.1517 14.9161C17.1477 13.5985 17.0603 11.9984 15.278 11.9984C13.4002 11.9984 13.1135 13.4611 13.1135 14.971V20.6942H9.51161V9.12143H12.9689V10.7028H13.0188L13.1052 10.5509C13.6314 9.68925 14.7739 8.83425 16.4313 8.83425ZM3.35125 5.45367C3.35125 4.30239 4.28565 3.36809 5.44404 3.36809C6.59732 3.36809 7.53556 4.30239 7.53556 5.45367C7.53556 6.60623 6.59732 7.54053 5.44404 7.54053C4.28565 7.54053 3.35125 6.60623 3.35125 5.45367Z",fill:"currentColor"}))),RMe=Object.freeze(Object.defineProperty({__proto__:null,default:Q8},Symbol.toStringTag,{value:"Module"})),J8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",...t},m.createElement("g",{clipPath:"url(#clip0_9013_4638)"},m.createElement("path",{d:"M14 0C6.26828 0 0 6.26828 0 14C0 17.8664 1.56734 21.3664 4.10047 23.8995L1.43391 26.5661C0.904531 27.0955 1.27969 28 2.02781 28H14C21.7317 28 28 21.7317 28 14C28 6.26828 21.7317 0 14 0Z",className:"fill-foreground-650"}),m.createElement("path",{d:"M16.8481 6.60187C17.091 7.63109 18.0152 8.39781 19.1188 8.39781C20.4072 8.39781 21.4517 7.35328 21.4517 6.06484C21.4517 4.7764 20.4072 3.73187 19.1188 3.73187C17.9922 3.73187 17.0527 4.53031 16.8339 5.59234C14.9472 5.79469 13.4739 7.39484 13.4739 9.33406C13.4739 9.33843 13.4739 9.34172 13.4739 9.34609C11.4221 9.4325 9.54846 10.0166 8.06096 10.9386C7.50861 10.5109 6.81518 10.2561 6.06268 10.2561C4.25689 10.2561 2.79346 11.7195 2.79346 13.5253C2.79346 14.8356 3.56346 15.9644 4.6758 16.4861C4.78408 20.2814 8.91955 23.3341 14.0066 23.3341C19.0936 23.3341 23.2346 20.2781 23.3374 16.4795C24.441 15.9545 25.2044 14.8291 25.2044 13.5264C25.2044 11.7206 23.741 10.2572 21.9352 10.2572C21.186 10.2572 20.4958 10.5098 19.9446 10.9342C18.4439 10.0056 16.5496 9.42156 14.4769 9.3439C14.4769 9.34062 14.4769 9.33844 14.4769 9.33515C14.4769 7.94609 15.5094 6.79328 16.8481 6.60406V6.60187ZM7.92971 15.6002C7.98439 14.4145 8.77189 13.5045 9.68736 13.5045C10.6028 13.5045 11.3028 14.4659 11.2481 15.6516C11.1935 16.8372 10.5099 17.2681 9.5933 17.2681C8.67674 17.2681 7.87502 16.7858 7.92971 15.6002ZM18.3269 13.5045C19.2435 13.5045 20.031 14.4145 20.0846 15.6002C20.1392 16.7858 19.3364 17.2681 18.421 17.2681C17.5055 17.2681 16.8208 16.8383 16.7661 15.6516C16.7114 14.4659 17.4103 13.5045 18.3269 13.5045ZM17.2375 18.3433C17.4092 18.3608 17.5186 18.5391 17.4519 18.6987C16.8886 20.0452 15.5586 20.9912 14.0066 20.9912C12.4546 20.9912 11.1256 20.0452 10.5613 18.6987C10.4946 18.5391 10.6039 18.3608 10.7756 18.3433C11.7819 18.2416 12.8702 18.1858 14.0066 18.1858C15.143 18.1858 16.2302 18.2416 17.2375 18.3433Z",style:{fill:"rgb(var(--color-foreground-100))"}})),m.createElement("defs",null,m.createElement("clipPath",{id:"clip0_9013_4638"},m.createElement("rect",{width:28,height:28,fill:"white"})))),NMe=Object.freeze(Object.defineProperty({__proto__:null,default:J8},Symbol.toStringTag,{value:"Module"})),X8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor",...t},m.createElement("g",null,m.createElement("path",{d:"M16.6638 11.85L27.0874 0H24.6174L15.5665 10.2892L8.33765 0H0L10.9315 15.5591L0 27.9856H2.47021L12.0281 17.1199L19.6623 27.9856H28L16.6632 11.85H16.6638ZM13.2805 15.6962L12.1729 14.1468L3.36026 1.81862H7.15435L14.2663 11.7679L15.3739 13.3172L24.6185 26.2497H20.8244L13.2805 15.6967V15.6962Z",fill:"currentColor"}))),PMe=Object.freeze(Object.defineProperty({__proto__:null,default:X8},Symbol.toStringTag,{value:"Module"})),Z8=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor",...t},m.createElement("path",{d:"M23.9202 4.06584C21.2885 1.44525 17.7882 0.00132957 14.0588 0C6.37397 0 0.119658 6.21909 0.116984 13.8635C0.115647 16.3072 0.758058 18.6925 1.97804 20.7946L0 27.9796L7.39072 26.0517C9.4269 27.1566 11.7198 27.7383 14.0528 27.739H14.0588C21.7423 27.739 27.9974 21.5192 28 13.8748C28.0013 10.17 26.5527 6.6871 23.9202 4.0665V4.06584ZM14.0588 25.3975H14.0541C11.9751 25.3969 9.93564 24.8411 8.15617 23.7914L7.73299 23.5415L3.34709 24.6856L4.5176 20.4329L4.24218 19.9968C3.08236 18.162 2.46937 16.0413 2.4707 13.8642C2.47338 7.51078 7.67149 2.34138 14.0635 2.34138C17.1586 2.34271 20.0678 3.54266 22.2557 5.72117C24.4437 7.89902 25.6476 10.7949 25.6463 13.8735C25.6436 20.2275 20.4455 25.3969 14.0588 25.3969V25.3975ZM20.4147 16.7673C20.0664 16.5938 18.3538 15.7561 18.0343 15.6405C17.7147 15.5248 17.4828 15.467 17.2508 15.814C17.0189 16.161 16.3511 16.9415 16.1478 17.1721C15.9446 17.4035 15.7414 17.4321 15.3931 17.2585C15.0449 17.085 13.9225 16.7194 12.5915 15.5394C11.5561 14.6206 10.8568 13.4866 10.6536 13.1395C10.4504 12.7925 10.6322 12.605 10.806 12.4329C10.9624 12.2773 11.1543 12.028 11.3287 11.8259C11.5033 11.6238 11.5607 11.4789 11.677 11.2482C11.7934 11.0168 11.7352 10.8148 11.6483 10.6412C11.5614 10.4677 10.8649 8.76253 10.574 8.06918C10.2912 7.39377 10.0039 7.48551 9.79059 7.47421C9.58736 7.46424 9.35542 7.46225 9.12279 7.46225C8.89016 7.46225 8.51309 7.54867 8.19358 7.89569C7.87407 8.24267 6.97426 9.08097 6.97426 10.7855C6.97426 12.49 8.22236 14.1381 8.39681 14.3694C8.57127 14.6008 10.8534 18.0995 14.3476 19.6006C15.1786 19.9576 15.8276 20.171 16.3336 20.3306C17.168 20.5945 17.9273 20.5573 18.5276 20.4682C19.1968 20.3685 20.5886 19.6299 20.8787 18.8208C21.1688 18.0117 21.1688 17.3177 21.0819 17.1734C20.995 17.0292 20.7624 16.9421 20.4141 16.7686L20.4147 16.7673Z"})),MMe=Object.freeze(Object.defineProperty({__proto__:null,default:Z8},Symbol.toStringTag,{value:"Module"})),OMe=["facebook","twitter","whatsapp","linkedin","reddit"],wIe={facebook:"senderToFacebook",twitter:"senderToX",linkedin:"senderToLinkedIn",whatsapp:"senderToWhatsApp",reddit:"senderToReddit"},Ig={facebook:{displayName:"Facebook",linkGenerator:t=>`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,icon:d.jsx(Y8,{})},twitter:{displayName:"X",linkGenerator:(t,e)=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(t)}&text=${encodeURIComponent(e)}`,icon:d.jsx(X8,{})},whatsapp:{displayName:"WhatsApp",linkGenerator:(t,e)=>`https://api.whatsapp.com/send?text=${encodeURIComponent(`${e} ${t}`)}`,icon:d.jsx(Z8,{})},linkedin:{displayName:"LinkedIn",linkGenerator:(t,e)=>`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(t)}&text=${encodeURIComponent(e)}`,icon:d.jsx(Q8,{})},reddit:{displayName:"Reddit",linkGenerator:(t,e)=>`https://www.reddit.com/submit?url=${encodeURIComponent(t)}&title=${encodeURIComponent(e)}`,icon:d.jsx(J8,{})}};function _Ie(t){const{socialMedia:e,className:n,loading:r,disabled:o,onClickSocialMedia:i,includeTitle:s,iconClassName:a="size-6"}=t,l=d.jsx("div",{className:a,children:Ig[e].icon}),u="56-xl",h="subtle-dimmed-inverted",f=Ig[e].displayName,p=Be("flex-1 py-2",n);return d.jsxs(Te,{size:u,color:h,title:f,className:p,onClick:g=>i(e,g),disabled:o,children:[r?d.jsx(_t,{className:"size-8"}):l,s&&d.jsx("span",{className:"font-medium text-foreground-550 text-3xs",children:Ig[e].displayName})]})}function AIe(t,e,n){if(!e)return;const r=Ig[t].linkGenerator(e,n??"");wl(r)}function LMe(t,e){nt({source:"shareMenu",scenario:t,sectionName:e})}function DMe(t){const{conversationId:e,messageId:n}=t;U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"sharePreview",eventInfo_impressionElement:"shareBlockedBanner",eventInfo_conversationId:e,eventInfo_messageId:n}})}function jMe(t){const{scenario:e,uploadedfileType:n,shareId:r,conversationId:o,messageIds:i}=t;U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"shareButton",eventInfo_clickScenario:e,eventInfo_uploadFileType:n,eventInfo_customData:JSON.stringify({eventInfo_shareId:r,eventInfo_oneTurn_messageId:i?i.join(","):""}),eventInfo_conversationId:o}})}function UMe(t){const{conversationId:e,shareId:n,socialMedia:r,scenario:o,sharedLevel:i}=t;U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:wIe[r],eventInfo_clickScenario:o,eventInfo_customData:JSON.stringify({eventInfo_shareId:n,SharedLevel:i}),eventInfo_conversationId:e}})}function FMe(t){U.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"receivePreview",eventInfo_impressionScenario:"shareAsLink",eventInfo_customData:JSON.stringify({eventInfo_shareId:t})}})}function BMe(){U.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"talkToCopilot"}})}function HMe(t){const{cardType:e,messageId:n,conversationId:r,scenario:o}=t;gn({source:"shareMenu",scenario:o,messageId:n,conversationId:r,cardType:e})}function zMe(t){const{conversationId:e,messageId:n,errorName:r,errorMessage:o,errorStack:i}=t;U.trackEvent({name:"system",data:{eventName:"shareMessagesFailed",eventInfo_conversationId:e,eventInfo_messageId:n??"",eventInfo_error:r,eventInfo_errorMessage:o,eventInfo_errorStack:i}})}function kIe(){nt({source:"continueClicked"})}function xIe(t){const{shareId:e,error:n,conversationId:r}=t;Dr({feature:"share",scenario:"continueClickFailed",errorType:n==null?void 0:n.name,errorMessage:n==null?void 0:n.message,customData:JSON.stringify({eventInfo_shareId:e,eventInfo_conversationId:r})})}function RIe(t,e,n){const r=at();return new Promise((o,i)=>{let s=null;e(r.get(t))&&o(r.get(t));const a=r.sub(t,()=>{const u=r.get(t);e(u)&&(a(),o(u))}),l=()=>{a(),s&&clearTimeout(s)};s=setTimeout(()=>{l(),i(new Error("Timeout waiting for atom to be ready"))},n)})}function NIe(t){return t.some(e=>e.author==="human"&&e.content.some(n=>n.type==="image"||n.type==="document"))}function VMe(t){var n,r;const e=t.filter(o=>o.author==="human");if(e.length===1){const o=(r=(n=e[0])==null?void 0:n.content.find(i=>i.type==="image"||i.type==="document"))==null?void 0:r.type;return o==="image"?"image":o==="document"?"file":void 0}return NIe(t)?"image|file":void 0}function PIe(t){const n=new URL(t).pathname.split("/").filter(Boolean);return n[n.length-1]??null}async function tM(){kIe();const t=at(),e=PIe(window.location.href);let n;t.set(GI,!0);try{const r=await MIe(`/conversations/shares/${e}/continue`),{id:o,title:i}=r.conversation;n=o;const s=new Date().toISOString(),a={id:o,updatedAt:s,isNew:!1,title:i,history:[],streamingState:"idle",continuedAt:s};t.set(bn,l=>{const u=new Map(l);return u.set(o,a),u}),t.set(it,o),await LIe(o)}catch(r){throw na({title:Rt.t("composer.errors.continue.title"),message:Rt.t("composer.errors.continue.message")}),xIe({shareId:e??"",conversationId:n,error:r instanceof Error?r:new Error(String(r))}),r}finally{t.set(GI,!1)}}async function MIe(t){return(await $n(t,UJ,{options:{method:"POST"}})).data}const OIe=1e4;async function LIe(t){await RIe(bn,e=>{const n=e.get(t);return((n==null?void 0:n.history)??[]).length>0},OIe)}function DIe(t,e,n){if(!t||!e)return!1;const r=t.getTime(),o=e.getTime(),i=n?n.getTime():null;return o<=r||i===null?!1:i<=r}function e7(){return`Copilot_${Nc(new Date,"yyyyMMdd_HHmmss")}`}async function $Me(t,e){const n=e7(),o=await(await fetch(t)).blob(),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}function jIe(t){t.target instanceof HTMLImageElement&&URL.revokeObjectURL(t.target.src)}async function UIe(t,e=!1){try{const n=await xa(t,{analytics:{anonymousPath:"/attachments/*.png"}});return e&&n.status!==200?null:await n.blob()}catch{return null}}async function FIe(t,e=!1){try{const n=await UIe(t,e);return n?URL.createObjectURL(n):null}catch{return null}}function dE(t,e){const n=rn(t),r=rn(e);return n.getTime()>r.getTime()}function ly(t){const e=rn(t);return e.setHours(0,0,0,0),e}function wA(t,e){const n=ly(t),r=ly(e);return+n==+r}function uy(t,e){return iT(t,-e)}const BIe=11,HIe=7,zIe=2,VIe=10,$Ie=21,GIe=21,KIe=10,nM=c.object({daysActive:c.array(c.coerce.date())}),hE=c.object({result:c.enum(["dismissed","positive","negative"]),date:c.coerce.date(),dismissCounter:c.number()});function qIe(t){const e=new Date;let n=t;return t.some(r=>wA(r,e))||(n=[...t,e]),n.length>KIe?n.slice(-10):n}function WIe(){const t=Co(ox,nM),e=(t==null?void 0:t.daysActive)??[],n=qIe(e),r=uy(new Date,HIe),o=n.filter(i=>dE(i,r)||wA(i,r)).length;return n!==e&&Ro(ox,nM,{daysActive:n}),o}function YIe(){const t=Co(g1,hE);if(!t)return!1;const e=t.result==="positive",n=t.result==="negative"&&dE(t.date,uy(new Date,GIe)),r=t.result==="dismissed"&&dE(t.date,uy(new Date,t.dismissCounter>5?$Ie:VIe));return e||n||r}function QIe(t,e){let n="popUpDismiss";e==="negative"?n="appThumbDown":e==="positive"&&(n="appThumbUp"),gn({source:n,conversationId:t});const r=Co(g1,hE),o=(r==null?void 0:r.result)==="dismissed"?r.dismissCounter:0,i={result:e,date:new Date,dismissCounter:e==="dismissed"?o+1:0};Ro(g1,hE,i)}function JIe(t={},e=!1){const[n,r]=m.useState(!1),[o,i]=m.useState(!1),{onFocus:s,onBlur:a,onPointerDown:l}=t;return[n,{onFocus:h=>{(!o||e)&&r(!0),s==null||s(h)},onBlur:h=>{r(!1),i(!1),a==null||a(h)},onPointerDown:h=>{i(!0),l==null||l(h)}}]}const XIe="bg-stone-300/20 dark:bg-midnight-350/5";function ZIe(t,e){return t?t===!0?{animate:{...e}}:{animate:t}:{style:e}}function eEe(t,e,n,r){const o=e?r:n;return t?{animate:o}:{style:o}}function _A(t){const{children:e,size:n="md",position:r="default",nested:o=!1,background:i="default",stroke:s,className:a,containerRef:l,interactable:u=!1,label:h,animate:f,onFocus:p,onBlur:g,onPointerDown:v,onAnimationStart:y,onAnimationComplete:b,focusOnPointerDown:C,isSelected:S=!1,...I}=t,[E,T]=JIe({onFocus:p,onBlur:g,onPointerDown:v},C),w=S||E,_=o&&(i==="acrylic"||i==="acrylic-thin"),L=_?j0[`${n}-${r}`]:tEe[`${n}-${r}`],N=_?j0[`${n}-${r}`]:nEe[`${n}-${r}`],K=_?j0[`${n}-${r}`]:rEe[`${n}-${r}`],q={default:"bg-white/45 dark:bg-midnight-350/10",darker:XIe,acrylic:mi,"acrylic-fallback":MV,"acrylic-thin":aa,"acrylic-thin-fallback":jV,transparent:"bg-transparent"},ae=u?{"aria-label":h,role:"button",tabIndex:0,...T,onKeyDown:D=>{var G;(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),(G=I.onClick)==null||G.call(I,D))}}:{onFocus:p,onBlur:g,onPointerDown:v},O=ZIe(f,L),W=eEe(f,w,N,K),te=a&&!a.includes("relative")&&!a.includes("absolute")&&!a.includes("fixed")&&"relative";return d.jsxs(Ne.div,{className:Y(q[i],a,te,_&&"outline-1 outline-offset-2","isolate will-change-transform"),ref:l,onAnimationComplete:b,...O,...ae,...I,children:[e,d.jsx(Ne.div,{className:Y(w&&"border-foreground-750 dark:border-white",s&&!w&&"border-black/8 dark:border-white/8",!s&&!w&&"border-transparent",!_&&"border-[20px]",_&&s&&!w&&"border",_&&s&&w&&"border-2","pointer-events-none absolute inset-0"),...W})]})}const tEe={"xs-default":{clipPath:"var(--clip-path-squircle-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-24)"},"md-default":{clipPath:"var(--clip-path-squircle-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-48-60)"}},nEe={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-48-60)"}},rEe={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-focused-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-focused-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-focused-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-focused-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-focused-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-focused-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-focused-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-focused-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-focused-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-focused-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-48-60)"}},j0={"xs-default":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-default":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-default":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-default":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-default":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:60,borderBottomRightRadius:60},"xs-top":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:12,borderBottomRightRadius:12},"sm-top":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:16,borderBottomRightRadius:16},"md-top":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:24,borderBottomRightRadius:24},"lg-top":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:36,borderBottomRightRadius:36},"xl-top":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xs-bottom":{borderTopLeftRadius:12,borderTopRightRadius:12,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-bottom":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-bottom":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-bottom":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-bottom":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:60,borderBottomRightRadius:60}};function eC({className:t,style:e}){return d.jsx("div",{className:Y("animate-[shimmer_2s_infinite] bg-black/5 bg-gradient-to-r dark:bg-white/5","from-transparent via-background-150 to-transparent","bg-[length:50%_100%] bg-no-repeat",t),style:e})}function oEe(t){const{isImageOrVideo:e}=t;return d.jsx("div",{className:"flex flex-col gap-3 px-4",children:d.jsx(eC,{className:Y("w-full",e?"h-[144px] sm:h-[176px]":"h-[300px]"),style:{clipPath:"var(--clip-path-squircle-36)"}})})}function rM(t){const{type:e,length:n}=t;if(e==="ads")return d.jsx("div",{});const r=e==="image"||e==="video",o=r&&n===1;return d.jsx(_A,{size:"md",stroke:!0,className:Y("relative flex",o?"w-[300px]":"w-full","flex-col py-3 transition-opacity duration-300 ease-in-out"),children:d.jsx(oEe,{isImageOrVideo:r})})}function GMe(t){if(t.type==="image")return t.images.length;if(t.type==="video")return t.videos.length}function iEe(t){var y;const{uploadedFile:e,onRemove:n,scenario:r,isUploading:o,role:i}=t,{t:s}=xe(),[a,l]=m.useState(null),[u,h]=m.useState(!1),f=s(r==="screenshot"?"composer.screenshotAdded":"composer.uploadedImageAltText");m.useEffect(()=>{const b=URL.createObjectURL(e);return h(!1),l(b),()=>{URL.revokeObjectURL(b)}},[e]);const p=b=>{h(!0),b.target instanceof HTMLImageElement&&URL.revokeObjectURL(b.target.src)},g=m.useCallback(()=>{n==null||n(),xl({msg:s("fileUpload.imageRemoved")})},[n,s]);if(!a)return null;const v=(y=me.instance().config().composer)==null?void 0:y.smallAttachmentCard;return d.jsxs(Ne.div,{className:Y("relative max-w-fit shrink-0",{"mx-1 mt-2 h-[58px]":v,"h-32":!v}),layout:"position",initial:ot,animate:u?Lt:ot,exit:ot,transition:{delay:fU},role:i,children:[d.jsx(Ne.img,{className:Y("w-auto rounded-xl border border-black/8 object-contain shadow-inner dark:border-white/8",{"h-[58px]":v,"h-32":!v}),src:a,role:"presentation","aria-label":f,alt:f,onLoad:p,onError:p,draggable:!1}),d.jsx(Td,{msg:f}),n&&d.jsx(Ne.button,{type:"button",title:s("fileUpload.removeImageWithName",{name:e.name}),"aria-label":s("fileUpload.removeImageWithName",{name:e.name}),onClick:g,className:"absolute end-0.5 top-0.5 m-1 rounded-full border border-black/20 bg-white fill-black p-1 text-black",children:d.jsx(Mr,{className:"size-3","aria-hidden":!0})}),o&&d.jsxs(wn,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45",children:[d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(_t,{type:"spinnerThemed",className:"size-11"})}),d.jsx(Td,{msg:s("fileUpload.uploadingImage"),type:"polite"})]})]})}const AA=m.memo(t=>{const{attachment:e,onRemove:n,role:r}=t,{file:o,processing:i,error:s,scenario:a}=e;if(s||!o)return null;const l=Ns(o);return Vp(l)?d.jsx(sA,{onRemove:n,filename:o.name,fileType:l,isUploading:i,role:r}):d.jsx(iEe,{uploadedFile:o,onRemove:n,scenario:a,isUploading:i,role:r})});AA.displayName="AttachmentItem";function sEe(){m.useEffect(()=>{const t=document.activeElement;return()=>{t.focus()}},[])}function aEe(t){const{fileName:e,fileType:n,role:r}=t,o=n!==""?n:iA(e);return Vp(o)?d.jsx(sA,{filename:e,fileType:o,role:r}):null}const cEe=[{canHandle:t=>t.startsWith("https://"),getImageSrc:t=>t,shouldReleaseOnLoad:!1},{canHandle:t=>t.startsWith("/attachments"),getImageSrc:t=>FIe(t),shouldReleaseOnLoad:!0}];function lEe(t){return cEe.find(e=>e.canHandle(t))??null}function uEe({url:t}){const{t:e}=xe(),[n,r]=m.useState(null),[o,i]=m.useState(!1);return m.useEffect(()=>{if(!t){r(null);return}const s=lEe(t);if(!s){r(null);return}(async()=>{const l=await s.getImageSrc(t);r(l),i(s.shouldReleaseOnLoad)})()},[t]),n?d.jsx("img",{className:"block h-full overflow-hidden rounded-2xl bg-background-static-250 object-cover object-center shadow-inner dark:bg-background-static-900",alt:e("chat.uploadedImageAltText"),src:n,onLoad:o?jIe:void 0}):null}function dEe(){const{t}=xe();return d.jsx("div",{className:"flex w-fit justify-end",children:d.jsx("div",{className:"flex h-32 w-44 items-center justify-center rounded-xl border border-stroke-250 bg-accent-200 px-4 py-2 dark:bg-accent-250",children:d.jsx("span",{className:"text-center text-foreground-450 text-sm",children:t("share.imagePlaceholder")})})})}function t7(t){const{messageItem:e,isForSharing:n,imageClassName:r,role:o}=t,i=!bo("kill-share-c2");if(e.type==="document")return d.jsx(aEe,{fileType:e.contentType,fileName:e.fileName,role:o});const s=e.type==="image"&&e.url.startsWith("/attachments");return i&&n&&s?d.jsx(dEe,{}):e.type==="image"?d.jsx("div",{className:Be("inline-block h-full max-w-[min(80%,256px)] align-top",r),role:o,children:d.jsx("div",{className:"h-full w-fit min-w-0",children:d.jsx(uEe,{url:e.url})})}):null}function n7(t){const{onRemove:e,onClose:n,messages:r=[],attachments:o=[],isForSharing:i}=t;sEe();const{t:s}=xe();return o.length===0&&r.length===0?null:d.jsxs(Ol,{isOpen:!0,fullBleed:!0,className:"max-h-[580px] min-h-[480px] w-full justify-between p-6 sm:w-[640px]",onClose:n,dialogName:s("userInput.filePreviewModalTitle"),children:[d.jsx("h1",{className:"w-full shrink-0 text-center leading-8 text-xl",children:s("userInput.filePreviewModalTitle")}),d.jsx("div",{className:"max-h-[450px] min-h-0 flex-1 overflow-y-auto p-4",children:d.jsx("div",{role:"list",className:"flex flex-wrap content-start gap-x-2 gap-y-1",children:o.length>0?o.map((a,l)=>d.jsx(AA,{attachment:a,onRemove:()=>e==null?void 0:e(l),role:"listitem"},`attachment-${l}`)):r.map((a,l)=>d.jsx(t7,{messageItem:a,imageClassName:"h-32",role:"listitem",isForSharing:i},`message-${l}`))})}),d.jsx(Te,{color:"strong",className:"w-full shrink-0",title:s("common.dismiss"),onClick:n,children:s("common.dismiss")})]})}function hEe(t){const{attachments:e,onRemove:n,onVisibilityChange:r}=t,{t:o}=xe(),i=m.useCallback(y=>{const b=e[y];b!=null&&b.file&&n(y)},[e,n]),s=m.useMemo(()=>e.filter(y=>!y.error),[e]),a=m.useMemo(()=>s.slice(0,Mg),[s]),l=m.useMemo(()=>s.slice(Mg),[s]),u=l.filter(y=>y.processing).length,[h,f]=m.useState(!1),p=m.useCallback(()=>{xl({msg:o("userInput.seeAll"),type:"polite"}),f(!0),r==null||r(!0)},[f,o,r]),g=m.useCallback(()=>{f(!1),r==null||r(!1)},[f,r]),v=u>0?o("userInput.uploadingProcess",{uploadingCount:u,totalCount:l.length}):o("userInput.seeAll");return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative flex max-h-64 min-w-0 max-w-full flex-wrap gap-2 overflow-y-auto overflow-x-hidden px-1",children:[a.map((y,b)=>d.jsx(AA,{attachment:y,onRemove:()=>i(e.indexOf(y))},y.id??`file-${b}`)),l.length>0&&d.jsx(Te,{"aria-label":v,title:v,color:"overlay-dimmed-inverted",onClick:p,className:"flex h-32 cursor-pointer items-center justify-center rounded-xl border-none px-3.5 py-1 text-xs",children:u>0?d.jsxs(d.Fragment,{children:[d.jsx(_t,{className:"size-6"}),o("userInput.uploadingProcess",{uploadingCount:u,totalCount:l.length})]}):d.jsx(d.Fragment,{children:o("userInput.seeAll")})})]}),h&&d.jsx(n7,{onClose:g,attachments:e,onRemove:n})]})}function fEe(t){const{imgAlt:e,imgSrc:n,text:r,className:o,onClick:i,fetchPriority:s}=t,[a,l]=m.useState(!1);return d.jsx("div",{className:"aspect-[155/190] w-full min-w-[100px] max-w-full sm:w-[155px] sm:min-w-[120px] sm:max-w-[155px]",children:d.jsxs("button",{className:Be("relative flex h-full w-full flex-col items-center gap-2 rounded-lg bg-white p-2 shadow-md transition-all duration-[400ms] ease-[cubic-bezier(0,0,0,1)] hover:scale-[1.025] hover:shadow-lg dark:bg-slate-700",o),onClick:i,type:"button",children:[!a&&d.jsx(eC,{className:"aspect-square w-full rounded-md"}),d.jsx("img",{className:Be("aspect-square w-full rounded-md object-cover",a?"opacity-100":"opacity-0"),src:n,alt:e,onLoad:()=>l(!0),onError:()=>l(!1),fetchPriority:s}),d.jsx("div",{className:"flex w-full flex-1 items-center justify-center px-2",children:d.jsx("p",{className:"truncate text-center text-xs-strong",children:r})})]})})}function oM(t){const{className:e,text:n,imgSrc:r,imgAlt:o,variant:i,onClick:s,fetchPriority:a}=t,[l,u]=m.useState(!1);return d.jsx("div",{className:Be("max-w-full drop-shadow-md transition-shadow hover:drop-shadow-lg sm:min-w-[120px]",i==="kickstarter"&&"aspect-[166/200] w-[166px] sm:max-w-[166px]",i==="feature-discovery"&&"aspect-[155/200] w-[155px] sm:max-w-[155px]"),children:d.jsxs(_A,{interactable:!0,stroke:!0,onClick:s,className:Be("relative h-full w-full transition-transform duration-[400ms] ease-[cubic-bezier(0,0,0,1)] hover:scale-[1.025]",e),children:[!l&&d.jsx(eC,{className:"absolute size-full"}),d.jsx("img",{src:r,alt:o,className:Be("absolute size-full object-cover",l?"opacity-100":"opacity-0"),onLoad:()=>u(!0),onError:()=>u(!1),fetchPriority:a}),l&&d.jsx("div",{className:"absolute z-10 flex size-full flex-col px-4 py-5",children:d.jsx("p",{className:Y("mt-auto line-clamp-2 overflow-hidden text-center text-xs-strong",i==="feature-discovery"&&"text-white/80",i==="kickstarter"&&"text-white"),children:n})})]})})}const pEe={deepLink:"deepLink",prefillComposer:"chatBox",sendMessage:"chat"};function mEe(t){const{className:e,onWidgetClick:n}=t,r=ar({breakpoint:"md"}),o=vi(),i=x(Fa),s=o&&i&&!r,a=m.useRef(null),l=x(Da),u=vy(a,{once:!0,amount:"all"});m.useEffect(()=>{u&&l&&"items"in l&&Ls({page:"chatPage",scenario:"widgets",element:l.id,customData:JSON.stringify({visibleItems:l.items.map(p=>p.id)})})},[u,l]);const h=p=>{const{prompt:g,id:v,actionType:y,uri:b,widgetName:C,source:S}=p,I=y==="deepLink"?JSON.stringify({uri:b}):void 0;nt({pageName:"chatPage",sectionName:"widgets",scenario:C,source:v,destination:pEe[y],customData:I}),n({actionType:y,id:v,prompt:g,uri:b,source:S})},f=p=>{const g=new URL(p);return g.searchParams.set("o","7"),g.searchParams.set("rm","3"),g.toString()};return!l||l.type!=="textAndImage"?null:d.jsx("div",{className:Be("grid w-full grid-cols-2 gap-6 px-2 sm:flex sm:items-center",s&&"scrollbar-container justify-start overflow-x-auto bp-960:justify-center bp-960:overflow-x-hidden",!s&&"sm:justify-center",e),ref:a,children:l.items.map((p,g)=>{const{id:v,text:y}=p,{type:b}=p.action,C="prompt"in p.action?p.action.prompt:void 0,S="uri"in p.action?p.action.uri:void 0,{altText:I,url:E}=p.thumbnail,T={actionType:b,id:v,prompt:C,uri:S,widgetName:l.id,source:"widgets"},w=g%2===0?"-rotate-2 hover:rotate-0":"rotate-2 hover:rotate-0";switch(l.id){case"kickstarter":return d.jsx(oM,{text:y,imgSrc:f(E),imgAlt:I,variant:"kickstarter",onClick:()=>h(T),className:w,fetchPriority:"high"},v);case"feature-discovery":return d.jsx(oM,{text:y,imgSrc:f(E),imgAlt:I,variant:"feature-discovery",onClick:()=>h(T),className:w,fetchPriority:"high"},v);case"image-generation":return d.jsx(fEe,{text:y,imgSrc:f(E),imgAlt:I,className:w,onClick:()=>h(T),fetchPriority:"high"},v);default:return null}})})}function gEe(t){const[e,n]=m.useState(!1),{tab:r,className:o=""}=t,{t:i}=xe();return e||!r.favIconUrl?d.jsx(yA,{className:Y("size-5",o)}):d.jsx("img",{src:r.favIconUrl,alt:i("composer.multiTabs.tabFavIconAltText"),className:Y("size-4 rounded bg-white",o),onError:()=>{n(!0)}})}function vEe(t){try{return new URL(t).hostname.replace(/^www\./,"")}catch{return null}}function yEe(t,e=5){const n=new Set;for(const r of t){if(n.size>=e)break;if(r.url){const o=vEe(r.url);o&&n.add(o)}}return Array.from(n).join(", ")}function bEe(t,e=5){const n=new Set;for(const r of t){if(n.size>=e)break;r.title&&n.add(r.title)}return Array.from(n).join(", ")}function CEe(t){const{tabs:e}=t,n=m.useMemo(()=>bEe(e,5),[e]),r=e.length-1;return d.jsxs("div",{className:"flex",children:[d.jsx("span",{className:"min-w-0 truncate font-semibold text-foreground-750 text-xs",children:n}),r>0&&d.jsxs("span",{className:"ms-1 font-semibold text-foreground-750 text-xs",children:["+",r]})]})}function SEe(t){const{tabs:e}=t,n=m.useMemo(()=>yEe(e,5),[e]);return d.jsx("span",{className:"truncate text-foreground-750 opacity-60 text-2xs",children:n})}function IEe(t,e){return`${t.id}-${t.url??""}-${e}`}function r7(t){const{tabs:e,onRemove:n,showRemoveIcon:r,onClick:o,isLoading:i=!1}=t,{t:s}=xe(),a=m.useMemo(()=>e.slice(0,3),[e]),l=h=>{h.stopPropagation(),n==null||n()},u=h=>{h.stopPropagation(),o==null||o()};return d.jsxs(Ne.div,{className:"relative flex h-[58px] w-full flex-row items-center justify-center gap-2 overflow-hidden rounded-xl border border-black/8 bg-white/90 p-3 dark:border-white/8 dark:bg-midnight-800/80",layout:"position",initial:ot,animate:Lt,exit:ot,onClick:u,children:[d.jsx("div",{className:Y("flex h-5 min-w-5 flex-none items-center justify-center rounded bg-white/90 dark:bg-midnight-800/80"),children:a.map((h,f)=>d.jsx(gEe,{tab:h,className:Y(f>0&&"-ms-[6px]")},IEe(h,f)))}),d.jsxs("div",{className:"me-7 flex min-w-0 flex-1 flex-col",children:[d.jsx(CEe,{tabs:e}),d.jsx(SEe,{tabs:e})]}),i&&d.jsx(wn,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45","data-testid":"multi-tabs-loading",children:d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(_t,{type:"spinnerThemed",className:"size-11"})})}),r&&d.jsx("button",{type:"button",title:s("composer.removeImage"),"aria-label":s("composer.removeImage"),onClick:l,tabIndex:0,className:"absolute end-0.5 top-0.5 m-1 rounded-full p-1 text-foreground-850 safe-hover:bg-black/5 dark:safe-hover:bg-black/30",children:d.jsx(Mr,{className:"size-3"})})]})}function EEe({onClick:t,showRemoveIcon:e=!0,isLoading:n=!1}){const[r,o]=Ze(Ra),i=m.useMemo(()=>Array.from(r.values()),[r]);return r.size===0?null:d.jsx("div",{className:"flex min-h-[60px] cursor-pointer flex-col gap-2","data-testid":"manual-multi-tabs-preview-card",children:d.jsx(r7,{showRemoveIcon:e,tabs:i,onRemove:()=>{o(new Map)},onClick:t,isLoading:n})})}const o7=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M11.7498 3C12.1295 3 12.4434 3.28201 12.4931 3.64808L12.5 3.74985L12.5012 11H19.7543C20.1685 11 20.5043 11.3358 20.5043 11.75C20.5043 12.1297 20.2221 12.4435 19.8561 12.4932L19.7543 12.5H12.5012L12.5032 19.7491C12.5033 20.1633 12.1676 20.4993 11.7534 20.4993C11.3737 20.4993 11.0598 20.2173 11.0101 19.8512L11.0032 19.7494L11.0012 12.5H3.7522C3.33798 12.5 3.0022 12.1642 3.0022 11.75C3.0022 11.3703 3.28435 11.0565 3.65043 11.0068L3.7522 11H11.0012L11 3.75015C10.9999 3.33594 11.3356 3 11.7498 3Z"})),KMe=Object.freeze(Object.defineProperty({__proto__:null,default:o7},Symbol.toStringTag,{value:"Module"}));function TEe({onRef:t,onClick:e,onButtonRef:n}){const{t:r}=xe(),o=x(Db);return d.jsx(Zo,{data:{title:r("common.open"),testId:"plus-button",isVisible:!0,ariaExpanded:o==="plus",onClick:e},ref:t,onButtonRef:n,children:d.jsx(o7,{className:"size-6","aria-hidden":!0})})}const i7=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.92188 11.8237H19.4529C19.4529 11.8237 19.4529 9.89366 19.4529 9.6831C18.6246 6.41578 15.6854 4 12.1862 4C9.56739 4 7.26337 5.35396 5.92188 7.4044C5.92188 8.82754 5.92188 11.8237 5.92188 11.8237Z",fill:"#0364B8"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.15227 8.30349L9.15203 8.30431C8.23597 7.73294 7.1565 7.40234 6.00013 7.40234C5.97439 7.40234 5.94909 7.404 5.92344 7.40431C2.64519 7.44587 0 10.1364 0 13.4511C0 14.7371 0.399257 15.9285 1.07801 16.9086H14.1906V11.3459L9.15227 8.30349Z",fill:"#0078D4"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.4514 9.68327C19.3425 9.67596 19.233 9.6709 19.1223 9.6709C18.4357 9.6709 17.7825 9.81469 17.1899 10.073L14.1875 11.3461V16.9176H23.4143C23.7861 16.2237 23.9974 15.4296 23.9974 14.5855C23.9974 11.9828 21.9902 9.85405 19.4514 9.68327Z",fill:"#1490DF"}),m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.1602 14.3467L17.9151 13.5949L15.0613 11.8716L14.1907 11.3459L11.8941 12.3202L7.49635 14.1859L5.52123 15.0238L1.07812 16.9087C2.16256 18.4747 3.96212 19.5 6.00025 19.5H19.1255C20.9807 19.5 22.5937 18.4551 23.4175 16.9175L19.1602 14.3467Z",fill:"#28A8EA"})),qMe=Object.freeze(Object.defineProperty({__proto__:null,default:i7},Symbol.toStringTag,{value:"Module"})),kA=t=>m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",null,m.createElement("path",{id:"Shape",d:"M11.7717 3.74212C14.1132 1.39853 17.9121 1.39853 20.2553 3.74168C22.5384 6.02474 22.5969 9.68995 20.4309 12.0439L20.2428 12.2413L11.4427 21.0395L11.4062 21.0697C9.94492 22.3865 7.69092 22.3417 6.28355 20.9344C4.96453 19.6153 4.84241 17.5527 5.9172 16.096C5.94054 16.0506 5.96879 16.0068 6.002 15.9657L6.05556 15.9061L6.14247 15.8183L6.28355 15.6704L6.28647 15.6733L13.7222 8.21901C13.9881 7.95239 14.4047 7.92763 14.6986 8.14509L14.7829 8.2176C15.0495 8.48351 15.0742 8.90014 14.8568 9.19404L14.7843 9.27826L7.18966 16.8913C6.47202 17.7669 6.5219 19.0612 7.3393 19.8786C8.16836 20.7077 9.48801 20.7472 10.3638 19.997L19.1965 11.1666C20.952 9.40894 20.952 6.5597 19.1946 4.80234C17.4922 3.0999 14.765 3.0467 12.9986 4.64274L12.8307 4.80234L12.8181 4.81665L3.28179 14.353C2.9889 14.6459 2.51403 14.6459 2.22113 14.353C1.95487 14.0867 1.93066 13.67 2.14852 13.3764L2.22113 13.2923L11.77 3.74168L11.7717 3.74212Z",fill:"currentColor"}))),WMe=Object.freeze(Object.defineProperty({__proto__:null,default:kA},Symbol.toStringTag,{value:"Module"})),s7=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",...t},m.createElement("path",{fill:"currentColor",d:"M6.3 3A3.2 3.2 0 0 0 3 6.3v11.4C3 19.6 4.5 21 6.3 21h11.4c1.8 0 3.3-1.5 3.3-3.3V6.3C21 4.5 19.5 3 17.7 3H6.3ZM4.5 6.3c0-1 .8-1.8 1.8-1.8h11.4c1 0 1.8.8 1.8 1.8v11.4c0 1-.8 1.8-1.8 1.8H6.3c-1 0-1.8-.8-1.8-1.8V6.3ZM8 7.5c-.3 0-.5.2-.5.5v2.3a.8.8 0 0 1-1.5 0V8c0-1.1.9-2 2-2h2.3a.8.8 0 0 1 0 1.5H8Zm0 9a.5.5 0 0 1-.5-.5v-2.3a.8.8 0 0 0-1.5 0V16c0 1.1.9 2 2 2h2.3a.8.8 0 0 0 0-1.5H8ZM16.5 8c0-.3-.2-.5-.5-.5h-2.3a.8.8 0 0 1 0-1.5H16a2 2 0 0 1 2 2v2.3a.8.8 0 0 1-1.5 0V8Zm-.5 8.5c.3 0 .5-.2.5-.5v-2.3a.8.8 0 0 1 1.5 0V16a2 2 0 0 1-2 2h-2.3a.8.8 0 0 1 0-1.5H16Z"})),YMe=Object.freeze(Object.defineProperty({__proto__:null,default:s7},Symbol.toStringTag,{value:"Module"})),a7=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...t},m.createElement("path",{d:"M3 5.75A2.75 2.75 0 0 1 5.75 3h12.5A2.75 2.75 0 0 1 21 5.75v6.272a6.471 6.471 0 0 0-1.5-.709V5.75c0-.69-.56-1.25-1.25-1.25H5.75c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25h5.563c.173.534.412 1.037.709 1.5H5.75A2.75 2.75 0 0 1 3 18.25V5.75ZM23 17.5a5.5 5.5 0 1 0-11 0 5.5 5.5 0 0 0 11 0Zm-5 .5.001 2.503a.5.5 0 1 1-1 0V18h-2.505a.5.5 0 0 1 0-1H17v-2.5a.5.5 0 1 1 1 0V17h2.497a.5.5 0 0 1 0 1H18Z"})),QMe=Object.freeze(Object.defineProperty({__proto__:null,default:a7},Symbol.toStringTag,{value:"Module"})),jh=Y("flex w-full flex-row items-center gap-2");function wEe(t){const{startNewChatDisabled:e,startNewConversation:n,selectFile:r,selectOneDriveFile:o,takeScreenshot:i,selectUserOpenedTabs:s,uploadButtonDisabled:a=!1}=t,l=m.useRef(null),{t:u}=xe(),h=x(hl),f=x(it),p=m.useRef(void 0);return qb(l),m.useEffect(()=>{i&&p.current!==f&&TSe(f)},[f,i]),d.jsxs(Ll,{className:"pointer-events-auto relative flex flex-col rounded-2xl contrast-more:border-2","data-testid":"composer-plus-menu",role:"menu",circular:!0,children:[d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:"ps-3.5",title:u("composer.startNewChat"),onClick:n,testId:"new-chat-button",ref:l,disabled:e,children:d.jsxs("div",{className:jh,children:[d.jsx(zb,{className:"size-5"}),u("composer.startNewChatShort")]})}),r&&!h&&d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.upload"),disabled:a,testId:"file-upload-button",onClick:g=>{g.preventDefault(),r()},children:d.jsxs("div",{className:jh,children:[d.jsx(kA,{className:"size-6"})," ",u("composer.upload")]})}),i&&d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.takeScreenshot"),onClick:g=>{g.preventDefault(),g.stopPropagation(),i(),kSe(f)},children:d.jsxs("div",{className:jh,children:[d.jsx(s7,{className:"size-6"}),u("composer.takeScreenshotShort")]})}),o&&d.jsx(Te,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",title:u("composer.addFromOneDrive"),onClick:g=>{g.preventDefault(),g.stopPropagation(),o()},children:d.jsxs("div",{className:jh,children:[d.jsx(i7,{className:"size-6"}),u("composer.addFromOneDrive")]})}),s&&d.jsx(Te,{role:"menuitem",variant:"rect",testId:"add-tabs-button",color:"subtle-dimmed-inverted",title:u("composer.multiTabs.addTab"),onClick:g=>{g.preventDefault(),g.stopPropagation(),s()},children:d.jsxs("div",{className:jh,children:[d.jsx(a7,{className:"size-6"}),u("composer.multiTabs.addTab")]})})]})}function _Ee(){const[t,e]=m.useState(!1);return m.useEffect(()=>{async function n(){const{uiOverrides:{showScreenshotButton:r=()=>Promise.resolve(!1)}={}}=me.instance().config(),o=await r();e(o)}n().catch(()=>{})},[]),t}function AEe({startNewChatDisabled:t,uploadButtonDisabled:e=!1,onStartNewConversation:n,onSelectFileIfEnabled:r,onSelectOneDriveFileIfEnabled:o,onTakeScreenshot:i,onSelectUserOpenedTabsIfEnabled:s,onRef:a}){const[l,u]=Ze(Db),h=_Ee(),p=`plus-menu-${Ep()}`,g=l==="plus";return d.jsx(Hb,{isOpen:g,onIsOpenChange:v=>u(y=>v?"plus":y==="plus"?null:y),renderTrigger:v=>d.jsx(TEe,{onRef:v.ref,onButtonRef:a,onClick:y=>{v.onClick(y),nt({source:"composerPlusButton",pageName:"chatPage",customData:JSON.stringify({isOpen:g})})}}),options:{placement:"top-start",offset:{mainAxis:10,crossAxis:-12},hideOnMenuClick:!0},className:Be(mi,"p-2"),children:d.jsx(wEe,{startNewChatDisabled:t,uploadButtonDisabled:e,startNewConversation:n,selectFile:r,selectOneDriveFile:o,takeScreenshot:h?i:void 0,selectUserOpenedTabs:s})},p)}function c7(){const t=XU(),e=x(it),n=x(OT),r=m.useCallback(async({url:i,args:s,conversationId:a})=>{const l=await $n(i,f5,{query:s,analytics:{anonymousPath:"/conversations/*/history"},parseOptions:{safe:!0}}).then(u=>u.data);return l.results.length>0&&(l.results=O8(l.results),t(a,u=>{var h;u.length===0&&kEe((h=l.results.at(0))==null?void 0:h.createdAt),l.results.reverse(),u.unshift(...l.results)})),l},[t]);return Y_(r,(i,s)=>{if(!e||n!=null&&n.prompt||!(s!=null&&s.next)&&i>0)return null;const a={url:`/conversations/${e}/history`,conversationId:e};return s!=null&&s.next&&(a.args={cursor:s.next}),a})}function kEe(t){try{const e=Ue(eo),n=e==null?void 0:e.updatedAt;if(!t||!n)return;const r=new Date(n),o=new Date(t);(r.getTime()-o.getTime())/1e3/60>1&&U.trackEvent({name:"system",data:{eventName:"historyUpdatedAtDiscrepancy",eventInfo_conversationId:e.id,eventInfo_conversationUpdatedAt:n,eventInfo_lastMessageCreatedAt:t}})}catch{}}const xEe=3,REe=10,NEe=3,iM={SUCCESS:"success",FAILED:"failed"};function PEe({toggleVoiceChat:t,enabled:e=!1}){const n=m.useRef(t);n.current=t;const r=m.useRef({hasAudio:!0,hasText:!0,retryCount:0,consecutiveErrors:0,isFirstTurn:!0}),[o,i]=m.useState(!1),s=x(it),a=m.useCallback(g=>{const v=r.current;let y="initialAutoRetry";o?y="userManualRetry":v.isFirstTurn?y="initialAutoRetry":v.consecutiveErrors>0&&(y="backendAutoRecover");const b=JSON.stringify({retryCount:v.retryCount,consecutiveErrors:v.consecutiveErrors});U.trackEvent({name:"system",data:{eventName:"voiceRecoveryEventData",eventInfo_result:g,eventInfo_scenario:y,eventInfo_customData:b,eventInfo_conversationId:s??""}})},[o,s]),l=m.useCallback(async()=>{n.current("end",{force:!0}),await tA(),n.current("start",{force:!0}),r.current.isFirstTurn=!0,r.current.retryCount+=1},[]),u=m.useCallback(()=>{a(iM.FAILED),n.current("end",{force:!0}),r.current.retryCount=0,r.current.consecutiveErrors=0,i(!0)},[a,i]),h=m.useCallback(()=>{(r.current.retryCount>0||r.current.consecutiveErrors>0||o)&&a(iM.SUCCESS),r.current.retryCount=0,r.current.consecutiveErrors=0,i(!1)},[i,a,o]),f=m.useCallback(()=>{const g=r.current;if(!o&&g.isFirstTurn&&g.retryCount<REe){l();return}if(!(!g.isFirstTurn&&!o&&(g.consecutiveErrors+=1,g.consecutiveErrors<NEe))){if(o&&g.retryCount<xEe){l();return}u()}},[o,l,u]);return{voiceRecoveryHandler:m.useCallback(g=>{if(e)switch(g.event){case"startMessage":r.current.hasAudio=!1,r.current.hasText=!1;break;case"appendText":r.current.hasText=!0;break;case"audio":r.current.hasAudio=!0,h();break;case"done":r.current.hasText&&!r.current.hasAudio&&f(),r.current.isFirstTurn=!1;break}},[h,f,e]),isNoAudioErrorVisible:e?o:!1}}const fy=class fy{constructor(){j(this,"readyTime",0);j(this,"startCallTime",0);j(this,"startMessageTime",0);j(this,"mostRecentTokenTime",0);j(this,"interruptAudioTime",0);j(this,"speechEndTime",0);j(this,"currentConversationId","");j(this,"currentCallId","");j(this,"currentMessageId","");j(this,"introComplete",!1);j(this,"receivedTranscript",!1);j(this,"receivedText",!1);j(this,"receivedAudio",!1);j(this,"receivedFirstToken",!1);j(this,"receivedLastToken",!1);j(this,"receivedFirstAnimation",!1);j(this,"hasAudioStarted",!1);j(this,"scenario")}static getInstance(){return this.instance||(this.instance=new fy),this.instance}onBeforeStartCall(e){this.readyTime=performance.now(),this.scenario=e?"appearance":void 0}onStartCall(e){this.interruptAudioTime=0,this.speechEndTime=0,this.introComplete=!1,this.startCallTime=performance.now(),this.currentConversationId=e,this.currentCallId=crypto.randomUUID(),U.trackEvent({name:"interaction",data:{eventName:"copilotCompose",eventInfo_conversationId:this.currentConversationId,eventInfo_inputMethod:"voice",eventInfo_landingPage:U.getLandingPage(),eventInfo_scenario:this.scenario}}),U.trackEvent({name:"interaction",data:{eventName:"audioStartSent",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.startCallTime-this.readyTime,eventInfo_scenario:this.scenario}})}onStartMessage(e){this.receivedTranscript=!1,this.receivedText=!1,this.receivedAudio=!1,this.receivedFirstToken=!1,this.receivedLastToken=!1,this.receivedFirstAnimation=!1,this.hasAudioStarted=!1,this.currentMessageId=e,this.startMessageTime=performance.now(),Yg.onStartMessage(e,this.startMessageTime),this.speechEndTime&&U.trackEvent({name:"system",data:{eventName:"copilotAudioReqtoResp",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.startMessageTime-this.speechEndTime,eventInfo_scenario:this.scenario}}),U.trackEvent({name:"system",data:{eventName:"copilotAudioStartMessage",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete}})}onTranscriptReceived(){this.receivedTranscript=!0}onTextReceived(e){e===this.currentMessageId&&(this.receivedText=!0)}onAudioInterrupt(){this.interruptAudioTime=performance.now()}onAudioReceived(){this.receivedAudio=!0,!(!this.introComplete||!this.currentMessageId)&&(this.mostRecentTokenTime=performance.now(),this.receivedFirstToken||(this.receivedFirstToken=!0,this.startMessageTime&&U.trackEvent({name:"system",data:{eventName:"copilotAudioResptoReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime-this.startMessageTime,eventInfo_scenario:this.scenario}}),this.speechEndTime&&U.trackEvent({name:"system",data:{eventName:"copilotAudioFirstTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario}})))}onSpeechEndDetected(){this.speechEndTime=performance.now(),Yg.onSpeechEndDetected(this.speechEndTime),this.interruptAudioTime&&U.trackEvent({name:"system",data:{eventName:"copilotAudioInput",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.speechEndTime-this.interruptAudioTime,eventInfo_scenario:this.scenario}})}onCallUIEventReceived(){const e=performance.now(),n=this.speechEndTime?e-this.speechEndTime:void 0;U.trackEvent({name:"system",data:{eventName:"callUIEventReceived",eventInfo_scenario:"adaptiveUI",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:n}})}onCharacterAnimationReceived(){this.receivedFirstAnimation||(this.receivedFirstAnimation=!0,U.trackEvent({name:"system",data:{eventName:"copilotAudioCharacterAnimationReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_messageId:this.currentMessageId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario}}))}onMessageDone(e){const{messageId:n,voiceType:r}=e;if(U.trackEvent({name:"system",data:{eventName:"copilotAudioMessageDone",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:n,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete,eventInfo_transcriptReceived:this.receivedTranscript,eventInfo_textReceived:this.receivedText,eventInfo_audioReceived:this.receivedAudio}}),!this.introComplete){this.introComplete=!0,U.trackEvent({name:"system",data:{eventName:"copilotAudioCallSetUp",eventInfo_duration:performance.now()-this.readyTime,eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_responseVoiceType:r,eventInfo_scenario:this.scenario}});return}!this.receivedLastToken&&n===this.currentMessageId&&(this.receivedLastToken=!0,this.speechEndTime&&U.trackEvent({name:"system",data:{eventName:"copilotAudioLastTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:n,eventInfo_callId:this.currentCallId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario}}),U.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_inputMethod:"voice",eventInfo_responseMethod:"voice",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_responseVoiceType:r,eventInfo_landingPage:U.getLandingPage(),eventInfo_scenario:this.scenario}}))}onEndCall(e){const n=performance.now()-this.startCallTime;U.trackEvent({name:"system",data:{eventName:"copilotAudioCallEnd",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:n,eventInfo_numMessages:e,eventInfo_scenario:this.scenario}}),this.currentCallId=""}onAudioStartFailed(e){U.trackEvent({name:"system",data:{eventName:"copilotAudioStartFailed",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:e,reason:e,eventInfo_scenario:this.scenario}})}onAudioStartTimeout(e){U.trackEvent({name:"system",data:{eventName:"copilotAudioStartTimeout",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:e,eventInfo_scenario:this.scenario}})}onTerminated(e){U.trackEvent({name:"system",data:{eventName:"copilotAudioTerminated",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:e,reason:e,eventInfo_scenario:this.scenario}})}onError(e){U.trackEvent({name:"system",data:{eventName:"copilotAudioError",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_errorCode:e,eventInfo_scenario:this.scenario}})}onAudioStart(){if(!this.hasAudioStarted){this.hasAudioStarted=!0;const e=Math.round(performance.now()-(this.speechEndTime||this.startMessageTime));U.trackEvent({name:"system",data:{eventName:"copilotAudioStart",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:e,eventInfo_scenario:this.scenario}})}}};j(fy,"instance");let fE=fy;const MEe=null;function OEe(t){return t instanceof Error&&(t.name==="NotFoundError"||t.name==="OverconstrainedError")}function LEe({initAudio:t,getAudioConstraints:e,onCallTerminated:n,onSpeechEndDetected:r,keepAudioInputAlive:o=!1,shouldRefetchHistory:i=!0,isVoiceRecoveryEnabled:s=!1}){const a=ve(Ic),l=ve(cX),u=ve(Sp),h=se("voice-call-jingles"),f=ve(JJ),p=x(it),g=x(Uy),v=x(Cp),y=ve(rf),b=ve(XJ),C=ve(Dc),S=ve(Dd),I=se("voice-speed"),E=x(DX),T=XU(),{refetch:w}=c7(),{showBoundary:A}=lO(),{isLivingPortraitEnabled:_}=KT(),L=x(pD),N=ve(_U),K=m.useRef("inactive"),q=DD(),ae=m.useRef(0),[O,W]=m.useState(!t),te=fE.getInstance();m.useEffect(()=>{t||(W(!0),y("waiting-for-user-interaction"))},[t,W,y]),m.useEffect(()=>{cn.AudioIn.toggleMute(O)},[O]);const D=m.useCallback(async()=>{p&&(T(p,k=>k.splice(0)),await w())},[w,p,T]),G=m.useCallback(()=>{cn.AudioOut.stopAudioPlayback(),q&&cn.Animation.stopAnimation()},[q]),re=m.useCallback(async k=>{K.current="ending",cn.AudioIn.stopAudioCapture(),G(),W(!1),k.sendAudioEnd(),f("idle"),Ue(rf)==="available"&&(h&&cn.AudioOut.playCallEndJingle(),i&&await D(),te.onEndCall(ae.current),ae.current=0,S(!0))},[G,f,h,i,te,S,D]),J=m.useCallback(async k=>{const{AudioIn:B}=cn,ge=Q=>{Q instanceof CustomEvent&&typeof Q.detail=="string"&&k.sendAudio(Q.detail)},M=async()=>{o&&K.current==="active"&&J(k),B.removeEventListener("audioData",ge),B.removeEventListener("audioTrackEnded",M)};try{await B.startAudioCapture(e),B.addEventListener("audioData",ge),B.addEventListener("audioTrackEnded",M)}catch(Q){Q instanceof Error&&(Q.name==="NotAllowedError"||Q.name==="NotSupportedError")?(y("microphone-denied"),await re(k),U.trackEvent({name:"system",data:{eventName:"copilotNoMicrophoneAccess"}})):OEe(Q)?(y("microphone-not-found"),await re(k),U.trackEvent({name:"system",data:{eventName:"copilotMicrophoneNotFound"}})):A(new Error(`Error starting audio capture: ${Q}`))}},[o,e,y,re,A]),ne=m.useCallback(k=>{const B=k==="mute";W(B),En(Khe,B)},[]),X=m.useCallback(async k=>{cn.currentTurnIndex+=1,cn.AudioIn.audioContext||J(k);const B=I?E:pp;await cn.AudioOut.initialize(B),cn.Animation.initialize(q),Ue(DT)&&ne("mute")},[E,q,I,J,ne]),Ie=m.useCallback(()=>{if(_)return"portrait";const k=me.instance().config().audioConfigClientType;if(k)return k;if(q)return"character"},[q,_]),Ce=m.useCallback(async k=>{var Q;if(!p||!t||K.current==="ending")return;y("checking-availability"),b(null);const{sendAudioStart:B}=k,ge=Ie();B(p,{voice:_&&L?L.voiceId:v??((Q=g[0])==null?void 0:Q.id)},ge),cn.currentTurnIndex=0;const M=1e4;setTimeout(()=>{Ue(rf)==="checking-availability"&&K.current==="active"&&te.onAudioStartTimeout(M)},M),te.onStartCall(p),h&&await cn.AudioOut.playCallStartJingle(),ku("onStartVoiceChat")},[p,t,y,v,g,te,b,h,Ie,_,L]),be=m.useCallback(async(k,B)=>{await re(k),n(B)},[re,n]),ue=m.useRef(null),Me=m.useCallback(k=>B=>{var ge,M;switch(B.event){case"startMessage":{const{messageId:Q}=B;if(te.onStartMessage(Q),G(),K.current==="inactive")break;X(k),y("available"),f("listening");break}case"transcriptEvent":{te.onTranscriptReceived();break}case"appendText":{const{messageId:Q}=B;te.onTextReceived(Q);break}case"audioStartFailed":{const{reason:Q}=B,{success:fe}=L5.safeParse(Q);y(fe?Q:"error"),te.onAudioStartFailed(Q);break}case"audioTimeRemaining":{const{seconds:Q}=B;b(Q);break}case"audio":{if(K.current==="inactive")break;te.onAudioReceived(),cn.AudioOut.appendAudioData(B.audio);break}case"characterAnimation":{te.onCharacterAnimationReceived(),q&&cn.Animation.setFrameData(B);break}case"callUI":{const{callUI:Q}=B,fe=Ue(Xh);Q?Array.isArray(Q.topics)?(Q.selectedIndex??(Q.selectedIndex=-1),En(Xh,Q)):En(Xh,{...fe??{},...Q,topics:(fe==null?void 0:fe.topics)??null}):En(Xh,null),te.onCallUIEventReceived();break}case"characterEmotion":{q&&l({emotion:B.emotion,bodyReaction:B.bodyReaction});break}case"interruptAudio":{f("listening"),a("listening"),te.onAudioInterrupt(),G(),l(null);break}case"speechEndDetected":{te.onSpeechEndDetected(),a("thinking"),r==null||r();break}case"callTerminated":{be(k,B.reason),te.onTerminated(B.reason);break}case"error":{const{errorCode:Q}=B;switch(Q){case"over-turn-limit":{C(0);break}case"character-out-of-capacity":{k.setCallType("standard");break}}K.current==="active"&&te.onError(Q);break}case"done":{const{messageId:Q}=B;ae.current+=1,cn.AudioOut.setAudioDone(),cn.Animation.setAnimationDone(),te.onMessageDone({messageId:Q,voiceType:v??((ge=g[0])==null?void 0:ge.id)});break}case"banned":{const{expiresAt:Q}=B,fe=F_(Q);fe&&(B_(fe,"voice",Q),G(),re(k));break}case"callTypeChanged":{const{callType:Q}=B;Q==="standard"&&u(void 0);break}}try{(M=ue.current)==null||M.call(ue,B)}catch{}},[te,G,X,y,f,q,b,a,r,be,C,v,g,re,u,l]),Ye=m.useCallback(()=>k=>{switch(k.event){case"callEnded":{K.current="inactive";break}}},[]),le=m.useCallback(async(k,B)=>{const{force:ge=!1}=B??{};if(k==="start"&&K.current!=="inactive"&&!ge||(k==="start"&&te.onBeforeStartCall(q),k==="end"&&K.current==="inactive"&&!ge))return;K.current=k==="start"&&t?"active":"inactive",Yg.onVoiceChatToggled(k,p);const M=await ts({useMockConnection:!!MEe});k==="start"?(M.setOnEvent(Me(M)),await Ce(M)):(M.setOnEvent(Ye()),await re(M))},[t,p,q,te,Me,Ce,Ye,re]),{voiceRecoveryHandler:we,isNoAudioErrorVisible:Ke}=PEe({toggleVoiceChat:le,enabled:s});return ue.current=we,m.useEffect(()=>{const{AudioOut:k}=cn,B=()=>{N(!0),f("responding"),a("responding"),te.onAudioStart()},ge=()=>{N(!1),f("listening"),a("listening")};return k.addEventListener("audioStart",B),k.addEventListener("audioEnd",ge),()=>{k.removeEventListener("audioStart",B),k.removeEventListener("audioEnd",ge)}},[a,N,f,te]),{toggleVoiceChat:le,toggleMute:ne,isInputMuted:O,inputVolume:cn.AudioIn.volume,isNoAudioErrorVisible:Ke}}const JMe="https://picassostaticassetsstg.azureedge.net/character/try-now/lumi_intro_394_222";function sM(t,e){if(!t)return!1;const n=yn(bG)??yn(CG);return!e&&!n}function DEe({isAudioCall:t,onCallTerminated:e,onMute:n,onUnmute:r}){const o=$t(),i=rD(),[s,a]=Mb(),l=s==="audioCall",[u,h]=m.useState(!1),f=x(Sp),p=se("appearance-try-now-modal"),g=x(DT),{state:v,setState:y}=Q_({defaultValue:!l}),{toggleVoiceChat:b,toggleMute:C,inputVolume:S,isInputMuted:I}=LEe({initAudio:v,onCallTerminated:e}),E=m.useRef(b);E.current=b,m.useEffect(()=>{t?!l&&!sM(p,f)&&!g&&E.current("start"):E.current("end")},[o,t,l,E,f,g,p]);const T=m.useCallback(()=>{b("start"),v&&!u&&(h(!0),C("unmute"))},[b,v,u,C]),w=m.useCallback(()=>{a(),y(!0),b("end")},[a,y,b]),A=m.useCallback(()=>{y(!0),C(I?"unmute":"mute"),I?r==null||r():n==null||n()},[y,C,I,n,r]);m.useEffect(()=>{t&&l&&v&&T()},[v,t,l,T]);const _=m.useCallback(async(K=!1)=>{(!t||K)&&await L()!=="NotSupported"||(await i({talk:!0}),sM(p,f)||T())},[t,p,i,f,T]);m.useEffect(()=>{l&&_(!0)},[l,_]);async function L(){return(await Mue.run({onAudioCall:async()=>"NotSupported"})).onAudioCall()}const N=m.useCallback(K=>{const{toLocation:q}=K,ae=q.pathname;t&&!ae.endsWith("/talk")&&E.current("end")},[t]);return D_(N),{launchAudioCall:_,startAudioCallIfNotStartedAlready:T,endAudioCall:w,toggleAudioInput:A,inputVolume:S,isInputMuted:I,isAudioDeepLink:l,canInitAudio:v}}const l7=crypto.randomUUID();function jEe(){return{sdk:"8.0",messaging:{origin:window.location.origin,channelId:l7},accessibility:{showFocusOnLoad:!1,enableFocusTrap:!0},authentication:{},entry:{oneDrive:{recent:{}}},typesAndSources:{mode:"files",filters:ige(),pivots:{oneDrive:!0,recent:!0,photos:!1}}}}function UEe(){const t=new URLSearchParams({app:"CMC",scenario:"AnalyzeDoc",filePicker:JSON.stringify(jEe()),locale:Rt.resolvedLanguage??"en-US"});return`${u7}/picker?${t}`}const u7="https://onedrive.live.com";async function d7(){const t=await $ue();return(t==null?void 0:t.accessToken)??""}function FEe(t){return t!==null&&typeof t=="object"&&"type"in t&&t.type==="initialize"&&"channelId"in t&&typeof t.channelId=="string"}function BEe({port:t,onClose:e,onPick:n,setIsLoading:r,onError:o}){return async i=>{let s;switch(i.data.type){case"notification":i.data.data.notification==="page-loaded"&&r(!1);break;case"command":switch(t.postMessage({type:"acknowledge",id:i.data.id}),i.data.data.command){case"authenticate":s=await d7(),typeof s<"u"?t.postMessage({type:"result",id:i.data.id,data:{result:"token",token:s}}):(t.postMessage({type:"result",id:i.data.id,data:{result:"error",error:{code:"authTokenError",message:"Could not get OneDrive authentication token."}}}),r(!1),o(),e());break;case"close":e();break;case"pick":i.data.data.items!==void 0&&i.data.data.items.length>0&&i.data.data.items[0]!==void 0&&(n(i.data.data.items[0]),t.postMessage({type:"result",id:i.data.id,data:{result:"success"}}),e());break;default:r(!1),t.postMessage({result:"error",error:{code:"unsupportedCommand",message:i.data.data.command},isExpected:!0}),o(),e();break}break}}}function HEe({onClose:t,onPick:e,onError:n}){const r=m.useRef(null),{t:o}=xe(),[i,s]=m.useState(!0);return m.useEffect(()=>{var f;const a=()=>{const p={title:o("composer.errors.attachmentOneDrive.title"),message:o("composer.errors.attachmentOneDrive.message")};n(p),U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:p.message,eventInfo_details:"Error submitting message"}})},l=(f=r.current)==null?void 0:f.contentWindow;let u,h;return l&&(async()=>{const g=l.document.createElement("form");g.method="POST",g.action=UEe(),l.document.body.appendChild(g);const v=l.document.createElement("input");v.type="hidden",v.name="access_token",v.value=await d7(),g.appendChild(v),window.addEventListener("message",y=>{if(y.origin&&y.origin===u7){const b=y.data;if(FEe(b)&&b.channelId===l7){if([h]=y.ports,!h){s(!1),a(),t();return}u=BEe({port:h,onClose:t,onPick:e,onError:a,setIsLoading:s}),h.addEventListener("message",u),h.start(),h.postMessage({type:"activate"})}}}),g.submit()})(),()=>{u&&window.removeEventListener("message",u),h&&h.close()}},[t,e,n,o]),d.jsxs(Ol,{isOpen:!0,onClose:t,className:"flex h-[90vh] max-h-[680px] w-[90vw] max-w-[1080px]",fullBleed:!0,children:[i&&d.jsxs("div",{className:"flex size-full items-center justify-center","aria-live":"polite",role:"status","aria-label":o("oneDrive.pickerLoading"),children:[d.jsx("span",{className:"sr-only",children:o("oneDrive.pickerLoading")}),d.jsx(_t,{className:"size-20"})]}),d.jsx("iframe",{title:o("onedrive.filePicker"),ref:r,hidden:i,width:"100%",height:"100%"})]})}const zEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/add-BTcFT5ig.svg",VEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/image-zMo0jLdY.svg",$Ee="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/podcast-BQmBU8ew.svg",GEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/quiz-BBvkoZrF.svg",KEe="https://studiostaticassetsprod.azureedge.net/bundle-cmc/assets/research-i8a7tpJF.svg";function qEe(t){const{onPrefillComposerInput:e,disabled:n=!1}=t,r=x(BT),o=x(Vy),[i,s]=Ze(hn),a=x(br),l=x($y),u=Sr(),h=ve(_l),f=Wb(),{handleSubscription:p}=ay({payflowEntryPoint:"PodcastLimit",skuType:l?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Button"}),{handleSubscription:g}=ay({payflowEntryPoint:"DeepResearchLimit",skuType:l?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Button"}),v=WEe({remainingPodcastGeneration:r,remainingResearchReportGeneration:o,isPro:(a==null?void 0:a.isPro)??!1}),y=ve(Zj),b=TA(),C=m.useCallback(E=>{const T=v[E];if(T){switch(T.key){case"image":y("image");break;case"podcast":if(!u&&r===0){h({isOpen:!0,scenario:"podcast",reason:"createPodcast"});return}if(!(a!=null&&a.isPro)&&r===0){if(!f)return;p();return}y("podcast");break;case"researchReport":if(!u&&o===0){h({isOpen:!0,scenario:"researchReport",reason:"createResearchReport"});return}if(!(a!=null&&a.isPro)&&o===0){if(!f)return;g();return}y("researchReport"),s("research");break;case"quiz":y("quiz");break;case"actions":y("actions"),s("computerUse");break;default:y(null);break}e(T.composerInputPrompt??"")}},[v,y,e,a,r,o,f,p,g,u,h,s]),S=m.useCallback(()=>{y(null),uE(),s("chat")},[y,s]),I=m.useRef(null);return m.useEffect(()=>{var E;b.length===0&&i!=="research"&&i!=="computerUse"&&((E=I.current)==null||E.setSelectedItemIndex(0),S())},[b,S,i]),d.jsx(vA,{ref:I,items:v,onSelect:C,defaultSelectedItemIndex:0,onReset:S,disabled:n,onMenuClick:()=>nt({source:"composerCreateButton",pageName:"chatPage"})})}function nu(t){return e=>{ISe(t,e)}}function ru(t){return e=>{wSe(t,e)}}function WEe({remainingPodcastGeneration:t,remainingResearchReportGeneration:e,isPro:n}){const r=se("podcast-in-create-drawer"),o=f8(),i=Z_(),s=r,a=o,l=se("quiz-in-create-drawer"),{t:u}=xe("translation",{keyPrefix:"composer.create"});return m.useMemo(()=>{const f={key:"create",title:u("buttonTitle"),icon:d.jsx(Hn,{url:zEe,className:"size-5"}),description:u("buttonDescription"),composerInputPrompt:"",testId:"composer-create-button",onImpression:nu(null),beforeClick:ru(null),isIconEnabledInButton:!0},p={key:"image",title:u("image.title"),icon:d.jsx(Hn,{url:VEe,className:"size-6"}),description:u("image.description"),composerInputPrompt:u("image.prompt"),testId:"composer-create-image-button",onImpression:nu("image"),beforeClick:ru("image")};function g(){return{key:"podcast",title:u("podcast.title"),icon:d.jsx(Hn,{url:$Ee,className:"size-6"}),description:u("podcast.description"),composerInputPrompt:u("podcast.prompt"),testId:"composer-create-podcast-button",onImpression:nu("podcast"),beforeClick:ru("podcast"),tags:t!==null&&n===!1?[{label:u("podcast.remainingCalls",{remainingCalls:t.toString()}),color:t>0?"neutral":"accent"}]:void 0}}function v(){return{key:"researchReport",title:u("researchReport.title"),icon:d.jsx(Hn,{url:KEe,className:"size-6"}),description:u("researchReport.description"),composerInputPrompt:u("researchReport.prompt"),testId:"composer-create-research-report-button",onImpression:nu("researchReport"),beforeClick:ru("researchReport"),tags:e!==null&&n===!1?[{label:u("researchReport.remainingCalls",{remainingCalls:e.toString()}),color:e>0?"neutral":"accent"}]:void 0}}function y(){return{key:"quiz",title:u("quiz.title"),icon:d.jsx(Hn,{url:GEe,className:"size-6"}),description:u("quiz.description"),composerInputPrompt:u("quiz.prompt"),testId:"composer-create-quiz-button",onImpression:nu("quiz"),beforeClick:ru("quiz")}}function b(){return{key:"actions",title:u("actions.title"),icon:d.jsx(Hn,{url:h8,className:"size-6"}),description:u("actions.description"),composerInputPrompt:u("actions.prompt"),testId:"composer-create-actions-button",onImpression:nu("actions"),beforeClick:ru("actions"),tags:n===!1?[{label:u("actions.labsTag"),color:"accent"}]:void 0}}return[f,p,a?v():void 0,s?g():void 0,l?y():void 0,i?b():void 0].filter(C=>C!==void 0)},[t,n,u,i,s,a,e,l])}function YEe({selectFile:t,disabled:e=!1}){const{t:n}=xe();return d.jsx("div",{className:"flex",children:d.jsx(Te,{role:"menuitem",variant:"rect",size:"36-sm",color:"subtle-dimmed-inverted",title:n("composer.upload"),disabled:e,testId:"file-upload-button","aria-label":n("composer.upload"),className:"size-9 p-1",onClick:r=>{r.preventDefault(),t()},children:d.jsx(kA,{className:"size-6"})})})}const h7=at(),xA=P(null),RA=P(null);function f7(t){h7.set(xA,t)}function p7(t){h7.set(RA,t)}function QEe(t,e){var s;const n={eventInfo_inputLength:t.length};let r=n;const o=Ue(xA);if(o){const{source:a,type:l,prompt:u}=o;a==="widgets"?r={...n,widget:l,widgetPromptLength:u.length}:r={...n,pill:l,pillPromptLength:u.length}}const i=Ue(RA);return i&&(r={...r,autoCompleteLength:i.prompt.length}),(e==null?void 0:e.length)!==0&&((s=e==null?void 0:e[0])!=null&&s.scenario)&&(r={...r,uploadFileScenario:e[0].scenario}),JSON.stringify(r)}function JEe(t){const e=Ue(xA),n=Ue(RA),r=e==null?void 0:e.prompt.trim(),o=t.trim(),i=n==null?void 0:n.prompt.trim(),s=n==null?void 0:n.prefix.trim(),a=o.toLowerCase()===(i==null?void 0:i.toLowerCase());return!a&&!e?null:a?!r||!o.toLowerCase().includes(r.toLowerCase())?"autoComplete":s&&s.length>r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithTextAndAutoComplete":"pillWithTextAndAutoComplete":(s==null?void 0:s.length)===r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithAutoComplete":"pillWithAutoComplete":"autoComplete":!r||!o.toLowerCase().includes(r.toLowerCase())?null:o.length>r.length?(e==null?void 0:e.source)==="widgets"?"widgetWithText":"pillWithText":(e==null?void 0:e.source)==="widgets"?"widget":"pill"}function XEe(){f7(null),p7(null)}function ZEe(t){const{categories:e,onClose:n,selectedCategoryIndex:r,handleCategoryClick:o}=t,{t:i}=xe(),s=m.useRef(null),a=vy(s,{amount:"all"});return m.useEffect(()=>{a&&Ls({page:"chatPage",element:"chatStarterPillCategory",customData:JSON.stringify({visibleItems:e.map(l=>l.id)})})},[a,e]),d.jsx(B9,{onClose:n,className:"px-3",children:d.jsxs("div",{className:"flex w-full flex-col items-center gap-4",ref:s,children:[d.jsx("h1",{className:"mt-2 px-3 text-md-strong",children:i("widgets.categorySelectorModalHeader")}),d.jsx("ul",{className:"flex w-full list-none flex-col items-center",role:"list",children:e.map((l,u)=>d.jsx("li",{className:"w-full",children:d.jsx(Te,{className:"w-full",variant:"rect",color:"subtle-dimmed-inverted",title:l.label,onClick:()=>o(u),children:d.jsxs("span",{className:"flex w-full items-center justify-between",children:[d.jsx("span",{className:"truncate text-start",children:l.label}),r===u&&d.jsx(fA,{className:"ms-2 size-4 shrink-0 text-foreground-600 contrast-more:text-current"})]})})},l.id))})]})})}function eTe(t){const{text:e,onClick:n,className:r,testId:o}=t;return d.jsx(Te,{title:"",onClick:n,className:Be("min-w-fit",r),color:"chip",testId:o,children:d.jsx("span",{className:"px-1",children:e})})}const tTe=1e3;function NA(){var h;const t=!!((h=me.instance().config().landingPage)!=null&&h.enablePromptedGreetings),e=se("intent-image-gen-prompted-greeting"),n=se("qa-intent-image-gen-prompted-greeting"),r=se("intent-f1-prompted-greeting"),o=se("qa-intent-f1-prompted-greeting"),i=se("intent-school-prompted-greeting"),s=se("qa-intent-school-prompted-greeting"),a=se("conversation-starter-prompted-greeting-c1"),l=se("qa-conversation-starter-prompted-greeting-c1"),u=se("qa-conversation-starter-prompted-greeting-debug");return t&&(e||n||r||o||i||s||a||l||u)}function nTe(){const[t,e]=Ze(Z5),n=NA();return m.useEffect(()=>{let r;return n?(e(!1),r=window.setTimeout(()=>{e(!0)},tTe)):e(!1),()=>{r&&clearTimeout(r)}},[e,n]),t}function rTe(t){const{className:e,onWidgetClick:n,pageName:r="chatPage",widgetSource:o,starterPromptsData:i,shouldStackChips:s,shouldCenterChips:a,containerId:l="",selectedCategory:u,onCategoryClick:h}=t,f=m.useRef(null),p=vy(f,{once:!0,amount:"all"}),g=ar({breakpoint:"sm"});m.useEffect(()=>{p&&Ls({page:r,scenario:o,element:"chatStarterPills"})},[p,o,r]);const v=y=>{const{prompt:b,id:C,actionType:S,uri:I,source:E,text:T,index:w}=y;nt({pageName:r,source:o,scenario:C,customData:JSON.stringify({prompt:b,text:T,index:w,category:u==null?void 0:u.id})}),n({actionType:S,id:C,prompt:b,uri:I,source:E})};return d.jsxs(wn,{role:"list","aria-label":"",className:Be("flex w-full gap-2 px-1 py-1 sm:flex-wrap sm:py-4",s?"mb-3 flex-col items-end space-y-1 sm:flex-row":"scrollbar-container max-h-[110px] overflow-x-auto overflow-y-hidden",a?"sm:justify-center":"sm:justify-start",e),id:l,ref:f,children:[u&&g&&d.jsx(Te,{onClick:h,title:u.label,className:"min-w-fit",color:"overlay-dimmed-inverted",children:d.jsxs("span",{className:"flex items-center gap-2",children:[u.label,d.jsx(El,{className:"size-4 -rotate-90"})]})}),i.map((y,b)=>{const{id:C,text:S}=y,{type:I}=y.action,E="prompt"in y.action?y.action.prompt:void 0,T="uri"in y.action?y.action.uri:void 0;return d.jsx(eTe,{text:S,onClick:()=>v({prompt:E,uri:T,id:C,actionType:I,source:"pills",text:S,index:b}),className:Y(s&&"w-auto min-w-min max-w-[80%] text-start"),testId:`starter-prompt-${C}`},C)})]})}function oTe(t){var y;const{className:e,onWidgetClick:n,pageName:r="chatPage",selectedCategory:o,onCategoryClick:i}=t,s=x(QX),a=x(Da),l=NA(),u=x(Z5),{isAppearanceOnHomeEnabled:h}=th(),f=h||(a==null?void 0:a.type)==="categories",p=x(zT),g=(y=me.instance().config().landingPage)==null?void 0:y.stackStarterChipsForSmallScreens;let v="";return p?v=p:o&&(v=o.id),l&&!u||!s?null:d.jsx(rTe,{onWidgetClick:n,className:e,pageName:r,starterPromptsData:s,widgetSource:(a==null?void 0:a.source)??"chatStarterPills",shouldStackChips:g,shouldCenterChips:f,containerId:v,selectedCategory:o,onCategoryClick:i})}const iTe=m.lazy(()=>H(()=>import("./starter-prompt-category-Bd1uIdNx.js"),__vite__mapDeps([239,1,2])));function sTe(t){const{className:e,onWidgetClick:n,pageName:r="chatPage"}=t,o=x(Da),i=ar({breakpoint:"sm"}),[s,a]=Ze(X5),[l,u]=m.useState(!1),h=v=>{var y;v!==s&&(a(v),nt({source:"chatStarterPillCategory",pageName:"chatPage",destination:f?(y=f[v])==null?void 0:y.id:void 0})),u(!1)},f=o&&o.type==="categories"?o.categories.map(v=>({id:v.id,label:v.label})):void 0,p=f&&!i,g=l&&f&&i;return!o||!["text","textAndGreeting","categories"].includes(o.type)?null:d.jsxs("div",{className:Be("mx-auto flex w-full flex-col gap-3 px-2",e),children:[p&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"h-8 w-full"}),children:d.jsx(iTe,{categories:f,handleCategoryClick:h,selectedCategoryIndex:s})}),d.jsx(oTe,{onWidgetClick:n,pageName:r,selectedCategory:f?f[s]:void 0,onCategoryClick:f?()=>u(!0):void 0}),g&&d.jsx(ZEe,{categories:f,handleCategoryClick:h,selectedCategoryIndex:s,onClose:()=>u(!1)})]})}function aTe({isOpen:t,onClose:e}){const{t:n}=xe(),r=vU(),o=m.useMemo(()=>["twitter","facebook","whatsapp"],[]);return d.jsx(Ol,{isOpen:t,className:"grid max-h-[640px] max-w-[640px] grid-rows-[auto_1fr] gap-4",onClose:e,headerText:n("common.share"),children:(r==null?void 0:r.type)==="image"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mx-auto mb-4 flex h-full w-fit overflow-hidden rounded-2xl",children:d.jsx("img",{src:r.url,alt:r.altText,className:"object-contain"})}),d.jsx(qbe,{value:r.url,title:n("share.copy"),size:"56-xl",variant:"pill",className:"w-full"}),d.jsx("div",{className:"flex w-full items-center justify-around",children:o.map(i=>d.jsx(_Ie,{socialMedia:i,className:"flex flex-col gap-1",onClickSocialMedia:s=>{AIe(s,r.url)},includeTitle:!0},i))}),d.jsx("div",{className:"text-center text-foreground-550 text-2xs",children:n("share.shareImageDescription")})]})})}const cTe=m.lazy(()=>H(()=>import("./product-purchase-D6ud5ovI.js"),__vite__mapDeps([240,1,2,241,242,243,244,245,246,247,248,232])).then(t=>({default:t.ProductPurchase}))),lTe=64,uTe=8,dTe={opacity:0,translateY:lTe},hTe={opacity:1,scale:1,translateY:0},ou="size-6",fTe=m.lazy(()=>H(()=>import("./upsell-block-CWNF8Ri0.js"),__vite__mapDeps([249,1,2,250]))),pTe=m.lazy(()=>H(()=>import("./price-tracking-block-CzyM37Ee.js").then(t=>t.p),__vite__mapDeps([251,1,2,252,253,254,255,256,257])).then(t=>({default:t.PriceTrackingBlock}))),mTe=m.lazy(()=>H(()=>import("./composer-auto-complete-CPBByIJb.js"),__vite__mapDeps([258,1,2]))),gTe=m.lazy(()=>H(()=>import("./composer-actions-prompt-suggestions-Dl3tKfm2.js"),__vite__mapDeps([259,1,2,260,261,262,263,264,265,266,267,268,269])).then(t=>({default:t.ComposerActionsPromptSuggestions}))),vTe=m.lazy(()=>H(()=>import("./voice-options-C0EjD4wp.js").then(t=>t.v),__vite__mapDeps([270,1,2,271]))),yTe=m.lazy(()=>H(()=>import("./think-deeper-pro-subscription-DiC9bvSs.js"),__vite__mapDeps([272,1,2]))),bTe=m.lazy(()=>H(()=>import("./over-task-quota-DNlQASn7.js"),__vite__mapDeps([273,1,2,274])).then(t=>({default:t.OverTaskQuota}))),CTe=m.lazy(()=>H(()=>import("./computer-use-task-closed-PKtkyL6j.js"),__vite__mapDeps([275,1,2,276,277,278,279,280,281,282,283,284,285,286,274])).then(t=>({default:t.ComputerUseTaskClosed}))),STe=m.lazy(()=>H(()=>import("./safety-risk-card-DNeSO5UC.js"),__vite__mapDeps([287,1,2,288,274])).then(t=>({default:t.SafetyRiskCard}))),ITe=m.lazy(()=>H(()=>import("./add-to-page-C9fEpY6t.js"),__vite__mapDeps([289,1,2])).then(t=>({default:t.AddToPage}))),ETe=m.lazy(()=>H(()=>import("./cross-selling-strip-consumer-BcC0bqCu.js"),__vite__mapDeps([290,1,2,250]))),TTe=m.lazy(()=>H(()=>import("./composer-prompt-review-BiRrCY-3.js"),__vite__mapDeps([291,1,2,292]))),U0=m.lazy(()=>H(()=>import("./composer-action-CkFMKms7.js"),__vite__mapDeps([274,1,2]))),wTe=m.lazy(()=>H(()=>import("./biometric-consent-CX-K5aHX.js"),__vite__mapDeps([293,1,2])).then(t=>({default:t.BiometricConsent}))),_Te=m.lazy(()=>H(()=>Promise.resolve().then(()=>Zbe),void 0)),ATe=m.lazy(()=>H(()=>import("./daily-briefing-chat-JAkt9Aba.js"),__vite__mapDeps([294,1,2,295,296])).then(t=>({default:t.DailyBriefingChat}))),kTe=m.lazy(()=>H(()=>import("./composer-sign-in-CImxjkLw.js"),__vite__mapDeps([297,1,2,298]))),xTe=m.lazy(()=>H(()=>import("./daily-briefing-composer-player-DT9-rEBN.js"),__vite__mapDeps([299,1,2,284,280,281,282,283,296])));function RTe(){var Ek,Tk;const{t}=xe(),{isLivingPortraitEnabled:e}=KT(),n=se("image-copy-paste"),r=x(hl),o=se("pay-native-checkout"),i=se("shopping-card"),s=Hp(),a=se("anonymousattachmentupload"),l=se("onedrive-file-upload"),u=se("ds-editprompt"),h=se("ds-new-progress"),f=!j_(),p=x(H5),g=se("multi-file-upload"),v=se("dr-nano-single-file-upload"),y=Sl(),b=gi(),C=rD(),S=E1e(),I=$t(),E=x(Sn),T=vi(),w=x(Fa),A=ar({breakpoint:"sm"}),_=cy({breakpoint:"h760"}),L=cy({breakpoint:"h600"}),N=W_(),K=bIe(),q=TA(),ae=yIe(),[O,W]=m.useState(null),te=ve(y5),[D,G]=Ze(_l),re=x(Bhe),J=x(Hhe),ne=x(eX),X=x(T5),Ie=x(QJ),Ce=x(GI),[be,ue]=m.useState(!1),Me=Ie||be,{startConversationDisabled:Ye}=P_(),le=x(Os),[we,Ke]=m.useState(!1),[k,B]=Ze(Zr),ge=ve(ede),[M,Q]=Ze(JX),[fe,z]=Ze(Op),Z=ve(I5),Ee=x(ms),tt=(Ee==null?void 0:Ee.type)==="popup",ht=w1e(),mt=tt||ht,Ve=j8(),rt=(Ek=me.instance().config().composer)==null?void 0:Ek.enableAppShadow,{isPlaying:xt,pause:qt,resetAllTimers:Wt}=M8(),Yt=Z0e(),nr=M1e(),V=I1e(),ye=Sr(),_e=m.useRef(null),Pe=m.useRef(null),We=m.useRef(null),ut=m.useRef(null),[He,F]=m.useState(!1),[oe,de]=m.useState(null),je=m.useCallback(pe=>{de(pe)},[de]),Le=m.useCallback(()=>{F(!1)},[F]),Je=se("imagegenv3"),dt=se("logged-out-sharing"),ct=se("remove-prefill-space-after-prompt-cmc"),{isMediaViewerOpen:st,closeMediaViewer:dr,isPictureInPictureSupported:Gn,triggerPictureInPicture:hr,showOneLineComposerWhenMediaViewerOpen:Rn,contentComposerType:rs,contentPageType:rh}=Us(),{trackConsumptionPageComposerClick:Eo,trackConsumptionPageComposerSubmit:jl}=z0e(),Tr=vU(),Wp=rs===Jv.IMAGE_VIEWER,oh=rs===Jv.CLOSE_BUTTON,ih=ve(Lb),_n=I.endsWith("/talk"),Kn=I.endsWith("/daily"),Ul=se("1s-dbchat"),Yp=se("db-transcript"),Qp=se("discover-composer-off"),Ko=Vb(),et=Kn||Ko,$=y1e(),Re=Fb(),$e=I.startsWith("/chats")&&!_n,Ut=I.startsWith("/shares"),qn=rh==="weather",Nn=x(rf),{login:fr}=Wd(),rr=k==="dialog",os=o&&k==="checkout",or=h1e(),[ir,Jp]=Ze(hn),[RF,NF]=m.useState(!1),PF=x(Zj),qo=bA(),{isCentralComposerEnabled:MF,isAutoSuggestEnabled:OF,isStarterPromptsEnabled:LF,isWidgetSectionEnabled:DF,isAppearanceOnHomeEnabled:jF}=th(),{floatingStyles:UF,edgeTabMenuRefs:oC,isMultiTabsMenuExpanded:FF,setIsMultiTabsMenuExpanded:FA,multiTabsMenuMode:BF,setMultiTabsMenuMode:BA,handleMentionEvent:HF,handleMultiTabsMenuSaveBtnEvent:HA,handleMultiTabsMenuCloseBtnEvent:zA,handleUserInputEnterEvent:zF,handleUserInputKeydownEvent:VA,isMentionTriggered:$A,isFetchingTabsPageContext:GA}=F0e(),KA=x(fme),sh=ir==="computerUse",Fl=MF&&(!k||k==="biometric-consent"),qA=OF&&!k&&!sh,WA=ae==="autosuggest"&&qA,YA=m.useId(),VF=x(VT),$F=ve(Up),GF=LF&&(!k||k==="biometric-consent")&&!sh&&!VF&&(!L||A),KF=Fl&&DF&&!sh&&!A&&!_,ah=m.useRef(null),qF=T1e(),WF=!_n&&!Kn&&!Ko&&!Fl&&!os&&!qn;let QA=!0;const iC=(Re||$e||$||Ut)&&(!k||k==="biometric-consent")&&!(st&&!Rn);iC&&((Tk=me.instance().config().composer)!=null&&Tk.disableTextInput)&&(QA=!1);const JA=os,sC=x(M_),XA=x(nX),[aC,ZA]=Ze(rde),Xp=x(ode);se("multiple-research-tasks-in-conversation");const Bl=Rfe(),ch=x(Lr),Va=ch==="side-by-side"&&(Bl==null?void 0:Bl.type)==="computerUse"&&$e,ek=Jb(),Zp=Va&&!zU(Bl.status),lh=Va&&Lfe(Bl),YF=Va&&Dfe(Bl),QF=!I.endsWith("/agents")&&!Kn&&!$&&!Ut&&!jF&&!st&&!y,em=Xp&&!0&&!h,tk=lh||Va||Kn||em||st,JF=m.useCallback(()=>{const pe=[];if(Pe.current){const Ge=Pe.current.getTextAreaRef();Ge.current&&pe.push(Ge)}return pe},[Pe]),nk=!(st&&!Rn)&&!_n&&(!k||k==="daily-briefing-chat"),tm=ne||!nk||Zp||lh||YF||em,[XF,ZF]=m.useState(!1),cC=e1e(nk),uh=x(nde),Fs=x(tde),[lC,rk]=Ze(Xj),uC=rl(),{dismissCoachmark:ok}=Yb(Qb),dh=k==="prompt-sign-in"||k==="prompt-3p-sign-in"||k==="prompt-location"||k==="prompt-review"||k==="confirm-link-navigation"||k==="cross-promo-card"||k==="shopping-upsell-card"||k==="shopping-price-tracking"||k==="add-to-page"||k==="safety-risk-card"||k==="computer-use-task-closed"||k==="over-task-quota"||k==="daily-briefing-chat"||k==="upsell-microsoft-account-for-pro-subscription"||k==="biometric-consent"||k==="finance-watchlist-unfollow-toast",ik=!_n&&k!=="daily-briefing-player"&&k!=="audioSettings"&&k!=="reasoning-mode-pro-subscription"&&k!=="checkout"&&!dh&&!(st&&!Rn),eB=m.useCallback(pe=>{na(pe)},[]),tB=()=>{var Ge;const pe=((Ge=me.instance().config().composer)==null?void 0:Ge.homeButtonState)??"enabled";return pe!=="enabled"?pe:Re?"disabled":"enabled"},nB=m.useCallback(()=>{var pe;(pe=Pe.current)==null||pe.focus(),rc(!0)},[]),rB=m.useCallback(()=>{We.current&&(We.current.value="")},[]),Hl=m.useCallback((pe,Ge)=>{G({isOpen:!0,scenario:Ge??null,reason:pe})},[G]),oB=m.useCallback(()=>{Hl("fileUpload")},[Hl]),{processUploadedFiles:sk,processUploadedLocalFiles:Bs,isUploadingAttachments:iB,uploadedAttachments:zl,resetFileUpload:sB,removeAttachment:dC}=a1e(nB,na,rB,oB),aB=x(hme),Wo=zl.filter(({error:pe})=>!pe),hC=(Wo.length>0||cC)&&!_n,ak=Wo.length>0||KA,cB=iB||qo&&GA,ck=!!(q.trim().length>0||ak)&&!tm,lk=!!((O&&O.length>0)===!0||cB||Me||Ce||q.trim().length===0&&ir==="computerUse"),lB=se("file-upload-config"),hh=x(kl),uk=g&&Wo.length>=hh.maxFilesPerMessage,[uB,dB]=m.useMemo(()=>{const{reason:pe}=D;return pe?[t(`signInPrompt.${pe}Header`,t("signInPrompt.header")),t(`signInPrompt.${pe}Text`,t("signInPrompt.text"))]:[t("signInPrompt.header"),t(dt?"signInPrompt.textV2":"signInPrompt.textV3")]},[dt,D,t]),[dk,hB]=m.useState({onSubmitCallback:null,onCancelCallback:null}),[fC,pC]=m.useState(!1);m.useEffect(()=>{!st&&fC&&pC(!1)},[st,fC]);const fB=m.useCallback(()=>{var pe;HA(),(pe=Pe.current)==null||pe.focus()},[HA]),pB=m.useCallback(()=>{var pe;$A||(pe=_e.current)==null||pe.focus(),zA()},[zA,$A]),mB=m.useCallback(async()=>new Promise(pe=>{if(Ue(V5)||Wo.length===0){pe(!0);return}B("biometric-consent"),hB({onSubmitCallback:()=>{B(null),pe(!0)},onCancelCallback:()=>{B(null),pe(!1)}})}),[Wo,B]),gB=m.useCallback(pe=>{var Gt;if(!VA(pe)&&pe.key==="ArrowDown"&&(Gt=Pe.current)!=null&&Gt.contains(document.activeElement)&&ah.current){pe.preventDefault();const Nt=ah.current.querySelector("button");Nt&&Nt.focus()}},[VA]),mC=async pe=>{var Ge,Gt;if(Ut&&await tM(),!ck||!q&&!ak||lk){await gs.onSubmitMessageBlocked();return}if(!(Je&&!await mB())){if(h&&ir==="research"&&Xp){const Nt=Ue(it);if(Nt){Gh(t("error.researchTaskNotAllowedWhileRunningAnother"),Nt),Jp("chat");return}}ok(),uE(),kB?(Gt=Pe.current)==null||Gt.focus():(Ge=Pe.current)==null||Ge.blur(),await LB(pe??q)}},vB=m.useCallback(async()=>{await C()},[C]),gC=x(_U),{launchAudioCall:vC,startAudioCallIfNotStartedAlready:yC,endAudioCall:fh,toggleAudioInput:yB,inputVolume:bB,isInputMuted:CB,isAudioDeepLink:SB,canInitAudio:IB}=DEe({isAudioCall:_n,onCallTerminated:vB,onMute:()=>gn({source:"audioCall",scenario:"mute"})});m.useEffect(()=>{re&&(B(uC?"prompt-3p-sign-in":"prompt-sign-in"),D.isOpen&&G({...D,isOpen:!1,reason:D.reason??(ne?"overTurnLimit":null)}),rc(!0))},[B,G,re,D,uC,ne]),m.useEffect(()=>{J&&("geolocation"in navigator?setTimeout(()=>{B("prompt-location"),rc(!0),cr("hasBeenPromptedForLocation","true"),U.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"seen"}})},XH):U.trackEvent({name:"system",data:{eventName:"geolocationUnavailable"}}))},[B,J]),m.useEffect(()=>{et?B("daily-briefing-player"):mt?(rc(!0),B("cross-promo-card")):B(lh?"safety-risk-card":Zp?"computer-use-task-closed":null)},[B,mt,Zp,lh,et]);const bC=m.useRef(null),nm=cp(pe=>{const Ge=document.getElementById("app");Ge&&(ge(pe.height),Ge.style.setProperty("--composer-container-height",`${pe.height}px`))}),EB=cp(pe=>{nm.current&&(pe.height===0?nm.current.style.removeProperty("--composer-attachments-height"):nm.current.style.setProperty("--composer-attachments-height",`${pe.height+uTe}px`))}),TB=()=>{Vr(),Q(void 0)},hk=()=>{we&&(yC(),Ke(!1))},Vr=()=>{if(Kn&&k==="daily-briefing-chat"&&(B("daily-briefing-player"),uE()),k==="prompt-3p-sign-in"&&(Ko||Kn)&&B("daily-briefing-player"),!(ne||Kn||Ko||Zp||lh)){if(rr&&(Fs!=null&&Fs.closeDialogCallback)){Fs.closeDialogCallback();return}k==="prompt-review"&&QIe(Ue(it),"dismissed"),k==="cross-promo-card"&&Ve(),k==="audioSettings"&&hk(),B(null),k==="prompt-sign-in"&&D.scenario&&G({isOpen:!1,scenario:null})}},CC=m.useCallback(async()=>{fh(),ih("bottom"),e?await b({to:"/labs/portrait",from:I}):await C()},[fh,ih,e,b,I,C]);m.useEffect(()=>{me.instance().config().endAudioOnVisibilityHidden&&!XA&&(xt?qt==null||qt():_n&&CC())},[CC,_n,xt,qt,XA]);const fk={title:t("composer.endAudioCall"),icon:d.jsx(Mr,{className:ou,"aria-hidden":!0}),isVisible:!0,onClick:CC},wB=D0e(),pk=()=>{Kn||Ko?qt==null||qt():_n&&fh(),Ke(!0)},rm=ve(Db),SC=(ir==="chat"||ir==="reasoning"||ir==="smart"||ir==="research"&&v)&&!Va&&!XF,_B=x(Jd),no=ir==="research"?hh.document.mimeTypes:_B,AB=h9(no);m.useEffect(()=>{for(const[pe,Ge]of zl.entries())oA(Ge.file,{supportedMimeTypes:no})||dC(pe)},[no,zl,dC]);const kB=CA(),pr=gA(),xB=pr&&(ir==="chat"||ir==="research"||ir==="computerUse"),RB=pr&&PF===null,ph=pr&&!_n&&!st,mh=m.useCallback(()=>{rm(null)},[rm]);m.useEffect(()=>{mh()},[ik,mh]),m.useEffect(()=>{Sg(q&&sC?"autosuggest":sh&&(!q||pr)?"actions-autosuggest":"starter-prompts")},[sC,q,pr,sh]),Na({onOutsideEvent:()=>{Vr()},elements:[bC],includeScroll:!1,invokeOnce:!1}),Na({onOutsideEvent:ef,elements:[bC,ah],includeScroll:!1,invokeOnce:!1});const mk={title:t("composer.closeVoiceSettings"),icon:d.jsx(Mr,{className:ou,"aria-hidden":!0}),isVisible:!0,onClick:Sk},om={title:t("imageCard.composer.closeImageViewer"),icon:d.jsx(Mr,{className:ou,"aria-hidden":!0}),isVisible:!0,onClick:dr},gk={title:t("imageCard.composer.shareImageViewer"),icon:d.jsx(_8,{className:ou,"aria-hidden":!0}),isVisible:!0,onClick:()=>{pC(!0)}},vk={title:t("imageCard.composer.downloadImageViewer"),icon:d.jsx(rA,{className:ou,"aria-hidden":!0}),isVisible:!0,onClick:async()=>{if((Tr==null?void 0:Tr.type)==="image")try{await v9({url:Tr.url,fileName:e7()})}catch(pe){const Ge=pe instanceof Error?pe.message:"unknown error on downloading image";JI(Ge)}}},NB=pe=>{var Nt;rc(!0),s&&A8("idle");const{relatedTarget:Ge}=pe;((Nt=ah.current)==null?void 0:Nt.contains(Ge))||setTimeout(()=>ef(),100)},PB=pe=>{qA&&pe&&V8(pe)},yk=m.useCallback(async pe=>{const{actionType:Ge,id:Gt,prompt:Nt,uri:is,source:yi}=pe;switch(Ge){case"prefillComposer":{if(Nt){Gt&&f7({prompt:Nt,type:Gt,source:yi});const $r=ct?Nt:`${Nt} `;Wm({prompt:$r,prefillSource:yi==="widgets"?"widget":"starterPill"})}break}case"sendMessage":{if(Nt)try{ue(!0),await gs.submitMessage({text:Nt,inputMethod:"text"})}finally{ue(!1)}break}case"deepLink":{is&&is==="copilotn://voiceCall"&&await vC();break}}},[ct,vC]),MB=(pe,Ge)=>{p7({prompt:pe,prefix:Ge}),mC(pe)},bk=m.useCallback(pe=>{Wm({prompt:pe,prefillSource:"promptPassThrough"}),z(null),Z(null)},[z,Z]);m.useEffect(()=>{((fe==null?void 0:fe.source)==="promptInUrl"||(fe==null?void 0:fe.source)==="edgeOnAskCopilot")&&bk(fe.prompt)},[fe,bk]);const IC=m.useCallback((pe,Ge)=>{const{scenario:Gt,reasonIfSignInError:Nt}=Ge;pe.message==="not-signed-in"?Hl(Nt,Gt):na(m9(pe.message))},[Hl]),OB=se("local-agents"),LB=async pe=>{var yi,$r,wk,_k;const Ge=JEe(pe),Gt=QEe(pe,zl),Nt=pe.trim(),is=ir==="research"&&u?{research:{awaitUserConfirmation:!0}}:void 0;if(k!=="daily-briefing-chat"&&(sB(),rc(!0),q8(!1),te(!0),B(null)),ef(),OB){if(Nt.startsWith("/agent")){await S();return}if(I.endsWith("/agents"))return}st&&Rn?($F(!0),jl()):k!=="daily-briefing-chat"&&!y&&await C();try{ue(!0);let Hs;Yt&&(Hs=Yt),nr&&(Hs=nr),V&&(Hs=V),await gs.submitMessage({text:Nt,filesWithAttachment:zl,inputMethod:"text",scenario:Ge??void 0,customData:Gt??void 0,reference:Hs,context:is})}catch(Hs){if(Hs instanceof Error){let Ak={};Wo.length>0&&(Ak={eventInfo_uploadFileSize:(($r=(yi=Wo[0])==null?void 0:yi.file)==null?void 0:$r.size)??0,eventInfo_uploadFileType:((_k=(wk=Wo[0])==null?void 0:wk.file)==null?void 0:_k.type)??"",eventInfo_numDocumentsUploaded:Wo.length}),U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:Hs.message,eventInfo_details:"Error submitting message",...Ak}}),IC(Hs,{reasonIfSignInError:"fileUpload"})}else U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:"Unknown error",eventInfo_details:"Error submitting message"}}),na({title:t("composer.errors.default.title"),message:t("composer.errors.default.message")})}finally{ue(!1),XEe()}},gh=m.useCallback(pe=>{const Ge=!ye&&!a;return Ge&&Hl("fileUpload",pe),Ge},[ye,a,Hl]),Ck=m.useCallback(()=>{var pe;gh()||(pe=We.current)==null||pe.click()},[gh]);m.useEffect(()=>{if(tm||!n)return()=>{};const pe=async Ge=>{const{file:Gt,error:Nt}=cge(Ge);(Gt??Nt)&&(Ge.preventDefault(),Nt?IC(Nt,{reasonIfSignInError:"fileUpload"}):Gt&&Bs({rawFiles:[Gt],scenario:"pasteUpload",replaceExisting:!g,supportedMimeTypes:no}))};return document.addEventListener("paste",pe),()=>document.removeEventListener("paste",pe)},[Bs,tm,n,IC,g,no]),m.useEffect(()=>{aC!==null&&(Bs({rawFiles:[aC],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:no}),ZA(null))},[aC,Bs,ZA,g,no]),m.useEffect(()=>{oe&&!He&&(sk({uploads:[{kind:"onedrive",item:oe,file:new File([],oe.name)}],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:no}),de(null))},[oe,de,He,sk,g,no]),m.useEffect(()=>{Kn&&Wt()},[Kn]);function DB(pe){const Ge=Array.from(pe.target.files??[]),Gt=Ge[0];if(Ge.length===0||!Gt)return;Bs({rawFiles:g?Ge:[Gt],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:no})}const jB=pe=>{if(!SC||(pe.preventDefault(),gh()))return;mh();const Ge=pe.dataTransfer.files[0],Gt=Array.from(pe.dataTransfer.files);Ge&&Bs({rawFiles:g?Gt:[Ge],scenario:"fileUpload",replaceExisting:!g,supportedMimeTypes:no})};function Sk(){NF(!0),B(pe=>pe==="audioSettings"?(hk(),null):"audioSettings")}async function UB(){Ut&&await tM(),gn({source:"audioCallButton"}),await vC()}m.useEffect(()=>{const pe=Ge=>Ge==="start"?yC():fh();return wt.on("composer:request-voice",pe),()=>{wt.off("composer:request-voice",pe)}},[fh,yC]),m.useEffect(()=>{const pe=()=>{var Ge;(Ge=Pe.current)==null||Ge.focus()};return wt.on("composer:focus-input",pe),()=>{wt.off("composer:focus-input",pe)}},[]);const FB=m.useCallback(()=>{var pe;(pe=Pe.current)==null||pe.focus()},[Pe]),BB=Qd(FB),HB=m.useCallback(async()=>{if(gh())return;mh();const{file:pe,error:Ge}=await Nue.run({});pe?Bs({rawFiles:[pe],scenario:"screenshot",replaceExisting:!g,supportedMimeTypes:no}):Ge&&na(Ge)},[mh,gh,Bs,g,no]),zB=async()=>{Vr(),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(async pe=>{const{latitude:Ge,longitude:Gt,accuracy:Nt}=pe.coords;U.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"shared",eventInfo_locationAccuracy:Nt}}),await Ur({path:"/user/location",args:{body:{latitude:Ge,longitude:Gt,accuracyInMeters:Nt,provider:Nt<100?"gps":"wifi"}}})},pe=>{U.trackEvent({name:"interaction",data:{eventName:"locationPrompt",eventInfo_action:"denied",eventInfo_error:{code:pe.code,message:pe.message}}}),na({title:t("composer.errors.location.title"),message:t("composer.errors.location.message")})},{enableHighAccuracy:!0})},VB=w8({from:"/",scenario:"voice"}),$B=()=>{const pe=d.jsx(Zo,{className:"end-0",data:fk,children:fk.icon});if(k==="dismiss-audio-call-only")return pe;switch(Nn){case"requires-account":case"signed-out":return d.jsxs(d.Fragment,{children:[pe,d.jsx(mA,{className:"mx-2",title:t("voice.signUpOrLogin"),onClick:VB})]});case"time-expired-non-pro":case"time-expired-month-non-pro":return d.jsxs(d.Fragment,{children:[pe,wB]});case"time-expired":case"checking-availability":case"error":case"not-in-flight":case"throttled":case"throttled-non-pro":case"region-not-available":case"time-expired-month":case"microphone-denied":case"microphone-not-found":return pe;case"waiting-for-user-interaction":case"available":return d.jsx(Ne.div,{className:Y(k!=="audioSettings"&&"flex"),children:k==="audioSettings"?d.jsx(Zo,{className:"end-0",data:mk,children:mk.icon}):d.jsxs(d.Fragment,{children:[pe,d.jsx(dCe,{className:"mx-2",inputVolume:bB,isMuted:CB,isOutputPlaying:gC,coachUserUnmute:SB&&!IB&&!RF,onClick:yB}),!e&&d.jsx(qm,{children:d.jsx(Zo,{className:"start-0",data:{title:t("composer.voiceSettings"),isVisible:!0,onClick:Sk},children:d.jsx(Hn,{url:j0e,className:ou,"aria-hidden":!0})})})]})});default:return Nn}},EC=({enableActionButtons:pe})=>{var yi;let Ge;Wo.length>0?Ge=t("userInput.messageRequiredPlaceholderText"):cC?SC?Ge=lB?t("userInput.fileUploadLimit",{imageSizeLimit:hh.image.maxBytes/(1024*1024),documentSizeLimit:hh.document.maxBytes/(1024*1024),maxCount:hh.maxFilesPerMessage}):t("userInput.imageDropPreviewPlaceHolderText"):Ge=t("userInput.fileDropNotSupportedPlaceHolderText",{chatMode:op({chatMode:ir})}):Ut?Ge=t("userInput.continueConversationInputPlaceholderText"):p!=null&&p.name&&s?Ge=t("userInput.characterPlaceholderText",{character:p.name}):em?Ge=t("research.placeholder"):Ul&&Kn?Ge=t(k==="daily-briefing-chat"?"userInput.dailyChatInputPlaceholderText":"userInput.dailyComposerInputPlaceholderText"):qo?Ge=t("userInput.placeholderTextWithMention"):Ge=void 0;const Gt=(yi=me.instance().config().composer)==null?void 0:yi.smallAttachmentCard,is=k==="daily-briefing-player"&&Ul&&Kn?"":void 0;return d.jsxs(d.Fragment,{children:[d.jsxs(Ne.div,{className:Y("w-full",{"mt-2 h-auto min-h-32 px-2":hC&&!qo&&!Gt,"mt-2 h-[58px] px-2":hC&&!qo&&Gt,"h-auto":qo,"h-0":!hC&&!qo}),ref:EB,layout:!0,children:[aB&&d.jsx(hEe,{onRemove:dC,attachments:zl,onVisibilityChange:ZF}),qo&&KA&&d.jsx(Ne.div,{className:"z-10 mt-2 w-full px-2","data-testid":"browser-tabs-preview",children:d.jsx(EEe,{onClick:()=>{BA("update"),FA(!0)},isLoading:GA})})]}),d.jsx(EA,{ref:Pe,className:Y("w-auto grow",pr&&!Kn&&"mt-1"),disabled:tm,disabledClassName:is,inputValue:q,errorMessage:O,onClick:async()=>{QF&&(Re&&nt({source:"composerInput",scenario:"clickNavigateToChat",pageName:"discover"}),await C()),st&&Rn&&Eo()},onBlur:NB,onChange:$r=>{W8({text:$r,attachments:Wo}),ok()},onFocus:PB,onEnter:async()=>{zF()||await mC()},onKeyDown:gB,onMentionIfEnabled:qo?HF:void 0,setInput:lE,setError:W,placeholder:Ge,characterLimit:X,rightButtons:pe?[d.jsx(UP,{config:Ik()},"composer-action-button")]:void 0,testId:"composer-input","aria-autocomplete":"both","aria-controls":WA?YA:void 0})]})},Ik=()=>{if(Me||em)return{mode:"stop",onClick:gs.stopMessage};if(ck)return{mode:"submit",disabled:lk,onClick:mC};if(!r&&!tk)return{mode:"microphone",onClick:UB}};function im(pe){return pe?iSe:oSe}function GB(pe){return pe?aSe:sSe}const KB=({showChatModeSwitcherButton:pe,showPlusButton:Ge,showUploadFileButton:Gt,homeButtonState:Nt,enableInputActionButtons:is})=>{const yi=pr?"to-stone-400/8 from-stone-400/5 dark:from-midnight-800/65 dark:to-midnight-800/65":"from-stone-400/10 to-white/35 dark:from-slate-700/35 dark:to-midnight-800/65";return d.jsx(Ne.div,{className:Y("relative max-h-full w-expanded-composer max-w-chat bg-gradient-to-b p-1.5",yi),layout:!0,style:{borderRadius:im(ph),boxShadow:le==="dark"?a8:s8},ref:oC.setReference,children:d.jsxs(Ne.div,{className:Y(pr?dSe:uSe),layout:!0,style:{borderRadius:GB(ph)},children:[d.jsx(Ne.div,{className:Y(cSe,lSe,cC?"before:opacity-100 before:delay-100 before:duration-200":"before:opacity-0"),layout:!0,onDragOver:$r=>$r.preventDefault(),onDrop:$r=>jB($r),children:EC({enableActionButtons:is})}),!is&&d.jsxs(Ne.div,{className:Y("relative bottom-0 flex justify-between pb-0.5",pr?"mt-1 pe-2.5 ps-1.5":"px-2"),layout:!0,children:[d.jsxs("div",{className:"flex gap-1",children:[d.jsx(VSe,{state:Nt}),d.jsxs("div",{className:"flex gap-2",children:[pe&&d.jsx(zSe,{disableChatModeSwitcher:!tk}),xB&&d.jsx(qEe,{onPrefillComposerInput:$r=>{Wm({prompt:$r,prefillSource:"create"})},disabled:Me||Xp}),RB&&d.jsx(xSe,{disabled:Me||Xp})]})]}),d.jsxs("div",{className:"flex gap-2",children:[Ge&&d.jsx(AEe,{startNewChatDisabled:Ye,onStartNewConversation:BB,onSelectFileIfEnabled:SC?Ck:void 0,uploadButtonDisabled:uk,onSelectOneDriveFileIfEnabled:(E==null?void 0:E.provider)==="microsoft"&&l?()=>{F(!0),rm(null)}:void 0,onTakeScreenshot:HB,onSelectUserOpenedTabsIfEnabled:qo?()=>{rm(null),BA("add"),FA(!0)}:void 0,onRef:$r=>{_e.current=$r}}),Gt&&d.jsx(YEe,{selectFile:Ck,disabled:uk}),d.jsx(UP,{config:Ik()})]})]})]})})},qB=async()=>{D.scenario&&(gn({source:"signin",scenario:D.scenario}),G({isOpen:!1,scenario:null})),uC?await b({from:"/conversations",to:"/login"}):await fr({provider:"microsoft"})};return!or||!QA||Re&&Qp&&!st?null:d.jsxs(d.Fragment,{children:[d.jsx(aTe,{isOpen:fC,onClose:()=>pC(!1)}),JA&&d.jsx("div",{className:Y("fixed inset-0 size-full bg-stone-850/30 backdrop-blur-[10px] dark:bg-midnight-850/70")}),d.jsxs("div",{"data-testid":"composer",ref:nm,className:Y("pointer-events-none absolute bottom-0 flex",Fl&&"sm:bottom-1/2 sm:translate-y-1/2 sm:pt-36",jt.composer,ch==="side-by-side"&&$e&&T&&!ek&&"mb-2",ch==="side-by-side"&&$e&&!ek&&"w-1/4 min-w-chat-side-by-side",ch==="side-by-side"&&$e&&"end-0 pe-1",(ch==="chat-only"||A||!$e)&&"w-full"),children:[d.jsx("input",{type:"file",accept:AB.join(","),className:"hidden",ref:We,onChange:DB,"aria-hidden":"true",multiple:g}),d.jsx(Mn,{children:WF&&d.jsx(GCe,{dynamicHeight:k===null&&!Re})}),d.jsxs(Ne.div,{className:Y("relative flex w-full flex-col-reverse items-center px-3 sm:flex-col",Fl?"sm:mb-0":"sm:mb-8",rt?"mb-3":"mb-4",(Kn||Ko)&&"min-w-72"),initial:f?"enter":!1,animate:"animate",variants:{enter:dTe,animate:hTe},transition:H_,style:LE,children:[KF&&d.jsx(wn,{className:"pointer-events-auto flex h-[250px] w-full max-w-chat justify-center px-2 pb-4",initial:f?"initial":!1,children:d.jsx(mEe,{onWidgetClick:yk})}),d.jsxs(iO,{transition:K?Xde:{duration:0},children:[d.jsxs(Ne.div,{className:Y("relative max-h-full min-h-composer min-w-16 max-w-chat rounded-5xl",qo&&"z-40",T&&w&&!Fl&&!N&&"md:top-2"),children:[s&&ik&&d.jsx(JCe,{}),d.jsx(Ne.div,{className:"absolute inset-0",layout:!0,style:{borderRadius:im(ph),boxShadow:IIe(le,pr)}}),d.jsx(Mn,{children:gC&&d.jsx(jP,{})}),d.jsx(Ne.div,{className:Y("relative",DV),layout:!0,style:{borderRadius:im(ph),boxShadow:EIe(le,pr)},children:d.jsxs(Ne.div,{className:Y("pointer-events-auto relative flex flex-col overflow-hidden contrast-more:border-2",rr&&"max-w-72",JA&&aa),"data-testid":"composer-content",ref:bC,layout:!0,style:{borderRadius:im(ph),boxShadow:TIe(le)},children:[d.jsx(Mn,{children:gC&&d.jsx(jP,{isNested:!0})}),d.jsxs(Mn,{children:[k&&k!=="daily-briefing-player"&&k!=="dismiss-audio-call-only"&&d.jsxs(Ne.div,{className:Y(!rr&&!dh&&k!=="reasoning-mode-pro-subscription"&&"border-b border-black/10 dark:border-white/10",k==="reasoning-mode-pro-subscription"&&"sm:w-think-deeper-pro-subscription",k==="audioSettings"&&"w-settings",dh&&k!=="daily-briefing-chat"&&"w-prompt-sign-in",dh&&(k==="computer-use-task-closed"||k==="safety-risk-card")&&"max-w-single-image",k==="daily-briefing-chat"&&(w?"min-w-chat-side-by-side bp-960:max-w-full lg:w-expanded-composer":"w-expanded-composer")),layout:!0,children:[k!=="dialog"&&d.jsxs(Ne.div,{"data-testid":"audio-settings-dialog",className:Y("t-custom-scrollbar max-h-expanded-section overflow-auto",k==="audioSettings"&&"px-2 py-4"),layout:!0,initial:ot,animate:{...Lt,transition:{delay:jo.default}},ref:ut,children:[d.jsx(Mn,{children:dh&&d.jsxs(qm,{children:[k==="biometric-consent"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:d.jsx(wTe,{onSubmit:dk.onSubmitCallback,onCancel:dk.onCancelCallback})}),k==="prompt-sign-in"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(U0,{header:uB,text:dB,primaryAction:{title:t("common.loginText"),onClick:qB},testid:"prompt-sign-in-composer-action",secondaryAction:ne?void 0:{onClick:Vr,title:t("common.maybeLater"),testid:"maybe-later-button"},onClose:Vr})}),k==="prompt-3p-sign-in"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(kTe,{dismiss:Vr})}),k==="upsell-microsoft-account-for-pro-subscription"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(_Te,{dismiss:Vr,source:"Composer"})}),k==="daily-briefing-chat"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(ATe,{dismiss:Vr,inputUI:EC({enableActionButtons:!0})})}),k==="prompt-location"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(U0,{header:t("locationPermission.header"),text:t("locationPermission.text"),primaryAction:{title:t("locationPermission.share"),onClick:zB},secondaryAction:{onClick:Vr,title:t("common.maybeLater")},onClose:Vr})}),k==="confirm-link-navigation"&&lC&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(U0,{showImage:!1,header:t("composer.linkConfirmation.header"),text:t("composer.linkConfirmation.text",{url:lC}),primaryAction:{title:t("common.continue"),onClick:()=>{gn({source:"linkNavigationConfirmButton"}),qF(da(od(lC))),Vr(),rk(void 0)}},secondaryAction:{onClick:()=>{Vr(),rk(void 0)},title:t("common.cancel")},onClose:Vr,restoreFocusOnUnmount:!0})}),k==="prompt-review"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(TTe,{})}),k==="cross-promo-card"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(ETe,{variant:"aggressive"})}),i&&k==="shopping-upsell-card"&&d.jsx(m.Suspense,{fallback:d.jsx(rM,{}),children:d.jsx(fTe,{onDismiss:()=>B(null)})}),k==="shopping-price-tracking"&&M&&d.jsx(m.Suspense,{fallback:d.jsx(rM,{}),children:d.jsx(pTe,{content:M.data,messageId:M.messageId,cardType:M.cardType,onConfirm:()=>B("shopping-upsell-card"),onCancel:TB})}),k==="add-to-page"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(ITe,{onClose:Vr})}),k==="safety-risk-card"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(STe,{})}),k==="computer-use-task-closed"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(CTe,{})}),k==="over-task-quota"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(bTe,{})})]})}),k==="audioSettings"&&d.jsx(qm,{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(vTe,{onVoiceSelected:pk,onVoiceSpeedChange:pk})})}),k==="reasoning-mode-pro-subscription"&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(yTe,{})}),os&&d.jsx(qm,{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex max-h-expanded-section w-prompt-sign-in flex-col overflow-auto rounded-t-5xl p-5 sm:w-checkout-composer",children:d.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:d.jsx(_t,{className:"size-12"})})}),children:d.jsx(cTe,{})})})]}),rr&&uh&&Fs&&d.jsx(fSe,{titleKey:uh.titleKey,textKey:uh.textKey,buttonTextKey:uh.buttonTextKey,onClick:uh.onClick,button:Fs.button,cancelButton:Fs.cancelButton,closeDialogCallback:Fs.closeDialogCallback})]}),(Kn&&k!=="daily-briefing-chat"||Ko)&&d.jsx(m.Suspense,{fallback:d.jsx("div",{className:Be("flex h-composer items-center justify-center",Yp?"w-daily-briefing-lg":"w-daily-briefing"),children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(xTe,{isPodcast:Ko,inputUI:Ul&&!Ko?EC({enableActionButtons:!1}):void 0})}),_n&&(!k||k==="audioSettings"||k==="dismiss-audio-call-only")&&d.jsx("div",{className:"flex justify-center p-2",children:$B()}),iC&&KB({showChatModeSwitcherButton:!pr,showPlusButton:!pr,showUploadFileButton:pr&&!r&&ir!=="computerUse",homeButtonState:Va||pr?"hidden":tB(),enableInputActionButtons:st&&Rn||pr&&Va}),st&&oh&&d.jsxs(Ne.div,{className:Y("relative flex max-h-full max-w-chat justify-center",!k&&"p-2",!rr&&"h-composer"),layout:!0,children:[d.jsx(Zo,{data:om,children:om.icon}),Gn&&d.jsx(b0e,{onClick:hr})]}),st&&Wp&&d.jsxs(Ne.div,{className:Y("relative flex max-h-full max-w-chat justify-center",!k&&"p-2",!rr&&"h-composer"),layout:!0,children:[d.jsx(Zo,{data:om,children:om.icon}),(Tr==null?void 0:Tr.type)==="image"&&Tr.shareable&&d.jsx(Zo,{data:gk,children:gk.icon}),(Tr==null?void 0:Tr.type)==="image"&&Tr.downloadable&&d.jsx(Zo,{data:vk,children:vk.icon})]}),He&&d.jsx(HEe,{onPick:je,onClose:Le,onError:eB})]})]})})]}),Fl&&d.jsxs(wn,{id:ae,className:Y("pointer-events-auto flex h-[150px] w-full max-w-chat flex-none items-end px-2 sm:flex-initial sm:items-start",jt.composerBottomSlot),delay:.2,initial:f?"initial":!1,children:[WA&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(mTe,{id:YA,dataResponse:sC,onClick:(pe,Ge)=>MB(pe,Ge),onHighlight:pe=>lE(pe),onDismiss:ef,className:"mb-3 sm:mb-0 sm:mt-3",ref:ah})}),ae==="actions-autosuggest"&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(gTe,{onClick:pe=>Wm({prompt:pe,prefillSource:"action"})})}),ae==="starter-prompts"&&GF&&d.jsx(sTe,{className:"sm:mt-8",onWidgetClick:yk})]}),qo&&FF&&iC&&d.jsx(y0e,{onSave:fB,styles:UF,onRef:oC.setFloating,onClose:pB,outsideClickElements:JF(),mode:BF,originElement:oC.reference})]})]})]})]})}function NTe(t){const{isChecked:e,label:n,description:r,className:o,onChange:i,accessory:s,disabled:a,testId:l}=t,u=m.useId(),[h,f]=m.useState(!1),p=()=>f(!0),g=()=>f(!1),{focusable:v}=kd({autoRestoreFocus:!0,forceFocus:!0});let y=e?"bg-system-green-400":"bg-black/20 dark:bg-white/20";return a&&(y="bg-black/20 after:bg-white/40 dark:bg-white/20 dark:after:bg-black/40"),d.jsxs("label",{className:Y("flex items-center justify-between gap-4",!a&&"cursor-pointer",o),htmlFor:u,ref:v.ref,"data-testid":l,children:[d.jsxs("div",{className:"flex flex-1 flex-col",children:[d.jsx("span",{className:"text-foreground-800 text-sm",children:n}),r&&d.jsx("span",{className:"font-medium text-foreground-450 text-xs",children:r})]}),d.jsxs("span",{className:"flex flex-row items-center gap-2",children:[s,d.jsx("input",{id:u,type:"checkbox",title:n,checked:e,onChange:b=>i(b.target.checked),onFocus:p,onBlur:g,className:"sr-only",disabled:a}),d.jsx("div",{className:Y("relative h-6 w-10 rounded-full","after:absolute after:start-[2px] after:top-[2px] after:size-5 after:rounded-full after:transition-all contrast-more:forced-color-adjust-none",y,!a&&"after:bg-white after:shadow-switch after:hover:scale-110 after:active:w-6",e&&"after:translate-x-4",e&&!a&&"after:active:translate-x-3",h&&"outline")})]})]})}function PTe(){const t=bo("kill-cookie-banner"),e=x(Cr),[n,r]=Ze(jT),[o,i]=m.useState("main"),s=ol(),[a,l]=m.useState(()=>s.analytics),[u,h]=m.useState(s.advertising),[f,p]=m.useState(s.socialMedia),g=Bb(e),v=!!sT(),[y,b]=Ze(bU),C=!t&&(!!y||g&&!v&&!n);if(m.useEffect(()=>{C&&U.trackEvent({name:"system",data:{eventName:"cookieBannerShown",eventInfo_region:e}})},[e,C]),!C)return null;const S=E=>{U.trackEvent({name:"interaction",data:{eventName:"cookieBannerChoice",eventInfo_analytics:E.analytics,eventInfo_advertising:E.advertising,eventInfo_socialMedia:E.socialMedia}}),W$(E),i("main"),b(void 0),r(!0)},I=y==="more-options";return d.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[d.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-stone-150 opacity-90 dark:bg-midnight-850"}),d.jsx("div",{className:Y("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",mi,jt.modal),children:d.jsxs("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:[y!=="more-options"&&o==="main"&&d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsx("h3",{className:"text-md",children:ee("cookies.heading")}),d.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-2xs sm:flex-row",children:[d.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-2xs sm:flex-row",children:[d.jsx("p",{children:ee("cookies.bannerIntro")}),d.jsxs("p",{children:[ee("cookies.bannerExplanation"),d.jsx(ha,{href:Ed,title:ee("cookies.privacyLink"),className:"ps-1 underline",children:ee("cookies.privacyLink")})]})]}),d.jsxs("div",{className:"flex min-w-44 shrink-0 grow flex-col gap-2",children:[d.jsx(Te,{variant:"rect",size:"32-xs",onClick:()=>S({analytics:!0,advertising:!0,socialMedia:!0}),title:ee("cookies.accept"),testId:"cookie-banner-accept-button",children:ee("cookies.accept")}),d.jsx(Te,{variant:"rect",size:"32-xs",onClick:()=>S({analytics:!1,advertising:!1,socialMedia:!1}),title:ee("cookies.reject"),testId:"cookie-banner-reject-button",children:ee("cookies.reject")}),d.jsx(Te,{variant:"rect",color:"subtle-dimmed",size:"32-xs",onClick:()=>{i("more-options")},title:ee("cookies.moreOptions"),testId:"cookie-banner-options-button",children:ee("cookies.moreOptions")})]})]})]}),(y==="more-options"||o==="more-options")&&d.jsxs("div",{className:"flex flex-col",children:[d.jsxs("div",{className:"flex items-center",children:[!I&&d.jsx(Te,{title:ee("common.backText"),variant:"circle",color:"subtle-dimmed",size:"32-xs",onClick:()=>i("main"),children:d.jsx(El,{className:"rotate-180"})}),d.jsx("h3",{className:Y({"ps-3":!I},"text-md"),children:ee("cookies.moreOptionsHeading")})]}),d.jsx("p",{className:"py-3 text-2xs",children:ee("cookies.essentialCookiesExplanation")}),d.jsx(F0,{label:ee("cookies.advertisingLabel"),explanation:ee("cookies.advertisingDescription"),isChecked:u,onChange:()=>h(E=>!E),testId:"cookie-banner-advertising-option"}),d.jsx(F0,{label:ee("cookies.analyticsLabel"),explanation:ee("cookies.analyticsDescription"),isChecked:a,onChange:()=>l(E=>!E),testId:"cookie-banner-analytics-option"}),d.jsx(F0,{label:ee("cookies.socialMediaLabel"),explanation:ee("cookies.socialMediaDescription"),isChecked:f,onChange:()=>p(E=>!E),testId:"cookie-banner-social-option"}),d.jsx("div",{className:"flex justify-end",children:d.jsx(Te,{variant:"rect",size:"36-sm",className:"w-fit px-7",onClick:()=>{S({analytics:a,advertising:u,socialMedia:f})},title:ee("cookies.savePreferences"),testId:"cookie-banner-save",children:ee("cookies.savePreferences")})})]})]})})]})}function F0(t){const{label:e,explanation:n,isChecked:r,onChange:o,testId:i}=t;return d.jsxs(d.Fragment,{children:[d.jsx(dA,{horizontalMargin:!1}),d.jsx(NTe,{label:e,className:"w-full py-2 pe-1",isChecked:r,onChange:o,testId:i}),d.jsx("p",{className:"pb-4 pt-1 text-2xs",children:n})]})}function MTe(){const[t,e]=m.useState(!0),n=x(ms),r=j8(),o=m.useMemo(()=>n==null?void 0:n.images,[n]),i=m.useMemo(()=>({title:n==null?void 0:n.title,subTitle:n==null?void 0:n.subTitle}),[n]),a=x(Os)==="dark"?o==null?void 0:o.dark:o==null?void 0:o.light,l=i;m.useEffect(()=>{Ru({name:"interaction",status:"Shown",eventName:"crossPromotionStripCard",source:"bottomRightCard"})},[]);const u=()=>{e(!1),r()};return n===null||!t?null:d.jsx(wn,{mode:"sync",className:"fixed bottom-5 end-5 z-[1000]",children:d.jsxs("div",{className:Y("flex h-32 w-96 flex-col justify-center rounded-5xl border border-white bg-background-100 p-3 dark:border-white/5 dark:bg-background-250"),children:[d.jsxs("div",{className:"flex items-center",children:[a&&d.jsx("img",{src:a,alt:ee("crossSelling.imageAlt"),className:"size-24 rounded-lg object-cover"}),d.jsxs("div",{className:"me-6 ms-3",children:[d.jsx("div",{className:"mb-1 text-sm",children:d.jsx("strong",{children:l.title})}),d.jsx("div",{className:"text-sm",children:l.subTitle})]})]}),d.jsx("div",{className:"absolute end-1.5 top-1.5 flex self-start",children:d.jsx(Te,{title:ee("common.closeText"),variant:"square",color:"subtle-dimmed","aria-label":ee("common.closeText"),onClick:u,className:"flex size-8 items-center justify-center p-1.5",children:d.jsx(Mr,{className:"m-0 size-5 self-center p-0"})})})]})})}function aM({icon:t,text:e,buttonText:n,buttonColor:r,buttonOnClick:o,className:i=""}){return d.jsxs("div",{className:Y("flex items-center justify-between",i),children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"flex size-10 items-center justify-center rounded-[8.5px] border border-black/10 bg-background-200 dark:border-white/10",children:d.jsx("div",{className:"m-1 size-6",children:t})}),d.jsx("p",{className:"text-base",children:e})]}),d.jsx(Te,{className:"h-10 w-24",color:r,title:n,"aria-label":n,variant:"rect",onClick:o,children:n})]})}const m7=t=>m.createElement("svg",{viewBox:"0 0 192 192",xmlns:"http://www.w3.org/2000/svg",fill:"none",...t},m.createElement("circle",{cx:96,cy:96,r:74,stroke:"currentColor",strokeWidth:12}),m.createElement("ellipse",{cx:96,cy:96,stroke:"currentColor",strokeWidth:12,rx:30,ry:74}),m.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:12,d:"M28 72h136M28 120h136"})),XMe=Object.freeze(Object.defineProperty({__proto__:null,default:m7},Symbol.toStringTag,{value:"Module"})),OTe="https://ercz.adj.st/home?network=1g17o7tz&campaign=1gl0zo0u&adj_t=1gl0zo0u&adj_deep_link=sapphirecopilot%3A%2F%2Fhome%3Fnetwork%3D1g17o7tz%26campaign%3D1gl0zo0u&adj_redirect_android=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.microsoft.copilot&adj_redirect_ios=https%3A%2F%2Fapps.apple.com%2Fus%2Fapp%2Fmicrosoft-copilot%2Fid6472538445%3Fct%3DCMC_Copilot_ContinueChatting%26pt%3D80423";function LTe(){const t=CA(),e=rL(),n=nL(),r=hG(),o=m.useRef(null),[i,s]=m.useState(!1),a=x(Hy),l=x(ml),u=x(E5);m.useEffect(()=>{if(!u||!a||l||t||n||r||!e){s(!1);return}const p=yn(nx),g=yn(FC),v=!ey(p,3*Pg),y=eA(g,3);v||y?(s(!0),Ru({name:"system",status:"Shown",eventName:"copilotMobileCrossSelling"})):Ru({name:"system",status:"TriggeredButSnoozed",eventName:"copilotMobileCrossSelling"})},[l,t,n,r,a,u,e]);const h=()=>{cr(nx,Date.now().toString());const p=yn(FC);cr(FC,`${parseInt(p??"0",10)+1}`),s(!1),Ru({name:"interaction",status:"Dismissed",eventName:"copilotMobileCrossSelling"})},f=()=>{wl(OTe),s(!1),Ru({name:"interaction",status:"Clicked",eventName:"copilotMobileCrossSelling"})};return i?d.jsx(wn,{mode:"sync",className:Y("relative",jt.modal),children:d.jsx("div",{className:"fixed inset-0 grid bg-stone-850/30 dark:bg-midnight-850/70",children:d.jsx("div",{ref:o,className:"mb-0 h-fit w-full self-end justify-self-center rounded-t-3xl border border-white/10 bg-background-200 p-2 contrast-more:border-2 md:mb-5 md:w-fit md:rounded-3xl",children:d.jsxs("div",{className:"mx-3 mb-6 mt-3 flex flex-col gap-4",children:[d.jsx("div",{className:"text-md md:text-center",children:ee("crossSelling.header")}),d.jsx(aM,{icon:d.jsx(Fp,{}),text:ee("crossSelling.copilotApp"),buttonText:ee("common.open"),buttonColor:"strong",buttonOnClick:f,className:"gap-14"}),d.jsx(aM,{icon:d.jsx(m7,{}),text:ee("crossSelling.browser"),buttonText:ee("common.continue"),buttonColor:"subtle-bright",buttonOnClick:h,className:"gap-14"})]})})})}):null}const g7=t=>m.createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("g",{id:"Dots Horizontal"},m.createElement("path",{id:"Shape",d:"M5 8C5 8.55229 4.55228 9 4 9C3.44772 9 3 8.55229 3 8C3 7.44772 3.44772 7 4 7C4.55228 7 5 7.44772 5 8ZM9 8C9 8.55229 8.55229 9 8 9C7.44772 9 7 8.55229 7 8C7 7.44772 7.44772 7 8 7C8.55229 7 9 7.44772 9 8ZM12 9C12.5523 9 13 8.55229 13 8C13 7.44772 12.5523 7 12 7C11.4477 7 11 7.44772 11 8C11 8.55229 11.4477 9 12 9Z",fill:"currentColor"}))),ZMe=Object.freeze(Object.defineProperty({__proto__:null,default:g7},Symbol.toStringTag,{value:"Module"}));function DTe(t){const{className:e}=t,{t:n}=xe(),[r,o]=m.useState(!1),i=IU(),s=ve(Fa),a=m.useRef(null),l=m.useCallback(u=>{a.current=u},[]);return d.jsx(Hb,{isOpen:r,onIsOpenChange:o,renderTrigger:u=>d.jsx(Te,{ref:h=>{u.ref(h),l(h)},onClick:u.onClick,color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",title:n("edgeHeader.dropdownMenuButtonTitle"),className:"ms-auto",testId:"header-dropdown",children:d.jsx(g7,{className:"size-5"})}),options:{overrideZIndex:jt.header,placement:"bottom-end",offset:{mainAxis:4,crossAxis:0},hideOnMenuClick:!0},className:Be(mi,"flex p-1",e),children:d.jsxs("div",{className:"flex flex-col items-start gap-1",children:[i&&d.jsx(Te,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:()=>{s(!0),nt({source:"sidebarHeader"})},title:n("edgeHeader.conversationHistory"),testId:"header-conversation-history-button",children:n("edgeHeader.conversationHistory")}),d.jsx(Te,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:u=>{u.stopPropagation(),s(!1),dde("menu",{onPopPageCallback:()=>{var h;(h=a.current)==null||h.focus()}})},title:n("settings.settings"),testId:"header-settings-button",children:n("settings.settings")}),d.jsx(Te,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:()=>{wt.emit("edge:header-command","sendFeedback")},title:n("settings.feedbackButton"),testId:"header-feedback-button",children:n("settings.feedbackButton")})]})})}const v7=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M16.2425 2.93189L21.0682 7.75765C22.3955 9.08491 22.0324 11.3224 20.3535 12.1619L15.4826 14.5973C15.3073 14.685 15.1732 14.8379 15.1092 15.0232L13.6699 19.1895C13.3684 20.0622 12.2574 20.3181 11.6045 19.6653L8.50002 16.5607L4.06074 21.0001H3L3.00008 19.9394L7.43936 15.5001L4.33487 12.3956C3.682 11.7427 3.93791 10.6317 4.81061 10.3302L8.97688 8.89096C9.16223 8.82694 9.31512 8.69287 9.40281 8.51748L11.8382 3.6466C12.6777 1.96772 14.9152 1.60462 16.2425 2.93189ZM20.0076 8.81831L15.1818 3.99255C14.5785 3.38924 13.5614 3.55429 13.1799 4.31742L10.7445 9.18829C10.4814 9.71446 10.0227 10.1167 9.46666 10.3087L5.67812 11.6175L12.3826 18.322L13.6914 14.5335C13.8835 13.9774 14.2857 13.5188 14.8118 13.2557L19.6827 10.8202C20.4458 10.4387 20.6109 9.42161 20.0076 8.81831Z",fill:"currentColor"})),eOe=Object.freeze(Object.defineProperty({__proto__:null,default:v7},Symbol.toStringTag,{value:"Module"})),y7=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M3.28035 2.21967C2.98746 1.92678 2.51258 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98742 2.21967 3.28032L8.12461 9.18526L4.81064 10.3301C3.93794 10.6315 3.68202 11.7426 4.3349 12.3954L7.43942 15.4999L3.00009 19.9392L3.00001 20.9999H4.06077L8.50009 16.5605L11.6046 19.665C12.2575 20.3179 13.3686 20.062 13.67 19.1893L14.8148 15.8755L20.7196 21.7803C21.0125 22.0732 21.4874 22.0732 21.7803 21.7803C22.0732 21.4874 22.0732 21.0126 21.7803 20.7197L3.28035 2.21967ZM13.6353 14.696L12.3827 18.3218L5.67816 11.6174L9.30412 10.3648L13.6353 14.696ZM19.6829 10.8201L15.8957 12.7137L17.0137 13.8317L20.3537 12.1617C22.0326 11.3223 22.3957 9.08476 21.0684 7.75751L16.2426 2.93179C14.9153 1.60453 12.6778 1.96763 11.8383 3.6465L10.1684 6.98637L11.2864 8.10441L13.18 4.31731C13.5616 3.55419 14.5786 3.38914 15.1819 3.99244L20.0078 8.81817C20.6111 9.42146 20.446 10.4385 19.6829 10.8201Z",fill:"currentColor"})),tOe=Object.freeze(Object.defineProperty({__proto__:null,default:y7},Symbol.toStringTag,{value:"Module"}));function jTe(t){const{isPinned:e,showCloseButton:n,showPinButton:r,className:o}=t,{t:i}=xe();return d.jsxs("div",{className:Be("flex items-center",o),"data-testid":"header-controls",children:[d.jsx(DTe,{}),r&&d.jsx(Te,{variant:"square",color:"subtle-dimmed-inverted",size:"28-xxs",onClick:()=>{wt.emit("edge:header-command","togglePinState")},title:i(e?"edgeHeader.unpinButtonTitle":"edgeHeader.pinButtonTitle"),testId:"header-pin-button",children:e?d.jsx(y7,{className:"size-5"}):d.jsx(v7,{className:"size-5"})}),n&&d.jsx(Te,{variant:"square",color:"subtle-dimmed-inverted",size:"28-xxs",onClick:()=>{wt.emit("edge:header-command","closePane")},title:i(e?"edgeHeader.closeButtonAsPinnedTitle":"edgeHeader.closeButtonAsUnpinnedTitle"),testId:"header-close-button",children:d.jsx(Mr,{className:"size-5"})})]})}function UTe({pixelUrl:t,onComplete:e}){return m.useEffect(()=>{const n=setTimeout(()=>{e()},3e3);return()=>{clearTimeout(n)}},[t,e]),d.jsx("img",{className:"hidden",src:t,width:"1",height:"1",alt:"",referrerPolicy:"no-referrer-when-downgrade",onLoad:e,onError:e})}function FTe(){const t=se("ads-pixels"),[e,n]=Ze(A5),r=x(jT),o=x(Cr),i=(o&&yy.includes(o))===!0,s=m.useMemo(()=>ol(),[r]),a=!i||s.advertising;if(!t||!a)return null;const l=Object.values(e).filter(u=>u.isMounted).map(u=>u.url);return d.jsx("div",{className:"absolute start-[-9999px] top-[-9999px] size-px overflow-hidden",children:l.map(u=>d.jsx(UTe,{pixelUrl:u,onComplete:()=>n(h=>h[u]?{...h,[u]:{...h[u],isMounted:!1}}:h)},u))})}function BTe({onClick:t}){return d.jsx("div",{className:"absolute end-0 top-0 z-10 p-1 rtl:right-auto",children:d.jsx(Te,{title:ee("product.dismiss"),"aria-label":ee("product.dismiss"),variant:"rect",color:"subtle-bright-inverted",size:"32-xs",onClick:t,children:d.jsx(Mr,{className:"size-4"})})})}const HTe=["overflow-hidden","rounded-3xl","border","border-solid","border-white/20","shadow-lg","backdrop-blur-[30px]","bg-acrylic-default-tint-light/95","dark:bg-acrylic-default-tint-dark/95"];function zTe(t){const{title:e,subtitle:n,dismiss:r,link:o,dismissable:i=!0,className:s,Icon:a,iconClassName:l,isRTL:u,onClick:h,onActiveChange:f,customColorTheme:p}=t,g=x(Os),v=p??g,[y,b]=m.useState(!1),[C,S]=m.useState(!1),I=y||C;m.useEffect(()=>{f==null||f(I)},[I,f]);const E=n??o?d.jsxs(d.Fragment,{children:[typeof n=="string"?`${n} `:n,o&&d.jsx("span",{className:"font-sans font-normal leading-5 text-accent-450 underline text-sm dark:text-accent-600",role:"button",tabIndex:0,"aria-label":o,children:o})]}):null,T=me.instance().config().toastNotificationPositioning??"top-5 start-1/2 -translate-x-1/2";return d.jsx("div",{"data-theme":v,className:Y("pointer-events-none absolute",jt.toastNotification,T,s),onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onFocus:()=>S(!0),onBlur:()=>S(!1),children:d.jsx(Mn,{children:d.jsxs(Ne.div,{className:Y("pointer-events-auto","relative",HTe,h&&"cursor-pointer"),initial:{opacity:0,y:-40,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-40,scale:.98},transition:{type:"spring",stiffness:400,damping:30},onClick:h,children:[i&&d.jsx(BTe,{onClick:r}),d.jsx("div",{className:Y("flex","flex-col","items-center","justify-center","py-2","ps-2","pe-1.5",{"w-[min(381px,100vw)]":!!E}),children:d.jsxs("div",{className:Y("relative flex w-full items-center p-0",{"gap-x-3":a,"flex-row-reverse":a&&u}),children:[a&&d.jsx("div",{className:"flex size-16 shrink-0 items-center justify-center rounded-xl border border-black/10 dark:border-white/10",children:d.jsx(a,{className:l})}),d.jsxs("div",{className:Y("flex flex-1 flex-col justify-center py-1",{"ps-4":!a&&E,"pe-10":i&&E,"px-4":!E}),children:[d.jsx("header",{className:Y("flex w-full overflow-hidden",{"items-center":!!E,"items-center justify-center":!E}),children:d.jsx("h2",{className:Y("font-sans text-foreground-750",{"text-base-strong":!!E,"text-sm":!E}),children:e})}),E&&d.jsx("p",{className:"w-full font-sans font-normal leading-5 text-foreground-700 text-sm",children:E}),d.jsx(Td,{msg:`${e??""} ${typeof n=="string"?n:""}`,type:"assertive"})]})]})})]})},e)})}function VTe(){const[t,e]=Ze(js),n=Yd(),[r,o]=m.useState(!1),[i,s]=m.useState(!1),a=m.useCallback(()=>{t!=null&&t.trackingArgs&&nt({source:"toastNotification",scenario:t.trackingArgs.scenario,customData:t.trackingArgs.customData})},[t]),l=m.useCallback(()=>{e(null)},[e]),u=m.useCallback(()=>{var f;if(!(t!=null&&t.action))return;a();const{action:h}=t;h(),l(),(f=t.onClick)==null||f.call(t)},[t,a,l]);return m.useEffect(()=>{let h;return s(!1),o(!1),t!=null&&t.dismissAfter&&(h=window.setTimeout(()=>s(!0),t.dismissAfter)),()=>clearTimeout(h)},[t]),m.useEffect(()=>{i&&!r&&l()},[i,r,l]),t?d.jsx(zTe,{title:t.title,subtitle:t.subtitle,link:t.link,dismissable:t.dismissable,className:t.className,Icon:t.iconProvider,dismiss:h=>{h==null||h.stopPropagation(),l()},isRTL:n,onClick:t.action?u:void 0,onActiveChange:o,customColorTheme:t.customColorTheme}):null}function $Te(){var o;const t=se("top-banner-upgrade-surface-app"),e=(o=me.instance().config().uiOverrides)==null?void 0:o.showUpgradeAppTopBanner,n=t&&e;m.useEffect(()=>{n&&U.trackEvent({name:"system",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Shown"}})},[n]);const r=()=>{U.trackEvent({name:"interaction",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Clicked"}}),wl("macappstore://apps.apple.com/app/id6738511300")};return n?d.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[d.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-stone-150 opacity-90 dark:bg-midnight-850"}),d.jsx("div",{className:Y("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",mi,jt.modal),children:d.jsx("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsx("h3",{className:"text-md",children:ee("upgradeSurface.heading")}),d.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-2xs sm:flex-row",children:[d.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-2xs sm:flex-row",children:[d.jsx("p",{children:ee("upgradeSurface.primaryDescription")}),d.jsx("p",{children:ee("upgradeSurface.secondaryDescription")})]}),d.jsx("div",{className:"flex min-w-44 shrink-0 grow flex-col justify-center gap-2",children:d.jsx(Te,{variant:"rect",size:"32-xs",onClick:r,title:ee("upgradeSurface.buttonText"),children:ee("upgradeSurface.buttonText")})})]})]})})})]}):null}const GTe=m.lazy(()=>H(()=>Promise.resolve().then(()=>nA),void 0)),KTe=m.lazy(()=>H(()=>import("./settings-wrapper-B0uq52Y3.js"),__vite__mapDeps([300,1,2,301,223]))),qTe=m.lazy(()=>H(()=>import("./media-viewer-B36CCjiZ.js"),__vite__mapDeps([302,1,2,303,304,305,306])).then(t=>({default:t.MediaViewer}))),WTe=m.lazy(()=>H(()=>import("./picture-in-picture-g7WUq2Iq.js"),__vite__mapDeps([307,1,2,282,283,308,309,310,311,312])).then(t=>({default:t.PictureInPicture}))),YTe=m.lazy(()=>H(()=>import("./composer-large-screen-C1wi-P-j.js"),__vite__mapDeps([313,1,2,314,271,315])));function QTe(t){const{children:e,sidebar:n,customLayout:r}=t,o=$t(),{isPictureInPictureOpen:i}=yU(),s=me.instance().config().appLayout,a=x(ms),l=(a==null?void 0:a.type)==="card",u=x(MU),h=Gme(),f=x(hfe),p=$me();return d.jsxs(d.Fragment,{children:[p&&d.jsx("div",{className:Be("pointer-events-none sticky top-0 w-full",jt.header),children:d.jsx("div",{className:"pointer-events-auto absolute end-2 top-2",children:d.jsx(jTe,{isPinned:f,showCloseButton:u,showPinButton:h})})}),d.jsxs(ufe,{sidebar:n,children:[r?e:d.jsxs(X_,{className:"flex-1",children:[e,d.jsx(b7,{}),d.jsx(C7,{}),d.jsx(S7,{})]}),d.jsx(VTe,{}),i&&d.jsx(m.Suspense,{fallback:d.jsx(Xme,{}),children:d.jsx(WTe,{})})]}),s.showMobileCrossSelling&&o.startsWith("/chats")&&!o.endsWith("/talk")&&d.jsx(LTe,{}),l&&d.jsx(MTe,{}),s.showCookieBanner&&d.jsx(PTe,{}),d.jsx($Te,{}),d.jsx(nCe,{}),d.jsx("div",{id:"inAppFeedbackOcv"}),d.jsx("div",{id:"popoverPortal"}),d.jsx(FTe,{})]})}function b7(){const{isMediaViewerOpen:t}=Us();return t?d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"pointer-events-auto absolute inset-0 flex items-center justify-center",children:d.jsx(GTe,{type:"spinnerThemed",className:"size-12"})}),children:d.jsx(qTe,{})}):null}function C7(){const t=Hme(),e=zme();return d.jsxs(d.Fragment,{children:[t&&d.jsx(RTe,{}),e&&d.jsx(m.Suspense,{fallback:null,children:d.jsx(YTe,{})})]})}function S7(){const t=me.instance().config().appLayout,e=Vme({showSettings:t.showSettings,showSettingsRelyOnChatDetailLayout:t.showSettingsRelyOnChatDetailLayout}),n=vi();return e?d.jsx(m.Suspense,{fallback:null,children:d.jsx(KTe,{className:Y("top-6",n&&"-me-1 -mt-3")})}):null}function JTe(){const{t}=xe(),e=x(K5);let n="main";yn(p1)&&e==="permanent"&&(n="confirm-submission");const[r,o]=m.useState(n),[i,s]=m.useState(""),[a,l]=m.useState(!1),u=!i||i.trim().length===0||a,h=async()=>{if(!u){gn({source:"submitBanAppeal"}),l(!0);try{await Ur({path:"/user/bans/appeal",args:{body:{appealText:`APPEAL: ${i}`}}}),o("confirm-submission"),cr(p1,new Date().toISOString())}catch(f){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitBanAppeal",eventInfo_errorMessage:`${f}`,eventInfo_details:"Error submitting ban appeal"}})}l(!1)}};return d.jsxs("main",{className:"relative size-full",children:[d.jsx(Tl,{forceGradient:!0}),d.jsxs(wn,{id:r,className:"relative z-10 m-auto flex h-dvh max-w-[540px] flex-col items-center justify-center gap-3 p-12 text-center",children:[r==="main"&&d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl",children:e==="permanent"?t("composer.userBan.permanent"):t("composer.userBan.temporary",{duration:t(e==="1-hr"?"composer.userBan.duration1Hr":"composer.userBan.duration24Hr")})}),d.jsx("p",{children:t(e==="permanent"?"composer.userBan.banMessagePermanent":"composer.userBan.banMessageTemporary")}),e==="permanent"&&d.jsx(Te,{color:"strong",size:"56-xl",className:"mt-6 w-full",title:t("composer.userBan.submitAppeal"),onClick:()=>o("submit-appeal"),children:t("composer.userBan.submitAppeal")})]}),r==="submit-appeal"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex w-full items-center pb-4",children:[d.jsx(Te,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:t("common.backText"),onClick:()=>o("main"),children:d.jsx(jp,{className:"size-5 -rotate-90"})}),d.jsx("h2",{className:"grow pe-8",children:t("composer.userBan.submitAppeal")})]}),d.jsx("textarea",{className:"h-[240px] w-full resize-none rounded-xl bg-background-100 p-4 placeholder:text-foreground-650 contrast-more:border-2 dark:text-white",onChange:f=>s(f.target.value),disabled:a,placeholder:t("composer.userBan.submitAppealPlaceholder")}),d.jsx(Te,{color:"strong",className:"w-full",size:"56-xl",title:t("common.submitText"),onClick:h,disabled:u,children:t("common.submitText")})]}),r==="confirm-submission"&&d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl",children:t("composer.userBan.appealSubmitted")}),d.jsx("p",{children:t("composer.userBan.appealSubmittedDescription")}),d.jsx(Td,{msg:`${t("composer.userBan.appealSubmitted")}, ${t("composer.userBan.appealSubmittedDescription")}`})]})]})]})}class XTe{generateClientEventId(e){if(this.shouldLogForEventName(e.data.eventName))return crypto.randomUUID()}onBeforeTrackEvent(e){this.logEventIfNeededNonBlocking(e,"prepared")}eventsSent(e){for(const n of e)this.logEventIfNeededNonBlocking(n,"success")}eventsDiscarded(e,n){for(const r of e)this.logEventIfNeededNonBlocking(r,this.getStatusFromDiscardedReason(n))}logEventIfNeededNonBlocking(e,n){this.logEventIfNeeded(e,n).catch(()=>{})}async logEventIfNeeded(e,n){var r,o,i,s,a,l,u,h;this.shouldLogForEventName((r=e.data)==null?void 0:r.eventName)&&await xa("/client-telemetry",{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:(o=e.data)==null?void 0:o.eventInfo_clientEventId,eventName:(i=e.data)==null?void 0:i.eventName,status:n,retryCount:"sendAttempt"in e?e.sendAttempt:0,appInfoName:(s=e.data)==null?void 0:s.appName,userId:(a=e.data)==null?void 0:a.userPicassoId,userMuid:(l=e.data)==null?void 0:l.userMuid,conversationId:(u=e.data)==null?void 0:u.eventInfo_conversationId,messageId:(h=e.data)==null?void 0:h.eventInfo_messageId,isSdkInitialized:!0,clientTimestamp:e.time??new Date().toISOString()})}})}getStatusFromDiscardedReason(e){switch(e){case 1:return"nonRetryableStatus";case 2:return"invalidEvent";case 3:return"sizeLimitExceeded";case 4:return"killSwitch";case 5:return"queueFull";default:return"unknown"}}shouldLogForEventName(e){switch(e){case"copilotCompose":case"copilotResponseRender":case"copilotStart":return!0;default:return!1}}}const ZTe=.05,ewe=.1;function twe(){return me.instance().config().sentryDsnOverride??"https://323dd84fb4f632ccd95493debe9312e0@o4508134825000960.ingest.us.sentry.io/4508799962644480"}async function nwe(){const t=await H(()=>import("./vendor-BK0nFAyt.js").then(i=>i.ad),__vite__mapDeps([1,2]));if(Wr("kill-sentry"))return;const n=[t.browserTracingIntegration(),t.tanstackRouterBrowserTracingIntegration(Dl)],r=[],o=ze("sentry-force-log");t.init({dsn:twe(),release:G$(),sampleRate:o?1:ewe,environment:"production",integrations:[...n,...r],tracesSampleRate:o?1:ZTe,profilesSampleRate:0}),t.setTag("surface","cmc")}function rwe(t){const e=x(Cr);m.useEffect(()=>{U.ensureInitialized(owe()),t&&(window.appEnd=performance.now(),performance.mark("startupTime-begin",{startTime:window.appStart}),performance.mark("startupTime-end",{startTime:window.appEnd}),performance.measure("startupTime","startupTime-begin","startupTime-end"),nwe().catch(console.error))},[t]),m.useEffect(()=>{t&&e&&setTimeout(()=>{ku("onPageLoad")},1e3)},[t,e])}function owe(){return()=>ze("picasso-telemetry")?new XTe:null}function iwe(){const t=x(F5),e=m.useRef(!1);m.useEffect(()=>{t&&!e.current&&(U.trackEvent({name:"system",data:{eventName:"copilotStart",eventInfo_duration:window.appEnd-window.appStart,eventInfo_landingPage:U.getLandingPage()}}),e.current=!0)},[t])}function swe(t){m.useEffect(()=>(document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}),[t])}function awe(){swe(()=>{document.visibilityState==="visible"?U.trackEvent({name:"system",data:{eventName:"copilotVisible",eventInfo_landingPage:U.getLandingPage()}}):U.trackEvent({name:"system",data:{eventName:"copilotBackground"}})})}function I7(){return Co(v1,c.boolean().nullable())===!0}function cwe(){return Co(sL,c.boolean().nullable())===!0}function lwe(){return Co(jg,c.boolean().nullable())===!0}function uwe(){return Dl.state.location.pathname==="/login"}function E7(t){for(const e of t)if(e.tenantId===Rg)return e;return t[0]}function Tf(t){return ti(t)?"AAD":"MSA"}function dwe(){const[t,e]=m.useState(!1),n=ve(Sn),r=ve(ei),o=x(xD);return m.useEffect(()=>{if(t||I7())return;function s(l){var u;if(l===null){n(null),U.setUserAccountType(void 0);return}n({id:((u=l.idTokenClaims)==null?void 0:u.oid)??"",tenantId:l.tenantId,provider:"microsoft",accountType:Tf(l.tenantId)}),U.setUserAccountType(Tf(l.tenantId))}async function a(){try{const{msal:l}=await gr.get();U.trackEvent({name:"system",data:{eventName:"copilotMsalInit",eventInfo_initTrigger:"hook",eventInfo_timing:performance.now()-window.appStart}}),e(!0);const{monitorAccountChangesAcrossTabs:u,enableAuth0:h}=me.instance().config();u&&l.enableAccountStorageEvents(),l.addEventCallback(async f=>{if(Vj(f),(f.eventType===ce.LOGIN_SUCCESS||f.eventType===ce.ACQUIRE_TOKEN_SUCCESS)&&f.payload&&"account"in f.payload&&f.payload.account){const{account:p}=f.payload,g=l.getActiveAccount();(!g||g.homeAccountId!==p.homeAccountId)&&(l.setActiveAccount(p),s(p))}else if(f.eventType===ce.LOGOUT_SUCCESS){const p=E7(l.getAllAccounts());l.setActiveAccount(p??null),s(p??null)}else f.eventType===ce.ACCOUNT_ADDED?r({reason:"login"}):f.eventType===ce.ACCOUNT_REMOVED&&r({reason:"logout"})}),h&&u&&af.addEventListener("message",f=>{const p=B8.safeParse(f.data);if(!p.success)return;const{eventName:g}=p.data;g==="auth0.accountAdded"?r({reason:"login"}):g==="auth0.accountRemoved"&&r({reason:"logout"})})}catch(l){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"MsalInitError",eventInfo_details:"hook",eventInfo_errorMessage:l instanceof Error?l.message:""}})}}a().catch(console.error)},[t,r,n]),o===!0?o:t}async function hwe(){const t=at();async function e(){return await Rs.instance().getAccountFromProviders()!==null}function n(){return cwe()?!lwe():!1}function r(i){var s;if(i===null){t.set(Sn,null),U.setUserAccountType(void 0);return}t.set(Sn,{id:((s=i.idTokenClaims)==null?void 0:s.oid)??"",tenantId:i.tenantId,provider:"microsoft",accountType:Tf(i.tenantId)}),U.setUserAccountType(Tf(i.tenantId))}async function o(){try{me.instance().config().enableAuth0&&await ko.get();const{msal:i}=await gr.get();U.trackEvent({name:"system",data:{eventName:"copilotMsalInit",eventInfo_initTrigger:"DCL",eventInfo_timing:performance.now()-window.appStart}});const s=Bee();i.addEventCallback(async f=>{if(Vj(f),s){f.eventType===ce.ACCOUNT_ADDED?t.set(ei,{reason:"login"}):f.eventType===ce.ACCOUNT_REMOVED&&t.set(ei,{reason:"logout"});return}if((f.eventType===ce.LOGIN_SUCCESS||f.eventType===ce.ACQUIRE_TOKEN_SUCCESS)&&f.payload&&"account"in f.payload&&f.payload.account){const{account:p}=f.payload,g=i.getActiveAccount();(!g||g.homeAccountId!==p.homeAccountId)&&(fa({authWorkflowAccountType:"microsoft",apiName:"msal:differentAccountLogin",extraInfo:{eventInfo_eventType:f.eventType}}),i.setActiveAccount(p),r(p))}else if(f.eventType===ce.LOGOUT_SUCCESS){const p=E7(i.getAllAccounts());i.setActiveAccount(p??null),r(p??null)}else f.eventType===ce.ACCOUNT_ADDED?t.set(ei,{reason:"login"}):f.eventType===ce.ACCOUNT_REMOVED&&t.set(ei,{reason:"logout"})});let a=!1;if(j1()){const f=Rs.instance();await f.initAuthAccount(),a=!!await f.getAccountFromProviders()}else a=await e();t.set(xD,!0);const{monitorAccountChangesAcrossTabs:u,enableAuth0:h}=me.instance().config();if(u&&i.enableAccountStorageEvents(),!a&&n()){const f=performance.now();try{const p=await i.ssoSilent(XV),g=performance.now()-f,v=Tf(p.account.tenantId)==="MSA";v||h0({message:"SSO Silent returned an AAD account",errorCode:"unexpected_account_type"}),Ro(jg,c.boolean(),!0),uwe()&&h0({message:"User is on login page, skipping account update",errorCode:"sso_on_login_page"}),v?(i.setActiveAccount(p.account),r(p.account),kue({accountUpdate:!0,accountType:"MSA",message:"Account set by MSAL silent SSO",duration:g}),wt.emit("auth:account-set-by-msal-sso")):await i.logoutRedirect({account:p.account,onRedirectNavigate:()=>!1})}catch(p){h0({message:p instanceof Error?p.message:"Unknown error",errorCode:p instanceof Et?p.errorCode:""})}}h&&u&&af.addEventListener("message",f=>{const p=B8.safeParse(f.data);if(!p.success)return;const{eventName:g}=p.data;g==="auth0.accountAdded"?t.set(ei,{reason:"login"}):g==="auth0.accountRemoved"&&t.set(ei,{reason:"logout"})})}catch(i){U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"MsalInitError",eventInfo_details:"DCL",eventInfo_errorMessage:i instanceof Error?i.message:""}})}}return o()}function fwe(){const t=aG(),e=ve(Ip);t&&(r=>LG.includes(r))(t)&&e(t)}function pwe(){const t=x(Sn),e=se("account-change-chat-reset");m.useEffect(()=>{e&&tA()},[t,e])}function mwe(){const t=bo("kill-clarity"),e=x(it);F8({onStartComplete:()=>{n()}});const n=()=>{try{const o="n59ae4ieqq";if(t||!r(o))return()=>{};window.clarity||(window.clarity=function(...a){window.clarity&&(window.clarity.q=window.clarity.q??[]).push(a)});const i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.src=`/cl/tag/${o}`,document.body.appendChild(i),window.clarity("signal",async s=>{if(s.type==="cl_dtrs"&&s.value){const{sendChallengeResponse:a}=await ts();a({method:"clarity",token:s.value,conversationId:e})}}),window.clarity("metadata",()=>{KI({surface:"cmc"});const s=Ue(W5);s!==null&&KI({isNewUser:s.toString()})},!1,!0),()=>{delete window.clarity,i.remove()}}catch(o){return U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"useClarity",eventInfo_details:"Error loading Clarity",eventInfo_errorMessage:`${o}`}}),()=>{}}},r=o=>o.trim()!==""}function B0(t){if(me.instance().config().persistThemeChoice){const n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t!==n?cr(Ug,t):tr(Ug)}document.documentElement.setAttribute("data-theme",t),wt.emit("theme:color-applied",t)}function gwe(){const{persistThemeChoice:t,enforceTheme:e}=me.instance().config(),[n,r]=Ze(Os);m.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),i=a=>{const l=a.matches?"dark":"light";r(l),B0(l),t&&tr(Ug)};let s=t?yn(Ug):"";return s!=="dark"&&s!=="light"&&(s=o.matches?"dark":"light"),e&&(s=e),r(s),B0(s),o.addEventListener("change",i),()=>{o.removeEventListener("change",i)}},[r,t,e]),m.useEffect(()=>{n&&B0(n)},[n])}const vwe={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1,refreshInterval:SA};function ywe(t){return function(n){return $n(n,RQ,t?{query:{"api-version":"2"}}:void 0).then(r=>r.data)}}function ls(t){return Array.isArray(t)?wf(t):{positive:wf(t.positive),negative:wf(t.negative)}}function wf(t){const e=t,n=e.slice(0,-1),r=e.slice(-1);return[...YCe(n),...r]}function bwe(){const t=se("adspositivefeedbacksurvey"),e=se("file-upload-config"),n=ywe(t),{data:r,mutate:o}=Il("/config",n,vwe),i=ve(Uy),s=ve(C5),a=ve(T5),l=ve(Bpe),u=ve(Hpe),h=ve(zpe),f=ve(PT),p=ve(MT),g=ve(S5),v=ve(kl),y=ve(ZJ);U8(o),m.useEffect(()=>{if(r){if(i(r.voices),s(r.signInPrompts),a(r.maxTextMessageLength),l(r.maxPageContentLength),h(r.pageLimit),u(r.maxPageTitleLength),r.characters&&p(r.characters),r.feedbackOptions.text=wf(r.feedbackOptions.text),r.feedbackOptions.image=wf(r.feedbackOptions.image),r.feedbackOptions.card.local=ls(r.feedbackOptions.card.local),r.feedbackOptions.card.ads=ls(r.feedbackOptions.card.ads),r.feedbackOptions.card.video=ls(r.feedbackOptions.card.video),r.feedbackOptions.card.image=ls(r.feedbackOptions.card.image),r.feedbackOptions.card.shopping=ls(r.feedbackOptions.card.shopping),r.feedbackOptions.card.sports=ls(r.feedbackOptions.card.sports),r.feedbackOptions.card.finance=ls(r.feedbackOptions.card.finance),r.feedbackOptions.card.quiz=ls(r.feedbackOptions.card.quiz),r.feedbackOptions.card.weather=ls(r.feedbackOptions.card.weather),f(r.feedbackOptions),g(r.messagePreview),e){const b=T=>{const w={};for(const A of T)A in Gu&&Gu[A]&&(w[A]=Gu[A]);return w},C=b(r.attachments.image.mimeTypes),S=b(r.attachments.document.mimeTypes),I=Ue(d9),E=(T,w)=>({maxBytes:T.maxBytes??w.maxBytes,mimeTypes:Object.keys(T.mimeTypes??{}).length?T.mimeTypes??{}:w.mimeTypes});v({maxFilesPerMessage:r.attachments.maxFilesPerMessage||I.maxFilesPerMessage,image:E({maxBytes:r.attachments.image.maxBytes,mimeTypes:C},I.image),document:E({maxBytes:r.attachments.document.maxBytes,mimeTypes:S},I.document)})}y(r.portraits??[])}},[r,s,i,a,l,u,f,p,h,g,v,e,y])}function Cwe(){m.useEffect(()=>{if(window.ReportingObserver===void 0)return()=>{};const t=new ReportingObserver(e=>{for(const n of e){if(n.type!=="csp-violation"||!n.body)continue;const{body:r}=n,{blockedURL:o,documentURL:i,effectiveDirective:s,disposition:a}=r;console.error("Reporting CSP violation",{blockedURL:o,documentURL:i,effectiveDirective:s,disposition:a}),U.trackEvent({name:"system",data:{eventName:"copilotCSPViolation",eventInfo_blockedURL:o,eventInfo_documentURL:i,eventInfo_effectiveDirective:s,eventInfo_disposition:a}})}},{buffered:!0,types:["csp-violation"]});return t.observe(),()=>{t.disconnect()}},[])}function Swe(){const t=se("custom-1ds"),e=x(Cr);m.useEffect(()=>{if(!t||!me.instance().config().enableCustom1DS)return tL(),()=>{};if(!e)return()=>{};const n=()=>{if(window.oneDS){const{ApplicationInsights:i}=window.oneDS;return new i}},r=()=>{var l;window.OneDsAzureAnalytics=window.OneDsAzureAnalytics??n();function i(){var h;return!!!((h=window.OneDsAzureAnalytics)!=null&&h.getCookieMgr().get("MSCC"))}const s={adobe:i(),google:i()},a={instrumentationKey:"c72e6b24df604532a6282edd268b4ba4-9cdee1fe-5d2f-4626-9620-dbad9b53a8e5-8065",channelConfiguration:{eventsLimitInMem:50,autoFlushEventsLimit:1},propertyConfiguration:{userConsentCookieName:xy.name,gpcDataSharingOptIn:ZO(),callback:{userConsentDetails:()=>{if(!yy.includes(e))return{Required:!0,Analytics:!0,SocialMedia:!0,Advertising:!0};const u=ol();return{Required:Object.values(u).includes(!0),Analytics:u.analytics,SocialMedia:u.socialMedia,Advertising:u.advertising}}}},webAnalyticsConfiguration:{coreData:{appId:"JS:Copilot_microsoft_com"},cookiesToCollect:["_mkto_trk"],urlCollectQuery:!0,syncMuid:i()},extensionConfig:{IdSyncPlugin:s}};window.postConsAzure1DSInit||((l=window.OneDsAzureAnalytics)==null||l.initialize(a,[]),window.postConsAzure1DSInit=!0)},o=document.createElement("script");return o.src="https://az416426.vo.msecnd.net/scripts/c/ms.analytics-web-4.min.js",o.async=!0,o.onload=r,document.head.appendChild(o),()=>{document.head.removeChild(o)}},[t,e])}function Iwe(t){const{handler:e}=OU({deferred:!0}),{handler:n}=s9({deferred:!0}),{passthroughType:r,prompt:o}=a9(),i=m.useCallback(l=>{U.setLandingPage("chatWithPartialPromptPassthrough"),e(l)},[e]),s=m.useCallback(l=>{U.setLandingPage("chatWithFullPromptPassthrough"),n(l)},[n]),a=m.useCallback(()=>{if(o&&r)switch(r){case"partial":i(o);break;case"full":s(o);break}},[s,i,r,o]);m.useEffect(()=>{t&&a()},[t,a])}function Ewe(){const t=$t(),e=m.useRef(!1),n=x(br),[r,o]=Ze(Sp),i=LD();m.useEffect(()=>{t.startsWith("/chats")&&mn("appearance-talk")==="1"&&(e.current=!0)},[t]),m.useEffect(()=>{i&&n&&e.current&&(e.current=!1,o(UT))},[n,e,r,o,i])}function Twe(){const t=x(it),e=x(F5),n=se("adsidsync"),r=x(Cr),o=Sr(),i=Bb(r),s=x(jT),a=Sl();m.useEffect(()=>{const{adsEnabled:l,enforceAdsOptOutOfPersonalization:u}=me.instance().config(),h=l&&!a;if(t&&e&&n){const f=sT(),g=ol().advertising;if(U.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"syncAdvertisingId",eventInfo_conversationId:t,eventInfo_additionalData:JSON.stringify({isAdsEnabled:h,isAdPersonalizationEnabled:g,isAuthenticated:o,isGdprPlusRegion:i,isChoiceCookieEmpty:!f})}}),!h)return;const v=new URLSearchParams;if(v.append("cpid",e),v.append("cvid",t),o&&v.append("cp","1"),f){if(i&&!g)return;g&&!u?v.append("ps","1"):v.append("ps","0")}else{if(i)return;v.append("ps","1")}const y=`https://c.bing.com/cp?${v}`,b=performance.now();fetch(y,{method:"GET",mode:"no-cors",credentials:"include"}).then(C=>{const S=performance.now();UD(y,"GET",S-b,C.clone())}).catch(C=>{U.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"adsError",eventInfo_errorMessage:"Ads Id Sync failed with error",eventInfo_details:`Ads Id Sync failed: ${C}`}})})}},[s,t,r,i,n,e,o,a])}function wwe(t){const e=x(Sn),n=x(Hy),r=x(Gy),o=x(pl),i=x($y),{upsellFromAuth0:s}=me.instance().config().proSubscription,{handleSubscription:a}=ay({payflowEntryPoint:"RedirectFromAuth0Account",skuType:i?"FreeTrial":"1Mo-Paid",upsellReason:"",entryStyle:"Redirect"}),u=Sr()&&(e==null?void 0:e.provider)==="microsoft",h=se("cmc-m365-sku"),f=li("pff"),p=Q$("needsStartSubscription"),g=$t(),v=m.useRef(!1);m.useEffect(()=>{if(p&&h&&u&&!g.startsWith("/subscription/start")&&(f==="WinNative"||f==="EdgeSidepane")){eL("needsStartSubscription"),setTimeout(()=>{a()},0);return}if(!(s!=null&&s.navigateToProSubPageAfterLogin))return;const y=sessionStorage.getItem(t1);if(!y)return;async function b(C){const[,S]=C.split("-");if(S==="link"){const I=performance.now(),{getAuth0AccessToken:E,auth0:T}=await ko.get(),w=await E(xf);if(!w){Dr({feature:"accountLinkAuth0WithMSA",errorType:"LinkStartedWithoutAuth0Token"});return}try{await Ur({path:"/user/link",args:{body:{token:w}}})}catch(A){A instanceof Error&&Dr({feature:"accountLinkAuth0WithMSA",errorType:A.name,errorMessage:A.message,exception:A.stack})}finally{T.logout({openUrl:!1}),Sa({feature:"accountLinkAuth0WithMSA",duration:performance.now()-I}),o||await a()}}}if(t&&!v.current&&n){if(v.current=!0,sessionStorage.removeItem(t1),(e==null?void 0:e.accountType)!=="MSA"||r)return;b(y)}},[t,a,s,e,o,r,n,g,u,f,h,p])}function _we(t){const{isEnabled:e,onIntercept:n}=t;m.useEffect(()=>{if(!e)return()=>{};const r=s=>eU(s)?(n(s.toString()),!0):!1,o=s=>{const a=s.target.closest("a");a&&a instanceof HTMLAnchorElement&&r(a.href)&&s.preventDefault()},i=window.open;return window.open=function(...a){return a.length>0&&typeof a[0]=="string"&&!r(a[0])?i.apply(window,a):null},document.addEventListener("click",o),()=>{window.open=i,document.removeEventListener("click",o)}},[e,n])}function Awe(){m.useEffect(()=>{const t=yn(m1),e=Date.now();t||cr(m1,e.toString())},[])}function kwe(){m.useEffect(()=>{},[])}function xwe(t){const[e,n]=m.useState(!1),r=uU();return m.useEffect(()=>{e||!t||r({enablePageRedirect:!0,overwriteData:!1}).then(o=>{o&&n(!0)}).catch(console.error)},[r,e,t]),m.useEffect(()=>{const o=()=>{r({enablePageRedirect:!1,overwriteData:!0,eventDriven:!0}).catch(console.error)};return wt.on("auth:account-set-by-msal-sso",o),()=>{wt.off("auth:account-set-by-msal-sso",o)}},[r]),{appInitialized:e}}let T7=-1;const qp=t=>{addEventListener("pageshow",e=>{e.persisted&&(T7=e.timeStamp,t(e))},!0)},Pa=(t,e,n,r)=>{let o,i;return s=>{e.value>=0&&(s||r)&&(i=e.value-(o??0),(i||o===void 0)&&(o=e.value,e.delta=i,e.rating=((a,l)=>a>l[1]?"poor":a>l[0]?"needs-improvement":"good")(e.value,n),t(e)))}},w7=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},PA=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},tC=()=>{const t=PA();return(t==null?void 0:t.activationStart)??0},Ma=(t,e=-1)=>{const n=PA();let r="navigate";return T7>=0?r="back-forward-cache":n&&(document.prerendering||tC()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},H0=new WeakMap;function _7(t,e){return H0.get(t)||H0.set(t,new e),H0.get(t)}const nC=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(o=>{Promise.resolve().then(()=>{e(o.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},A7=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let Pu=-1;const cM=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,dy=t=>{document.visibilityState==="hidden"&&Pu>-1&&(Pu=t.type==="visibilitychange"?t.timeStamp:0,Rwe())},lM=()=>{addEventListener("visibilitychange",dy,!0),addEventListener("prerenderingchange",dy,!0)},Rwe=()=>{removeEventListener("visibilitychange",dy,!0),removeEventListener("prerenderingchange",dy,!0)},k7=()=>{var t;return Pu<0&&(Pu=(document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(n=>n.name==="hidden")[0])==null?void 0:t.startTime)??cM(),lM(),qp(()=>{setTimeout(()=>{Pu=cM(),lM()})})),{get firstHiddenTime(){return Pu}}},rC=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},uM=[1800,3e3],Nwe=(t,e={})=>{rC(()=>{const n=k7();let r,o=Ma("FCP");const i=nC("paint",s=>{for(const a of s)a.name==="first-contentful-paint"&&(i.disconnect(),a.startTime<n.firstHiddenTime&&(o.value=Math.max(a.startTime-tC(),0),o.entries.push(a),r(!0)))});i&&(r=Pa(t,o,uM,e.reportAllChanges),qp(s=>{o=Ma("FCP"),r=Pa(t,o,uM,e.reportAllChanges),w7(()=>{o.value=performance.now()-s.timeStamp,r(!0)})}))})};let x7=0,z0=1/0,Ym=0;const Pwe=t=>{for(const e of t)e.interactionId&&(z0=Math.min(z0,e.interactionId),Ym=Math.max(Ym,e.interactionId),x7=Ym?(Ym-z0)/7+1:0)};let pE;const dM=()=>pE?x7:performance.interactionCount??0,Mwe=()=>{"interactionCount"in performance||pE||(pE=nC("event",Pwe,{type:"event",buffered:!0,durationThreshold:0}))};let hM=0;class Owe{constructor(){j(this,"u",[]);j(this,"l",new Map);j(this,"m");j(this,"p")}v(){hM=dM(),this.u.length=0,this.l.clear()}P(){const e=Math.min(this.u.length-1,Math.floor((dM()-hM)/50));return this.u[e]}h(e){var o,i;if((o=this.m)==null||o.call(this,e),!e.interactionId&&e.entryType!=="first-input")return;const n=this.u.at(-1);let r=this.l.get(e.interactionId);if(r||this.u.length<10||e.duration>n.T){if(r?e.duration>r.T?(r.entries=[e],r.T=e.duration):e.duration===r.T&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],T:e.duration},this.l.set(r.id,r),this.u.push(r)),this.u.sort((s,a)=>a.T-s.T),this.u.length>10){const s=this.u.splice(10);for(const a of s)this.l.delete(a.id)}(i=this.p)==null||i.call(this,r)}}}const R7=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(e(t=A7(t)),document.addEventListener("visibilitychange",t,{once:!0}))},fM=[200,500],Lwe=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&rC(()=>{Mwe();let n,r=Ma("INP");const o=_7(e,Owe),i=a=>{R7(()=>{for(const u of a)o.h(u);const l=o.P();l&&l.T!==r.value&&(r.value=l.T,r.entries=l.entries,n())})},s=nC("event",i,{durationThreshold:e.durationThreshold??40});n=Pa(t,r,fM,e.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(i(s.takeRecords()),n(!0))}),qp(()=>{o.v(),r=Ma("INP"),n=Pa(t,r,fM,e.reportAllChanges)}))})};let Dwe=class{constructor(){j(this,"m")}h(e){var n;(n=this.m)==null||n.call(this,e)}};const pM=[2500,4e3],jwe=(t,e={})=>{rC(()=>{const n=k7();let r,o=Ma("LCP");const i=_7(e,Dwe),s=l=>{e.reportAllChanges||(l=l.slice(-1));for(const u of l)i.h(u),u.startTime<n.firstHiddenTime&&(o.value=Math.max(u.startTime-tC(),0),o.entries=[u],r())},a=nC("largest-contentful-paint",s);if(a){r=Pa(t,o,pM,e.reportAllChanges);const l=A7(()=>{s(a.takeRecords()),a.disconnect(),r(!0)});for(const u of["keydown","click","visibilitychange"])addEventListener(u,()=>R7(l),{capture:!0,once:!0});qp(u=>{o=Ma("LCP"),r=Pa(t,o,pM,e.reportAllChanges),w7(()=>{o.value=performance.now()-u.timeStamp,r(!0)})})}})},mM=[800,1800],mE=t=>{document.prerendering?rC(()=>mE(t)):document.readyState!=="complete"?addEventListener("load",()=>mE(t),!0):setTimeout(t)},Uwe=(t,e={})=>{let n=Ma("TTFB"),r=Pa(t,n,mM,e.reportAllChanges);mE(()=>{const o=PA();o&&(n.value=Math.max(o.responseStart-tC(),0),n.entries=[o],r(!0),qp(()=>{n=Ma("TTFB",0),r=Pa(t,n,mM,e.reportAllChanges),r(!0)}))})},Fwe=t=>{const n=performance.getEntriesByType("navigation")[0],r=n==null?void 0:n.type;let o;const i=navigator;i.connection&&typeof i.connection.effectiveType=="string"&&(o=i.connection.effectiveType);const s={eventName:t.name,eventInfo_duration:t.value,eventInfo_navigationType:r,eventInfo_connectionType:o};U.trackEvent({name:"system",data:s});try{const a=`web-vitals-${t.name}`;performance.mark(a),performance.measure(`web-vitals-measure-${t.name}`)}catch{}};let gM=!1;function Bwe(){const t=ve(R5);if(typeof window>"u"||gM)return;gM=!0;let e=!1;const n=o=>{Fwe(o),t(i=>({...i,[o.name.toLowerCase()]:o.value}))},r=o=>{e||(e=!0,n(o))};Uwe(n),Nwe(n),jwe(r,{reportAllChanges:!0}),Lwe(n)}function Hwe(){m.useEffect(()=>(window.addEventListener("unhandledrejection",cx),()=>{window.removeEventListener("unhandledrejection",cx)}),[])}function zwe(){const t=gp(bn);return m.useCallback(n=>{t(r=>{for(const{id:o,title:i,updatedAt:s,characterId:a,continuedAt:l}of n){const u=r.get(o);u?(u.title=i,u.updatedAt=s,u.characterId=a??null,u.continuedAt=l):r.set(o,{id:o,title:i,updatedAt:s,characterId:a??null,streamingState:"idle",history:[],continuedAt:null})}})},[t])}function Vwe(t,e){if(!(e!=null&&e.next)&&t>0)return null;const n={url:"/conversations",isFirstPage:t===0};return e!=null&&e.next&&(n.args={cursor:e.next}),n}function $we(){const t=zwe(),e=ve(jy),n=m.useCallback(async({url:r,args:o,isFirstPage:i})=>{const s=await $n(r,qQ,{query:o}).then(a=>a.data);if(s.results.length>0){const a=s.results.map(l=>({...l,history:[],streamingState:"idle"}));t(a),e(!0)}else i&&e(!1);return s},[t,e]);return Y_(n,Vwe)}const Gwe="aster";function Kwe(){const t=ve(Cr),e=ve(zX),n=!bo("kill-picasso-id-on-start");return m.useCallback(async()=>{const r=await $n("/user",n5,{parseOptions:{safe:!0},query:{"api-version":"2"}}).then(l=>l.data),{id:o,anid:i,isHistoryMigrationPending:s}=r;U.setAnid(i);const a=U.getPicassoId();return a!==null&&a!==o&&U.trackEvent({name:"health",data:{eventName:"userIdMismatch",eventInfo_customData:JSON.stringify({existingPicassoId:a,newPicassoId:o,origin:"user"})}}),n||U.setPicassoId(o),e(s),t(r.regionCode),r},[n,e,t])}function qwe(){const t=x(Sn),e=x(ml),{refetch:n}=$we(),r=Kwe(),o=ve(br),i=ve(Dc),s=ve(Cp),a=ve(B5),l=ve(z5),u=ve(FT),h=ve(zy),f=ve(UX),p=ve(aX),g=ve(V5),v=ve(FX),y=ve(j5),b=ve(BT),C=ve(Vy),S=ve(BX),I=Hp(),E=se("account-change-chat-reset"),T=Mb()[0]==="audioCall";m.useEffect(()=>{(async()=>{const A=Promise.all([r(),$n("/user/settings",$Q).then(Ke=>Ke.data),n()]),_=Rs.instance().getUserInfo(),[{id:L,firstName:N,isPro:K,inEeaPlusRegion:q,isEligibleForFreeTrial:ae,phoneLink:O,ageGroup:W,allowedToggles:te,remainingCalls:D,subscriptions:G,accountTier:re},{preferredVoice:J,preferredCharacter:ne,optOutOfTraining:X,optInToVoiceTraining:Ie,optOutOfPersonalization:Ce,optOutOfPhoneConnection:be,optInToGenerativeUI:ue,allowBiometricDataUse:Me,allowOneDriveAccess:Ye,features:le}]=await A;if(U.setIsAad(e),o({id:L,firstName:N,isPro:K&&!e,inEeaPlusRegion:q,isEligibleForFreeTrial:ae,phoneLink:O,ageGroup:W,allowedToggles:te,subscriptions:G,accountTier:re,isStudent:void 0}),y(N??void 0),!E&&!T&&await tA(),s(J||Gwe),I&&ne){const Ke=uL(ne);a(Ke)}l(X),u(Ie),h(Ce),f(!!be),p(!!ue),g(!!Me),v(!!Ye),S((le==null?void 0:le.suggestedFollowups)??!0),D&&(b(D.podcastGeneration),C(D.research)),U.setSettings({userSettingVoiceType:J??void 0,userConsentPersonalization:!Ce,userConsentModelTraining:!X,userSubscription:K?"pro":"free",accountTier:re??void 0,activeSubscriptions:(G==null?void 0:G.map(Ke=>Ke.tier).join(","))??void 0});const we=await _;if(we){const{mail:Ke,givenName:k,imgSrc:B,isStudent:ge}=we;o(M=>M&&{...M,givenName:k,email:Ke,imgSrc:B,isStudent:ge}),k&&!N&&y(k),e||i(null)}})().catch(console.error)},[t,E,o,i,n,l,s,I,f,p,u,h,g,v,r,e,a,T,y,b,C,S])}function Wwe(t={}){const{isAppInitialized:e=!1}=t,n=window.appStart;return m.useEffect(()=>!e||!n?()=>{}:(window.addEventListener("beforeunload",$x),()=>{window.removeEventListener("beforeunload",$x)}),[e,n]),{startTime:n}}const Ywe=c.object({isMobileAppInstalled:c.boolean()}),Qwe="/user/install-status";async function Jwe(){try{return(await $n(Qwe,Ywe,{options:{method:"GET"}})).data.isMobileAppInstalled}catch(t){throw console.error("Failed to fetch mobile app install status:",t),t}}function Xwe(){const t=ve(LT),{data:e,error:n,isLoading:r,mutate:o}=Il("mobileAppInstallStatus",Jwe,{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:6e4});return m.useEffect(()=>{e!==void 0&&t(e)},[e,t]),{isMobileAppInstalled:e,isLoading:r,error:n||null,refetch:o}}const Zwe="/user/narrative";function vM(t,e){var n;return(n=t.filter(r=>r.name===e)[0])==null?void 0:n.url}function rOe(t){const{background1:e,background2:n,background3:r}=t,i=[n,e,r].filter(a=>typeof a=="object"&&"light"in a&&"dark"in a);if(i.length===0)return[];const s=[];for(let a=0;a<i.length;a+=1){const l=i[a],u=i[(a+1)%i.length];!l||!u||(s.push({type:"gradient",from:l,to:u}),s.push({type:"solid",color:u}))}return s}function oOe(t,e,n){const r=t[e%t.length];return r?r.type==="gradient"?`linear-gradient(to bottom, ${n?`#${r.from.dark}`:`#${r.from.light}`}, ${n?`#${r.to.dark}`:`#${r.to.light}`})`:n?`#${r.color.dark}`:`#${r.color.light}`:"var(--background-color)"}function iOe(t,e){return e==="wavy-shape"?vM(t,"hero-image-wavy-tablet"):vM(t,`hero-image-${e}-tablet`)}const e_e=c.object({from:c.string()});function t_e(t){return e_e.safeParse(t).success}function sOe(t){return t_e(t)?t.from:"/"}const aOe={start:{...ot,y:300},end:{...Lt,y:0}},cOe={duration:Zde,ease:ehe},n_e={revalidateOnFocus:!1,shouldRetryOnError:!1,refreshInterval:SA};async function r_e(t){const{data:e,response:n}=await $n(t,rQ,{options:{method:"GET",headers:{"Content-Type":"application/json"}},query:{"api-version":"2"}});if(!n.ok)return null;const{id:r,sections:o,theme:i,masks:s,font:a,fontHandwriting:l}=e;return{id:r,sections:o.filter(u=>u.type!=="shareDefault"),config:{theme:i,masks:s,font:a,...l?{fontHandwriting:l}:{}}}}function o_e(){const t=Sr(),e=se("memory-narrative"),n=t&&e,{data:r,error:o,isLoading:i}=Il(n?Zwe:null,r_e,n_e);return{isLoading:i,error:o,data:i||!r?null:r}}function i_e(){typeof window<"u"&&(Object.defineProperty(window,"APP_VERSION",{value:oT()}),Object.defineProperty(window,"APP_SURFACE",{value:"cmc"}))}const s_e=new rH({defaultOptions:{queries:{retry:0,refetchOnWindowFocus:!1}}});function a_e({sidebar:t,customLayout:e=!1}){Awe(),Mb(),fwe(),bfe(),mde();const n=dwe(),{appInitialized:r}=xwe(n);P1e(),Iwe(r),gwe(),Hwe();const o=q9(),i=ve(Fy);_we({isEnabled:o,onIntercept:i});const s=x(ei);Wwe({isAppInitialized:r}),awe(),Ime(),Swe(),Ewe();const a=x(Ff);return rwe(r),Bwe(),pwe(),wwe(r),kwe(),mwe(),Cwe(),Twe(),a==="user-banned"?d.jsx(JTe,{}):a==="age-verification"?d.jsx(Ihe,{}):a?d.jsx(G_,{}):!r||!n?null:s?d.jsx(mU,{accountActionRequired:s}):d.jsx(oH,{client:s_e,children:d.jsx(iO,{reducedMotion:"user",children:d.jsx(c_e,{children:d.jsx(QTe,{sidebar:t,customLayout:e,children:d.jsx(iH,{})})})})})}function c_e(t){const{children:e}=t;return qwe(),Xwe(),o_e(),bwe(),H0e(),iwe(),e}function l_e(t){const{sidebar:e,customLayout:n,onError:r=cL}=t;return d.jsxs(cO,{fallback:d.jsx(G_,{}),onError:r,children:[d.jsx(bge,{}),d.jsx(a_e,{sidebar:e,customLayout:n,onError:r})]})}i_e();document.addEventListener("DOMContentLoaded",()=>{I7()&&setTimeout(()=>hwe(),0)});const MA=new Set;function u_e(t=!1){return yn(f1)!==null&&!t?!1:(tr(Ry),tr(ad),m_e(),cr(f1,"true"),!0)}function N7(){return parseInt(yn(Ry)??"0",10)}function d_e(){return new Date(yn(ad)??new Date().toISOString())}function h_e(t){yn(ad)||cr(ad,t)}function f_e(t){let e;try{e=N7()}catch{e=0}e<X0&&(e+=1,cr(Ry,`${e}`),MA.add(t),e===X0&&h_e(new Date().toISOString()))}function p_e(t){t&&(MA.has(t)||f_e(t))}function m_e(){MA.clear()}function g_e(){const t=Sr(),e=x(zy),n=ve(q5);m.useEffect(()=>{t&&!e&&u_e()&&n(!0)},[t,e,n])}function v_e(){const t=Sl(),[e,n]=Ze(kT),r=Qd();m.useEffect(()=>{!t&&e&&n(void 0),t&&!e&&r({isPrivate:!0})},[t,e,n,r])}aU();function y_e(){g_e(),v_e();const t=se("discover-with-pane-layout"),e=se("pages-layout-v2"),n=se("chat-layout-v2"),r=$t();let o=!1;return(e&&r.startsWith("/pages")||t&&r.startsWith("/discover")||n&&r.startsWith("/chats"))&&(o=!0),d.jsx(l_e,{customLayout:o})}const b_e=c.object({"prompt-branch":c.string().optional(),branch:c.string().optional()}),Tt=sH({component:y_e,validateSearch:gH(b_e),search:{middlewares:[aH(["prompt-branch","branch"])]}}),P7=m.lazy(()=>H(()=>import("./discover-D4g6cehV.js").then(t=>t.d),__vite__mapDeps([316,1,2,317,318,319,320,321,322,323,324,325,326,327,328,329,315,330,331,332,333,248,232,283,334,335,290,250]))),C_e=bt("/")({component:()=>d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(P7,{})})}),S_e=bt("/discover")({component:()=>d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(_t,{className:"size-12"})}),children:d.jsx(P7,{})})}),I_e=100,yM=.3,E_e=2*Ei,T_e="bottom-[60px] sm:bottom-[120px] h-[50px]",M7="min-h-[60px] sm:min-h-[120px]",O7="min-h-[calc(100dvh-60px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-120px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",w_e="min-h-[calc(100dvh-48px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-48px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",__e="min-h-[calc(100dvh-80px-var(--chat-details-container-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))] sm:min-h-[calc(100dvh-80px-var(--composer-container-height)-(2*var(--layout-offset-y)))]",A_e="bottom-[var(--character-component-height)] h-[50px]",k_e="min-h-[calc(100dvh-var(--character-component-height)-var(--composer-container-height)-(2*var(--layout-offset-y)))]";function x_e(t,e,n,r,o){const[i,s]=Ze(y5),a=m.useCallback(()=>{s(E=>!E)},[s]),l=vi(),u=m.useMemo(()=>({variants:{start:{opacity:0},exiting:{opacity:0,y:-100,transition:{duration:.2,y:{duration:.3}}}},initial:"start",animate:i?"exiting":"default"}),[i]),h=m.useMemo(()=>({initial:{opacity:0,y:I_e},animate:{opacity:1,y:0,transition:{duration:.4,y:{duration:yM}}},exit:{opacity:0,y:-100,transition:{duration:.2,y:{duration:yM}}},onAnimationStart:E=>{typeof E=="object"&&!Array.isArray(E)&&E.opacity===1&&(setTimeout(()=>t(),10),s(!1))}}),[t,s]),f=n?A_e:T_e,p=n?`min-h-[${r}px]`:M7,{highlighted:g,backstage:v}=N_e(o,i),y=P_e(n,v,g),b=m.useRef(null),{scrollYProgress:C}=cH({target:b,container:e,offset:["end start","start start"]}),S=nd(C,[E_e/100,1],[0,1]);return{toggleMessagesAreExiting:a,backstageMessagesProps:u,highlightedMessagesProps:h,opacity:l?S:C,sentinelRef:b,sentinelClasses:f,backstageClasses:p,highlightedClasses:y,highlighted:g,backstage:v}}function R_e(t){const e=L7(t);if(!e)return[];const n=t.at(-2),r=[];Ca(n)&&r.push(n),Ca(e)&&r.push(e);const o=t.at(-3);if((o==null?void 0:o.author)==="human"&&r.length===2)return[o,...r];const i=e.author==="human",s=!i&&(n==null?void 0:n.author)==="ai";return i||s?[e]:t.slice(-2)}function L7(t){return t.at(-1)}function N_e(t,e){const n=R_e(t),r=t.slice(0,-(n.length+(e?2:0)));return{highlighted:n,backstage:r}}function P_e(t,e,n){return t?k_e:me.instance().config().smallAnochorTopWithoutHeader&&n.length>0?e.length===0?__e:w_e:O7}function D7(){return Y(ip("pageContainer")??"px-6","mx-auto w-full max-w-chat")}function M_e(t){const{children:e,onClick:n,title:r,className:o,spatialNavigationAutofocus:i=!0,disabled:s=!1,testId:a,hoverVariant:l=!1}=t,[u,h]=m.useState(!1),[f,p]=m.useState(!1),g=()=>h(!0),v=()=>h(!1),y=()=>p(!0),b=()=>p(!1),C=u||f&&l?"acrylic-thin-inverted":"acrylic-thin";return d.jsx(Te,{disabled:s,variant:"pill",color:C,size:"64-xxl",testId:a,className:Y("w-conversations items-center justify-center",o),onClick:n,onFocus:g,onBlur:v,onMouseEnter:y,onMouseLeave:b,title:r,spatialNavigationAutofocus:i,children:e})}async function gE(t,e,n){try{await Ur({path:`/conversations/${t}/react`,args:{body:{[n]:e},analytics:{anonymousPath:"/conversations/*/react"}}})}catch{}}async function j7(t,e,n){try{await Ur({path:`/conversations/${t}/feedback`,args:{body:{types:Array.from(e),text:n},analytics:{anonymousPath:"/conversations/*/feedback"}}})}catch{}}const U7=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6 2C6.4075 2 6.77654 2.16302 7.04688 2.42676L7.05273 2.4248C7.70431 2.14511 8.40698 2 9.11816 2H14.7871C15.7302 2 16.5456 2.65891 16.7432 3.58105L17.9492 9.20801C17.9832 9.36686 18 9.52895 18 9.69141C18 10.9663 16.9663 12 15.6914 12H12.1904C12.3947 12.6629 12.5 13.3526 12.5 14.0469V14.668C12.5 15.6352 12.2133 16.581 11.6768 17.3857C11.4528 17.7215 11.0952 17.9399 10.7002 17.9893L10.5293 18H10.4775C9.66177 18 9 17.3382 9 16.5225V15.1719C8.9999 13.8855 8.54907 12.6397 7.72559 11.6514L6.91895 10.6836C6.66492 10.8811 6.34669 11 6 11H3.5C2.67157 11 2 10.3284 2 9.5V3.5C2 2.67157 2.67157 2 3.5 2H6ZM9.11816 3C8.55774 3 8.0038 3.11128 7.48828 3.32617C7.49488 3.38327 7.5 3.44114 7.5 3.5V9.5C7.5 9.59759 7.48948 9.69276 7.47168 9.78516L8.49316 11.0107C9.46653 12.1788 9.9999 13.6514 10 15.1719V16.5225C10 16.7859 10.2141 17 10.4775 17H10.5293L10.6221 16.9883C10.7122 16.9655 10.7919 16.9101 10.8447 16.8311C11.2717 16.1906 11.5 15.4377 11.5 14.668V14.0469C11.5 13.4073 11.3966 12.7718 11.1943 12.165L11.0254 11.6582C11.0223 11.6489 11.0211 11.6392 11.0186 11.6299C11.0142 11.6139 11.0105 11.5977 11.0078 11.5811C11.0046 11.5614 11.0028 11.542 11.002 11.5225C11.0016 11.515 11 11.5075 11 11.5C11 11.4948 11.0008 11.4896 11.001 11.4844C11.0016 11.4643 11.0038 11.4445 11.0068 11.4248C11.0089 11.4113 11.0106 11.3979 11.0137 11.3848C11.0179 11.3671 11.0242 11.3501 11.0303 11.333C11.0355 11.3184 11.0404 11.3039 11.0469 11.29C11.0531 11.2765 11.0609 11.2639 11.0684 11.251C11.077 11.236 11.0856 11.221 11.0957 11.207C11.1052 11.1939 11.1162 11.1821 11.127 11.1699C11.1369 11.1587 11.1463 11.147 11.1572 11.1367C11.17 11.1246 11.1841 11.1143 11.1982 11.1035C11.2105 11.0942 11.2223 11.0844 11.2354 11.0762C11.2399 11.0733 11.2443 11.0701 11.249 11.0674L11.3057 11.0391C11.3117 11.0365 11.318 11.0346 11.3242 11.0322C11.3301 11.03 11.3358 11.0274 11.3418 11.0254C11.3508 11.0224 11.3601 11.021 11.3691 11.0186C11.3852 11.0142 11.4014 11.0106 11.418 11.0078C11.4376 11.0045 11.457 11.0029 11.4766 11.002C11.4844 11.0016 11.4921 11 11.5 11H15.6914C16.414 11 17 10.414 17 9.69141C17 9.59931 16.99 9.50704 16.9707 9.41699L15.7656 3.79004C15.6667 3.32914 15.2585 3 14.7871 3H9.11816ZM3.5 3C3.22386 3 3 3.22386 3 3.5V9.5C3 9.77614 3.22386 10 3.5 10H6C6.27614 10 6.5 9.77614 6.5 9.5V3.5C6.5 3.22386 6.27614 3 6 3H3.5Z",fill:"currentColor"})),lOe=Object.freeze(Object.defineProperty({__proto__:null,default:U7},Symbol.toStringTag,{value:"Module"})),F7=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M10.7002 2.01074C11.0952 2.06005 11.4528 2.2785 11.6768 2.61426C12.2133 3.41901 12.5 4.36484 12.5 5.33203V5.95312C12.5 6.64737 12.3947 7.33709 12.1904 8H15.6914C16.9663 8 18 9.03369 18 10.3086C18 10.471 17.9832 10.6331 17.9492 10.792L16.7432 16.4189C16.5456 17.3411 15.7302 18 14.7871 18H9.11816C8.40698 18 7.70431 17.8549 7.05273 17.5752L7.04688 17.5723C6.7765 17.8363 6.40775 18 6 18H3.5C2.67157 18 2 17.3284 2 16.5V10.5C2 9.67157 2.67157 9 3.5 9H6C6.34648 9 6.665 9.11814 6.91895 9.31543L7.72559 8.34863C8.54907 7.36035 8.9999 6.11453 9 4.82812V3.47754C9 2.66177 9.66177 2 10.4775 2H10.5293L10.7002 2.01074ZM3.5 10C3.22386 10 3 10.2239 3 10.5V16.5C3 16.7761 3.22386 17 3.5 17H6C6.27614 17 6.5 16.7761 6.5 16.5V10.5C6.5 10.2239 6.27614 10 6 10H3.5ZM10.4775 3C10.2141 3 10 3.21405 10 3.47754V4.82812C9.9999 6.34856 9.46653 7.82122 8.49316 8.98926L7.47168 10.2139C7.48959 10.3066 7.5 10.4021 7.5 10.5V16.5C7.5 16.5585 7.4948 16.6161 7.48828 16.6729C8.00389 16.8878 8.55762 17 9.11816 17H14.7871C15.2585 17 15.6667 16.6709 15.7656 16.21L16.9707 10.583C16.99 10.493 17 10.4007 17 10.3086C17 9.58598 16.414 9 15.6914 9H11.5C11.4921 9 11.4844 8.99743 11.4766 8.99707C11.457 8.99614 11.4376 8.99451 11.418 8.99121C11.4013 8.98845 11.3852 8.98483 11.3691 8.98047C11.3602 8.97803 11.3507 8.97757 11.3418 8.97461C11.3357 8.97258 11.3302 8.96904 11.3242 8.9668C11.307 8.96032 11.2906 8.95259 11.2744 8.94434C11.261 8.93755 11.2479 8.93071 11.2354 8.92285C11.2217 8.91426 11.2091 8.90437 11.1963 8.89453C11.1828 8.88414 11.1695 8.87392 11.1572 8.8623C11.146 8.85165 11.1362 8.83977 11.126 8.82812C11.1156 8.81623 11.1049 8.80477 11.0957 8.79199C11.0856 8.77799 11.077 8.76309 11.0684 8.74805C11.0609 8.73511 11.0531 8.72253 11.0469 8.70898C11.0393 8.69254 11.0331 8.67555 11.0273 8.6582C11.0225 8.64364 11.0172 8.62925 11.0137 8.61426C11.0106 8.60113 11.0089 8.58772 11.0068 8.57422C11.0038 8.55451 11.0016 8.53476 11.001 8.51465C11.0008 8.50978 11 8.50491 11 8.5C11 8.49212 11.0016 8.48435 11.002 8.47656C11.0029 8.45704 11.0045 8.43757 11.0078 8.41797C11.0106 8.40136 11.0142 8.38516 11.0186 8.36914C11.021 8.36013 11.0224 8.35077 11.0254 8.3418L11.1943 7.83496C11.3966 7.22817 11.5 6.59274 11.5 5.95312V5.33203C11.5 4.56227 11.2717 3.80943 10.8447 3.16895C10.7919 3.08985 10.7122 3.03448 10.6221 3.01172L10.5293 3H10.4775Z",fill:"currentColor"})),uOe=Object.freeze(Object.defineProperty({__proto__:null,default:F7},Symbol.toStringTag,{value:"Module"}));function B7(t){const{titleText:e,subtitleText:n,positiveButtonText:r,negativeButtonText:o,positiveButtonTitle:i,negativeButtonTitle:s,modalHeaderText:a,onPositiveClick:l,onNegativeClick:u,isModalOpen:h,onModalClose:f,modalContent:p,className:g="",isDebugAudioRecorderEnabled:v=!1}=t;return d.jsxs("div",{className:g,children:[d.jsx("div",{className:"relative w-full pb-6 after:absolute after:mt-3 after:w-full after:border-b after:border-stroke-300"}),d.jsx("h2",{className:"mt-5 text-foreground-600 text-xs",children:d.jsx("strong",{children:e})}),d.jsx("p",{className:"mt-1 text-foreground-600 text-xs",children:n}),d.jsxs("div",{className:Y("mt-3.5 grid w-fit min-w-72 grid-rows-1 gap-2",v?"grid-cols-3":"grid-cols-2"),children:[d.jsxs(Te,{onClick:l,title:i,variant:"rect",size:"36-sm",children:[d.jsx(F7,{className:"size-5"})," ",r]}),d.jsxs(Te,{onClick:u,title:s,variant:"rect",size:"36-sm",children:[d.jsx(U7,{className:"size-5"})," ",o]}),v&&d.jsx(Te,{onClick:async()=>{const{AUDIO_RECORDER:y}=await H(async()=>{const{AUDIO_RECORDER:b}=await import("./audio-recorder-BeXU1zgv.js");return{AUDIO_RECORDER:b}},__vite__mapDeps([336,1,2]));await y.download()},title:"Download audio debug",variant:"rect",size:"36-sm",children:"Download audio debug"})]}),h&&d.jsx(Ol,{isOpen:!0,onClose:f,headerText:a,className:"w-full max-w-[400px]",children:p})]})}function O_e(){}function L_e({inputValue:t,handleChange:e,className:n=""}){const[r,o]=m.useState(""),{t:i}=xe();return bo("kill-free-form-text")?null:d.jsx(EA,{disabled:!1,className:Be(n,"max-h-[8rem] grow-0 basis-[8rem] !items-start overflow-auto rounded-xl border-2 border-stone-700 bg-black/5 px-0.5"),inputValue:t,characterLimit:uz,autoFocus:!1,setInput:a=>{e(a)},placeholder:i("chat.feedback.placeholder"),errorMessage:r,setError:o,onEnter:O_e,isMultiLines:!0})}function H7(t){const{feedbackOptions:e,onSubmit:n}=t,{t:r}=xe(),[o,i]=m.useState(new Set),[s,a]=m.useState(""),l=o.size===0,u=f=>{i(p=>{const g=new Set(p);return o.has(f)?g.delete(f):g.add(f),g})},h=async()=>{n(o,s),i(new Set)};return e?d.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[d.jsx("ul",{role:"list",className:"mt-0 flex list-none flex-col gap-2",children:e.map(f=>d.jsx("li",{children:d.jsx(G9,{label:f.label,setChecked:()=>u(f.type),checked:o.has(f.type)})},f.type))}),l?null:d.jsx(L_e,{inputValue:s,handleChange:a}),d.jsx(Te,{title:r("chat.feedback.submitFeedbackButton"),size:"48-lg",color:"strong",className:"mt-4 max-h-12",disabled:l,onClick:h,children:r("chat.feedback.submitFeedbackButton")})]}):null}function D_e(t){var C,S;const{className:e}=t,n=x(PT),[r,o]=Ze(By),[i,s]=m.useState(!1),[a,l]=m.useState(),u=se("ads-showroom-picasso-feedback"),{t:h}=xe(),f=I=>{gn({source:"feedback",scenario:AG[I],conversationId:r==null?void 0:r.conversationId,additionalData:{brandId:r==null?void 0:r.brandId,brandName:(r==null?void 0:r.brandName)??""}})},p=()=>{s(!1),o(void 0)},g=async I=>{r!=null&&r.conversationId&&u&&await gE(r.conversationId,I,"showroomReaction")},v=()=>{var I;f("thumbs-up"),l("thumbs-up"),(I=n==null?void 0:n.showroom)!=null&&I.positive?s(!0):p(),g("thumbs-up")},y=()=>{var I;f("thumbs-down"),l("thumbs-down"),(I=n==null?void 0:n.showroom)!=null&&I.negative?s(!0):p(),g("thumbs-down")},b=async(I,E)=>{p(),r&&U.trackEvent({name:"interaction",data:{eventName:"copilotSubmitFineConversationFeedback",eventInfo_fineFeedbackTypes:Array.from(I).join(","),eventInfo_conversationId:r.conversationId,eventInfo_additionalData:JSON.stringify({brandId:r.brandId,brandName:r.brandName,reactionType:a})}}),r!=null&&r.conversationId&&I.size>0&&j7(r.conversationId,I,E)};return d.jsx(B7,{titleText:h("ads.showroomFeedbackTitle",{brand:r==null?void 0:r.brandName}),subtitleText:h("ads.showroomFeedbackDescription"),positiveButtonText:h("ads.showroomFeedbackPositive"),negativeButtonText:h("ads.showroomFeedbackNegative"),positiveButtonTitle:h("reviewPrompt.positive"),negativeButtonTitle:h("reviewPrompt.negative"),modalHeaderText:h("ads.showroomFeedbackModalTitle"),onPositiveClick:v,onNegativeClick:y,isModalOpen:i,onModalClose:p,modalContent:d.jsx(H7,{onSubmit:b,feedbackOptions:a==="thumbs-up"?((C=n==null?void 0:n.showroom)==null?void 0:C.positive)??void 0:(S=n==null?void 0:n.showroom)==null?void 0:S.negative}),className:e,isDebugAudioRecorderEnabled:!1})}function j_e(t){const{onSubmit:e}=t,{t:n}=xe(),[r,o]=m.useState(!1),i=async s=>{o(!0),await e(s),o(!1)};return d.jsxs("div",{children:[d.jsx("p",{children:n("voice.feedback.reviewReason")}),d.jsx(Te,{title:n("voice.feedback.okay"),size:"48-lg",color:"strong",className:"mt-4 max-h-12 w-full",disabled:r,onClick:()=>i(!0),children:n("voice.feedback.okay")}),d.jsx(Te,{title:n("voice.feedback.noThanks"),size:"48-lg",color:"default",className:"mt-3 w-full",onClick:()=>i(!1),children:n("voice.feedback.noThanks")})]})}function U_e({className:t}){const e=x(it),n=x(PT),r=ve(Dd),[o,i]=Ze(FT),[s,a]=m.useState(),l=se("debug-audio-recorder")&&!1,u=DD(),{t:h}=xe(),f=()=>{gn({source:"voiceFeedback",scenario:"thumbsUp",conversationId:e,destination:u?"appearance":void 0}),e&&gE(e,"thumbs-up","audioReaction"),r(!1),wt.emit("feedback:ai-message-reaction","positive")},p=()=>{gn({source:"voiceFeedback",scenario:"thumbsDown",conversationId:e,destination:u?"appearance":void 0}),e&&gE(e,"thumbs-down","audioReaction"),a("feedback-options")},g=()=>{a(null),r(!1)},v=async(C,S)=>{nt({source:"voiceFeedback",scenario:"feedbackSubmit",conversationId:e,destination:u?"appearance":void 0,customData:JSON.stringify({selectedOptionsCount:C.size,feedbackTypes:[...C].join(",")})}),e&&C.size>0&&j7(e,C,S),o?g():a("review-request")},y=async C=>{C&&(i(!0),await Xpe({optInToVoiceTraining:!0})),g()},b=()=>s==="feedback-options"?d.jsx(H7,{onSubmit:v,feedbackOptions:u?n==null?void 0:n.appearance:n==null?void 0:n.call}):s==="review-request"?d.jsx(j_e,{onSubmit:y}):null;return d.jsx(B7,{titleText:h(u?"voice.feedback.howWasAppearanceChat":"voice.feedback.howWasVoiceChat"),subtitleText:h("voice.feedback.giveFeedback"),positiveButtonText:h("voice.feedback.good"),negativeButtonText:h("voice.feedback.bad"),positiveButtonTitle:h("reviewPrompt.positive"),negativeButtonTitle:h("reviewPrompt.negative"),modalHeaderText:h(s==="feedback-options"?"voice.feedback.chooseWhatHappened":"voice.feedback.canMicrosoftReview"),onPositiveClick:f,onNegativeClick:p,isModalOpen:!!s,onModalClose:g,modalContent:b(),className:t,isDebugAudioRecorderEnabled:l})}const F_e=m.lazy(()=>H(()=>import("./index.es-B1Q_jbUA.js"),__vite__mapDeps([226,2,1]))),B_e=l9();function H_e({onAnimationClicked:t}){const e=m.useRef(null),{t:n}=xe(),[r,o]=m.useState(null);m.useEffect(()=>{B_e.load("../../assets/lottie/character-thinking-cloud-animation.json").then(o).catch(()=>o(null))},[]),m.useEffect(()=>{const a=e.current;return a&&r&&a.playSegments([0,67],!0),()=>{a&&r&&a.playSegments([350,370],!0)}},[r]);const i=()=>{var l,u;(l=e.current)==null||l.playSegments([320,345],!0),(u=e.current)==null||u.pause(),t();const a=document.getElementById(IA);a==null||a.focus()},s=a=>{a.key==="Enter"&&i()};return d.jsx("div",{children:d.jsx(m.Suspense,{fallback:d.jsx("div",{}),children:d.jsx(F_e,{lottieRef:e,role:"button",tabIndex:0,"aria-label":n("characterAnimation.characterThinkingCloudAriaLabelText"),title:n("characterAnimation.characterThinkingCloudAriaLabelText"),animationData:r,loop:!1,onMouseDown:i,onMouseEnter:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([275,295],!0)},onMouseLeave:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([296,315],!0)},onKeyDown:s,onComplete:()=>{var a;return(a=e.current)==null?void 0:a.playSegments([68,274],!0)}})})})}const bM=1,z_e=m.lazy(()=>H(()=>import("./character-EZQ4m8o-.js"),__vite__mapDeps([237,1,2,238])).then(t=>({default:t.Character})));function V_e({animatingMessageId:t,isStreamingMessage:e,displayedCharacterId:n,setCharacterComponentHeight:r}){const o=se("characterspeech"),[i,s]=m.useState(0),[a,l]=m.useState(!1),[u,h]=Ze(Ic),f=x(Zi),p=()=>{s(0),l(!1)};m.useEffect(()=>{let y;return o&&u==="idle"&&(y=setInterval(()=>{s(b=>b<bM?b+1:b),f.length>0&&i===bM&&!e&&(l(!0),U.trackEvent({name:"system",data:{eventName:"characterTalkToMeDisplayed",eventInfo_conversationId:Ue(it),eventInfo_characterId:n}}))},1e3)),()=>clearInterval(y)},[u,n,f.length,o,i,e]),m.useEffect(()=>{o&&u!=="idle"&&u!=="hovering"&&p()},[u,o]);const g=async()=>{p(),h("responding"),await gs.submitMessage({command:{type:"promptCharacterSpeech"},inputMethod:"promptCharacterSpeech"}),U.trackEvent({name:"interaction",data:{eventName:"characterTalkToMeClicked",eventInfo_conversationId:Ue(it),eventInfo_characterId:n}})};function v(){switch(n){case"aqua":return"translate-x-9";case"mica":return"translate-x-14";case"erin":return"translate-x-16";default:throw new Error("Invalid characterId provided to getTranslateXClass")}}return d.jsx(cO,{fallback:d.jsx(G_,{}),onError:jG(t,n),children:d.jsxs("div",{"data-testid":"character-div",className:Y("sticky top-0 h-2/5 min-h-[40vh] w-full bg-gradient-chat-light-character dark:bg-midnight-850 dark:bg-none",jt.babylonCharacter),style:{maskImage:"linear-gradient(to bottom, #000 95%, transparent 100%)"},children:[d.jsx(Mn,{children:a&&d.jsx(Ne.div,{className:Y("absolute start-1/2 top-12 size-36",v()),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},children:d.jsx(H_e,{onAnimationClicked:g})})}),d.jsx(m.Suspense,{fallback:d.jsx("div",{className:"flex h-full items-center justify-center",children:d.jsx(_t,{type:"spinnerThemed",className:"size-12"})}),children:d.jsx(z_e,{characterId:n,setCharacterComponentHeight:r})})]})})}function $_e({className:t}){const{t:e}=xe();return d.jsxs("div",{className:Be("flex items-center gap-2",t),children:[d.jsx(_t,{type:"reasoning",className:"size-11"}),d.jsxs("div",{className:"flex flex-col text-sm",children:[d.jsx("span",{children:e("chat.reasoningLoading.title")}),d.jsx("span",{className:"text-foreground-450 dark:text-foreground-600",children:e("chat.reasoningLoading.description")})]})]})}function z7(){const t=x(hn),e=x(aD);switch(t){case"chat":case"computerUse":case"study":case"research":return!e;case"reasoning":return!0;case"smart":return!1;default:return!1}}function G_e(t){const{isActive:e,animationDuration:n="5s",children:r,className:o,...i}=t;return d.jsx("div",{className:Be(e&&"bg-gradient-to-l from-foreground-800 via-foreground-300 to-foreground-800 bg-[size:200%_100%] bg-clip-text text-transparent",o),style:{...e&&{animation:`shimmer-reverse ${n} linear infinite 0.5s`}},...i,children:r})}const K_e="rounded-2xl border border-stroke-250 p-3";function q_e(t){const{title:e}=t,{t:n}=xe(),r=n("chat.reasoningLoading.title"),o=e&&e.trim()!==""?e:r;return d.jsx("div",{className:"text-base",children:d.jsx(G_e,{isActive:!0,children:o})})}function W_e(){return d.jsx(Ne.div,{initial:ot,animate:Lt,className:Y("w-max",K_e),children:d.jsx(q_e,{})})}function OA(){const t=x(hn),e=x(aD),n=se("think-deeper-cot");if(!z7())return null;switch(t){case"chat":case"computerUse":case"study":case"research":return e?null:d.jsx(_t,{type:"spinnerThemed",className:"absolute -ms-2.5 -mt-2 size-11"});case"reasoning":return n?d.jsx(W_e,{}):d.jsx($_e,{className:"absolute -ms-2.5 -mt-2 w-max"});case"smart":return null;default:return null}}const Y_e=m.lazy(()=>H(()=>import("./actions-chat-detail-BGR7xeS-.js"),__vite__mapDeps([337,1,2,338,339,340,341,342,328,288,305,306])).then(t=>({default:t.ActionsChatDetail}))),Q_e=m.lazy(()=>H(()=>import("./showroom-chat-detail-B07K2FRq.js"),__vite__mapDeps([343,1,2])).then(t=>({default:t.ShowroomChatDetail})));function J_e(){const t=x(fl);return d.jsx("div",{className:"flex size-full items-center justify-center",children:t?d.jsx(m.Suspense,{fallback:d.jsx(CM,{}),children:d.jsx(Q_e,{})}):d.jsx(m.Suspense,{fallback:d.jsx(CM,{}),children:d.jsx(Y_e,{})})})}function CM(){return d.jsx("div",{className:"flex size-full items-center justify-center",children:d.jsx(_t,{className:"size-12"})})}const V0=376,$0="0.5rem";function V7(t){const{children:e}=t,n=x(Lr),r=vi(),o=n==="side-by-side",i=Jb(),s=n==="side-by-side"&&!i,a=r?"bg-stone-150":"bg-gradient-chat-light",l=cp(h=>{const f=document.getElementById("app");f&&f.style.setProperty("--chat-details-container-height",i?`${h.height}px`:null)}),u=()=>n==="detail-only"?"0px":s?`max(${V0}px, 25%)`:"100%";return d.jsxs("div",{className:Y("flex size-full max-h-[100vh] min-h-0",i&&"flex-col",o&&"bg-sidebar-light dark:bg-sidebar-dark",r&&o&&"pb-2"),style:s?{gap:$0}:void 0,children:[n!=="chat-only"&&d.jsx(Ne.div,{ref:l,className:Y("rounded-lg",i&&"h-fit",o&&"shadow-lg","dark:bg-midnight-850 dark:bg-none",a),initial:{width:s?`calc(100% - ${$0} - max(${V0}px, 25%))`:"100%"},animate:{width:s?`calc(100% - ${$0} - max(${V0}px, 25%))`:"100%"},transition:Ho,children:d.jsx(J_e,{})}),d.jsx(Ne.div,{className:Y(n==="detail-only"&&"hidden",o&&a,i?"h-[calc(100vh-var(--chat-details-container-height))]":"h-full",o&&"rounded-lg pb-px shadow-lg dark:bg-midnight-850 dark:bg-none"),initial:{width:u()},animate:{width:u()},transition:Ho,children:e})]})}function SM(t){const e=rn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Eg(t,e){const n=ly(t),r=ly(e),o=+n-SM(n),i=+r-SM(r);return Math.round((o-i)/Hde)}function _f(t,e){const n=rn(t),r=rn(e),o=n.getTime()-r.getTime();return o<0?-1:o>0?1:o}function X_e(t,e){const n=rn(t),r=rn(e),o=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return o*12+i}function Z_e(t){const e=rn(t);return e.setHours(23,59,59,999),e}function eAe(t){const e=rn(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function tAe(t){const e=rn(t);return+Z_e(e)==+eAe(e)}function nAe(t,e){const n=rn(t),r=rn(e),o=_f(n,r),i=Math.abs(X_e(n,r));let s;if(i<1)s=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*i);let a=_f(n,r)===-o;tAe(rn(t))&&i===1&&_f(t,r)===1&&(a=!1),s=o*(i-Number(a))}return s===0?0:s}function rAe(t,e){const n=rn(t),r=rn(e);return n.getFullYear()-r.getFullYear()}function oAe(t,e){const n=rn(t),r=rn(e),o=_f(n,r),i=Math.abs(rAe(n,r));n.setFullYear(1584),r.setFullYear(1584);const s=_f(n,r)===-o,a=o*(i-+s);return a===0?0:a}function iAe(t,e){const n=rn(t),r=rn(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function sAe(t,e){const n=e==null?void 0:e.weekStartsOn,r=rn(t),o=r.getDay(),i=(o<n?7:0)+o-n;return r.setDate(r.getDate()-i),r.setHours(0,0,0,0),r}function aAe(t,e,n){const r=Eg(t,e),o=sAe(e,{weekStartsOn:1}),i=Eg(o,e),s=Eg(uy(o,7),e),a=Nc(t,"EEEE"),l=n(`dates.weekdays.${a.toLowerCase()}`),u=n(`dates.months.${Nc(t,"MMMM").toLowerCase()}Abbr`),h=Nc(t,"d"),f=n("dates.dayMonthDate",{day:l,month:u,date:h});return r>=1?f:r>=0?`${n("dates.today")}`:r>=-1?`${n("dates.yesterday")}`:r>=i?l:r>=s?n("dates.previousDay",{day:l}):f}function cAe(t,e,n){const r=Eg(e,t);if(r===0)return n("dates.today");if(r<=1)return n("dates.yesterday");if(r<7)return n("dates.weekThis");if(iAe(t,e))return n("dates.monthThis");if(nAe(e,t)<12){const s=Nc(t,"MMMM").toLowerCase();return n(`dates.months.${s}`)}const i=oAe(e,t);return i===1?n("dates.yearAgo"):n("dates.yearsAgoPlural",{count:i})}function lAe(t,e){return aAe(t,new Date,e)}function dOe(t,e){return cAe(t,new Date,e)}function hOe(t){const e=Math.max(0,t),n=Math.floor(e/60),r=e%60;return`${n}:${r<10?"0":""}${r}`}function uAe(t){const{date:e,className:n}=t,{t:r}=xe();return d.jsxs("div",{className:Y("flex items-center",n),children:[d.jsx("span",{className:"opacity-70 text-xs-strong","data-testid":"date-divider",children:lAe(e,r)}),d.jsx(dA,{verticalMargin:!1,color:"accent",className:"mt-px grow"})]})}function dAe(t){const{content:e}=t;return d.jsx("div",{className:"text-center text-foreground-450 text-xs dark:text-foreground-600",children:e})}const hAe="contrast-more:outline contrast-more:after:border-2 contrast-more:after:absolute contrast-more:after:pointer-events-none contrast-more:after:w-2/3 contrast-more:after:h-2/3",fAe="text-stone-550 active:text-stone-350 dark:text-slate-400 active:dark:text-slate-450",pAe="bg-white/3 safe-hover:bg-black/5 active:bg-black/3 dark:bg-black/3 dark:safe-hover:bg-white/5 dark:active:bg-white/3",mAe="border-[1px] border-black/8 dark:border-white/8",gAe=`${fAe} ${pAe} ${mAe}`;function vAe(t){const{children:e,isSelected:n,className:r,onClick:o,disabled:i,unselectedColorClass:s,variant:a="standard"}=t,{focusable:l}=kd({autoRestoreFocus:!0,forceFocus:!0});let u;return n?u=Pc.strong:a==="flat"?u=gAe:u=Pc[s??"overlay-dimmed-inverted"],d.jsx("button",{disabled:i,type:"button",ref:l.ref,className:Y("shadow-none dark:shadow-none",kf,VE["40-base"],$E["40-base"],e1["40-base"],by,u,r,n&&hAe),onClick:o,"aria-pressed":n,"data-spatial-focus-key":l.focusKey,children:e})}function yAe(t){const{query:e,messageId:n,index:r,onClick:o}=t,i=x(it),s=()=>{gn({source:"suggestionChip",conversationId:i,messageId:n}),U.trackEvent({name:"interaction",data:{eventName:"copilotSuggestionFollowupSelection",eventInfo_messageId:n,eventInfo_conversationId:i??"",eventInfo_suggestionIndex:r}}),o()};return d.jsx(vAe,{isSelected:!1,variant:"flat",className:"max-w-[80%] text-start sm:max-w-fit",onClick:s,children:d.jsx("span",{className:"p-1",children:e})})}function bAe(t){const{mostRecentMessageId:e,className:n}=t,r=x(sX),o=r&&e===r.messageId;return m.useEffect(()=>{o&&Ls({page:"chat",scenario:"suggestionReceived"})},[o]),d.jsx("div",{className:Y("mt-auto",n),children:o&&d.jsx(CAe,{suggestions:r.suggestions,messageId:r.messageId})})}function CAe({suggestions:t,messageId:e}){const n=m.useRef(null),r=vy(n,{amount:"all",once:!0});return m.useEffect(()=>{r&&Ls({page:"chat",scenario:"suggestionRender"})},[r]),d.jsx(wn,{ref:n,duration:jo.suggestions,className:"flex flex-col items-end gap-3 pb-8",children:t.map((o,i)=>d.jsx(yAe,{index:i,messageId:e,onClick:()=>gs.submitMessage({text:o,inputMethod:"suggestion"}),query:o},o))})}function IM(t){var e;return((e=me.instance().config().settingsOverrides)==null?void 0:e[t.key])??t.default}function SAe(){const t=Sr(),e=x(z5),n=x(FT),r=x(zy),o=x(hl),i=x(VX),s=!!x($X),a=!!x(GX),l=!!(IM({key:"shouldShowTextModelTrainingSettings",default:!0})&&s),u=!!(IM({key:"shouldShowVoiceModelTrainingSettings",default:!0})&&a),h=se("view-settings-disclaimer"),f=l||u,p=!f||e&&!n,g=N7(),[v,y]=Ze(q5),[b,C]=m.useState(!1);m.useEffect(()=>{if((f||i)&&t&&!o){if(v){C(!0),y(!1);return}if(g<X0){C(!0);return}let E;try{E=d_e()}catch{E=new Date}const T=gU(E,6),w=new Date;w>T&&(C(!0),cr(ad,w.toISOString()))}},[t,f,o,g,i,v,y]);const S=()=>p===void 0||r===void 0||i===void 0?null:o||!t?"chat.unauthenticatedDisclaimer":!i||!b?"chat.firstTurnDisclaimerBase":!p&&!r?h?"chat.firstTurnDisclaimerPersonalizationTrainingViewSettings":"chat.firstTurnDisclaimerPersonalizationTraining":p&&!r?h?"chat.firstTurnPersonalizationDisclaimerViewSettings":"chat.firstTurnPersonalizationDisclaimer":r&&!p?h?"chat.firstTurnTrainingDisclaimerViewSettings":"chat.firstTurnTrainingDisclaimer":"chat.firstTurnDisclaimerBase";return(()=>{var T,w,A;let E=S();return E?(T=me.instance().config().uiOverrides)!=null&&T.hideTrainingDisclaimer?"chat.firstTurnDisclaimerBase":(E=((A=(w=me.instance().config()).textOverrides)==null?void 0:A.call(w,E))??E,E):null})()}const LA="text-foreground-450 text-xs dark:text-foreground-600",IAe="underline",EM={settingsLink:d.jsx(Ub,{pages:["menu","account","privacy"],className:Y(LA,IAe),clickSource:"disclaimerSettingsLink"}),learnMoreLink:d.jsx(yE,{link:Xv})},TM={termsLink:d.jsx(yE,{link:rp}),privacyLink:d.jsx(yE,{link:Ed})},EAe={settingsLink:d.jsx(Ub,{pages:["menu","account","privacy"],className:Y(LA),disableLink:!0})};function vE(t){const{forceVisible:e,disableDisclaimerSettingsLink:n,className:r,testId:o,shouldUpdateNewConversationCount:i}=t,s=SAe(),a=x(eo),l=a==null?void 0:a.id,h=((a==null?void 0:a.isNew)??e)&&s;if(m.useEffect(()=>{!i||!h||!l||p_e(l)},[i,h,l]),!h)return null;const f=p=>{switch(p){case"chat.unauthenticatedDisclaimer":return d.jsxs(d.Fragment,{children:[d.jsx(co,{i18nKey:"chat.firstTurnDisclaimerBase"})," ",d.jsx(co,{i18nKey:p,components:{termsLink:TM.termsLink,privacyLink:TM.privacyLink}})]});case"chat.firstTurnTrainingDisclaimer":case"chat.firstTurnPersonalizationDisclaimer":case"chat.firstTurnDisclaimerPersonalizationTraining":case"chat.firstTurnTrainingDisclaimerViewSettings":case"chat.firstTurnPersonalizationDisclaimerViewSettings":case"chat.firstTurnDisclaimerPersonalizationTrainingViewSettings":return d.jsxs(d.Fragment,{children:[d.jsx(co,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBase"})," ",d.jsx(co,{i18nKey:p,components:{settingsLink:n?EAe.settingsLink:EM.settingsLink}})]});case"chat.edge.firstTurnPersonalizationDisclaimer":case"chat.edge.firstTurnPersonalizationSettingsDisclaimer":return d.jsxs(d.Fragment,{children:[d.jsx(co,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBase"})," ",d.jsx(co,{i18nKey:p,components:{learnMoreLink:EM.learnMoreLink,bold:d.jsx("strong",{})}})]});case"chat.firstTurnDisclaimerBase":case"chat.firstTurnPersonalizationDisclaimerBase":case"chat.tv.firstTurnDisclaimer":return d.jsx(co,{i18nKey:p});default:return null}};return d.jsx(wn,{id:s,mode:"wait",className:Y("space-y-8 pb-8",LA,r),"data-testid":o,children:f(s)})}function yE(t){const{children:e,link:n,className:r}=t;return d.jsx(ha,{className:Y("underline",r),href:n,title:"",children:e})}function $7(t){const{customBottomDisclaimer:e}=t,n=se("async-disclaimer-text"),r=TA(),[o,i]=m.useState(!n);return m.useEffect(()=>{r&&r.length>0&&i(!0)},[r]),e||(o?d.jsx(wn,{className:"absolute bottom-0 flex max-w-chat justify-center px-6 text-center","data-testid":"bottom-disclaimer",children:d.jsx(vE,{shouldUpdateNewConversationCount:!0})}):null)}function TAe(){return d.jsx("div",{"aria-hidden":!0,className:"flex size-full flex-col items-center justify-center"})}const iu="absolute animate-dot-ellipsis size-2 rounded-full bg-background-450";function wAe(t){const{className:e}=t;return d.jsxs("div",{className:Be("flex items-center justify-center gap-3",e),children:[d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:iu,style:{animationDelay:"0ms"}}),d.jsx("div",{className:iu,style:{animationDelay:"30ms"}})]}),d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:iu,style:{animationDelay:"100ms"}}),d.jsx("div",{className:iu,style:{animationDelay:"130ms"}})]}),d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:iu,style:{animationDelay:"200ms"}}),d.jsx("div",{className:iu,style:{animationDelay:"230ms"}})]})]})}function _Ae(t){const{text:e,staggerChildren:n=.018,delayChildren:r=0,initialOpacity:o=0}=t;return d.jsx(Ne.div,{variants:{show:{transition:{staggerChildren:n,delayChildren:r}}},initial:"hidden",animate:"show",children:aA(e).map((i,s)=>d.jsx(Ne.span,{variants:{hidden:{opacity:o},show:{opacity:1,transition:{duration:b9}}},children:i},s))})}const AAe={sm:"text-md",md:"text-xl",lg:"text-3xl"},wM=25;function kAe(t){const{subheading:e}=t;return d.jsx("h2",{className:"mt-4 text-foreground-800 text-base",children:e})}function xAe(t){const{className:e,fontSize:n="lg"}=t,r=x(Ky),o=x(U5),{t:i}=xe(),{greetingKey:s,widgetGreeting:a,widgetSubheading:l}=tD(),{isCentralComposerEnabled:u,isGreetingCentered:h}=th(),f=NA(),p=nTe(),g=o&&o.length>wM?`${o.slice(0,wM)}…`:o,v=s?i(s,{name:g}):"";return f?d.jsx("div",{className:Be(e,"flex w-full flex-col items-start justify-start gap-2 sm:mb-6 sm:h-[100px] sm:justify-end"),children:d.jsx("div",{className:"flex justify-start sm:min-h-8",children:!p||r?d.jsx("div",{className:"ms-2 mt-6 flex size-full sm:mt-0",children:d.jsx(wAe,{className:"flex-1"})}):d.jsxs("div",{className:"flex flex-col items-start gap-2",children:[d.jsxs(wn,{className:"flex items-center gap-2 text-foreground-550 dark:text-foreground-750",id:a??v,children:[d.jsx("p",{className:"text-xs-strong",children:i("common.copilotText")}),d.jsx("p",{className:"text-xs",children:Nc(new Date,"h:mm aa")})]}),d.jsx("h1",{className:"text-lg",children:d.jsx(G7,{text:a??v},a)})]})})}):d.jsxs("div",{className:Be("flex w-full flex-col items-start justify-start sm:mb-8 sm:h-[100px] sm:justify-end",h&&"sm:items-center",!u&&"sm:justify-start",AAe[n],l&&"sm:mb-4",e),"data-testid":"launch-greeting",children:[d.jsx("h1",{children:v}),l&&d.jsx(kAe,{subheading:l})]})}const G7=m.memo(t=>{const{text:e}=t;return d.jsx(_Ae,{text:e,staggerChildren:.02,delayChildren:.1},e)});G7.displayName="AnimatedTextMemo";function RAe(t){const{customLaunchGreeting:e,className:n}=t;return e||d.jsx(xAe,{className:n,fontSize:"md"})}function NAe(t){const{className:e}=t,n=x(hl),r="top-disclaimer";return n?d.jsx(vE,{forceVisible:!0,className:e,testId:r,shouldUpdateNewConversationCount:!0}):d.jsx(vE,{className:e,testId:r,shouldUpdateNewConversationCount:!0})}function PAe({characterId:t,className:e}){const n=x(eo),[r,o]=Ze(b5),{t:i}=xe();return m.useEffect(()=>{(n==null?void 0:n.isNew)===!1&&o(!1)},[o,n==null?void 0:n.isNew]),n!=null&&n.isNew?d.jsxs(wn,{id:"character-disclaimer",mode:"wait",className:Y("pb-2 text-stone-550/90 text-xs dark:text-slate-250/60",e),children:[i("characterAnimation.characterDisclaimerTextV2",{characterName:DG(t,i)})," ",r&&d.jsx(co,{i18nKey:"characterAnimation.characterSettingDisclaimerText",components:{settingsLink:d.jsx(Ub,{pages:["menu","character-options"],className:"text-stone-550/90 underline text-xs dark:text-slate-250/60"})}})]}):null}function MAe(){return d.jsx(_A,{size:"sm",stroke:!0,className:"flex h-[172px] w-[324px] cursor-pointer flex-col p-4",children:d.jsx("div",{className:"flex flex-1",children:d.jsx(eC,{className:"size-full",style:{clipPath:"var(--clip-path-squircle-36)"}})})})}const OAe=m.lazy(()=>H(()=>import("./contextual-shopping-card-C4v24Z9M.js"),__vite__mapDeps([344,1,2,345,257,252,346,301,347,253,254,255,241,348,305,306,349,350,351,352,353,354,333,248,232])).then(t=>({default:t.AnimatedContextualShoppingCard})));function K7(t){const{customLaunchGreeting:e,chatItemClasses:n}=t,{isCentralComposerEnabled:r,isWidgetSectionEnabled:o,isAppearanceOnHomeEnabled:i,isGreetingCentered:s}=th(),a=ar({breakpoint:"sm"}),l=cy({breakpoint:"h760"}),u=cy({breakpoint:"h600"}),h=se("appr-home-toggle"),f=x(jX),p=i&&(!h||!f)&&!u,g=Hp(),v=Ep(),y=x(NT),b=x(tZ),C=!j_(),S=g&&y!==null,I=c9(),{launchGreetingShown:E,widgetSubheading:T}=tD(),w=x(x5),{showShoppingCardInNewChat:A,shoppingProductMetadata:_,isCopilotOpenedViaEdgeCTAs:L}=$T(),N=!L&&!b&&!S&&!E&&v&&!I,q=me.instance().config().smallScreenShowTopDisclaimerAfterSendingMessage??!1?!v:!N,ae=S||a&&q,W=x(hn)==="computerUse",te=o&&!W&&!a&&!l,D=N&&"pb-2",G=m.lazy(()=>i?H(()=>import("./appearance-chat-BQNyN1Vt.js"),__vite__mapDeps([355,1,2])).then(J=>({default:J.AppearanceChat})):Promise.resolve({default:()=>null})),re=d.jsxs(wn,{delay:.2,initial:C?"initial":!1,className:Be(r?"mt-2 flex flex-col items-start text-pretty pe-0 sm:absolute sm:inset-x-0 sm:inset-y-0 sm:mx-auto sm:mt-0 sm:max-w-chat sm:px-4 sm:pb-[calc(var(--composer-container-height))]":D,A&&"mx-auto mt-2 max-w-sm sm:relative sm:mt-6 sm:max-w-md sm:px-4",p&&a&&"grow",te&&!T&&"sm:pb-[calc(var(--composer-container-height)-64px)]",te&&T&&"sm:pb-[calc(var(--composer-container-height)-32px)]"),children:[p&&r&&d.jsx("div",{className:Be("order-2 flex w-full flex-col items-center justify-center sm:absolute sm:h-[calc(50%-60px-var(--composer-container-height)/2)]",a&&"grow"),children:d.jsx(m.Suspense,{fallback:d.jsx(TAe,{}),children:d.jsx(G,{voiceAppearanceId:UT})})}),d.jsxs("div",{className:"order-1 flex w-full flex-col gap-2 sm:top-0 sm:h-full sm:justify-center",children:[N&&d.jsx(RAe,{customLaunchGreeting:e,className:Be(s?"sm:text-center":"sm:ps-2")}),S&&d.jsx(PAe,{characterId:y}),A&&_&&!w&&d.jsx(m.Suspense,{fallback:d.jsx(MAe,{}),children:d.jsx(OAe,{content:_})}),ae&&d.jsx(NAe,{})]})]},"chat-welcome");return n?d.jsx("div",{className:n,children:re}):re}const _M=10,LAe=0,DAe=.2;function jAe({onClick:t,shouldShowScrollToBottomButton:e,bottomButtonClass:n=""}){const{t:r}=xe(),o=x(Lr),i=Jb(),s=o==="side-by-side"&&!i;return d.jsx(Mn,{children:e&&d.jsx(Ne.div,{className:Be("pointer-events-none absolute flex justify-center",jt.chatScrollToBottomButton,s?"end-0 w-1/4 min-w-chat-side-by-side justify-end":"inset-x-0",n),initial:{...ot,y:_M},animate:{...Lt,y:LAe},exit:{...ot,y:_M},transition:{duration:DAe},children:d.jsx(Te,{color:"acrylic",variant:"circle",size:"36-sm",title:r("chat.scrollToBottom"),onClick:t,className:"pointer-events-auto border-none shadow-xl",children:d.jsx("span",{className:Be("relative rounded-full bg-white/40 p-2 shadow-xl hover:bg-white hover:p-[9px] dark:bg-background-350/60","after:absolute after:inset-0 after:rounded-full after:shadow-xl","before:absolute before:-inset-px before:rounded-full before:border before:border-black/8"),children:d.jsx(jp,{className:"size-5 rotate-180 fill-foreground-900 dark:fill-white"})})})})})}function q7(t){const{delay:e,className:n}=t,{t:r}=xe(),o=se("announce-loading"),i=m.useId(),s=x(hn);return z7()?d.jsxs(Ne.div,{"aria-hidden":!0,className:Be("relative size-7",n),initial:"start",animate:"end",variants:{start:{...ot},end:{...Lt,transition:{delay:e}}},children:[o&&d.jsx(Td,{id:i,timeout:3e3,msg:r(s==="reasoning"?"chat.reasoning":"chat.loading"),type:"polite"}),d.jsx(OA,{})]}):null}const AM=m.lazy(()=>H(()=>import("./ai-message-C8ikz2Ct.js").then(t=>t.j),__vite__mapDeps([356,1,2,301,315,228,320,357,358,223,325,359,349])));function UAe(t){const{message:e,animatingMessageIds:n,conversationId:r,sideBySideComparisonId:o,isStreamingComplete:i,shouldAnimate:s,reactionsToDisable:a,isLastMessage:l}=t,{t:u}=xe(),h=ve(js);if(!r)return null;if(!sD(e))return d.jsx(Ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.25},children:d.jsx(m.Suspense,{fallback:d.jsx(OA,{}),children:d.jsx(AM,{message:e,isStreamingComplete:i,shouldAnimate:!1,reactionsToDisable:a,isLastMessage:l})})});if(!o)return null;const{left:f,right:p}=e,g=b=>!(n!=null&&n.has(b.id))&&!b.sideBySideConfig.isStreamingComplete,v=(b,C)=>{Wpe({sideBySideComparisonId:o,sideBySideConfig:C}),gs.selectSideBySideMessage({selectedMessageId:b,sideBySideComparisonId:o}),vZ(r,b),h({title:u("chat.sideBySide.selectedResponseToastTitle"),subtitle:u("chat.sideBySide.selectedResponseToastSubtitle"),dismissAfter:2e3})},y=d.jsx(q7,{delay:.5,className:"mt-2"});return d.jsxs("div",{className:"flex w-full flex-col items-center gap-6 pb-4",children:[d.jsx("p",{children:u("chat.sideBySide.preambleMessage")}),d.jsx("div",{className:"flex flex-col justify-center gap-6 @5xl/chat:w-[100cqw] @5xl/chat:flex-row @5xl/chat:items-stretch @5xl/chat:px-6",children:[f,p].map(b=>d.jsxs("div",{className:"flex min-h-24 flex-col rounded-2xl border-[0.5px] border-black/12 bg-white/45 p-6 @5xl/chat:min-w-[480px] @5xl/chat:max-w-[600px] @5xl/chat:flex-[1_1_600px] dark:bg-midnight-350/10",children:[d.jsx("div",{className:"flex-1",children:g(b)?y:d.jsx(m.Suspense,{fallback:y,children:d.jsx(AM,{message:b,isStreamingComplete:i,shouldAnimate:s,reactionsToDisable:"all",isLastMessage:!0,groupHasTopMargin:!1,isInSideBySide:!0})})}),i&&d.jsx(Ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:d.jsx(Te,{size:"36-sm",className:"mx-auto mt-6",title:u("chat.actions.selectResponse"),color:"strong",onClick:()=>v(b.id,b.sideBySideConfig),children:u("chat.actions.selectResponse")})})]},b.id))})]})}const W7=t=>m.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("mask",{id:"mask0_12117_44960",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20},m.createElement("path",{d:"M7.19253 7.24894C7.46962 6.94112 7.94384 6.91617 8.25172 7.1932L10.7517 9.44267C10.9098 9.58487 11 9.78745 11 10C11 10.2126 10.9098 10.4152 10.7517 10.5574L8.25172 12.8068C7.94384 13.0839 7.46962 13.0589 7.19253 12.7511C6.91543 12.4433 6.94039 11.9692 7.24827 11.6922L8.29553 10.7499H4.75C4.33579 10.7499 4 10.4141 4 10C4 9.58591 4.33579 9.2502 4.75 9.2502H8.29553L7.24828 8.30789C6.94039 8.03086 6.91543 7.55675 7.19253 7.24894ZM20 15.2506C20 16.7691 18.7688 18 17.25 18L2.75 18C1.23122 18 0 16.7691 0 15.2506V4.74937C0 3.23093 1.23122 2 2.75 2H17.25C18.7688 2 20 3.23094 20 4.74937L20 15.2506ZM17.25 16.5003C17.9404 16.5003 18.5 15.9408 18.5 15.2506L18.5 4.74937C18.5 4.05917 17.9404 3.49966 17.25 3.49966L13.9958 3.49966L13.9958 16.5003H17.25ZM12.4958 16.5003L12.4958 3.49966L2.75 3.49965C2.05965 3.49965 1.5 4.05917 1.5 4.74937L1.5 15.2506C1.5 15.9408 2.05964 16.5003 2.75 16.5003L12.4958 16.5003Z",fill:"currentColor"})),m.createElement("g",{mask:"url(#mask0_12117_44960)"},m.createElement("rect",{width:24,height:24,transform:"translate(-2 -2)",fill:"currentColor"}))),fOe=Object.freeze(Object.defineProperty({__proto__:null,default:W7},Symbol.toStringTag,{value:"Module"}));function FAe(){const t=!bo("kill-share-c2"),e=$t(),n=x(eo),r=x(hl),o=Sl();return!!(!r&&t&&e.startsWith("/chats")&&!e.endsWith("/talk")&&(n!=null&&n.history.length)&&!o)}function Y7(){const{t}=xe(),e=ar({breakpoint:"md"}),n=ar({breakpoint:"sm"}),r=ar({breakpoint:"xl"}),o=x(Lr)==="side-by-side",i=x(Fa),s=x(Up),a=$t(),l=ve(Lr),u=Jb(),h=o&&!n&&a.startsWith("/chats"),f=FAe()&&r,p=(e||!i||h||f)&&!u&&!s,g=m.useCallback(()=>{l("detail-only")},[l]);return d.jsx("div",{className:Y("sticky top-0 z-20 w-full"),children:d.jsx(Mn,{children:p&&d.jsx(Ne.div,{className:"absolute h-16 w-full rounded-lg bg-stone-150/90 backdrop-blur-md dark:bg-midnight-850/80",initial:"initial",animate:"animate",exit:"exit",variants:{initial:ot,animate:Lt,exit:ot},transition:Ho,"data-testid":"sticky-header",children:h&&d.jsx(Ne.div,{initial:ot,animate:Lt,exit:{transition:{duration:0},...ot},transition:Ho,children:d.jsx(Te,{title:t("actions.hideDetails"),color:"subtle-dimmed",variant:"square",size:"36-sm",className:"ms-3.5 mt-1.5",onClick:g,children:d.jsx(W7,{className:"size-5"})})})})})})}const BAe="answerCards.ariaLabel.numberOfLocalResultsSingle",HAe="answerCards.ariaLabel.numberOfLocalResultsPlural";function zAe(t){let e="";for(const r of t.entities){if(e+=r.name,r.category&&(e+=`, ${r.category}`),r.price&&(e+=`, ${VAe(r.price)}`),r.reviews[0]){const o=r.reviews[0];e+=", ",e+=ee("answerCards.ariaLabel.ratedByReviewer",{rating:o.rating,reviewCount:o.count,reviewProvider:o.providerName})}r.phoneNumber&&(e+=", ",e+=ee("answerCards.ariaLabel.phoneNumber",{phoneNumber:r.phoneNumber})),r.location.address&&(e+=", ",e+=ee("answerCards.ariaLabel.address",{address:r.location.address})),e+=". "}const n=t.entities.length===1?BAe:HAe;return ee(n,{count:t.entities.length,resultSummary:e})}function VAe(t){switch(t.length){case 1:return ee("answerCards.ariaLabel.inexpensivePrices");case 2:return ee("answerCards.ariaLabel.averagePrices");default:return ee("answerCards.ariaLabel.expensivePrices")}}function $Ae(t){const{content:e,announce:n}=t;let r;for(const o of e){switch(o.type){case"text":r=o.text;break;case"image":o.url?r=ee("chat.imageGenerated",{prompt:o.prompt??""}):r=ee("chat.imageGenerating");break;case"page":break;case"citation":break;case"card":r=GAe(o.card);break;case"error":r=o.text;break;case"task":break;case"deleted":break;case"chainOfThought":break;case"chainOfThoughtGroup":break;case"document":break;case"activity":break;case"memorySignal":r=o.text;break}r&&n({msg:r})}}function GAe(t){switch(t.type){case"localEntity":return zAe(t);case"ads":case"weather":case"weatherTemperatureHourly":case"weatherTemperatureDaily":case"weatherPrecipitationHourly":case"weatherPrecipitationDaily":case"image":case"person":case"phoneImages":case"phoneLinking":case"phoneAlarm":case"phoneTimer":case"phoneSendMessage":case"video":case"sportsSchedule":case"sportsGame":case"safetyHelpline":case"shopping":case"shoppingProducts":case"shoppingCurated":case"job":case"inlineVideo":case"quiz":case"financeChart":case"generativeUI":case"recipe":case"mediaSpotlight":case"inlineImage":case"m365":case"file":case"computerUseFeedback":case"document":return"";default:return""}}function KAe(t,e){const n=m.useRef();m.useEffect(()=>{var o;if(e==="streaming")return;const r=t.at(-1);r&&r.author==="ai"&&r.id!==((o=n.current)==null?void 0:o.id)&&($Ae({content:r.content,announce:xl}),n.current=r)},[t,e])}function qAe(t){m.useEffect(()=>{if(t.current){const e=r=>{var i,s,a,l,u;if(r.target&&r.target instanceof Element&&r.target.closest('[data-formatless-copy="false"]'))return;const o=window.getSelection();if(o!=null&&o.rangeCount){let h=document.createElement("div");const f=o.getRangeAt(0),{startContainer:p,endContainer:g}=f;h.appendChild(f.cloneContents());const v=(i=p.parentElement)==null?void 0:i.closest("pre"),y=(s=g.parentElement)==null?void 0:s.closest("pre"),b=!!v&&!!y&&v===y,C=!!((a=p.parentElement)!=null&&a.closest("table"))&&!WAe(f),S=h.getElementsByTagName("*");for(const w of S)w.getAttribute("data-copy")==="false"?w.remove():(w.removeAttribute("style"),w.removeAttribute("class"),w.removeAttribute("initial"),w.removeAttribute("animate"),w.removeAttribute("variants"),w.removeAttribute("custom"));if(b){const w=document.createElement("pre");w.appendChild(h),h=w}if(C){const w=document.createElement("table"),A=Array.from(h.children);for(const _ of A)w.appendChild(_);h=w}h.style.position="absolute",h.style.left="-9999px",document.body.appendChild(h);const I=window.getSelection(),E=document.createRange();E.selectNodeContents(h),I==null||I.removeAllRanges(),I==null||I.addRange(E);const T=(I==null?void 0:I.toString())??"";I==null||I.removeAllRanges(),I==null||I.addRange(f),document.body.removeChild(h),h.removeAttribute("style"),(l=r.clipboardData)==null||l.setData("text/plain",T),(u=r.clipboardData)==null||u.setData("text/html",b||C?h.outerHTML:h.innerHTML)}r.preventDefault()},n=t.current;return n.addEventListener("copy",e),()=>{n.removeEventListener("copy",e)}}return()=>{}},[t])}function WAe(t){var i,s,a,l;const{startContainer:e,endContainer:n}=t,r=((i=e.parentElement)==null?void 0:i.closest("td"))??((s=e.parentElement)==null?void 0:s.closest("th")),o=((a=n.parentElement)==null?void 0:a.closest("td"))??((l=n.parentElement)==null?void 0:l.closest("th"));return!!(r&&o&&r===o)}const YAe=typeof document<"u"?m.useLayoutEffect:m.useEffect;function QAe(t,e){const n=m.useRef(0),r=m.useRef(0);m.useEffect(()=>{const{current:o}=e,i=()=>{if(o){const s=o.scrollHeight-o.scrollTop;r.current=s}};return o==null||o.addEventListener("scroll",i,{passive:!0}),i(),()=>{o==null||o.removeEventListener("scroll",i)}},[e]),YAe(()=>{const{current:o}=e;o&&o.scrollTop+r.current!==o.scrollHeight&&(n.current===0?setTimeout(()=>{o.scrollTop=o.scrollHeight},100):o.scrollTop=o.scrollHeight-r.current,n.current=t)},[t,e])}function JAe(t,e){const n=bo("kill-review-prompt"),o=!!me.instance().config().promptForReviews&&!n,i=ve(Zr),s=m.useCallback(async l=>{if(!o)return;const{shown:u}=await Pue.run({});if(u)return;const f=WIe()>=zIe,p=l>BIe;(f||p)&&!YIe()&&(i("prompt-review"),U.trackEvent({name:"system",data:{eventName:"inAppSurveyPopUp",eventInfo_triggerType:p?"longChat":"activeDays"}}))},[o,i]),a=m.useRef(!1);m.useEffect(()=>{e&&(a.current=!0)},[e]),m.useEffect(()=>{e||!a.current||s(t)},[t,e,s])}function XAe(t){return m.useCallback(({behavior:n="smooth",delay:r=0})=>{setTimeout(()=>{t.current&&t.current.scrollTo({top:t.current.scrollHeight,behavior:n})},r)},[t])}const ZAe=.1;function eke(t){const{chatRef:e,hasMessages:n=!0}=t,r=m.useRef(null),[o,i]=m.useState(!1),s=m.useCallback(a=>{const l=a[0];l&&i(!l.isIntersecting&&n)},[n]);return m.useEffect(()=>{if(!e.current||!r.current)return()=>{};const a=new IntersectionObserver(s,{root:e.current,threshold:ZAe});return a.observe(r.current),()=>{a.disconnect()}},[e,s]),m.useEffect(()=>{n||i(!1)},[n]),{bottomRef:r,shouldShowScrollToBottomButton:o}}function tke(){const t=x(Ip),e=gp(bn),n=x(xT);m.useEffect(()=>{e(r=>{if(n){const o=r.get(n);o&&(o.characterId=t)}})},[n,t,e])}async function nke(t,e){const n=qT(e);if(n){const{message:r,part:o}=n;if(!o.task)return;const i=await ts();i.setConversationIdByMessageId({messageId:r.id,conversationId:t}),i.setMessageIdByTaskId({taskId:o.task.id,messageId:r.id})}}const rke=window.requestIdleCallback||function(e){const n=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-n))}})},1)},Q7=t=>m.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M2 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7a2 2 0 0 1-1.164 1.818 1.497 1.497 0 0 0-.275-.379l-.446-.446A1 1 0 0 0 17 13V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5v1H4a2 2 0 0 1-2-2V6Zm8.854 4.146A.5.5 0 0 0 10 10.5v7a.5.5 0 0 0 .91.287l1.571-2.245 2.943.452a.5.5 0 0 0 .43-.848l-5-5ZM11 15.915v-4.207l3.066 3.067-1.74-.268a.5.5 0 0 0-.486.207l-.84 1.2Z"})),pOe=Object.freeze(Object.defineProperty({__proto__:null,default:Q7},Symbol.toStringTag,{value:"Module"})),J7=t=>m.createElement("svg",{viewBox:"0 0 64 64",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M32.0007 5.33301C46.7282 5.33301 58.6673 17.2721 58.6673 31.9997C58.6673 46.7273 46.7282 58.6663 32.0007 58.6663C17.2731 58.6663 5.33398 46.7273 5.33398 31.9997C5.33398 17.2721 17.2731 5.33301 32.0007 5.33301ZM32.0007 8.66634C19.114 8.66634 8.66732 19.113 8.66732 31.9997C8.66732 44.8863 19.114 55.333 32.0007 55.333C44.8873 55.333 55.334 44.8863 55.334 31.9997C55.334 19.113 44.8873 8.66634 32.0007 8.66634ZM23.7105 21.3663L23.8458 21.4878L32.0007 29.6437L40.1555 21.4878C40.763 20.8803 41.7227 20.8398 42.3772 21.3663L42.5125 21.4878C43.12 22.0953 43.1605 23.0551 42.634 23.7095L42.5125 23.8449L34.3567 31.9997L42.5125 40.1545C43.12 40.762 43.1605 41.7217 42.634 42.3762L42.5125 42.5115C41.905 43.119 40.9453 43.1595 40.2908 42.633L40.1555 42.5115L32.0007 34.3557L23.8458 42.5115C23.2383 43.119 22.2786 43.1595 21.6241 42.633L21.4888 42.5115C20.8813 41.904 20.8408 40.9443 21.3673 40.2898L21.4888 40.1545L29.6447 31.9997L21.4888 23.8449C20.8813 23.2374 20.8408 22.2776 21.3673 21.6232L21.4888 21.4878C22.0963 20.8803 23.0561 20.8398 23.7105 21.3663Z"})),mOe=Object.freeze(Object.defineProperty({__proto__:null,default:J7},Symbol.toStringTag,{value:"Module"})),kM="size-5",xM="flex w-full items-center justify-end gap-1.5 text-foreground-450 dark:text-slate-400";function oke({type:t}){const{t:e}=xe();switch(t){case"takeTaskControl":return d.jsxs("div",{className:xM,children:[d.jsx(Q7,{className:kM}),e("actions.tookControl")]});case"cancelTask":return d.jsxs("div",{className:xM,children:[d.jsx(J7,{className:kM}),e("actions.cancelledTask")]});case"createPage":case"appendToPage":case"promptCharacterSpeech":default:return null}}function ike(t){const{text:e}=t;return d.jsx("div",{className:"flex w-full flex-col items-end","data-content":"user-message",children:d.jsx("div",{className:Y("font-ligatures-none h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-accent-250/60 px-5 py-3 dark:bg-accent-200",Xi("userMessage")??"text-base"),children:e})})}const ske="edge://discover-chat-v2",ake="edge://discover-chat-v2.top-chrome",gOe="Edge.Context.Pref",vOe="Edge.Context.OnPref",yOe="browser.underside_chat_consent",bOe="browser.underside_video_transcript_consent",cke="Edge.IsFeatureEnabled",lke="Edge.OnIsFeatureEnabled",COe="isShowCopilotButtonSupported";class hy{constructor(){j(this,"resolve",null);j(this,"isCancelled");j(this,"token");this.token=new Promise(e=>{this.resolve=e}),this.isCancelled=!1}static cancelled(){const e=new hy;return e.cancel(),e}static create(e){const n=new hy;return e&&e.then(()=>n.cancel()),n}static delay(e){return this.create(new Promise(n=>{setTimeout(()=>n(null),e)}))}cancelled(){return this.isCancelled}cancel(){return!this.isCancelled&&this.resolve&&this.resolve(this),this.isCancelled=!0,this.isCancelled}dispose(){this.cancel()}}function uke(t){window.parent.postMessage(t,ske),window.parent.postMessage(t,ake)}class DA{constructor(e,n="",r,o){j(this,"listenerKey",DA.name);j(this,"result",null);j(this,"priority","Normal");j(this,"createdDate",new Date);j(this,"id");j(this,"resolveListener");j(this,"eventName");j(this,"canResolve");this.eventName=e,this.id=n,r==null||r.then(()=>this.cancel()),this.canResolve=o}init(e){e!==void 0?this.resolveListener=e:this.result=new Promise(n=>{this.resolveListener=n})}maybeHandleEvent(e){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");const{eventName:n,requestId:r}=e;return r!==this.id?!1:n===this.eventName?this.canResolve&&!this.canResolve(e)?!1:(this.resolveListener(e),!0):!1}cancel(){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");return this.result&&this.resolveListener(null),!0}}const fc=class fc{constructor(){j(this,"activeListeners",[])}static instance(){return fc.singleton||(fc.singleton=new fc),fc.singleton}push(e,n,r){return e.init(r),this.activeListeners.push(e),n&&n(),e.result===null?Promise.resolve(null):e.result.then(o=>(this.pop(e),o)).catch(()=>(this.pop(e),null))}pop(e){const n=this.activeListeners.indexOf(e);n>-1&&this.activeListeners.splice(n,1)}findAndHandleListener(e){for(const n of[...this.activeListeners].sort((r,o)=>r.createdDate<o.createdDate?-1:1))if(n.maybeHandleEvent(e))break}};j(fc,"singleton",null);let bE=fc;class dke{constructor(){j(this,"isFeatureAvailableApiSupported");j(this,"enabledFeatures",new Map);this.isFeatureAvailableApiSupported=this.getFeatureAvailableApiSupported()}async isFeatureEnabled(e){return this.enabledFeatures.has(e)||await this.retrieveEnabledFeatures([e]),this.enabledFeatures.get(e)??!1}updateFeatureEnabledForTest(e,n){this.enabledFeatures.set(e,n)}async retrieveEnabledFeatures(e){if(!this.isFeatureAvailableApiSupported)return;await this.waitForNativeBridgeConnected();const n=1e3,r={eventName:cke,requestId:crypto.randomUUID(),isOutgoing:!0,args:{featureNames:e}},o=await bE.instance().push(new DA(lke,r.requestId,hy.delay(n).token),()=>{uke(r)});if(o){const i=o.args;for(const s of e){const a=i.featureNames.includes(s);this.enabledFeatures.set(s,a)}}}getFeatureAvailableApiSupported(){for(const n of navigator.userAgent.split(" "))if(n.startsWith("Edg/")){const r=n.split("/")[1];if(r!==void 0){const o=r.split(".")[0];if(o!==void 0)return parseInt(o,10)>=132}}return!1}waitForNativeBridgeConnected(){const e=at();return e.get(eg)?Promise.resolve():new Promise(n=>{const r=e.sub(eg,()=>{e.get(eg)&&(r(),n())})})}}const SOe=new dke;function hke(t){return t!=null&&typeof t=="object"&&"id"in t&&typeof t.id=="number"&&"windowId"in t&&typeof t.windowId=="number"&&"url"in t&&typeof t.url=="string"}function fke(t){return Array.isArray(t)&&t.every(e=>hke(e))}const X7=m.forwardRef((t,e)=>{const{children:n,tabBehavior:r="limited-trap-focus",ignoreDefaultKeydown:o,...i}=t,s=sO({tabBehavior:r,ignoreDefaultKeydown:o});return se("a11y-keyboard-navigation")?d.jsx(Ne.div,{ref:e,...s,...i,tabIndex:0,children:n}):d.jsx(Ne.div,{...i,ref:e,children:n})});X7.displayName="FocusableGroupMotion";function pke(t){const{children:e,tabBehavior:n="limited-trap-focus",ignoreDefaultKeydown:r,...o}=t,i=sO({tabBehavior:n,ignoreDefaultKeydown:r});return se("a11y-keyboard-navigation")?d.jsx("div",{...i,...o,tabIndex:0,role:"article",children:e}):d.jsx("div",{...o,children:e})}const Z7=t=>d.jsx(pke,{...t});Z7.Motion=X7;function mke({tabs:t=[]}){return t.length===0?null:d.jsx(Ll,{className:"flex min-h-[60px] flex-col gap-2",tabbable:!0,tabIndex:0,children:d.jsx(r7,{showRemoveIcon:!1,tabs:t})})}function gke(t){var b;const{message:e,className:n,isForSharing:r}=t,{t:o}=xe(),s=!!x(fl),a=bA(),l=se("a11y-keyboard-navigation"),u=o(l?"chat.userSaid":"chat.user"),h=e.content.filter(C=>C.type==="document"||C.type==="image"),[f,p]=m.useState(!1),g=h.slice(0,Mg),v=m.useCallback(()=>{xl({msg:o("userInput.seeAll"),type:"polite"}),p(!0)},[o,p]),y=h.length>Mg;return d.jsxs(Z7,{className:Y("space-y-1",n),id:`${e.id}-user-message`,"aria-labelledby":`${e.id}-user-message`,children:[d.jsxs("div",{className:"relative space-y-3",children:[d.jsx("h2",{className:"sr-only","aria-label":u,"data-copy":"false",children:u}),h.length>0&&d.jsxs("div",{className:"flex h-32 w-full flex-row justify-end gap-2 overflow-hidden",children:[g.map((C,S)=>d.jsx(t7,{messageItem:C,isForSharing:r},`file-${S}`)),y&&d.jsx(Te,{"aria-label":o("userInput.seeAll"),title:o("userInput.seeAll"),color:"overlay-dimmed-inverted",onClick:v,children:o("userInput.seeAll")}),f&&d.jsx(n7,{onClose:()=>p(!1),messages:h,isForSharing:r})]}),e.content.map((C,S)=>C.type==="browserTabs"?a&&fke(C.tabs)?d.jsx(mke,{tabs:C.tabs},S):null:C.type==="text"?d.jsx(ike,{text:C.text},S):C.type==="command"?d.jsx(oke,{type:C.command.type},S):(C.type==="document",null)),e.emojiReaction&&d.jsx("div",{className:"absolute -bottom-3 end-3",children:e.emojiReaction})]}),!s&&((b=e.brand)==null?void 0:b.brandLogo)&&d.jsx("div",{className:"w-full px-3 text-right text-foreground-600 text-xs",children:o("ads.aboutBrand",{brand:e.brand.brandLogo.businessName})})]},e.id)}const vke=m.lazy(()=>H(()=>import("./ai-message-C8ikz2Ct.js").then(t=>t.j),__vite__mapDeps([356,1,2,301,315,228,320,357,358,223,325,359,349]))),yke=1.5,RM="inline-block w-full space-y-8",jA="max-w-chat w-full";function CE(t){var We,ut,He;const{className:e,conversationContainerClassName:n="mb-[var(--composer-container-height)]",bottomButtonClassName:r="bottom-[calc(var(--composer-container-height)+1rem)]",customLaunchGreeting:o,customBottomDisclaimer:i,enableHighlightedClasses:s=!0,enableBackstageClasses:a=!0,disableStickyHeader:l=!1,disableSuggestions:u=!1,disableScrollToBottomButton:h=!1,reactionsToDisable:f}=t,{loader:p}=c7(),g=x(Zi),v=x(eo),y=x(NT),b=x(By),C=ar({breakpoint:"sm"}),S=ve(hn),I=se("sticky-conversation-mode"),T=Hp()&&y!==null,w=se("share-continue-v2"),A=!j_();m.useEffect(()=>{I&&S(g5("sticky-conversation-mode")??Ng)},[I,S]);const _=v==null?void 0:v.sideBySideComparisonId,L=!!_,[N,K]=m.useState(0);tke();const q=m.useRef(null),ae=XAe(q);QAe(g.length,q),qAe(q),PU({scrollableRef:q,source:"chat",customData:{conversationId:v==null?void 0:v.id}});const[O]=Ube({...p,disabled:!!p.error}),{backstageMessagesProps:W,highlightedMessagesProps:te,sentinelRef:D,sentinelClasses:G,backstageClasses:re,highlightedClasses:J,opacity:ne,highlighted:X,backstage:Ie}=x_e(()=>ae({behavior:"instant",delay:me.instance().config().scrollToBottomDelay}),q,T,N,g),Ce=nd(ne,F=>F<.5?"none":"auto"),be=()=>ae({behavior:"smooth"}),{bottomRef:ue,shouldShowScrollToBottomButton:Me}=eke({chatRef:q,hasMessages:g.length>0&&!h}),le=x(RT).get((v==null?void 0:v.id)??""),we=!!(le!=null&&le.size),Ke=le==null?void 0:le.values().next().value,k=x(Dd);m.useEffect(()=>{v!=null&&v.id&&(nke(v.id,g),rke(()=>{H(()=>import("./ai-message-C8ikz2Ct.js").then(F=>F.j),__vite__mapDeps([356,1,2,301,315,228,320,357,358,223,325,359,349]))}))},[v==null?void 0:v.id,g]),KAe(g,v==null?void 0:v.streamingState);const B=L7(X),ge=(B==null?void 0:B.author)==="human"&&B.id===""||(v==null?void 0:v.streamingState)==="streaming",M=!!x($h),Q=x(Lu),fe=m.useMemo(()=>{if((B==null?void 0:B.author)!=="ai")return!1;const F=B.content.at(-1);return(F==null?void 0:F.type)==="image"&&F.status==="generating"},[B]),z=ge&&!we||M||Q,{disableMultiturn:Z}=me.instance().config(),Ee=(ut=(We=me.instance().config().styleOverrides)==null?void 0:We.width)==null?void 0:ut.chat;JAe(g.length,ge);const tt=vi(),ht=Ep(),{showShoppingCardInNewChat:mt}=$T(),Ve=!T&&!C&&ht,rt=a&&!(mt&&!C),{isMediaViewerOpen:xt}=Us(),qt=x(Up),Wt=se("chat-refactor-max-width"),Yt=Wt?D7():void 0,nr=Wt?"w-full":jA,V=(v==null?void 0:v.streamingState)==="idle",ye=!u&&!L,_e=z&&!L&&!fe,Pe=(F,oe=!1,de,je=!1)=>F.map((Le,Je)=>{const dt=new Date(Le.createdAt),ct=Je>0?F[Je-1]:de,st=ct&&new Date(ct.createdAt),dr=!st||!wA(dt,st),Gn=w&&DIe(v!=null&&v.continuedAt?new Date(v.continuedAt):null,dt,st);let hr;return uZ(Le)?hr=d.jsx(UAe,{message:Le,conversationId:v==null?void 0:v.id,animatingMessageIds:le,sideBySideComparisonId:_,isStreamingComplete:V,shouldAnimate:oe,reactionsToDisable:f,isLastMessage:je&&Je===F.length-1}):Le.author==="ai"?hr=d.jsx(m.Suspense,{fallback:d.jsx(OA,{}),children:d.jsx(vke,{message:Le,isStreamingComplete:V,shouldAnimate:oe,reactionsToDisable:f,isLastMessage:je&&Je===F.length-1})}):hr=d.jsx(gke,{message:Le,className:Yt}),d.jsxs(m.Fragment,{children:[Gn&&d.jsx(dAe,{content:ee("chat.continuedConversationDisclaimer")}),dr&&!Z&&d.jsx(uAe,{date:dt,className:Yt}),hr]},Le.id)});return d.jsx(V7,{children:d.jsxs("div",{className:Be("scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 @container/chat sm:min-w-chat-side-by-side",(v==null?void 0:v.id)&&VU(v.id)&&"t-custom-scrollbar",me.instance().config().showScrollbarOnHover&&"scrollbar-container",xt&&!qt&&"invisible",e),ref:q,"data-testid":"chat-page",children:[!l&&d.jsx(Y7,{}),p.hasNextPage&&d.jsx("div",{ref:O}),T&&d.jsx(V_e,{animatingMessageId:Ke,isStreamingMessage:ge,displayedCharacterId:y,setCharacterComponentHeight:K}),d.jsx(Ll.Motion,{circular:!1,tabbable:!0,initial:A?"start":!1,animate:"end",variants:{start:ot,end:{...Lt,transition:{duration:.2,delay:.2}}},className:Be(n,"grow",!Wt&&(ip("pageContainer")??"px-6"),nr,Ee),layout:"position",transition:Ho,"data-content":"conversation","data-copy":"false",children:d.jsxs(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:[d.jsxs(Ne.div,{className:Be("relative",tt||!l?"pt-10":"pt-6",Ie.length>0&&RM,rt&&re),variants:W.variants,initial:A?W.initial:!1,animate:W.animate,style:{opacity:g.length>0?ne:0,pointerEvents:Ce},children:[d.jsx("div",{className:Be("absolute -z-10 w-full",G),ref:D}),Pe(Ie)]}),d.jsxs("div",{className:Be(s&&J,"flex flex-col"),"data-testid":"highlighted-chats",children:[d.jsx(Mn,{mode:"wait",initial:!1,children:d.jsxs(d.Fragment,{children:[d.jsx(K7,{customLaunchGreeting:o,chatItemClasses:Yt}),X.length>0&&d.jsxs(Ne.div,{className:Be(Z?"pb-24":"pb-6",RM),initial:te.initial,animate:te.animate,exit:te.exit,onAnimationStart:te.onAnimationStart,children:[Pe(L?lZ(X,_):X,we,Ie[Ie.length-1]??void 0,!0),d.jsx(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:_e&&d.jsx(q7,{delay:yke,className:Yt})}),d.jsx(wn,{children:k&&d.jsx(U_e,{className:Yt})}),d.jsx(wn,{children:b&&b.visible&&d.jsx(D_e,{className:Yt})})]},(He=X[0])==null?void 0:He.createdAt)]})}),ye&&d.jsx(bAe,{mostRecentMessageId:B==null?void 0:B.id,className:Yt}),d.jsx("div",{ref:ue,style:{height:0,overflow:"hidden"}}),d.jsx(jAe,{shouldShowScrollToBottomButton:Me,onClick:be,bottomButtonClass:r}),Z&&!z&&d.jsx(M_e,{title:ee("tv.chat.moveToMultiturn"),onClick:()=>{const F=new URL(window.location.origin);F.searchParams.set("wtv","1"),F.searchParams.set("oem","lg-multiturn"),Lp(F.toString())},hoverVariant:!0,className:Be("fixed bottom-6 start-1/2 z-10 -translate-x-1/2 px-8 transition-opacity duration-300",Me?"pointer-events-none opacity-0":"opacity-100"),children:ee("tv.chat.moveToMultiturn")})]})]})}),Ve&&d.jsx($7,{customBottomDisclaimer:i})]})})}const IOe=Object.freeze(Object.defineProperty({__proto__:null,CHAT_WIDTH_CLASSES:jA,default:CE},Symbol.toStringTag,{value:"Module"}));function eF(t){var y,b;const{className:e,conversationContainerClassName:n="mb-[var(--composer-container-height)]",customLaunchGreeting:r,customBottomDisclaimer:o,disableStickyHeader:i=!1,enableBackstageClasses:s=!0,enableHighlightedClasses:a=!0}=t,l=se("chat-refactor-max-width"),u=ar({breakpoint:"sm"}),h=vi(),f=!u,p=(b=(y=me.instance().config().styleOverrides)==null?void 0:y.width)==null?void 0:b.chat,g=l?D7():void 0,v=l?"w-full":jA;return d.jsx(V7,{children:d.jsxs("div",{className:Be("scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 sm:min-w-chat-side-by-side",me.instance().config().showScrollbarOnHover&&"scrollbar-container",e),"data-testid":"landing-page",children:[!i&&d.jsx(Y7,{}),d.jsx(Ll.Motion,{circular:!1,tabbable:!0,initial:"start",animate:"end",variants:{start:ot,end:{...Lt,transition:{duration:.2,delay:.2}}},className:Be(n,"grow",!l&&(ip("pageContainer")??"px-6"),v,p),layout:"position",transition:Ho,children:d.jsxs(m.Suspense,{fallback:d.jsx("div",{"aria-hidden":!0}),children:[d.jsx("div",{className:Be("relative",h||!i?"pt-10":"pt-6",s&&M7)}),d.jsx("div",{className:Be("flex",a&&O7),children:d.jsx(Mn,{mode:"wait",initial:!1,children:d.jsx(K7,{customLaunchGreeting:r,chatItemClasses:g})})})]})}),f&&d.jsx($7,{customBottomDisclaimer:o})]})})}const bke=bt("/")({component:eF});bt("/w/landing")({component:eF});function tF(t){En(nF,t)}function Cke(){return x(nF)}const nF=P(null),Ske=c.union([c.literal(!0),c.literal(!1)]);c.object({enabled:Ske.optional()});function Ike(){const t=Cke(),{t:e}=xe();return t?d.jsx(X_,{className:"ms-2.5 w-96 shrink-0",children:d.jsxs("div",{className:"size-full overflow-auto",children:[d.jsx(Te,{title:e("common.closeText"),className:"absolute end-2 top-2",size:"32-xs",variant:"circle",onClick:()=>tF(null),children:d.jsx(Mr,{className:"size-4"})}),d.jsx(Eke,{panelData:t})]})}):null}function Eke(t){const{panelData:e}=t;switch(e.type){case"devModeMessageInfo":return UE;case"__TODO___REPLACE_ME__":throw new Error("ConversationPanelContent: Unimplemented type")}return null}const Tke=lH("/chats/$conversationId");function wke(t){const{disableStickyHeader:e,reactionsToDisable:n}=t,{conversationId:r}=Tke.useParams(),o=se("chat-layout-v2"),i=ve(it),s=se("conversation-id-sync");return m.useEffect(()=>{s&&i(r)},[r,i,s]),m.useEffect(()=>()=>{tF(null)},[]),o?d.jsxs(d.Fragment,{children:[d.jsxs(X_,{className:"relative h-full flex-1 overflow-hidden will-change-auto",children:[d.jsx(CE,{disableStickyHeader:e,reactionsToDisable:n}),d.jsx(b7,{}),d.jsx(C7,{}),d.jsx(S7,{})]}),d.jsx(Ike,{})]}):d.jsx(CE,{disableStickyHeader:e,reactionsToDisable:n})}const _ke=bt("/chats/$conversationId")({component:wke}),Ake=bt("/topic-selection")(),kke=bt("/login")(),xke=bt("/library")(),Rke=bt("/gaming")(),Nke=bt("/gallery")(),Pke=bt("/discover")(),Mke=bt("/daily")(),Oke=bt("/agents")(),Lke=bt("/referrals/")(),Dke=bt("/labs_/")(),jke=bt("/subscription/start")(),Uke=bt("/subscription/manage")(),Fke=bt("/shares/$conversationId")(),Bke=bt("/referrals/rules")(),Hke=bt("/pro/subscribe")(),zke=bt("/pages/$pageId")(),Vke=bt("/memory/narrative")(),$ke=bt("/gallery/$galleryItemId")(),Gke=bt("/connector/callback")(),Kke=bt("/chats/private")(),qke=bt("/campaigns/$campaignId")(),Wke=bt("/labs_/portrait/")(),Yke=bt("/labs_/audio-expression/")(),Qke=bt("/shares/podcasts/$shareId")(),Jke=bt("/shares/pages/$shareId")(),Xke=bt("/shares/3d-generations/$shareId")(),Zke=bt("/pro/redeem/$redeemCode")(),exe=bt("/pro/ewallet/return")(),txe=bt("/podcasts/$podcastType/$podcastId")(),nxe=bt("/labs_/portrait/talk")(),rxe=bt("/labs_/experiments/$experimentAlias")(),oxe=bt("/chats_/$conversationId/talk")(),ixe=bt("/labs_/experiments/3d-generations/")(),sxe=bt("/labs_/experiments/3d-generations/my-creations")(),axe=Ake.update({id:"/topic-selection",path:"/topic-selection",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./topic-selection.lazy-B5cI1orD.js"),__vite__mapDeps([360,1,2])).then(t=>t.Route)),cxe=kke.update({id:"/login",path:"/login",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./login.lazy-C39O15Ja.js"),__vite__mapDeps([361,1,2,298])).then(t=>t.Route)),lxe=xke.update({id:"/library",path:"/library",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./library.lazy-zM9-siRr.js"),__vite__mapDeps([362,1,2])).then(t=>t.Route)),uxe=Rke.update({id:"/gaming",path:"/gaming",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./gaming.lazy-BCtfmq0S.js"),__vite__mapDeps([363,1,2,234,235])).then(t=>t.Route)),rF=Nke.update({id:"/gallery",path:"/gallery",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./gallery.lazy-CrAumhq5.js"),__vite__mapDeps([364,1,2,365])).then(t=>t.Route)),dxe=Pke.update({id:"/discover",path:"/discover",getParentRoute:()=>Tt}).lazy(()=>H(()=>Promise.resolve().then(()=>zRe),void 0).then(t=>t.Route)),hxe=Mke.update({id:"/daily",path:"/daily",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./daily.lazy-CvPqLBmR.js"),__vite__mapDeps([366,1,2,367,368,369,330,370,371,372,373,374,284,375,359,318])).then(t=>t.Route)),fxe=Oke.update({id:"/agents",path:"/agents",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./agents.lazy-DWNX03Hz.js"),__vite__mapDeps([376,1,2])).then(t=>t.Route)),pxe=C_e.update({id:"/",path:"/",getParentRoute:()=>Tt}),mxe=Lke.update({id:"/referrals/",path:"/referrals/",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./index.lazy-BkyizCh6.js"),__vite__mapDeps([377,1,2,378,245,379,380,381,382,383,384,385,386])).then(t=>t.Route)),gxe=Dke.update({id:"/labs_/",path:"/labs/",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./index.lazy-DkDc0SGa.js"),__vite__mapDeps([387,1,2,388,389,390,391,392,393,375])).then(t=>t.Route)),vxe=jke.update({id:"/subscription/start",path:"/subscription/start",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./subscription.start.lazy-ECFx5Fve.js"),__vite__mapDeps([394,1,2])).then(t=>t.Route)),yxe=Uke.update({id:"/subscription/manage",path:"/subscription/manage",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./subscription.manage.lazy-B6aiVxo_.js"),__vite__mapDeps([395,1,2,340])).then(t=>t.Route)),bxe=Fke.update({id:"/shares/$conversationId",path:"/shares/$conversationId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./shares._conversationId.lazy-DfJgrCt4.js"),__vite__mapDeps([396,1,2])).then(t=>t.Route)),Cxe=Bke.update({id:"/referrals/rules",path:"/referrals/rules",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./rules.lazy-CKsdQ3DE.js"),__vite__mapDeps([397,1,2,245,380,382,398,399])).then(t=>t.Route)),Sxe=Hke.update({id:"/pro/subscribe",path:"/pro/subscribe",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./pro.subscribe.lazy-Cvnppj0b.js"),__vite__mapDeps([400,1,2,246,247,248,232,401,402,285,403,404,405,406,407,241,408,409,410,411,412,413,301,414,415,416,417,418,244,245,419,420,421,422,423,234,235,424,425])).then(t=>t.Route)),Ixe=zke.update({id:"/pages/$pageId",path:"/pages/$pageId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./pages._pageId.lazy-D-TEEBIg.js"),__vite__mapDeps([426,1,2,427,357,428,429,430,431,432,433,224,434,435,295,436,320,370,220,437,438,222])).then(t=>t.Route)),Exe=Vke.update({id:"/memory/narrative",path:"/memory/narrative",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./memory.narrative.lazy-DN0YBIDB.js"),__vite__mapDeps([439,1,2,440])).then(t=>t.Route)),Txe=$ke.update({id:"/$galleryItemId",path:"/$galleryItemId",getParentRoute:()=>rF}).lazy(()=>H(()=>import("./gallery._galleryItemId.lazy-B0N8Q4zd.js"),__vite__mapDeps([441,1,2,365,442,308,309,310,311,312,302,303,304,305,306])).then(t=>t.Route)),wxe=Gke.update({id:"/connector/callback",path:"/connector/callback",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./connector.callback.lazy-BLFM1XTG.js"),__vite__mapDeps([443,1,2])).then(t=>t.Route)),_xe=Kke.update({id:"/chats/private",path:"/chats/private",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./chats.private.lazy-D158OGYP.js"),__vite__mapDeps([444,1,2])).then(t=>t.Route)),Axe=qke.update({id:"/campaigns/$campaignId",path:"/campaigns/$campaignId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./campaigns._campaignId.lazy-syIKUxMy.js"),__vite__mapDeps([445,1,2])).then(t=>t.Route)),kxe=bke.update({id:"/w/landing",path:"/w/landing",getParentRoute:()=>Tt}),xxe=_ke.update({id:"/chats/$conversationId",path:"/chats/$conversationId",getParentRoute:()=>Tt}),Rxe=Wke.update({id:"/labs_/portrait/",path:"/labs/portrait/",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./index.lazy-B8ukvlN1.js"),__vite__mapDeps([446,1,2])).then(t=>t.Route)),Nxe=Yke.update({id:"/labs_/audio-expression/",path:"/labs/audio-expression/",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./index.lazy-C8UXcOZm.js"),__vite__mapDeps([447,1,2,282,283])).then(t=>t.Route)),Pxe=Qke.update({id:"/shares/podcasts/$shareId",path:"/shares/podcasts/$shareId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./shares.podcasts._shareId.lazy-BBylXnFT.js"),__vite__mapDeps([448,1,2,359,335,373,374])).then(t=>t.Route)),Mxe=Jke.update({id:"/shares/pages/$shareId",path:"/shares/pages/$shareId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./shares.pages._shareId.lazy-BaoYf6Y9.js"),__vite__mapDeps([449,1,2,438,427,357,428,429,430,431,432,433,224,434,435,295,436,320,370,220,437,222,450])).then(t=>t.Route)),Oxe=Xke.update({id:"/shares/3d-generations/$shareId",path:"/shares/3d-generations/$shareId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./shares.3d-generations._shareId.lazy-Duil6rPz.js"),__vite__mapDeps([451,1,2,452,415,453,454])).then(t=>t.Route)),Lxe=Zke.update({id:"/pro/redeem/$redeemCode",path:"/pro/redeem/$redeemCode",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./pro.redeem._redeemCode.lazy-KwSzkrST.js"),__vite__mapDeps([455,1,2])).then(t=>t.Route)),Dxe=exe.update({id:"/pro/ewallet/return",path:"/pro/ewallet/return",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./pro.ewallet.return.lazy-C9pttPAC.js"),__vite__mapDeps([456,1,2,402,285])).then(t=>t.Route)),jxe=txe.update({id:"/podcasts/$podcastType/$podcastId",path:"/podcasts/$podcastType/$podcastId",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./podcasts._podcastType._podcastId.lazy-Bb5VWy3F.js"),__vite__mapDeps([457,1,2,367,368,369,330,370,371,372,373,374,284,375,359,318])).then(t=>t.Route)),Uxe=nxe.update({id:"/labs_/portrait/talk",path:"/labs/portrait/talk",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./talk.lazy-CKQ1Wepe.js"),__vite__mapDeps([458,1,2,459,460,461,462,375])).then(t=>t.Route)),Fxe=rxe.update({id:"/labs_/experiments/$experimentAlias",path:"/labs/experiments/$experimentAlias",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./experiments._experimentAlias.lazy-DYjNjQEX.js").then(t=>t.e),__vite__mapDeps([463,1,2,389,388,390,391,392,393,375,282,283])).then(t=>t.Route)),Bxe=oxe.update({id:"/chats_/$conversationId/talk",path:"/chats/$conversationId/talk",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./chats_._conversationId.talk.lazy-CCDeMOlb.js"),__vite__mapDeps([464,1,2,459,460,461,462,375])).then(t=>t.Route)),Hxe=ixe.update({id:"/labs_/experiments/3d-generations/",path:"/labs/experiments/3d-generations/",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./my-creations.lazy-ofoK-SiS.js").then(t=>t.i),__vite__mapDeps([465,1,2,452,415,388,466,293,236,368,369,330,222,235,467])).then(t=>t.Route)),zxe=sxe.update({id:"/labs_/experiments/3d-generations/my-creations",path:"/labs/experiments/3d-generations/my-creations",getParentRoute:()=>Tt}).lazy(()=>H(()=>import("./my-creations.lazy-ofoK-SiS.js").then(t=>t.m),__vite__mapDeps([465,1,2,452,415,388,466,293,236,368,369,330,222,235,467])).then(t=>t.Route)),Vxe={GalleryGalleryItemIdLazyRoute:Txe},$xe=rF._addFileChildren(Vxe),Gxe={IndexRoute:pxe,AgentsLazyRoute:fxe,DailyLazyRoute:hxe,DiscoverLazyRoute:dxe,GalleryLazyRoute:$xe,GamingLazyRoute:uxe,LibraryLazyRoute:lxe,LoginLazyRoute:cxe,TopicSelectionLazyRoute:axe,ChatsConversationIdRoute:xxe,WLandingRoute:kxe,CampaignsCampaignIdLazyRoute:Axe,ChatsPrivateLazyRoute:_xe,ConnectorCallbackLazyRoute:wxe,MemoryNarrativeLazyRoute:Exe,PagesPageIdLazyRoute:Ixe,ProSubscribeLazyRoute:Sxe,ReferralsRulesLazyRoute:Cxe,SharesConversationIdLazyRoute:bxe,SubscriptionManageLazyRoute:yxe,SubscriptionStartLazyRoute:vxe,LabsIndexLazyRoute:gxe,ReferralsIndexLazyRoute:mxe,ChatsConversationIdTalkLazyRoute:Bxe,LabsExperimentsExperimentAliasLazyRoute:Fxe,LabsPortraitTalkLazyRoute:Uxe,PodcastsPodcastTypePodcastIdLazyRoute:jxe,ProEwalletReturnLazyRoute:Dxe,ProRedeemRedeemCodeLazyRoute:Lxe,Shares3dGenerationsShareIdLazyRoute:Oxe,SharesPagesShareIdLazyRoute:Mxe,SharesPodcastsShareIdLazyRoute:Pxe,LabsAudioExpressionIndexLazyRoute:Nxe,LabsPortraitIndexLazyRoute:Rxe,LabsExperiments3dGenerationsMyCreationsLazyRoute:zxe,LabsExperiments3dGenerationsIndexLazyRoute:Hxe},Kxe=Tt._addFileChildren(Gxe)._addFileTypes(),Dl=uH({routeTree:Kxe});function qxe(){return d.jsx(dH,{router:Dl})}(function(){const t="onabort onactivate onactivateinvisible onafterprint onafterupdate onanimationcancel onanimationend onanimationiteration onanimationstart onariarequest onauxclick onbeforeactivate onbeforecopy onbeforecut onbeforedeactivate onbeforeeditfocus onbeforepaste onbeforeprint onbeforeunload onbegin onblur onbounce oncancel oncanplay oncanplaythrough oncellchange onchange onclick onclose oncommand oncontextmenu oncontrolselect oncopy oncuechange oncut ondataavailable ondatasetchanged ondatasetcomplete ondblclick ondeactivate ondrag ondragdrop ondragend ondragenter ondragexit ondragleave ondragover ondragstart ondrop ondurationchange onemptied onend onended onerror onerrorupdate onexit onfilterchange onfinish onfocus onfocusin onfocusout onformdata onfullscreenchange onfullscreenerror ongotpointercapture onhelp oninput oninvalid onkeydown onkeypress onkeyup onlayoutcomplete onload onloadeddata onloadedmetadata onloadend onloadstart onlosecapture onlostpointercapture onmediacomplete onmediaerror onmessage onmousedown onmouseenter onmouseleave onmousemove onmouseout onmouseover onmouseup onmousewheel onmove onmoveend onmovestart onmozfullscreenchange onmozfullscreenerror onmscontentzoom onmsgesturechange onmsgesturedoubletap onmsgestureend onmsgesturehold onmsgesturestart onmsgesturetap onmsgotpointercapture onmsinertiastart onmslostpointercapture onmsmanipulationstatechanged onmspointercancel onmspointerdown onmspointerenter onmspointerleave onmspointermove onmspointerout onmspointerover onmspointerup onoffline ononline onoutofsync onoverscroll onpaste onpause onplay onplaying onpointercancel onpointerdown onpointerenter onpointerleave onpointermove onpointerout onpointerover onpointerrawupdate onpointerup onprogress onpropertychange onratechange onreadystatechange onrepeat onreset onresize onresizeend onresizestart onresume onreverse onrowdelete onrowenter onrowexit onrowinserted onscroll onscrollend onsearch onseek onseeked onseeking onselect onselectionchange onselectstart onshow onstalled onstart onstop onstorage onsubmit onsuspend onsynchrestored ontimeerror ontimeupdate ontoggle ontrackchange ontransitioncancel ontransitionend ontransitionrun ontransitionstart onunload onurlflip onvolumechange onwaiting onwebkitanimationend onwebkitanimationiteration onwebkitanimationstart onwebkitfullscreenchange onwebkitfullscreenerror onwebkittransitionend onwheel".split(" ");function e(){if(typeof window<"u"){const f=[];for(const p in HTMLElement.prototype)p.slice(0,2)==="on"&&f.push(p);return f}return t}const n=typeof window<"u",r=()=>{throw new TypeError("undefined conversion")},o=()=>null,{toLowerCase:i,toUpperCase:s}=String.prototype;function a(){throw new TypeError("Illegal constructor")}function l(){throw new TypeError("Illegal constructor")}const{l:u}=function(){function f(le){let we=ae.get(le);return we===void 0&&(we=I(null),ae.set(le,we)),we}function p(le){const we=A(le);if(we==null||A(we)!==_)throw Error();for(const Ke of w(we))E(le,Ke,{value:le[Ke]});return le}function g(le,we){T(le.prototype),delete le.name,E(le,"name",{value:we})}function v(le){return we=>we instanceof le&&ae.has(we)}function y(le,we){function Ke(B,ge){const M=we[ge]||(le=="default"?o:r),Q=T(new B(q,le));return T({[ge](fe,...z){if(fe=M(""+fe,...z),fe==null){if(le=="default")return fe;fe=""}return fe=""+fe,z=T(I(Q)),f(z).v=fe,z}}[ge])}const k=I(a.prototype);for(const B of w(Me))k[B]=Ke(Me[B],B);return E(k,"name",{value:le,writable:!1,configurable:!1,enumerable:!0}),T(k)}function b(le,we,Ke,k="",B=""){if(le=s.apply(String(le)),(k=B||k)||(k="http://www.w3.org/1999/xhtml"),k=L.apply(be,[k])?be[k]:null){if(L.apply(k,[le])&&k[le]&&L.apply(k[le][we],[Ke])&&k[le][we][Ke])return k[le][we][Ke];if(L.apply(k,["*"])&&L.apply(k["*"][we],[Ke])&&k["*"][we][Ke])return k["*"][we][Ke]}}function C(){return D}const{assign:S,create:I,defineProperty:E,freeze:T,getOwnPropertyNames:w,getPrototypeOf:A,prototype:_}=Object,{hasOwnProperty:L}=_,{forEach:N,push:K}=Array.prototype,q=Symbol(),ae=p(new WeakMap),O=p([]),W=p([]);let te=!0,D=null,G=!1;class re{constructor(we,Ke){if(we!==q)throw Error("cannot call the constructor");E(this,"policyName",{value:Ke,enumerable:!0})}toString(){return f(this).v}valueOf(){return f(this).v}}class J extends re{}g(J,"TrustedScriptURL");class ne extends re{}g(ne,"TrustedHTML");class X extends re{}g(X,"TrustedScript"),g(re,"TrustedType");const Ie=T(I(new ne(q,"")));f(Ie).v="";const Ce=T(I(new X(q,"")));f(Ce).v="";const be={"http://www.w3.org/1999/xhtml":{EMBED:{attributes:{src:J.name}},IFRAME:{attributes:{srcdoc:ne.name}},OBJECT:{attributes:{data:J.name,codebase:J.name}},SCRIPT:{attributes:{src:J.name,text:X.name},properties:{innerText:X.name,textContent:X.name,text:X.name}},"*":{attributes:{},properties:{innerHTML:ne.name,outerHTML:ne.name}}},"http://www.w3.org/2000/svg":{"*":{attributes:{},properties:{}}}};var ue={codebase:"codeBase",formaction:"formAction"};!n||"srcdoc"in HTMLIFrameElement.prototype||delete be["http://www.w3.org/1999/xhtml"].IFRAME.attributes.srcdoc;for(const le of Object.keys(be["http://www.w3.org/1999/xhtml"])){be["http://www.w3.org/1999/xhtml"][le].properties||(be["http://www.w3.org/1999/xhtml"][le].properties={});for(const we of Object.keys(be["http://www.w3.org/1999/xhtml"][le].attributes))be["http://www.w3.org/1999/xhtml"][le].properties[ue[we]?ue[we]:we]=be["http://www.w3.org/1999/xhtml"][le].attributes[we]}for(const le of e())be["http://www.w3.org/1999/xhtml"]["*"].attributes[le]="TrustedScript",be["http://www.w3.org/2000/svg"]["*"].attributes[le]="TrustedScript";const Me={createHTML:ne,createScriptURL:J,createScript:X},Ye=Me.hasOwnProperty;return ue=I(l.prototype),S(ue,{createPolicy:function(le,we){if(!le.match(/^[-#a-zA-Z0-9=_/@.%]+$/g))throw new TypeError("Policy "+le+" contains invalid characters.");if(G&&W.indexOf(le)===-1&&W.indexOf("*")===-1)throw new TypeError("Policy "+le+" disallowed.");if(le==="default"&&D)throw new TypeError("Policy "+le+" already exists.");if(G&&!te&&O.indexOf(le)!==-1)throw new TypeError("Policy "+le+" exists.");O.push(le);const Ke=I(null);if(we&&typeof we=="object")for(const k of w(we))Ye.call(Me,k)&&(Ke[k]=we[k]);else console.warn("trustedTypes.createPolicy "+le+" was given an empty policy");return T(Ke),we=y(le,Ke),le==="default"&&(D=we),we},h:v(ne),j:v(J),i:v(X),c:function(le,we,Ke="",k=""){return we=i.apply(String(we)),b(le,"attributes",we,Ke,k)||null},f:function(le,we,Ke=""){return b(le,"properties",String(we),Ke)||null},g:function(le=""){if(!le)try{le=document.documentElement.namespaceURI}catch{le="http://www.w3.org/1999/xhtml"}return(le=be[le])?JSON.parse(JSON.stringify(le)):{}},a:Ie,b:Ce,o:D,TrustedHTML:ne,TrustedScriptURL:J,TrustedScript:X}),E(ue,"defaultPolicy",{get:C,set:()=>{}}),{l:T(ue),w:function(le,we){G=!0,W.length=0,N.call(le,Ke=>{K.call(W,""+Ke)}),te=we,O.length=0},m:function(){G=!1},s:C,u:function(){D=null,O.splice(O.indexOf("default"),1)}}}();if(typeof window<"u"&&(window.TrustedTypes&&typeof window.trustedTypes>"u"&&(window.trustedTypes=Object.freeze(window.TrustedTypes)),typeof window.trustedTypes>"u")){var h=Object.create(l.prototype);Object.assign(h,{isHTML:u.h,isScriptURL:u.j,isScript:u.i,createPolicy:u.createPolicy,getAttributeType:u.c,getPropertyType:u.f,getTypeMapping:u.g,emptyHTML:u.a,emptyScript:u.b,_isPolyfill_:!0}),Object.defineProperty(h,"defaultPolicy",Object.getOwnPropertyDescriptor(u,"defaultPolicy")||{}),window.trustedTypes=Object.freeze(h),window.TrustedHTML=u.TrustedHTML,window.TrustedScriptURL=u.TrustedScriptURL,window.TrustedScript=u.TrustedScript,window.TrustedTypePolicy=a,window.TrustedTypePolicyFactory=l}}).call(void 0);/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:oF,setPrototypeOf:NM,isFrozen:Wxe,getPrototypeOf:Yxe,getOwnPropertyDescriptor:Qxe}=Object;let{freeze:Fr,seal:zo,create:iF}=Object,{apply:SE,construct:IE}=typeof Reflect<"u"&&Reflect;Fr||(Fr=function(e){return e});zo||(zo=function(e){return e});SE||(SE=function(e,n,r){return e.apply(n,r)});IE||(IE=function(e,n){return new e(...n)});const Qm=Br(Array.prototype.forEach),Jxe=Br(Array.prototype.lastIndexOf),PM=Br(Array.prototype.pop),Uh=Br(Array.prototype.push),Xxe=Br(Array.prototype.splice),Tg=Br(String.prototype.toLowerCase),G0=Br(String.prototype.toString),MM=Br(String.prototype.match),Fh=Br(String.prototype.replace),Zxe=Br(String.prototype.indexOf),eRe=Br(String.prototype.trim),Qo=Br(Object.prototype.hasOwnProperty),Ar=Br(RegExp.prototype.test),Bh=tRe(TypeError);function Br(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return SE(t,e,r)}}function tRe(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return IE(t,n)}}function It(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tg;NM&&NM(t,null);let r=e.length;for(;r--;){let o=e[r];if(typeof o=="string"){const i=n(o);i!==o&&(Wxe(e)||(e[r]=i),o=i)}t[o]=!0}return t}function nRe(t){for(let e=0;e<t.length;e++)Qo(t,e)||(t[e]=null);return t}function oc(t){const e=iF(null);for(const[n,r]of oF(t))Qo(t,n)&&(Array.isArray(r)?e[n]=nRe(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=oc(r):e[n]=r);return e}function Hh(t,e){for(;t!==null;){const r=Qxe(t,e);if(r){if(r.get)return Br(r.get);if(typeof r.value=="function")return Br(r.value)}t=Yxe(t)}function n(){return null}return n}const OM=Fr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),K0=Fr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),q0=Fr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),rRe=Fr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),W0=Fr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),oRe=Fr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),LM=Fr(["#text"]),DM=Fr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Y0=Fr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jM=Fr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Jm=Fr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),iRe=zo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sRe=zo(/<%[\w\W]*|[\w\W]*%>/gm),aRe=zo(/\$\{[\w\W]*/gm),cRe=zo(/^data-[\-\w.\u00B7-\uFFFF]+$/),lRe=zo(/^aria-[\-\w]+$/),sF=zo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),uRe=zo(/^(?:\w+script|data):/i),dRe=zo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aF=zo(/^html$/i),hRe=zo(/^[a-z][.\w]*(-[.\w]+)+$/i);var UM=Object.freeze({__proto__:null,ARIA_ATTR:lRe,ATTR_WHITESPACE:dRe,CUSTOM_ELEMENT:hRe,DATA_ATTR:cRe,DOCTYPE_NAME:aF,ERB_EXPR:sRe,IS_ALLOWED_URI:sF,IS_SCRIPT_OR_DATA:uRe,MUSTACHE_EXPR:iRe,TMPLIT_EXPR:aRe});const zh={element:1,text:3,progressingInstruction:7,comment:8,document:9},fRe=function(){return typeof window>"u"?null:window},pRe=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(r=n.getAttribute(o));const i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},FM=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function cF(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fRe();const e=et=>cF(et);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==zh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,o=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:h=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:f,DOMParser:p,trustedTypes:g}=t,v=l.prototype,y=Hh(v,"cloneNode"),b=Hh(v,"remove"),C=Hh(v,"nextSibling"),S=Hh(v,"childNodes"),I=Hh(v,"parentNode");if(typeof s=="function"){const et=n.createElement("template");et.content&&et.content.ownerDocument&&(n=et.content.ownerDocument)}let E,T="";const{implementation:w,createNodeIterator:A,createDocumentFragment:_,getElementsByTagName:L}=n,{importNode:N}=r;let K=FM();e.isSupported=typeof oF=="function"&&typeof I=="function"&&w&&w.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:q,ERB_EXPR:ae,TMPLIT_EXPR:O,DATA_ATTR:W,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:D,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:re}=UM;let{IS_ALLOWED_URI:J}=UM,ne=null;const X=It({},[...OM,...K0,...q0,...W0,...LM]);let Ie=null;const Ce=It({},[...DM,...Y0,...jM,...Jm]);let be=Object.seal(iF(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,Me=null,Ye=!0,le=!0,we=!1,Ke=!0,k=!1,B=!0,ge=!1,M=!1,Q=!1,fe=!1,z=!1,Z=!1,Ee=!0,tt=!1;const ht="user-content-";let mt=!0,Ve=!1,rt={},xt=null;const qt=It({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Wt=null;const Yt=It({},["audio","video","img","source","image","track"]);let nr=null;const V=It({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ye="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",Pe="http://www.w3.org/1999/xhtml";let We=Pe,ut=!1,He=null;const F=It({},[ye,_e,Pe],G0);let oe=It({},["mi","mo","mn","ms","mtext"]),de=It({},["annotation-xml"]);const je=It({},["title","style","font","a","script"]);let Le=null;const Je=["application/xhtml+xml","text/html"],dt="text/html";let ct=null,st=null;const dr=n.createElement("form"),Gn=function($){return $ instanceof RegExp||$ instanceof Function},hr=function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(st&&st===$)){if((!$||typeof $!="object")&&($={}),$=oc($),Le=Je.indexOf($.PARSER_MEDIA_TYPE)===-1?dt:$.PARSER_MEDIA_TYPE,ct=Le==="application/xhtml+xml"?G0:Tg,ne=Qo($,"ALLOWED_TAGS")?It({},$.ALLOWED_TAGS,ct):X,Ie=Qo($,"ALLOWED_ATTR")?It({},$.ALLOWED_ATTR,ct):Ce,He=Qo($,"ALLOWED_NAMESPACES")?It({},$.ALLOWED_NAMESPACES,G0):F,nr=Qo($,"ADD_URI_SAFE_ATTR")?It(oc(V),$.ADD_URI_SAFE_ATTR,ct):V,Wt=Qo($,"ADD_DATA_URI_TAGS")?It(oc(Yt),$.ADD_DATA_URI_TAGS,ct):Yt,xt=Qo($,"FORBID_CONTENTS")?It({},$.FORBID_CONTENTS,ct):qt,ue=Qo($,"FORBID_TAGS")?It({},$.FORBID_TAGS,ct):{},Me=Qo($,"FORBID_ATTR")?It({},$.FORBID_ATTR,ct):{},rt=Qo($,"USE_PROFILES")?$.USE_PROFILES:!1,Ye=$.ALLOW_ARIA_ATTR!==!1,le=$.ALLOW_DATA_ATTR!==!1,we=$.ALLOW_UNKNOWN_PROTOCOLS||!1,Ke=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,k=$.SAFE_FOR_TEMPLATES||!1,B=$.SAFE_FOR_XML!==!1,ge=$.WHOLE_DOCUMENT||!1,fe=$.RETURN_DOM||!1,z=$.RETURN_DOM_FRAGMENT||!1,Z=$.RETURN_TRUSTED_TYPE||!1,Q=$.FORCE_BODY||!1,Ee=$.SANITIZE_DOM!==!1,tt=$.SANITIZE_NAMED_PROPS||!1,mt=$.KEEP_CONTENT!==!1,Ve=$.IN_PLACE||!1,J=$.ALLOWED_URI_REGEXP||sF,We=$.NAMESPACE||Pe,oe=$.MATHML_TEXT_INTEGRATION_POINTS||oe,de=$.HTML_INTEGRATION_POINTS||de,be=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&Gn($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(be.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&Gn($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(be.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(be.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),k&&(le=!1),z&&(fe=!0),rt&&(ne=It({},LM),Ie=[],rt.html===!0&&(It(ne,OM),It(Ie,DM)),rt.svg===!0&&(It(ne,K0),It(Ie,Y0),It(Ie,Jm)),rt.svgFilters===!0&&(It(ne,q0),It(Ie,Y0),It(Ie,Jm)),rt.mathMl===!0&&(It(ne,W0),It(Ie,jM),It(Ie,Jm))),$.ADD_TAGS&&(ne===X&&(ne=oc(ne)),It(ne,$.ADD_TAGS,ct)),$.ADD_ATTR&&(Ie===Ce&&(Ie=oc(Ie)),It(Ie,$.ADD_ATTR,ct)),$.ADD_URI_SAFE_ATTR&&It(nr,$.ADD_URI_SAFE_ATTR,ct),$.FORBID_CONTENTS&&(xt===qt&&(xt=oc(xt)),It(xt,$.FORBID_CONTENTS,ct)),mt&&(ne["#text"]=!0),ge&&It(ne,["html","head","body"]),ne.table&&(It(ne,["tbody"]),delete ue.tbody),$.TRUSTED_TYPES_POLICY){if(typeof $.TRUSTED_TYPES_POLICY.createHTML!="function")throw Bh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof $.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Bh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=$.TRUSTED_TYPES_POLICY,T=E.createHTML("")}else E===void 0&&(E=pRe(g,o)),E!==null&&typeof T=="string"&&(T=E.createHTML(""));Fr&&Fr($),st=$}},Rn=It({},[...K0,...q0,...rRe]),rs=It({},[...W0,...oRe]),rh=function($){let Re=I($);(!Re||!Re.tagName)&&(Re={namespaceURI:We,tagName:"template"});const $e=Tg($.tagName),Ut=Tg(Re.tagName);return He[$.namespaceURI]?$.namespaceURI===_e?Re.namespaceURI===Pe?$e==="svg":Re.namespaceURI===ye?$e==="svg"&&(Ut==="annotation-xml"||oe[Ut]):!!Rn[$e]:$.namespaceURI===ye?Re.namespaceURI===Pe?$e==="math":Re.namespaceURI===_e?$e==="math"&&de[Ut]:!!rs[$e]:$.namespaceURI===Pe?Re.namespaceURI===_e&&!de[Ut]||Re.namespaceURI===ye&&!oe[Ut]?!1:!rs[$e]&&(je[$e]||!Rn[$e]):!!(Le==="application/xhtml+xml"&&He[$.namespaceURI]):!1},Eo=function($){Uh(e.removed,{element:$});try{I($).removeChild($)}catch{b($)}},jl=function($,Re){try{Uh(e.removed,{attribute:Re.getAttributeNode($),from:Re})}catch{Uh(e.removed,{attribute:null,from:Re})}if(Re.removeAttribute($),$==="is")if(fe||z)try{Eo(Re)}catch{}else try{Re.setAttribute($,"")}catch{}},Tr=function($){let Re=null,$e=null;if(Q)$="<remove></remove>"+$;else{const Nn=MM($,/^[\r\n\t ]+/);$e=Nn&&Nn[0]}Le==="application/xhtml+xml"&&We===Pe&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");const Ut=E?E.createHTML($):$;if(We===Pe)try{Re=new p().parseFromString(Ut,Le)}catch{}if(!Re||!Re.documentElement){Re=w.createDocument(We,"template",null);try{Re.documentElement.innerHTML=ut?T:Ut}catch{}}const qn=Re.body||Re.documentElement;return $&&$e&&qn.insertBefore(n.createTextNode($e),qn.childNodes[0]||null),We===Pe?L.call(Re,ge?"html":"body")[0]:ge?Re.documentElement:qn},Wp=function($){return A.call($.ownerDocument||$,$,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},oh=function($){return $ instanceof f&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof h)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},ih=function($){return typeof a=="function"&&$ instanceof a};function _n(et,$,Re){Qm(et,$e=>{$e.call(e,$,Re,st)})}const Kn=function($){let Re=null;if(_n(K.beforeSanitizeElements,$,null),oh($))return Eo($),!0;const $e=ct($.nodeName);if(_n(K.uponSanitizeElement,$,{tagName:$e,allowedTags:ne}),$.hasChildNodes()&&!ih($.firstElementChild)&&Ar(/<[/\w]/g,$.innerHTML)&&Ar(/<[/\w]/g,$.textContent)||$.nodeType===zh.progressingInstruction||B&&$.nodeType===zh.comment&&Ar(/<[/\w]/g,$.data))return Eo($),!0;if(!ne[$e]||ue[$e]){if(!ue[$e]&&Yp($e)&&(be.tagNameCheck instanceof RegExp&&Ar(be.tagNameCheck,$e)||be.tagNameCheck instanceof Function&&be.tagNameCheck($e)))return!1;if(mt&&!xt[$e]){const Ut=I($)||$.parentNode,qn=S($)||$.childNodes;if(qn&&Ut){const Nn=qn.length;for(let fr=Nn-1;fr>=0;--fr){const rr=y(qn[fr],!0);rr.__removalCount=($.__removalCount||0)+1,Ut.insertBefore(rr,C($))}}}return Eo($),!0}return $ instanceof l&&!rh($)||($e==="noscript"||$e==="noembed"||$e==="noframes")&&Ar(/<\/no(script|embed|frames)/i,$.innerHTML)?(Eo($),!0):(k&&$.nodeType===zh.text&&(Re=$.textContent,Qm([q,ae,O],Ut=>{Re=Fh(Re,Ut," ")}),$.textContent!==Re&&(Uh(e.removed,{element:$.cloneNode()}),$.textContent=Re)),_n(K.afterSanitizeElements,$,null),!1)},Ul=function($,Re,$e){if(Ee&&(Re==="id"||Re==="name")&&($e in n||$e in dr))return!1;if(!(le&&!Me[Re]&&Ar(W,Re))){if(!(Ye&&Ar(te,Re))){if(!Ie[Re]||Me[Re]){if(!(Yp($)&&(be.tagNameCheck instanceof RegExp&&Ar(be.tagNameCheck,$)||be.tagNameCheck instanceof Function&&be.tagNameCheck($))&&(be.attributeNameCheck instanceof RegExp&&Ar(be.attributeNameCheck,Re)||be.attributeNameCheck instanceof Function&&be.attributeNameCheck(Re))||Re==="is"&&be.allowCustomizedBuiltInElements&&(be.tagNameCheck instanceof RegExp&&Ar(be.tagNameCheck,$e)||be.tagNameCheck instanceof Function&&be.tagNameCheck($e))))return!1}else if(!nr[Re]){if(!Ar(J,Fh($e,G,""))){if(!((Re==="src"||Re==="xlink:href"||Re==="href")&&$!=="script"&&Zxe($e,"data:")===0&&Wt[$])){if(!(we&&!Ar(D,Fh($e,G,"")))){if($e)return!1}}}}}}return!0},Yp=function($){return $!=="annotation-xml"&&MM($,re)},Qp=function($){_n(K.beforeSanitizeAttributes,$,null);const{attributes:Re}=$;if(!Re||oh($))return;const $e={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ie,forceKeepAttr:void 0};let Ut=Re.length;for(;Ut--;){const qn=Re[Ut],{name:Nn,namespaceURI:fr,value:rr}=qn,os=ct(Nn);let or=Nn==="value"?rr:eRe(rr);if($e.attrName=os,$e.attrValue=or,$e.keepAttr=!0,$e.forceKeepAttr=void 0,_n(K.uponSanitizeAttribute,$,$e),or=$e.attrValue,tt&&(os==="id"||os==="name")&&(jl(Nn,$),or=ht+or),B&&Ar(/((--!?|])>)|<\/(style|title)/i,or)){jl(Nn,$);continue}if($e.forceKeepAttr||(jl(Nn,$),!$e.keepAttr))continue;if(!Ke&&Ar(/\/>/i,or)){jl(Nn,$);continue}k&&Qm([q,ae,O],Jp=>{or=Fh(or,Jp," ")});const ir=ct($.nodeName);if(Ul(ir,os,or)){if(E&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!fr)switch(g.getAttributeType(ir,os)){case"TrustedHTML":{or=E.createHTML(or);break}case"TrustedScriptURL":{or=E.createScriptURL(or);break}}try{fr?$.setAttributeNS(fr,Nn,or):$.setAttribute(Nn,or),oh($)?Eo($):PM(e.removed)}catch{}}}_n(K.afterSanitizeAttributes,$,null)},Ko=function et($){let Re=null;const $e=Wp($);for(_n(K.beforeSanitizeShadowDOM,$,null);Re=$e.nextNode();)_n(K.uponSanitizeShadowNode,Re,null),Kn(Re),Qp(Re),Re.content instanceof i&&et(Re.content);_n(K.afterSanitizeShadowDOM,$,null)};return e.sanitize=function(et){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Re=null,$e=null,Ut=null,qn=null;if(ut=!et,ut&&(et="<!-->"),typeof et!="string"&&!ih(et))if(typeof et.toString=="function"){if(et=et.toString(),typeof et!="string")throw Bh("dirty is not a string, aborting")}else throw Bh("toString is not a function");if(!e.isSupported)return et;if(M||hr($),e.removed=[],typeof et=="string"&&(Ve=!1),Ve){if(et.nodeName){const rr=ct(et.nodeName);if(!ne[rr]||ue[rr])throw Bh("root node is forbidden and cannot be sanitized in-place")}}else if(et instanceof a)Re=Tr("<!---->"),$e=Re.ownerDocument.importNode(et,!0),$e.nodeType===zh.element&&$e.nodeName==="BODY"||$e.nodeName==="HTML"?Re=$e:Re.appendChild($e);else{if(!fe&&!k&&!ge&&et.indexOf("<")===-1)return E&&Z?E.createHTML(et):et;if(Re=Tr(et),!Re)return fe?null:Z?T:""}Re&&Q&&Eo(Re.firstChild);const Nn=Wp(Ve?et:Re);for(;Ut=Nn.nextNode();)Kn(Ut),Qp(Ut),Ut.content instanceof i&&Ko(Ut.content);if(Ve)return et;if(fe){if(z)for(qn=_.call(Re.ownerDocument);Re.firstChild;)qn.appendChild(Re.firstChild);else qn=Re;return(Ie.shadowroot||Ie.shadowrootmode)&&(qn=N.call(r,qn,!0)),qn}let fr=ge?Re.outerHTML:Re.innerHTML;return ge&&ne["!doctype"]&&Re.ownerDocument&&Re.ownerDocument.doctype&&Re.ownerDocument.doctype.name&&Ar(aF,Re.ownerDocument.doctype.name)&&(fr="<!DOCTYPE "+Re.ownerDocument.doctype.name+`>
`+fr),k&&Qm([q,ae,O],rr=>{fr=Fh(fr,rr," ")}),E&&Z?E.createHTML(fr):fr},e.setConfig=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hr(et),M=!0},e.clearConfig=function(){st=null,M=!1},e.isValidAttribute=function(et,$,Re){st||hr({});const $e=ct(et),Ut=ct($);return Ul($e,Ut,Re)},e.addHook=function(et,$){typeof $=="function"&&Uh(K[et],$)},e.removeHook=function(et,$){if($!==void 0){const Re=Jxe(K[et],$);return Re===-1?void 0:Xxe(K[et],Re,1)[0]}return PM(K[et])},e.removeHooks=function(et){K[et]=[]},e.removeAllHooks=function(){K=FM()},e}var BM=cF(),Af=class{constructor(t,e,n,r,o,i){j(this,"type",3);j(this,"name","");j(this,"prefix","");j(this,"value","");j(this,"suffix","");j(this,"modifier",3);this.type=t,this.name=e,this.prefix=n,this.value=r,this.suffix=o,this.modifier=i}hasCustomName(){return this.name!==""&&typeof this.name!="number"}},mRe=/[$_\p{ID_Start}]/u,gRe=/[$_\u200C\u200D\p{ID_Continue}]/u,EE=".*";function vRe(t,e){return/^[\x00-\x7F]*$/.test(t)}function lF(t,e=!1){let n=[],r=0;for(;r<t.length;){let o=t[r],i=function(s){if(!e)throw new TypeError(s);n.push({type:"INVALID_CHAR",index:r,value:t[r++]})};if(o==="*"){n.push({type:"ASTERISK",index:r,value:t[r++]});continue}if(o==="+"||o==="?"){n.push({type:"OTHER_MODIFIER",index:r,value:t[r++]});continue}if(o==="\\"){n.push({type:"ESCAPED_CHAR",index:r++,value:t[r++]});continue}if(o==="{"){n.push({type:"OPEN",index:r,value:t[r++]});continue}if(o==="}"){n.push({type:"CLOSE",index:r,value:t[r++]});continue}if(o===":"){let s="",a=r+1;for(;a<t.length;){let l=t.substr(a,1);if(a===r+1&&mRe.test(l)||a!==r+1&&gRe.test(l)){s+=t[a++];continue}break}if(!s){i(`Missing parameter name at ${r}`);continue}n.push({type:"NAME",index:r,value:s}),r=a;continue}if(o==="("){let s=1,a="",l=r+1,u=!1;if(t[l]==="?"){i(`Pattern cannot start with "?" at ${l}`);continue}for(;l<t.length;){if(!vRe(t[l])){i(`Invalid character '${t[l]}' at ${l}.`),u=!0;break}if(t[l]==="\\"){a+=t[l++]+t[l++];continue}if(t[l]===")"){if(s--,s===0){l++;break}}else if(t[l]==="("&&(s++,t[l+1]!=="?")){i(`Capturing groups are not allowed at ${l}`),u=!0;break}a+=t[l++]}if(u)continue;if(s){i(`Unbalanced pattern at ${r}`);continue}if(!a){i(`Missing pattern at ${r}`);continue}n.push({type:"REGEX",index:r,value:a}),r=l;continue}n.push({type:"CHAR",index:r,value:t[r++]})}return n.push({type:"END",index:r,value:""}),n}function uF(t,e={}){let n=lF(t);e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./");let r=`[^${wo(e.delimiter)}]+?`,o=[],i=0,s=0,a=new Set,l=S=>{if(s<n.length&&n[s].type===S)return n[s++].value},u=()=>l("OTHER_MODIFIER")??l("ASTERISK"),h=S=>{let I=l(S);if(I!==void 0)return I;let{type:E,index:T}=n[s];throw new TypeError(`Unexpected ${E} at ${T}, expected ${S}`)},f=()=>{let S="",I;for(;I=l("CHAR")??l("ESCAPED_CHAR");)S+=I;return S},p=S=>S,g=e.encodePart||p,v="",y=S=>{v+=S},b=()=>{v.length&&(o.push(new Af(3,"","",g(v),"",3)),v="")},C=(S,I,E,T,w)=>{let A=3;switch(w){case"?":A=1;break;case"*":A=0;break;case"+":A=2;break}if(!I&&!E&&A===3){y(S);return}if(b(),!I&&!E){if(!S)return;o.push(new Af(3,"","",g(S),"",A));return}let _;E?E==="*"?_=EE:_=E:_=r;let L=2;_===r?(L=1,_=""):_===EE&&(L=0,_="");let N;if(I?N=I:E&&(N=i++),a.has(N))throw new TypeError(`Duplicate name '${N}'.`);a.add(N),o.push(new Af(L,N,g(S),_,g(T),A))};for(;s<n.length;){let S=l("CHAR"),I=l("NAME"),E=l("REGEX");if(!I&&!E&&(E=l("ASTERISK")),I||E){let w=S??"";e.prefixes.indexOf(w)===-1&&(y(w),w=""),b();let A=u();C(w,I,E,"",A);continue}let T=S??l("ESCAPED_CHAR");if(T){y(T);continue}if(l("OPEN")){let w=f(),A=l("NAME"),_=l("REGEX");!A&&!_&&(_=l("ASTERISK"));let L=f();h("CLOSE");let N=u();C(w,A,_,L,N);continue}b(),h("END")}return o}function wo(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function HM(t){return t&&t.ignoreCase?"ui":"u"}function yRe(t,e,n){return dF(uF(t,n),e,n)}function Mu(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function dF(t,e,n={}){n.delimiter??(n.delimiter="/#?"),n.prefixes??(n.prefixes="./"),n.sensitive??(n.sensitive=!1),n.strict??(n.strict=!1),n.end??(n.end=!0),n.start??(n.start=!0),n.endsWith="";let r=n.start?"^":"";for(let a of t){if(a.type===3){a.modifier===3?r+=wo(a.value):r+=`(?:${wo(a.value)})${Mu(a.modifier)}`;continue}e&&e.push(a.name);let l=`[^${wo(n.delimiter)}]+?`,u=a.value;if(a.type===1?u=l:a.type===0&&(u=EE),!a.prefix.length&&!a.suffix.length){a.modifier===3||a.modifier===1?r+=`(${u})${Mu(a.modifier)}`:r+=`((?:${u})${Mu(a.modifier)})`;continue}if(a.modifier===3||a.modifier===1){r+=`(?:${wo(a.prefix)}(${u})${wo(a.suffix)})`,r+=Mu(a.modifier);continue}r+=`(?:${wo(a.prefix)}`,r+=`((?:${u})(?:`,r+=wo(a.suffix),r+=wo(a.prefix),r+=`(?:${u}))*)${wo(a.suffix)})`,a.modifier===0&&(r+="?")}let o=`[${wo(n.endsWith)}]|$`,i=`[${wo(n.delimiter)}]`;if(n.end)return n.strict||(r+=`${i}?`),n.endsWith.length?r+=`(?=${o})`:r+="$",new RegExp(r,HM(n));n.strict||(r+=`(?:${i}(?=${o}))?`);let s=!1;if(t.length){let a=t[t.length-1];a.type===3&&a.modifier===3&&(s=n.delimiter.indexOf(a)>-1)}return s||(r+=`(?=${i}|${o})`),new RegExp(r,HM(n))}var ea={delimiter:"",prefixes:"",sensitive:!0,strict:!0},bRe={delimiter:".",prefixes:"",sensitive:!0,strict:!0},CRe={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function SRe(t,e){return t.length?t[0]==="/"?!0:!e||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}function hF(t,e){return t.startsWith(e)?t.substring(e.length,t.length):t}function IRe(t,e){return t.endsWith(e)?t.substr(0,t.length-e.length):t}function fF(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}var pF=["ftp","file","http","https","ws","wss"];function mF(t){if(!t)return!0;for(let e of pF)if(t.test(e))return!0;return!1}function ERe(t,e){if(t=hF(t,"#"),e||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}function TRe(t,e){if(t=hF(t,"?"),e||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}function wRe(t,e){return e||t===""?t:fF(t)?yF(t):vF(t)}function _Re(t,e){if(e||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}function ARe(t,e){if(e||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}function kRe(t,e,n){if(n||t==="")return t;if(e&&!pF.includes(e))return new URL(`${e}:${t}`).pathname;let r=t[0]=="/";return t=new URL(r?t:"/-"+t,"https://example.com").pathname,r||(t=t.substring(2,t.length)),t}function xRe(t,e,n){return gF(e)===t&&(t=""),n||t===""?t:bF(t)}function RRe(t,e){return t=IRe(t,":"),e||t===""?t:UA(t)}function gF(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function UA(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}function NRe(t){if(t==="")return t;let e=new URL("https://example.com");return e.username=t,e.username}function PRe(t){if(t==="")return t;let e=new URL("https://example.com");return e.password=t,e.password}function vF(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let e=new URL("https://example.com");return e.hostname=t,e.hostname}function yF(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}function bF(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}function MRe(t){if(t==="")return t;let e=new URL("https://example.com");return e.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?e.pathname.substring(2,e.pathname.length):e.pathname}function ORe(t){return t===""?t:new URL(`data:${t}`).pathname}function LRe(t){if(t==="")return t;let e=new URL("https://example.com");return e.search=t,e.search.substring(1,e.search.length)}function DRe(t){if(t==="")return t;let e=new URL("https://example.com");return e.hash=t,e.hash.substring(1,e.hash.length)}var Yu,kr,Qn,an,Cc,Qu,ao,Ju,Xu,Zu,ke,Dn,CF,TE,tf,wg,_o,wE,SF,_g,IF,EF,Ag,yu,ic,TF,wF,_F,AF,wi,kF,YM,jRe=(YM=class{constructor(t){on(this,ke);on(this,Yu);on(this,kr,[]);on(this,Qn,{});on(this,an,0);on(this,Cc,1);on(this,Qu,0);on(this,ao,0);on(this,Ju,0);on(this,Xu,0);on(this,Zu,!1);Ft(this,Yu,t)}get result(){return he(this,Qn)}parse(){for(Ft(this,kr,lF(he(this,Yu),!0));he(this,an)<he(this,kr).length;Ft(this,an,he(this,an)+he(this,Cc))){if(Ft(this,Cc,1),he(this,kr)[he(this,an)].type==="END"){if(he(this,ao)===0){Fe(this,ke,TE).call(this),Fe(this,ke,ic).call(this)?Fe(this,ke,Dn).call(this,9,1):Fe(this,ke,yu).call(this)?Fe(this,ke,Dn).call(this,8,1):Fe(this,ke,Dn).call(this,7,0);continue}else if(he(this,ao)===2){Fe(this,ke,tf).call(this,5);continue}Fe(this,ke,Dn).call(this,10,0);break}if(he(this,Ju)>0)if(Fe(this,ke,wF).call(this))Ft(this,Ju,he(this,Ju)-1);else continue;if(Fe(this,ke,TF).call(this)){Ft(this,Ju,he(this,Ju)+1);continue}switch(he(this,ao)){case 0:Fe(this,ke,wE).call(this)&&Fe(this,ke,tf).call(this,1);break;case 1:if(Fe(this,ke,wE).call(this)){Fe(this,ke,kF).call(this);let t=7,e=1;Fe(this,ke,SF).call(this)?(t=2,e=3):he(this,Zu)&&(t=2),Fe(this,ke,Dn).call(this,t,e)}break;case 2:Fe(this,ke,_g).call(this)?Fe(this,ke,tf).call(this,3):(Fe(this,ke,Ag).call(this)||Fe(this,ke,yu).call(this)||Fe(this,ke,ic).call(this))&&Fe(this,ke,tf).call(this,5);break;case 3:Fe(this,ke,IF).call(this)?Fe(this,ke,Dn).call(this,4,1):Fe(this,ke,_g).call(this)&&Fe(this,ke,Dn).call(this,5,1);break;case 4:Fe(this,ke,_g).call(this)&&Fe(this,ke,Dn).call(this,5,1);break;case 5:Fe(this,ke,_F).call(this)?Ft(this,Xu,he(this,Xu)+1):Fe(this,ke,AF).call(this)&&Ft(this,Xu,he(this,Xu)-1),Fe(this,ke,EF).call(this)&&!he(this,Xu)?Fe(this,ke,Dn).call(this,6,1):Fe(this,ke,Ag).call(this)?Fe(this,ke,Dn).call(this,7,0):Fe(this,ke,yu).call(this)?Fe(this,ke,Dn).call(this,8,1):Fe(this,ke,ic).call(this)&&Fe(this,ke,Dn).call(this,9,1);break;case 6:Fe(this,ke,Ag).call(this)?Fe(this,ke,Dn).call(this,7,0):Fe(this,ke,yu).call(this)?Fe(this,ke,Dn).call(this,8,1):Fe(this,ke,ic).call(this)&&Fe(this,ke,Dn).call(this,9,1);break;case 7:Fe(this,ke,yu).call(this)?Fe(this,ke,Dn).call(this,8,1):Fe(this,ke,ic).call(this)&&Fe(this,ke,Dn).call(this,9,1);break;case 8:Fe(this,ke,ic).call(this)&&Fe(this,ke,Dn).call(this,9,1);break}}he(this,Qn).hostname!==void 0&&he(this,Qn).port===void 0&&(he(this,Qn).port="")}},Yu=new WeakMap,kr=new WeakMap,Qn=new WeakMap,an=new WeakMap,Cc=new WeakMap,Qu=new WeakMap,ao=new WeakMap,Ju=new WeakMap,Xu=new WeakMap,Zu=new WeakMap,ke=new WeakSet,Dn=function(t,e){var n,r,o;switch(he(this,ao)){case 0:break;case 1:he(this,Qn).protocol=Fe(this,ke,wi).call(this);break;case 2:break;case 3:he(this,Qn).username=Fe(this,ke,wi).call(this);break;case 4:he(this,Qn).password=Fe(this,ke,wi).call(this);break;case 5:he(this,Qn).hostname=Fe(this,ke,wi).call(this);break;case 6:he(this,Qn).port=Fe(this,ke,wi).call(this);break;case 7:he(this,Qn).pathname=Fe(this,ke,wi).call(this);break;case 8:he(this,Qn).search=Fe(this,ke,wi).call(this);break;case 9:he(this,Qn).hash=Fe(this,ke,wi).call(this);break}he(this,ao)!==0&&t!==10&&([1,2,3,4].includes(he(this,ao))&&[6,7,8,9].includes(t)&&((n=he(this,Qn)).hostname??(n.hostname="")),[1,2,3,4,5,6].includes(he(this,ao))&&[8,9].includes(t)&&((r=he(this,Qn)).pathname??(r.pathname=he(this,Zu)?"/":"")),[1,2,3,4,5,6,7].includes(he(this,ao))&&t===9&&((o=he(this,Qn)).search??(o.search=""))),Fe(this,ke,CF).call(this,t,e)},CF=function(t,e){Ft(this,ao,t),Ft(this,Qu,he(this,an)+e),Ft(this,an,he(this,an)+e),Ft(this,Cc,0)},TE=function(){Ft(this,an,he(this,Qu)),Ft(this,Cc,0)},tf=function(t){Fe(this,ke,TE).call(this),Ft(this,ao,t)},wg=function(t){return t<0&&(t=he(this,kr).length-t),t<he(this,kr).length?he(this,kr)[t]:he(this,kr)[he(this,kr).length-1]},_o=function(t,e){let n=Fe(this,ke,wg).call(this,t);return n.value===e&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")},wE=function(){return Fe(this,ke,_o).call(this,he(this,an),":")},SF=function(){return Fe(this,ke,_o).call(this,he(this,an)+1,"/")&&Fe(this,ke,_o).call(this,he(this,an)+2,"/")},_g=function(){return Fe(this,ke,_o).call(this,he(this,an),"@")},IF=function(){return Fe(this,ke,_o).call(this,he(this,an),":")},EF=function(){return Fe(this,ke,_o).call(this,he(this,an),":")},Ag=function(){return Fe(this,ke,_o).call(this,he(this,an),"/")},yu=function(){if(Fe(this,ke,_o).call(this,he(this,an),"?"))return!0;if(he(this,kr)[he(this,an)].value!=="?")return!1;let t=Fe(this,ke,wg).call(this,he(this,an)-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"},ic=function(){return Fe(this,ke,_o).call(this,he(this,an),"#")},TF=function(){return he(this,kr)[he(this,an)].type=="OPEN"},wF=function(){return he(this,kr)[he(this,an)].type=="CLOSE"},_F=function(){return Fe(this,ke,_o).call(this,he(this,an),"[")},AF=function(){return Fe(this,ke,_o).call(this,he(this,an),"]")},wi=function(){let t=he(this,kr)[he(this,an)],e=Fe(this,ke,wg).call(this,he(this,Qu)).index;return he(this,Yu).substring(e,t.index)},kF=function(){let t={};Object.assign(t,ea),t.encodePart=UA;let e=yRe(Fe(this,ke,wi).call(this),void 0,t);Ft(this,Zu,mF(e))},YM),Q0=["protocol","username","password","hostname","port","pathname","search","hash"],Js="*";function zM(t,e){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,e);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}function us(t,e){return e?nf(t):t}function Vh(t,e,n){let r;if(typeof e.baseURL=="string")try{r=new URL(e.baseURL),e.protocol===void 0&&(t.protocol=us(r.protocol.substring(0,r.protocol.length-1),n)),!n&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&(t.username=us(r.username,n)),!n&&e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.username===void 0&&e.password===void 0&&(t.password=us(r.password,n)),e.protocol===void 0&&e.hostname===void 0&&(t.hostname=us(r.hostname,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&(t.port=us(r.port,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&(t.pathname=us(r.pathname,n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&(t.search=us(r.search.substring(1,r.search.length),n)),e.protocol===void 0&&e.hostname===void 0&&e.port===void 0&&e.pathname===void 0&&e.search===void 0&&e.hash===void 0&&(t.hash=us(r.hash.substring(1,r.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${e.baseURL}'.`)}if(typeof e.protocol=="string"&&(t.protocol=RRe(e.protocol,n)),typeof e.username=="string"&&(t.username=ARe(e.username,n)),typeof e.password=="string"&&(t.password=_Re(e.password,n)),typeof e.hostname=="string"&&(t.hostname=wRe(e.hostname,n)),typeof e.port=="string"&&(t.port=xRe(e.port,t.protocol,n)),typeof e.pathname=="string"){if(t.pathname=e.pathname,r&&!SRe(t.pathname,n)){let o=r.pathname.lastIndexOf("/");o>=0&&(t.pathname=us(r.pathname.substring(0,o+1),n)+t.pathname)}t.pathname=kRe(t.pathname,t.protocol,n)}return typeof e.search=="string"&&(t.search=TRe(e.search,n)),typeof e.hash=="string"&&(t.hash=ERe(e.hash,n)),t}function nf(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}function URe(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function FRe(t,e){e.delimiter??(e.delimiter="/#?"),e.prefixes??(e.prefixes="./"),e.sensitive??(e.sensitive=!1),e.strict??(e.strict=!1),e.end??(e.end=!0),e.start??(e.start=!0),e.endsWith="";let n=".*",r=`[^${URe(e.delimiter)}]+?`,o=/[$_\u200C\u200D\p{ID_Continue}]/u,i="";for(let s=0;s<t.length;++s){let a=t[s];if(a.type===3){if(a.modifier===3){i+=nf(a.value);continue}i+=`{${nf(a.value)}}${Mu(a.modifier)}`;continue}let l=a.hasCustomName(),u=!!a.suffix.length||!!a.prefix.length&&(a.prefix.length!==1||!e.prefixes.includes(a.prefix)),h=s>0?t[s-1]:null,f=s<t.length-1?t[s+1]:null;if(!u&&l&&a.type===1&&a.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let p=f.value.length>0?f.value[0]:"";u=o.test(p)}else u=!f.hasCustomName();if(!u&&!a.prefix.length&&h&&h.type===3){let p=h.value[h.value.length-1];u=e.prefixes.includes(p)}u&&(i+="{"),i+=nf(a.prefix),l&&(i+=`:${a.name}`),a.type===2?i+=`(${a.value})`:a.type===1?l||(i+=`(${r})`):a.type===0&&(!l&&(!h||h.type===3||h.modifier!==3||u||a.prefix!=="")?i+="*":i+=`(${n})`),a.type===1&&l&&a.suffix.length&&o.test(a.suffix[0])&&(i+="\\"),i+=nf(a.suffix),u&&(i+="}"),a.modifier!==3&&(i+=Mu(a.modifier))}return i}var Ni,Sc,ed,Jn,Jo,td,QM,BRe=(QM=class{constructor(t={},e,n){on(this,Ni);on(this,Sc,{});on(this,ed,{});on(this,Jn,{});on(this,Jo,{});on(this,td,!1);try{let r;if(typeof e=="string"?r=e:n=e,typeof t=="string"){let a=new jRe(t);if(a.parse(),t=a.result,r===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=r}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(r)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let o={ignoreCase:n.ignoreCase===!0};Ft(this,Ni,Vh({pathname:Js,protocol:Js,username:Js,password:Js,hostname:Js,port:Js,search:Js,hash:Js},t,!0)),gF(he(this,Ni).protocol)===he(this,Ni).port&&(he(this,Ni).port="");let s;for(s of Q0){if(!(s in he(this,Ni)))continue;let a={},l=he(this,Ni)[s];switch(he(this,ed)[s]=[],s){case"protocol":Object.assign(a,ea),a.encodePart=UA;break;case"username":Object.assign(a,ea),a.encodePart=NRe;break;case"password":Object.assign(a,ea),a.encodePart=PRe;break;case"hostname":Object.assign(a,bRe),fF(l)?a.encodePart=yF:a.encodePart=vF;break;case"port":Object.assign(a,ea),a.encodePart=bF;break;case"pathname":mF(he(this,Sc).protocol)?(Object.assign(a,CRe,o),a.encodePart=MRe):(Object.assign(a,ea,o),a.encodePart=ORe);break;case"search":Object.assign(a,ea,o),a.encodePart=LRe;break;case"hash":Object.assign(a,ea,o),a.encodePart=DRe;break}try{he(this,Jo)[s]=uF(l,a),he(this,Sc)[s]=dF(he(this,Jo)[s],he(this,ed)[s],a),he(this,Jn)[s]=FRe(he(this,Jo)[s],a),Ft(this,td,he(this,td)||he(this,Jo)[s].some(u=>u.type===2))}catch{throw new TypeError(`invalid ${s} pattern '${he(this,Ni)[s]}'.`)}}}catch(r){throw new TypeError(`Failed to construct 'URLPattern': ${r.message}`)}}test(t={},e){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=Vh(n,t,!1):n=Vh(n,zM(t,e),!1)}catch{return!1}let r;for(r of Q0)if(!he(this,Sc)[r].exec(n[r]))return!1;return!0}exec(t={},e){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=Vh(n,t,!1):n=Vh(n,zM(t,e),!1)}catch{return null}let r={};e?r.inputs=[t,e]:r.inputs=[t];let o;for(o of Q0){let i=he(this,Sc)[o].exec(n[o]);if(!i)return null;let s={};for(let[a,l]of he(this,ed)[o].entries())if(typeof l=="string"||typeof l=="number"){let u=i[a+1];s[l]=u}r[o]={input:n[o]??"",groups:s}}return r}static compareComponent(t,e,n){let r=(a,l)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(a[u]<l[u])return-1;if(a[u]!==l[u])return 1}return 0},o=new Af(3,"","","","",3),i=new Af(0,"","","","",3),s=(a,l)=>{let u=0;for(;u<Math.min(a.length,l.length);++u){let h=r(a[u],l[u]);if(h)return h}return a.length===l.length?0:r(a[u]??o,l[u]??o)};return!he(e,Jn)[t]&&!he(n,Jn)[t]?0:he(e,Jn)[t]&&!he(n,Jn)[t]?s(he(e,Jo)[t],[i]):!he(e,Jn)[t]&&he(n,Jn)[t]?s([i],he(n,Jo)[t]):s(he(e,Jo)[t],he(n,Jo)[t])}get protocol(){return he(this,Jn).protocol}get username(){return he(this,Jn).username}get password(){return he(this,Jn).password}get hostname(){return he(this,Jn).hostname}get port(){return he(this,Jn).port}get pathname(){return he(this,Jn).pathname}get search(){return he(this,Jn).search}get hash(){return he(this,Jn).hash}get hasRegExpGroups(){return he(this,td)}},Ni=new WeakMap,Sc=new WeakMap,ed=new WeakMap,Jn=new WeakMap,Jo=new WeakMap,td=new WeakMap,QM);globalThis.URLPattern||(globalThis.URLPattern=BRe);let xF;function EOe(t){xF=t}function HRe(){var t,e;typeof window<"u"&&(window.copilotTrustedTypesPolicy=(t=window.trustedTypes)==null?void 0:t.createPolicy("copilotPolicy",{createHTML:n=>BM.sanitize(n)}),(e=window.trustedTypes)==null||e.createPolicy("default",{createScriptURL:n=>{const r=/^\/cl\//,o=new URLPattern({protocol:"https",hostname:"*.clarity.ms"}),i=new URLPattern({protocol:"https",hostname:"*.cloudflare.com"}),s=new URLPattern({protocol:"https",hostname:"bat.bing.com"}),a=new URLPattern({protocol:"https",hostname:"az416426.vo.msecnd.net"}),l=new URLPattern({protocol:"https",hostname:"fpt.dfp.microsoft.com"}),u=new URLPattern({protocol:"https",hostname:"assets.msn.com"}),h=new URLPattern({protocol:"https",hostname:"content.lifecycle.office.net"}),f=new URLPattern({protocol:"https",hostname:"*.paypal.com"}),p=new URLPattern({protocol:"https",hostname:"*.paypalobjects.com"});if(r.test(n)||o.test(n)||i.test(n)||s.test(n)||a.test(n)||l.test(n)||u.test(n)||h.test(n)||f.test(n)||p.test(n)||n===xF)return n;throw new Error(`Unsafe script URL "${n}" blocked by CSP.`)},createHTML:n=>BM.sanitize(n)}))}HRe();hH.createRoot(document.getElementById("app")).render(d.jsx(nl.StrictMode,{children:d.jsx(qxe,{})}));const zRe=Object.freeze(Object.defineProperty({__proto__:null,Route:S_e},Symbol.toStringTag,{value:"Module"}));export{XU as $,me as A,Te as B,CE as C,Ol as D,rL as E,wn as F,se as G,ot as H,ms as I,yn as J,Fg as K,ha as L,cT as M,j8 as N,Ru as O,_O as P,wl as Q,cr as R,Td as S,co as T,v2e as U,ee as V,eA as W,ey as X,Pg as Y,Os as Z,qb as _,jNe as a,vE as a$,it as a0,MPe as a1,U as a2,Ue as a3,lNe as a4,KI as a5,cO as a6,jG as a7,Be as a8,jt as a9,HN as aA,WT as aB,gs as aC,kPe as aD,Fhe as aE,Nhe as aF,Ube as aG,RPe as aH,zpe as aI,XE as aJ,JNe as aK,wt as aL,rl as aM,Sr as aN,_l as aO,Lhe as aP,XRe as aQ,JRe as aR,P_ as aS,k8 as aT,eo as aU,vMe as aV,tD as aW,Lde as aX,yZ as aY,iE as aZ,Zd as a_,G_ as aa,H as ab,Ls as ac,nt as ad,Rt as ae,$n as af,w2e as ag,Ur as ah,Fq as ai,Wr as aj,T2e as ak,cy as al,mi as am,oX as an,$y as ao,Sn as ap,Gy as aq,ay as ar,Wb as as,SO as at,iX as au,pl as av,Jbe as aw,Xbe as ax,Rfe as ay,Oue as az,G9 as b,Q$ as b$,a8 as b0,s8 as b1,oSe as b2,sSe as b3,cSe as b4,tMe as b5,lSe as b6,uSe as b7,Wd as b8,$t as b9,z9 as bA,Uo as bB,Eh as bC,SNe as bD,aa as bE,da as bF,h2e as bG,f2e as bH,p2e as bI,Q5 as bJ,Cr as bK,w0e as bL,ba as bM,pi as bN,K9 as bO,uMe as bP,Vue as bQ,js as bR,Gbe as bS,P2e as bT,li as bU,D2e as bV,L2e as bW,Ro as bX,j2e as bY,y2e as bZ,Co as b_,Cy as ba,GE as bb,KE as bc,Ho as bd,Xt as be,xNe as bf,ANe as bg,PNe as bh,$he as bi,Ghe as bj,PN as bk,Ha as bl,CO as bm,gn as bn,ns as bo,Xh as bp,gde as bq,br,fbe as bs,Nc as bt,Us as bu,ts as bv,jp as bw,Ige as bx,XIe as by,fA as bz,Y as c,o6 as c$,Dr as c0,Ed as c1,rp as c2,xa as c3,Yd as c4,C8 as c5,s0e as c6,CU as c7,Dp as c8,OMe as c9,MT as cA,a0e as cB,cp as cC,CNe as cD,Khe as cE,wee as cF,cn as cG,bG as cH,yG as cI,o7 as cJ,Z8 as cK,K0e as cL,TMe as cM,eMe as cN,SMe as cO,CMe as cP,wMe as cQ,IMe as cR,EMe as cS,Il as cT,k2e as cU,gp as cV,V_ as cW,D_ as cX,sEe as cY,Tl as cZ,n2e as c_,_Ie as ca,AIe as cb,Kbe as cc,zMe as cd,vu as ce,w5 as cf,$p as cg,Ibe as ch,ibe as ci,rd as cj,ZX as ck,bo as cl,tT as cm,t2e as cn,H2e as co,cL as cp,YCe as cq,F7 as cr,U7 as cs,QIe as ct,Lp as cu,F5 as cv,Ic as cw,Hp as cx,LG as cy,gG as cz,ar as d,By as d$,Uj as d0,ale as d1,Xse as d2,Ka as d3,Hv as d4,ia as d5,kt as d6,I6 as d7,Kc as d8,Vae as d9,Y_ as dA,ede as dB,Xde as dC,_8 as dD,K_ as dE,ZT as dF,Hn as dG,j0e as dH,hl as dI,IM as dJ,L_ as dK,U5 as dL,FAe as dM,LMe as dN,Fb as dO,y1e as dP,Na as dQ,LE as dR,qI as dS,VNe as dT,PV as dU,dde as dV,wA as dW,gSe as dX,TP as dY,hOe as dZ,Dd as d_,Ta as da,hI as db,yr as dc,MNe as dd,dI as de,c2 as df,T_ as dg,Xae as dh,gI as di,Eae as dj,tue as dk,lle as dl,cle as dm,Nm as dn,rle as dp,fj as dq,Ace as dr,_ce as ds,Nce as dt,NTe as du,MV as dv,PT as dw,H7 as dx,yNe as dy,vO as dz,vi as e,N2e as e$,DX as e0,CA as e1,M8 as e2,yMe as e3,pp as e4,QPe as e5,qm as e6,Zo as e7,ec as e8,Qs as e9,BU as eA,$0e as eB,JX as eC,g8 as eD,$T as eE,VT as eF,ze as eG,QV as eH,ife as eI,kMe as eJ,oL as eK,u2e as eL,d2e as eM,fG as eN,TM as eO,iPe as eP,rPe as eQ,fPe as eR,hPe as eS,nPe as eT,bn as eU,Phe as eV,HSe as eW,cPe as eX,pPe as eY,qy as eZ,kU as e_,If as ea,dA as eb,Jv as ec,$Ae as ed,G_e as ee,$Me as ef,rA as eg,xl as eh,Ll as ei,Zi as ej,Fp as ek,$Ne as el,Xhe as em,ip as en,jA as eo,gke as ep,H_ as eq,hTe as er,dTe as es,BMe as et,qAe as eu,h1e as ev,l1e as ew,c7 as ex,FMe as ey,d1e as ez,FNe as f,lfe as f$,bO as f0,SA as f1,yU as f2,hhe as f3,th as f4,Vbe as f5,Hb as f6,Xz as f7,g7 as f8,bpe as f9,DMe as fA,O2e as fB,VMe as fC,jMe as fD,PIe as fE,UMe as fF,f5 as fG,O8 as fH,NIe as fI,OE as fJ,$z as fK,od as fL,Whe as fM,gPe as fN,bMe as fO,by as fP,x8 as fQ,Vb as fR,ON as fS,Xee as fT,h5 as fU,Dt as fV,Pfe as fW,Nfe as fX,gK as fY,Qd as fZ,APe as f_,M2e as fa,$we as fb,w8 as fc,di as fd,xT as fe,zX as ff,F2e as fg,kT as fh,pG as fi,W_ as fj,Z_ as fk,oD as fl,lD as fm,$be as fn,iD as fo,dOe as fp,lAe as fq,x2e as fr,lPe as fs,dPe as ft,uPe as fu,dd as fv,Sp as fw,rD as fx,UT as fy,Fbe as fz,d1 as g,BNe as g$,uy as g0,_Ne as g1,Eg as g2,Jye as g3,Or as g4,B9 as g5,UNe as g6,jf as g7,tK as g8,VE as g9,zU as gA,jIe as gB,UIe as gC,uN as gD,B2e as gE,EPe as gF,BM as gG,RV as gH,fp as gI,fMe as gJ,bX as gK,N5 as gL,dMe as gM,mMe as gN,Y5 as gO,C2e as gP,Q2e as gQ,J2e as gR,Y2e as gS,yX as gT,hMe as gU,Vde as gV,Bde as gW,_f as gX,rn as gY,SM as gZ,HNe as g_,$E as ga,e1 as gb,Zhe as gc,_ge as gd,wbe as ge,Yz as gf,obe as gg,LNe as gh,ONe as gi,Uy as gj,eNe as gk,Cp as gl,vAe as gm,Aee as gn,RC as go,LD as gp,gg as gq,sIe as gr,S2e as gs,Lr as gt,zg as gu,Jb as gv,Dfe as gw,Ofe as gx,J7 as gy,Q7 as gz,eC as h,Vfe as h$,nAe as h0,m7 as h1,G2e as h2,rf as h3,_U as h4,LEe as h5,HPe as h6,M_e as h7,GCe as h8,jP as h9,De as hA,Sy as hB,Oc as hC,dn as hD,Rr as hE,Nr as hF,Ey as hG,Do as hH,eT as hI,Es as hJ,QE as hK,Mc as hL,go as hM,cNe as hN,E2e as hO,A2e as hP,_2e as hQ,fT as hR,o2e as hS,aNe as hT,JIe as hU,fl as hV,Ehe as hW,Ff as hX,hn as hY,TPe as hZ,wPe as h_,ySe as ha,Y9 as hb,zE as hc,dCe as hd,Mue as he,En as hf,zx as hg,wNe as hh,ENe as hi,TNe as hj,LCe as hk,NCe as hl,UCe as hm,ua as hn,XPe as ho,JPe as hp,INe as hq,cX as hr,Yg as hs,I2e as ht,Y7 as hu,qO as hv,ZE as hw,No as hx,Ts as hy,Pi as hz,_t as i,_Me as i$,Sfe as i0,Ife as i1,EOe as i2,z_ as i3,VAe as i4,RNe as i5,Gx as i6,NNe as i7,_Ae as i8,Z7 as i9,F9 as iA,oy as iB,ry as iC,Xye as iD,$9 as iE,jPe as iF,q_e as iG,ebe as iH,xPe as iI,UD as iJ,L_e as iK,Yb as iL,nMe as iM,QNe as iN,v9 as iO,Sl as iP,HMe as iQ,UE as iR,rMe as iS,AG as iT,qU as iU,za as iV,An as iW,uNe as iX,_Pe as iY,rM as iZ,GMe as i_,cOe as ia,aOe as ib,ehe as ic,Zde as id,o_e as ie,rOe as ig,oOe as ih,iOe as ii,vM as ij,sOe as ik,CN as il,Fm as im,pMe as io,bNe as ip,m8 as iq,p8 as ir,LK as is,GP as it,lX as iu,KP as iv,c2e as iw,l2e as ix,Df as iy,$P as iz,El as j,Zwe as j$,T5 as j0,_fe as j1,FN as j2,Afe as j3,Cbe as j4,$m as j5,Abe as j6,kfe as j7,HU as j8,na as j9,YRe as jA,dNe as jB,UX as jC,BX as jD,nNe as jE,ZRe as jF,jX as jG,ND as jH,z2e as jI,aX as jJ,V2e as jK,K2e as jL,W2e as jM,q2e as jN,cd as jO,e2e as jP,xU as jQ,Zv as jR,Ip as jS,qCe as jT,B5 as jU,DG as jV,FX as jW,iU as jX,Nde as jY,Yde as jZ,zy as j_,m9 as ja,NSe as jb,c1e as jc,jpe as jd,Mpe as je,vpe as jf,zfe as jg,D7 as jh,eCe as ji,Xi as jj,XJ as jk,tNe as jl,gCe as jm,iy as jn,i8 as jo,ZPe as jp,DT as jq,sM as jr,JMe as js,CG as jt,RT as ju,JJ as jv,KT as jw,DD as jx,WRe as jy,QRe as jz,jo as k,sge as k$,j5 as k0,hIe as k1,qRe as k2,uke as k3,gOe as k4,yOe as k5,bOe as k6,z5 as k7,FT as k8,rNe as k9,WNe as kA,Up as kB,RTe as kC,$2e as kD,Sa as kE,hA as kF,zNe as kG,kf as kH,qhe as kI,_ue as kJ,b1e as kK,U8 as kL,Hme as kM,Vme as kN,X_ as kO,NV as kP,r2e as kQ,FE as kR,cMe as kS,T1e as kT,oPe as kU,mPe as kV,fIe as kW,XNe as kX,$b as kY,s1e as kZ,age as k_,oNe as ka,_5 as kb,q5 as kc,$X as kd,GX as ke,VX as kf,DNe as kg,DPe as kh,u_e as ki,b2e as kj,Hy as kk,sNe as kl,SOe as km,COe as kn,hy as ko,bE as kp,DA as kq,vOe as kr,Z2e as ks,iNe as kt,LT as ku,X2e as kv,g2e as kw,sz as kx,lT as ky,tCe as kz,Lt as l,QMe as l$,Ns as l0,ya as l1,U2e as l2,Bpe as l3,LPe as l4,hEe as l5,EA as l6,J_ as l7,VTe as l8,m2e as l9,SPe as lA,IPe as lB,nA as lC,OPe as lD,zPe as lE,VPe as lF,$Pe as lG,GPe as lH,KPe as lI,qPe as lJ,WPe as lK,YPe as lL,oMe as lM,iMe as lN,sMe as lO,aMe as lP,lMe as lQ,gMe as lR,xMe as lS,RMe as lT,NMe as lU,PMe as lV,MMe as lW,KMe as lX,qMe as lY,WMe as lZ,YMe as l_,AMe as la,L7 as lb,tPe as lc,ePe as ld,ZNe as le,NPe as lf,PPe as lg,Hpe as lh,sPe as li,aPe as lj,R2e as lk,lQ as ll,boe as lm,kNe as ln,U_ as lo,i2e as lp,s2e as lq,a2e as lr,GNe as ls,KNe as lt,qNe as lu,YNe as lv,vPe as lw,yPe as lx,bPe as ly,CPe as lz,zde as m,XMe as m0,ZMe as m1,eOe as m2,tOe as m3,lOe as m4,uOe as m5,fOe as m6,pOe as m7,mOe as m8,IOe as m9,Mr as n,Pc as o,Rl as p,_A as q,Zr as r,Fa as s,R8 as t,xe as u,gi as v,V5 as w,yE as x,Xv as y,Xpe as z};

//# debugId=9d6227d6-c0f1-54a4-96a3-a011de4575fb
